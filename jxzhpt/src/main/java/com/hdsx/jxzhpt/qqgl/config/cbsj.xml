<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.cbsj">
	<select id="queryCbsjLmgz" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.id, c.xmmc, c.xmbm, c.jsdw, c.xzqh, c.jsxz, c.lj, c.ql, c.hd, c.mc, c.jc, c.dc, c.sd, c.dq, c.sdmc, k.kgny kgsj,k.wgny wgsj, c.gq, c.sjdw, c.sjpfwh, c.pfsj, c.jaf,l.gydw,c.tz,l.tsdq,k.gkpfwh,  
		        c.shzt, c.sbzt, ql_ym, hd_m, sd_ym, dq_cd, dq_dk, sd_sfcd, sd_lx, sfbj, mc_lc, jc_lc, dc_lc, c.dfzc, c.yhdk
		        ,l.ghlxbh,l.lsjl,lx.qdzh,lx.zdzh,lx.jsjsdj,lx.lc,sl.xmsl,lx.ghlxbm,lx.ghlxmc,lx.ghqdzh,lx.ghzdzh,sl.zlc,c.bz
		        from cbsj_lmgz c left join lxsh_lmgz l on c.xmbm=l.xmbm left join kxxyj_lmgz k on c.xmbm=k.xmbm left join lxsh_lx lx on c.xmbm=lx.xmid
		        left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on c.xmbm=sl.xmid left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
		        where lx.jdbs='2' and lx.sffirst='1' 
		        <if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
					and lx.ghlxmc=#{cbsj.ghlxmc}
				</if>
				<!-- <if test="cbsj.ghlxbm!='' and cbsj.ghlxbm!= null ">
					and lx.ghlxbm=#{cbsj.ghlxbm}
				</if> -->
				<if test="cbsj.lxmc!='' and cbsj.lxmc!= null ">
					and lx.lxmc like '%'||{cbsj.lxmc}||'%'
				</if>
				<if test="cbsj.xmklx!='' and cbsj.xmklx!= null ">
					and xmklx like '%'||#{cbsj.xmklx}||'%'
				</if>
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbh})
				</if>
				<if test="cbsj.ghlxbm!=null and cbsj.ghlxbm!=''">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbm})
					)
				</if>
				<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%2___')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
				<if test="cbsj.lsjl!=null and cbsj.lsjl!=''">and l.lsjl=#{cbsj.lsjl}</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">${cbsj.tsdq}</if>
				<if test="cbsj.xmnf!=null and cbsj.xmnf!=''">and ${cbsj.xmnf}</if>
				<if test="cbsj.sbzt!=null and cbsj.sbzt!=''">and c.sbzt=#{cbsj.sbzt}</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
				<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
				<if test="cbsj.xmbm !=null and cbsj.xmbm !=''">and c.xmbm like '%'||#{cbsj.xmbm}||'%'</if>
				
				<if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{cbsj.ghlxmc}||'%')

					)
				</if>
				<if test="cbsj.lsxmnf !='' and cbsj.lsxmnf != null ">
					${cbsj.lsxmnf}
				</if>
				<if test="cbsj.lsxmlx !='' and cbsj.lsxmlx != null ">
					${cbsj.lsxmlx}
				</if>
				order by c.shzt,c.xmbm desc ) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	<select id="queryCbsjLmgzbg" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.id, c.xmmc, c.xmbm, jsdw, c.xzqh, c.jsxz, lj, ql, hd, mc, jc, dc, sd, dq, sdmc, kgsj, wgsj, gq, sjdw, sjpfwh, pfsj, jaf, 
		        c.shzt, c.sbzt, ql_ym, hd_m, sd_ym, dq_cd, dq_dk, sd_sfcd, sd_lx, sfbj, mc_lc, jc_lc, dc_lc, c.dfzc, c.yhdk
		        ,l.ghlxbh,l.lsjl,lx.qdzh,lx.zdzh,lx.jsjsdj,lx.lc,sl.xmsl,c.tzxz,c.tzsj
		        from cbsj_lmgz_tz c left join lxsh_lmgz l on c.xmbm=l.xmbm left join lxsh_lx_tz lx on c.xmbm=lx.xmid
		        left join (select xmid,count(xmid) xmsl from lxsh_lx_tz where jdbs='2' group by xmid) sl on c.xmbm=sl.xmid
		        where lx.jdbs='2' and lx.sffirst='1'
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
				</if>
				<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where ${cbsj.ylxbh} and xmid like '%2___')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
				<if test="cbsj.lsjl!=null and cbsj.lsjl!=''">and l.lsjl=#{cbsj.lsjl}</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">${cbsj.tsdq}</if>
				<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
				<if test="cbsj.tzxz !=null and cbsj.tzxz !=''">and c.tzxz like '%'||#{cbsj.tzxz}||'%'</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
				<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
				order by c.shzt,c.xmbm desc ) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	<select id="queryCbsjLmsj" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.id, c.xmmc, c.xmbm, c.jsdw, c.xzqh, c.jsxz, c.lj, c.ql, c.hd, c.mc, c.jc, c.dc, c.sd, c.dq, c.sdmc, k.kgny kgsj,k.wgny wgsj, c.gq, c.sjdw, c.sjpfwh, c.pfsj, c.jaf,l.gydw,c.tz,l.tsdq,k.gkpfwh,
		        c.shzt, c.sbzt, ql_ym, hd_m, sd_ym, dq_cd, dq_dk, sd_sfcd, sd_lx, sfbj, mc_lc, jc_lc, dc_lc, c.dfzc, c.yhdk,l.ghlxbh,l.lsjl,
		        lx.qdzh,lx.zdzh,c.jsjsdj,lx.lc,sl.xmsl,lx.ghlxbm,lx.ghlxmc,lx.ghqdzh,lx.ghzdzh,sl.zlc,c.bz
		        from cbsj_sjgz c left join lxsh_sjgz l on c.xmbm=l.xmbm left join kxxyj_sjgz k on c.xmbm=k.xmbm left join lxsh_lx lx on c.xmbm=lx.xmid
		        left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on c.xmbm=sl.xmid left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
		        where lx.jdbs='2' and lx.sffirst='1'
		        <if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
					and lx.ghlxmc=#{cbsj.ghlxmc}
				</if>
				<!-- <if test="cbsj.ghlxbm!='' and cbsj.ghlxbm!= null ">
					and lx.ghlxbm=#{cbsj.ghlxbm}
				</if> -->
				<if test="cbsj.lxmc!='' and cbsj.lxmc!= null ">
					and lx.lxmc=#{cbsj.lxmc}
				</if>
				<if test="cbsj.xmklx!='' and cbsj.xmklx!= null ">
					and xmklx like '%'||#{cbsj.xmklx}||'%'
				</if>
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
				
				<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%1___')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
				<if test="cbsj.lsjl!=null and cbsj.lsjl!=''">and l.lsjl=#{cbsj.lsjl}</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
					${cbsj.tsdq}
				</if>
				<if test="cbsj.xmnf!=null and cbsj.xmnf!=''">and ${cbsj.xmnf}</if>
				<if test="cbsj.sbzt!=null and cbsj.sbzt!=''">and c.sbzt=#{cbsj.sbzt}</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
				<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
				<if test="cbsj.xmbm !=null and cbsj.xmbm !=''">and c.xmbm like '%'||#{cbsj.xmbm}||'%'</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbh})
				</if>
				<if test="cbsj.ghlxbm!=null and cbsj.ghlxbm!=''">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbm})
					)
				</if>
				<if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{cbsj.ghlxmc}||'%')

					)
				</if>
				<if test="cbsj.lsxmnf !='' and cbsj.lsxmnf != null ">
					${cbsj.lsxmnf}
				</if>
				<if test="cbsj.lsxmlx !='' and cbsj.lsxmlx != null ">
					${cbsj.lsxmlx}
				</if>
				order by c.shzt,c.xmbm desc) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	<select id="queryCbsjLmsjbg" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.id, c.xmmc, c.xmbm, jsdw, c.xzqh, c.jsxz, lj, ql, hd, mc, jc, dc, sd, dq, sdmc, kgsj, wgsj, gq, sjdw, sjpfwh, pfsj, jaf, 
		        c.shzt, c.sbzt, ql_ym, hd_m, sd_ym, dq_cd, dq_dk, sd_sfcd, sd_lx, sfbj, mc_lc, jc_lc, dc_lc, c.dfzc, c.yhdk,l.ghlxbh,l.lsjl,
		        lx.qdzh,lx.zdzh,lx.jsjsdj,lx.lc,sl.xmsl,c.tzxz,c.tzsj
		        from cbsj_sjgz_tz c left join lxsh_sjgz l on c.xmbm=l.xmbm left join lxsh_lx_tz lx on c.xmbm=lx.xmid
		        left join (select xmid,count(xmid) xmsl from lxsh_lx_tz where jdbs='2' group by xmid) sl on c.xmbm=sl.xmid
		        where lx.jdbs='2' and lx.sffirst='1'
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
				</if>
				<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where ${cbsj.ylxbh} and xmid like '%1___')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
				<if test="cbsj.lsjl!=null and cbsj.lsjl!=''">and l.lsjl=#{cbsj.lsjl}</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
					${cbsj.tsdq}
				</if>
				<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
				<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
				<if test="cbsj.tzxz !=null and cbsj.tzxz !=''">and c.tzxz like '%'||#{cbsj.tzxz}||'%'</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
				order by c.shzt,c.xmbm desc) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	<select id="queryCbsjXj" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.id, c.xmmc, c.xmbm, c.jsdw, c.xzqh, c.jsxz, c.lj, c.ql, c.hd, c.mc, c.jc, c.dc, c.sd, c.dq, c.sdmc,k.kgny kgsj,k.wgny wgsj, c.gq, c.sjdw, c.sjpfwh, c.pfsj, c.jaf,l.gydw,c.tz,l.tsdq,k.gkpfwh,
				c.shzt, c.sbzt, ql_ym, hd_m, sd_ym, dq_cd, dq_dk, sd_sfcd, sd_lx, sfbj, mc_lc, jc_lc, dc_lc, c.dfzc, c.yhdk
				,lx.xjlxbm ghlxbh,l.lsjl,lx.xjqdzh qdzh,lx.xjzdzh zdzh,lx.jsjsdj,lx.lc,sl.xmsl,sl.zlc,c.bz
				from cbsj_xj c left join lxsh_xj l on c.xmbm=l.xmbm left join kxxyj_xj k on c.xmbm=k.xmbm left join lxsh_lx lx on c.xmbm=lx.xmid
				left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on c.xmbm=sl.xmid left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
				where lx.jdbs='2' and lx.sffirst='1'
				<if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
					and lx.ghlxmc=#{cbsj.ghlxmc}
				</if>
				<!-- <if test="cbsj.ghlxbm!='' and cbsj.ghlxbm!= null ">
					and lx.ghlxbm=#{cbsj.ghlxbm}
				</if> -->
				<if test="cbsj.lxmc!='' and cbsj.lxmc!= null ">
					and lx.lxmc=#{cbsj.lxmc}
				</if>
				<if test="cbsj.xmklx!='' and cbsj.xmklx!= null ">
					and xmklx like '%'||#{cbsj.xmklx}||'%'
				</if>
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
				
				<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%3___')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and l.xjsdj = #{cbsj.xjsdj}</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">${cbsj.tsdq}</if>
				<if test="cbsj.xmnf!=null and cbsj.xmnf!=''">and ${cbsj.xmnf}</if>
				<if test="cbsj.sbzt!=null and cbsj.sbzt!=''">and c.sbzt=#{cbsj.sbzt}</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and c.jsjsdj=#{cbsj.jsjsdj}</if>
				<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
				<if test="cbsj.xmbm !=null and cbsj.xmbm !=''">and c.xmbm like '%'||#{cbsj.xmbm}||'%'</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbh})
				</if>
				<if test="cbsj.ghlxbm!=null and cbsj.ghlxbm!=''">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbm})
					)
				</if>
				<if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{cbsj.ghlxmc}||'%')

					)
				</if>
				<if test="cbsj.lsxmnf !='' and cbsj.lsxmnf != null ">
					${cbsj.lsxmnf}
				</if>
				<if test="cbsj.lsxmlx !='' and cbsj.lsxmlx != null ">
					${cbsj.lsxmlx}
				</if>
				order by c.shzt,c.xmbm desc) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	<select id="queryCbsjXjbg" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.id, c.xmmc, c.xmbm, jsdw, c.xzqh, c.jsxz, lj, ql, hd, mc, jc, dc, sd, dq, sdmc, kgsj, wgsj, gq, sjdw, sjpfwh, pfsj, jaf, 
				c.shzt, c.sbzt, ql_ym, hd_m, sd_ym, dq_cd, dq_dk, sd_sfcd, sd_lx, sfbj, mc_lc, jc_lc, dc_lc, c.dfzc, c.yhdk
				,l.ghlxbh,l.lsjl,lx.qdzh,lx.zdzh,lx.jsjsdj,lx.lc,sl.xmsl,c.tzxz,c.tzsj
				from cbsj_xj_tz c left join lxsh_xj l on c.xmbm=l.xmbm left join lxsh_lx_tz lx on c.xmbm=lx.xmid
				left join (select xmid,count(xmid) xmsl from lxsh_lx_tz where jdbs='2' group by xmid) sl on c.xmbm=sl.xmid
				where lx.jdbs='2' and lx.sffirst='1'
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
				</if>
				<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where ${cbsj.ylxbh} and xmid like '%3___')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and l.xjsdj = #{cbsj.xjsdj}</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">${cbsj.tsdq}</if>
				<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and c.jsjsdj=#{cbsj.jsjsdj}</if>
				<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
				<if test="cbsj.tzxz !=null and cbsj.tzxz !=''">and c.tzxz like '%'||#{cbsj.tzxz}||'%'</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
				order by c.shzt,c.xmbm desc) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	
	<select id="queryCbsjYhdzx" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.id, c.xmbm, c.xmmc, jsdw, c.xzqh, c.jsxz, kgsj, wgsj, c.gq, sjdw, sjpfwh, pfsj, shzt, sbzt, c.jsfa, sfbj, mc, jc, dc, mc_lc, jc_lc, dc_lc,l.gydw,l.tsdq,l.ntz,c.tz,
				l.ghlxbh,l.ylxbh,l.lsjl, lx.qdzh, lx.zdzh,lx.jsjsdj,lx.xjsdj,sl.xmsl,lx.ghlxbm,lx.ghlxmc,lx.ghqdzh,lx.ghzdzh,sl.zlc,sl.sbzj,c.bz from cbsj_yhdzx c left join xmsq_yhdzx l on c.xmbm=l.xmbm left join lxsh_lx lx on c.xmbm=lx.xmid 
				left join (select xmid, WMSYS.WM_CONCAT(distinct to_char(l.xzqhdm2))||';'||WMSYS.WM_CONCAT(distinct to_char(x.xzqhdm2)) xzqhdm2
               from lxsh_lx l,xmsq_yhdzx x
               where l.xmid=x.xmbm
              group by xmid) myxz
				on c.xmbm=myxz.xmid
				left join (select xmid,count(xmid) xmsl,sum(sbzj) sbzj,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on c.xmbm=sl.xmid
				where lx.jdbs='2' and lx.sffirst='1'
				<if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
					and lx.ghlxmc=#{cbsj.ghlxmc}
				</if>
				<!-- <if test="cbsj.ghlxbm!='' and cbsj.ghlxbm!= null ">
					and lx.ghlxbm=#{cbsj.ghlxbm}
				</if> -->
				<if test="cbsj.lxmc!='' and cbsj.lxmc!= null ">
					and lx.lxmc=#{cbsj.lxmc}
				</if>
				
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
				
				<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%4___' and jdbs='2')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
				<if test="cbsj.lsjl!=null and cbsj.lsjl!=''">and l.lsjl=#{cbsj.lsjl}</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
					${cbsj.tsdq}
				</if>
				<if test="cbsj.gcfl!=null and cbsj.gcfl!=''">and ${cbsj.gcfl}</if>
				<if test="cbsj.xmnf!=null and cbsj.xmnf!=''">and ${cbsj.xmnf}</if>
				<if test="cbsj.sbzt!=null and cbsj.sbzt!=''">and c.sbzt=#{cbsj.sbzt}</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
				<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
				<if test="cbsj.xmbm !=null and cbsj.xmbm !=''">and c.xmbm like '%'||#{cbsj.xmbm}||'%'</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.xmlx1 !=null and cbsj.xmlx1 !=''"> ${cbsj.xmlx1}</if>
				<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbh})
				</if>
				<if test="cbsj.ghlxbm!=null and cbsj.ghlxbm!=''">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbm})
					)
				</if>
				<if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{cbsj.ghlxmc}||'%')

					)
				</if>
				<if test="cbsj.lsxmnf !='' and cbsj.lsxmnf != null ">
					${cbsj.lsxmnf}
				</if>
				<if test="cbsj.lsxmlx !='' and cbsj.lsxmlx != null ">
					${cbsj.lsxmlx}
				</if>
				order by c.shzt,c.xmbm desc) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	<select id="queryCbsjYhdzxbg" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.id, c.xmbm, c.xmmc, jsdw, c.xzqh, c.jsxz, kgsj, wgsj, c.gq, sjdw, sjpfwh, pfsj, shzt, sbzt, c.jsfa, sfbj, mc, jc, dc, mc_lc, jc_lc, dc_lc,c.tzxz,c.tzsj,
				l.ghlxbh,l.ylxbh,l.lsjl, lx.qdzh, lx.zdzh,lx.jsjsdj,lx.xjsdj,sl.xmsl from cbsj_yhdzx_tz c left join xmsq_yhdzx l on c.xmbm=l.xmbm left join lxsh_lx_tz lx on c.xmbm=lx.xmid
				left join (select xmid,count(xmid) xmsl from lxsh_lx_tz where jdbs='2' group by xmid) sl on c.xmbm=sl.xmid
				where lx.jdbs='2' and lx.sffirst='1'
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
				</if>
				<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where ${cbsj.ylxbh} and xmid like '%4___' and jdbs='2')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
				<if test="cbsj.lsjl!=null and cbsj.lsjl!=''">and l.lsjl=#{cbsj.lsjl}</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
					${cbsj.tsdq}
				</if>
				<if test="cbsj.gcfl!=null and cbsj.gcfl!=''">and ${cbsj.gcfl}</if>
				<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
				<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
				<if test="cbsj.tzxz !=null and cbsj.tzxz !=''">and c.tzxz like '%'||#{cbsj.tzxz}||'%'</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
				order by c.shzt,c.xmbm desc) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	
	<select id="queryCbsjSh" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.id, c.xmbm, c.xmmc, jsdw, c.xzqh, c.jsxz, kgsj, wgsj, c.gq, sjdw, sjpfwh, pfsj, shzt, sbzt, c.jsfa, sfbj, mc, jc, dc, mc_lc, jc_lc, dc_lc,lx.lc,l.gydw,l.tsdq,l.ntz,c.tz,
				l.ghlxbh,l.ylxbh,l.lsjl, lx.qdzh, lx.zdzh,lx.jsjsdj,lx.xjsdj,sl.xmsl,lx.ghlxbm,lx.ghlxmc,lx.ghqdzh,lx.ghzdzh,sl.zlc,c.bz from cbsj_sh c left join xmsq_sh l on c.xmbm=l.xmbm left join lxsh_lx lx on c.xmbm=lx.xmid left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
				left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on c.xmbm=sl.xmid
				where lx.jdbs='2' and lx.sffirst='1'
				<if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
					and lx.ghlxmc=#{cbsj.ghlxmc}
				</if>
				<!-- <if test="cbsj.ghlxbm!='' and cbsj.ghlxbm!= null ">
					and lx.ghlxbm=#{cbsj.ghlxbm}
				</if> -->
				<if test="cbsj.lxmc!='' and cbsj.lxmc!= null ">
					and lx.lxmc=#{cbsj.lxmc}
				</if>
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
				
				<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%5___' and jdbs='2')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
				<if test="cbsj.lsjl!=null and cbsj.lsjl!=''">and l.lsjl=#{cbsj.lsjl}</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">${cbsj.tsdq}</if>
				<if test="cbsj.xmnf!=null and cbsj.xmnf!=''">and ${cbsj.xmnf}</if>
				<if test="cbsj.sbzt!=null and cbsj.sbzt!=''">and c.sbzt=#{cbsj.sbzt}</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
				<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
				<if test="cbsj.xmbm !=null and cbsj.xmbm !=''">and c.xmbm like '%'||#{cbsj.xmbm}||'%'</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbh})
				</if>
				<if test="cbsj.ghlxbm!=null and cbsj.ghlxbm!=''">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbm})
					)
				</if>
				<if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{cbsj.ghlxmc}||'%')

					)
				</if>
				<if test="cbsj.lsxmnf !='' and cbsj.lsxmnf != null ">
					${cbsj.lsxmnf}
				</if>
				<if test="cbsj.lsxmlx !='' and cbsj.lsxmlx != null ">
					${cbsj.lsxmlx}
				</if>
				order by c.shzt,c.xmbm desc) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	<select id="queryCbsjShbg" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.id, c.xmbm, c.xmmc, jsdw, c.xzqh, c.jsxz, kgsj, wgsj, c.gq, sjdw, sjpfwh, pfsj, shzt, sbzt, c.jsfa, sfbj, mc, jc, dc, mc_lc, jc_lc, dc_lc,lx.lc,
				l.ghlxbh,l.ylxbh,l.lsjl, lx.qdzh, lx.zdzh,lx.jsjsdj,lx.xjsdj,sl.xmsl,c.tzxz,c.tzsj from cbsj_sh_tz c left join xmsq_sh l on c.xmbm=l.xmbm left join lxsh_lx_tz lx on c.xmbm=lx.xmid
				left join (select xmid,count(xmid) xmsl from lxsh_lx_tz where jdbs='2' group by xmid) sl on c.xmbm=sl.xmid
				where lx.jdbs='2' and lx.sffirst='1'
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
				</if>
				<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where ${cbsj.ylxbh} and xmid like '%5___' and jdbs='2')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
				<if test="cbsj.lsjl!=null and cbsj.lsjl!=''">and l.lsjl=#{cbsj.lsjl}</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">${cbsj.tsdq}</if>
				<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
				<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
				<if test="cbsj.tzxz !=null and cbsj.tzxz !=''">and c.tzxz like '%'||#{cbsj.tzxz}||'%'</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
				order by c.shzt,c.xmbm desc) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	
	<select id="queryCbsjLmgzCount" parameterType="java.util.Map" resultType="int">
		select count(c.id) from cbsj_lmgz c left join lxsh_lmgz l on c.xmbm=l.xmbm
		left join lxsh_lx lx
		     on c.xmbm = lx.xmid left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
		left join (select xmid, count(xmid) xmsl
		                              from lxsh_lx
		                             where jdbs = '2'
		                             group by xmid) sl
		                              on c.xmbm = sl.xmid
		where 1 = 1 and lx.jdbs = '2'
                   and lx.sffirst = '1'
        <if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
			and lx.ghlxmc=#{cbsj.ghlxmc}
		</if>
		<!-- <if test="cbsj.ghlxbm!='' and cbsj.ghlxbm!= null ">
			and lx.ghlxbm=#{cbsj.ghlxbm}
		</if> -->
		<if test="cbsj.lxmc!='' and cbsj.lxmc!= null ">
			and lx.lxmc=#{cbsj.lxmc}
		</if>
		<if test="cbsj.xmklx!='' and cbsj.xmklx!= null ">
					and xmklx like '%'||#{cbsj.xmklx}||'%'
				</if>
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%2___')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmnf!=null and cbsj.xmnf!=''">and ${cbsj.xmnf}</if>
		<if test="cbsj.sbzt!=null and cbsj.sbzt!=''">and c.sbzt=#{cbsj.sbzt}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			${cbsj.tsdq}
		</if>
		<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
		<if test="cbsj.xmbm !=null and cbsj.xmbm !=''">and c.xmbm like '%'||#{cbsj.xmbm}||'%'</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbh})
		</if>
		<if test="cbsj.ghlxbm!=null and cbsj.ghlxbm!=''">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbm})
			)
		</if>
		<if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{cbsj.ghlxmc}||'%')

			)
		</if>
		<if test="cbsj.lsxmnf !='' and cbsj.lsxmnf != null ">
			${cbsj.lsxmnf}
		</if>
		<if test="cbsj.lsxmlx !='' and cbsj.lsxmlx != null ">
			${cbsj.lsxmlx}
		</if>
	</select>
	<select id="queryCbsjLmgzbgCount" parameterType="java.util.Map" resultType="int">
		select count(c.id) from cbsj_lmgz_tz c left join lxsh_lmgz l on c.xmbm=l.xmbm 
		where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
		</if>
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where ${cbsj.ylxbh} and xmid like '%2___')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			${cbsj.tsdq}
		</if>
		<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
		<if test="cbsj.tzxz !=null and cbsj.tzxz !=''">and c.tzxz like '%'||#{cbsj.tzxz}||'%'</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
	</select>
	
	<select id="queryCbsjLmsjCount" parameterType="java.util.Map" resultType="int">
		select count(c.id) from cbsj_sjgz c left join lxsh_sjgz l on c.xmbm=l.xmbm left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
		left join lxsh_lx lx
		     on c.xmbm = lx.xmid
		left join (select xmid, count(xmid) xmsl
		                              from lxsh_lx
		                             where jdbs = '2'
		                             group by xmid) sl
		                              on c.xmbm = sl.xmid
		where 1 = 1 and lx.jdbs = '2'
                   and lx.sffirst = '1'
        <if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
			and lx.ghlxmc=#{cbsj.ghlxmc}
		</if>
		<!-- <if test="cbsj.ghlxbm!='' and cbsj.ghlxbm!= null ">
			and lx.ghlxbm=#{cbsj.ghlxbm}
		</if> -->
		<if test="cbsj.lxmc!='' and cbsj.lxmc!= null ">
			and lx.lxmc=#{cbsj.lxmc}
		</if>
		<if test="cbsj.xmklx!='' and cbsj.xmklx!= null ">
					and xmklx like '%'||#{cbsj.xmklx}||'%'
				</if>
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%1___')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmnf!=null and cbsj.xmnf!=''">and ${cbsj.xmnf}</if>
		<if test="cbsj.sbzt!=null and cbsj.sbzt!=''">and c.sbzt=#{cbsj.sbzt}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			${cbsj.tsdq}
		</if>
		<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
		<if test="cbsj.xmbm !=null and cbsj.xmbm !=''">and c.xmbm like '%'||#{cbsj.xmbm}||'%'</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbh})
		</if>
		<if test="cbsj.ghlxbm!=null and cbsj.ghlxbm!=''">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbm})
			)
		</if>
		<if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{cbsj.ghlxmc}||'%')

			)
		</if>
		<if test="cbsj.lsxmnf !='' and cbsj.lsxmnf != null ">
			${cbsj.lsxmnf}
		</if>
		<if test="cbsj.lsxmlx !='' and cbsj.lsxmlx != null ">
			${cbsj.lsxmlx}
		</if>
	</select>
<select id="queryCbsjLmsjbgCount" parameterType="java.util.Map" resultType="int">
		select count(c.id) from cbsj_sjgz_tz c left join lxsh_sjgz l on c.xmbm=l.xmbm
		where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
		</if>
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where ${cbsj.ylxbh} and xmid like '%1___')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			${cbsj.tsdq}
		</if>
		<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
		<if test="cbsj.tzxz !=null and cbsj.tzxz !=''">and c.tzxz like '%'||#{cbsj.tzxz}||'%'</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
	</select>

	<select id="queryCbsjXjCount" parameterType="java.util.Map" resultType="int">
		select count(c.id) from cbsj_xj c left join lxsh_xj l on c.xmbm=l.xmbm left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
		left join lxsh_lx lx
		     on c.xmbm = lx.xmid
		left join (select xmid, count(xmid) xmsl
		                              from lxsh_lx
		                             where jdbs = '2'
		                             group by xmid) sl
		                              on c.xmbm = sl.xmid
		where 1 = 1 and lx.jdbs = '2'
                   and lx.sffirst = '1'
        <if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
			and lx.ghlxmc=#{cbsj.ghlxmc}
		</if>
		<!-- <if test="cbsj.ghlxbm!='' and cbsj.ghlxbm!= null ">
			and lx.ghlxbm=#{cbsj.ghlxbm}
		</if> -->
		<if test="cbsj.lxmc!='' and cbsj.lxmc!= null ">
			and lx.lxmc=#{cbsj.lxmc}
		</if>
		<if test="cbsj.xmklx!='' and cbsj.xmklx!= null ">
					and xmklx like '%'||#{cbsj.xmklx}||'%'
				</if>
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%3___')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmnf!=null and cbsj.xmnf!=''">and ${cbsj.xmnf}</if>
		<if test="cbsj.sbzt!=null and cbsj.sbzt!=''">and c.sbzt=#{cbsj.sbzt}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			${cbsj.tsdq}
		</if>
		<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
		<if test="cbsj.xmbm !=null and cbsj.xmbm !=''">and c.xmbm like '%'||#{cbsj.xmbm}||'%'</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbh})
		</if>
		<if test="cbsj.ghlxbm!=null and cbsj.ghlxbm!=''">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbm})
			)
		</if>
		<if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{cbsj.ghlxmc}||'%')

			)
		</if>
		<if test="cbsj.lsxmnf !='' and cbsj.lsxmnf != null ">
			${cbsj.lsxmnf}
		</if>
		<if test="cbsj.lsxmlx !='' and cbsj.lsxmlx != null ">
			${cbsj.lsxmlx}
		</if>
	</select>
	<select id="queryCbsjXjbgCount" parameterType="java.util.Map" resultType="int">
		select count(c.id) from cbsj_xj_tz c left join lxsh_xj l on c.xmbm=l.xmbm
		where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
		</if>
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where ${cbsj.ylxbh} and xmid like '%3___')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			${cbsj.tsdq}
		</if>
		<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
		<if test="cbsj.tzxz !=null and cbsj.tzxz !=''">and c.tzxz like '%'||#{cbsj.tzxz}||'%'</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
	</select>
	
	<select id="queryCbsjYhdzxCount" parameterType="java.util.Map" resultType="int">
		select count(c.xmbm) from cbsj_yhdzx c left join xmsq_yhdzx l on c.xmbm=l.xmbm 
		left join lxsh_lx lx
		     on c.xmbm = lx.xmid left join (select xmid, WMSYS.WM_CONCAT(distinct to_char(l.xzqhdm2))||';'||WMSYS.WM_CONCAT(distinct to_char(x.xzqhdm2)) xzqhdm2
               from lxsh_lx l,xmsq_yhdzx x
               where l.xmid=x.xmbm
              group by xmid) myxz on c.xmbm=myxz.xmid
		left join (select xmid, count(xmid) xmsl
		                              from lxsh_lx
		                             where jdbs = '2'
		                             group by xmid) sl
		                              on c.xmbm = sl.xmid
		where 1 = 1 and lx.jdbs = '2'
                   and lx.sffirst = '1'
        <if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
			and lx.ghlxmc=#{cbsj.ghlxmc}
		</if>
		<!-- <if test="cbsj.ghlxbm!='' and cbsj.ghlxbm!= null ">
			and lx.ghlxbm=#{cbsj.ghlxbm}
		</if> -->
		<if test="cbsj.lxmc!='' and cbsj.lxmc!= null ">
			and lx.lxmc=#{cbsj.lxmc}
		</if>
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%4___' and jdbs='2')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.gcfl!=null and cbsj.gcfl!=''">and ${cbsj.gcfl}</if>
		<if test="cbsj.xmnf!=null and cbsj.xmnf!=''">and ${cbsj.xmnf}</if>
		<if test="cbsj.sbzt!=null and cbsj.sbzt!=''">and c.sbzt=#{cbsj.sbzt}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">${cbsj.tsdq}</if>
		<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
		<if test="cbsj.xmbm !=null and cbsj.xmbm !=''">and c.xmbm like '%'||#{cbsj.xmbm}||'%'</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.xmlx1 !=null and cbsj.xmlx1 !=''"> ${cbsj.xmlx1}</if>
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbh})
		</if>
		<if test="cbsj.ghlxbm!=null and cbsj.ghlxbm!=''">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbm})
			)
		</if>
		<if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{cbsj.ghlxmc}||'%')

			)
		</if>
		<if test="cbsj.lsxmnf !='' and cbsj.lsxmnf != null ">
			${cbsj.lsxmnf}
		</if>
		<if test="cbsj.lsxmlx !='' and cbsj.lsxmlx != null ">
			${cbsj.lsxmlx}
		</if>
	</select>
	<select id="queryCbsjYhdzxbgCount" parameterType="java.util.Map" resultType="int">
		select count(c.xmbm) from cbsj_yhdzx_tz c left join xmsq_yhdzx l on c.xmbm=l.xmbm where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
		</if>
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where ${cbsj.ylxbh} and xmid like '%4___' and jdbs='2')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.gcfl!=null and cbsj.gcfl!=''">and ${cbsj.gcfl}</if>
		<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">${cbsj.tsdq}</if>
		<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
		<if test="cbsj.tzxz !=null and cbsj.tzxz !=''">and c.tzxz like '%'||#{cbsj.tzxz}||'%'</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
	</select>
	
	<select id="queryCbsjShCount" parameterType="java.util.Map" resultType="int">
		select count(c.xmbm) from cbsj_sh c left join xmsq_sh l on c.xmbm=l.xmbm
		left join lxsh_lx lx
		     on c.xmbm = lx.xmid left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
		left join (select xmid, count(xmid) xmsl
		                              from lxsh_lx
		                             where jdbs = '2'
		                             group by xmid) sl
		                              on c.xmbm = sl.xmid
		where 1 = 1 and lx.jdbs = '2'
                   and lx.sffirst = '1'
        <if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
			and lx.ghlxmc=#{cbsj.ghlxmc}
		</if>
<!-- 		<if test="cbsj.ghlxbm!='' and cbsj.ghlxbm!= null "> -->
<!-- 			and lx.ghlxbm=#{cbsj.ghlxbm} -->
<!-- 		</if> -->
		<if test="cbsj.lxmc!='' and cbsj.lxmc!= null ">
			and lx.lxmc=#{cbsj.lxmc}
		</if>
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%' and jdbs='2')
		</if>
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%5___' and jdbs='2')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmnf!=null and cbsj.xmnf!=''">and ${cbsj.xmnf}</if>
		<if test="cbsj.sbzt!=null and cbsj.sbzt!=''">and c.sbzt=#{cbsj.sbzt}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">${cbsj.tsdq}</if>
		<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
		<if test="cbsj.xmbm !=null and cbsj.xmbm !=''">and c.xmbm like '%'||#{cbsj.xmbm}||'%'</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
		<if test="cbsj.ghlxbm!=null and cbsj.ghlxbm!=''">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxbm like '%'||#{cbsj.ghlxbm}||'%')
			or c.xmbm in (select distinct xmid from lx_clsd where ghlxbm like '%'||#{cbsj.ghlxbm}||'%')
			)
		</if>
		<if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{cbsj.ghlxmc}||'%')
			or c.xmbm in (select distinct xmid from lx_clsd where ghlxmc like '%'||#{cbsj.ghlxmc}||'%')
			)
		</if>
		<if test="cbsj.lsxmnf !='' and cbsj.lsxmnf != null ">
					${cbsj.lsxmnf}
				</if>
				<if test="cbsj.lsxmlx !='' and cbsj.lsxmlx != null ">
					${cbsj.lsxmlx}
				</if>
	</select>
	<select id="queryCbsjShbgCount" parameterType="java.util.Map" resultType="int">
		select count(c.xmbm) from cbsj_sh_tz c left join xmsq_sh l on c.xmbm=l.xmbm
		where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%' and jdbs='2')
		</if>
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where ${cbsj.ylxbh} and xmid like '%5___' and jdbs='2')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">${cbsj.tsdq}</if>
		<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
		<if test="cbsj.tzxz !=null and cbsj.tzxz !=''">and c.tzxz like '%'||#{cbsj.tzxz}||'%'</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
	</select>
	
	<select id="queryCbsjLmgzByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,xmklx,l.lxbm as ghlxbh,l.lxbm,decode(l.gpsqdzh,null,l.qdzh, l.gpsqdzh) gpsqdzh,l.qdmc,l.zdmc,decode(l.gpszdzh,null,l.qdzh, l.gpszdzh) gpszdzh,l.lc,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc,l.ghlxbm,l.ghlxmc,l.gxlxbm,l.gxqdzh,l.gxzdzh,l.ghqdzh,l.ghzdzh,l.lxbm ylxbh from cbsj_lmgz c left join lxsh_lmgz t on c.xmbm=t.xmbm left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjLmgzqxByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,xmklx,l.lxbm as ghlxbh,l.lxbm,decode(l.gpsqdzh,null,l.qdzh, l.gpsqdzh) gpsqdzh,l.qdmc,l.zdmc,decode(l.gpszdzh,null,l.qdzh, l.gpszdzh) gpszdzh,l.lc,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc,l.ghlxbm,l.ghlxmc,l.gxlxbm,l.gxqdzh,l.gxzdzh,l.ghqdzh,l.ghzdzh,l.lxbm ylxbh from cbsj_lmgz_qx c left join lxsh_lmgz_qx t on c.xmbm=t.xmbm left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjLmsjByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.XMMC,c.XMBM,c.JSDW,c.XZQH,c.QDZH,c.ZDZH,c.JSJSDJ,c.JSXZ,c.LJ,c.QL,c.HD,c.MC,c.JC,c.DC,c.SD,c.DQ,c.SDMC,c.KGSJ,c.WGSJ,c.GQ,c.SJDW,c.SJPFWH,c.PFSJ,c.JAF,c.SHZT,c.SBZT,c.QL_YM,c.HD_M,c.SD_YM,c.DQ_CD,c.DQ_DK,c.SD_SFCD,c.SD_LX,c.SFBJ,c.MC_LC,c.JC_LC,c.DC_LC,c.DFZC,c.YHDK,c.TZXZ,c.TZSJ,c.SBTHCD,c.THYY,c.XZQHDM,c.GYDW,c.GYDWDM,c.TZ,c.BZ,c.CBSJ_SJGZ,nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0) jszlc,xmklx,l.lxbm as ghlxbh,l.lxbm,decode(l.gpsqdzh,null,l.qdzh, l.gpsqdzh) gpsqdzh,l.qdmc,l.zdmc,decode(l.gpszdzh,null,l.qdzh, l.gpszdzh) gpszdzh,nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) lc,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc,l.jhyilc,l.jherlc,l.jhsanlc,l.jhsilc,l.jhdwlc,l.jhwllc,l.ghlxbm,l.ghlxmc,l.gxlxbm,l.gxqdzh,l.gxzdzh,l.ghqdzh,l.ghzdzh,l.lxbm ylxbh
		from cbsj_sjgz c left join lxsh_sjgz t on c.xmbm=t.xmbm left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjLmsjqxByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,xmklx,l.lxbm as ghlxbh,l.lxbm,decode(l.gpsqdzh,null,l.qdzh, l.gpsqdzh) gpsqdzh,l.qdmc,l.zdmc,decode(l.gpszdzh,null,l.qdzh, l.gpszdzh) gpszdzh,nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) lc,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc,l.jhyilc,l.jherlc,l.jhsanlc,l.jhsilc,l.jhdwlc,l.jhwllc,l.ghlxbm,l.ghlxmc,l.gxlxbm,l.gxqdzh,l.gxzdzh,l.ghqdzh,l.ghzdzh,l.lxbm ylxbh
		from cbsj_sjgz_qx c left join lxsh_sjgz_qx t on c.xmbm=t.xmbm left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjXjByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,xmklx,l.lxbm as ghlxbh,l.lxbm,decode(l.gpsqdzh,null,l.qdzh, l.gpsqdzh) gpsqdzh,l.qdmc,l.zdmc,decode(l.gpszdzh,null,l.qdzh, l.gpszdzh) gpszdzh,nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) lc,l.xjlxbm,l.xjqdzh,l.xjzdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc,l.ghlxbm,l.ghlxmc,l.gxlxbm,l.gxqdzh,l.gxzdzh,l.ghqdzh,l.ghzdzh,l.lxbm ylxbh from cbsj_xj c left join lxsh_xj t on c.xmbm=t.xmbm left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjXjqxByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,xmklx,l.lxbm as ghlxbh,l.lxbm,decode(l.gpsqdzh,null,l.qdzh, l.gpsqdzh) gpsqdzh,l.qdmc,l.zdmc,decode(l.gpszdzh,null,l.qdzh, l.gpszdzh) gpszdzh,nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) lc,l.xjlxbm,l.xjqdzh,l.xjzdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc,l.ghlxbm,l.ghlxmc,l.gxlxbm,l.gxqdzh,l.gxzdzh,l.ghqdzh,l.ghzdzh,l.lxbm ylxbh from cbsj_xj_qx c left join lxsh_xj_qx t on c.xmbm=t.xmbm left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjYhdzxByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*, l.qdmc,l.zdmc,l.lxbm as ghlxbh,l.lxbm,decode(l.gpsqdzh,null,l.qdzh,'0',l.qdzh,l.gpsqdzh) gpsqdzh,
		decode(l.gpszdzh,null,l.zdzh,'0',l.zdzh,l.gpszdzh) gpszdzh,
		l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc,l.ghlxbm,l.ghlxmc,nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) lc,
		l.gxlxbm,l.gxqdzh,l.gxzdzh,l.ghqdzh,l.ghzdzh,l.lxbm ylxbh,l.lxlmkd,decode(l.lxlmkd,null,x.lmkd,l.lxlmkd) lmkd,
		lqhntmc,gxlqhntmc,snhntmc,lqlmjdrzs,lqlmcbrzs,swjc,lqlmpmlqjdlzs,lqlmrhlqjdlzs,lqlmcblzs,
		xzrxjc,swjclzs,xfc,wcsnmb,wcswjc,snhntmchb,bx,snhntmcssh,
		lqhntmchd,gxlqhntmchd,snhntmchd,lqlmjdrzshd,lqlmcbrzshd,swjchd,lqlmpmlqjdlzshd,lqlmrhlqjdlzshd,lqlmcblzshd,
		xzrxjchd,swjclzshd,xfchd,wcsnmbhd,wcswjchd,snhntmchbhd,bxhd,snhntmcsshhd,sbzj,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,snhntmchbmj,fcbc30,bc6 ,bc25 ,bc30 ,bmc25 , wfc ,xjfc ,fcbc30hd ,bc6hd ,bc25hd ,bc30hd ,bmc25hd , wfchd ,xjfchd,wbc,wbchd   
		from cbsj_yhdzx c left join xmsq_yhdzx x on c.xmbm = x.xmbm left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjYhdzxqxByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*, l.qdmc,l.zdmc,l.lxbm as ghlxbh,l.lxbm,decode(l.gpsqdzh,null,l.qdzh,'0',l.qdzh,l.gpsqdzh) gpsqdzh,
		decode(l.gpszdzh,null,l.zdzh,'0',l.zdzh,l.gpszdzh) gpszdzh,
		l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc,l.ghlxbm,l.ghlxmc,
		l.gxlxbm,l.gxqdzh,l.gxzdzh,l.ghqdzh,l.ghzdzh,l.lxbm ylxbh,l.lxlmkd,decode(l.lxlmkd,null,x.lmkd,l.lxlmkd) lmkd,
		lqhntmc,gxlqhntmc,snhntmc,lqlmjdrzs,lqlmcbrzs,swjc,lqlmpmlqjdlzs,lqlmrhlqjdlzs,lqlmcblzs,
		xzrxjc,swjclzs,xfc,wcsnmb,wcswjc,snhntmchb,bx,snhntmcssh,
		lqhntmchd,gxlqhntmchd,snhntmchd,lqlmjdrzshd,lqlmcbrzshd,swjchd,lqlmpmlqjdlzshd,lqlmrhlqjdlzshd,lqlmcblzshd,
		xzrxjchd,swjclzshd,xfchd,wcsnmbhd,wcswjchd,snhntmchbhd,bxhd,snhntmcsshhd,sbzj,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,snhntmchbmj,fcbc30,bc6 ,bc25 ,bc30 ,bmc25 , wfc ,xjfc ,fcbc30hd ,bc6hd ,bc25hd ,bc30hd ,bmc25hd , wfchd ,xjfchd,wbc,wbchd   
		from cbsj_yhdzx_qx c left join xmsq_yhdzx_qx x on c.xmbm = x.xmbm left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjShByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,l.lxbm as ghlxbh,l.lxbm,decode(l.gpsqdzh,null,l.qdzh,'0',l.qdzh,l.gpsqdzh) gpsqdzh,decode(l.gpszdzh,null,l.zdzh,'0',l.zdzh,l.gpszdzh) gpszdzh,l.qdmc,l.zdmc,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc,l.ghlxbm,l.ghlxmc,l.gxlxbm,l.gxqdzh,l.gxzdzh,l.ghqdzh,l.ghzdzh,l.lxbm ylxbh from cbsj_sh c left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjShqxByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,l.lxbm as ghlxbh,l.lxbm,decode(l.gpsqdzh,null,l.qdzh,'0',l.qdzh,l.gpsqdzh) gpsqdzh,decode(l.gpszdzh,null,l.zdzh,'0',l.zdzh,l.gpszdzh) gpszdzh,l.qdmc,l.zdmc,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc,l.ghlxbm,l.ghlxmc,l.gxlxbm,l.gxqdzh,l.gxzdzh,l.ghqdzh,l.ghzdzh,l.lxbm ylxbh from cbsj_sh_qx c left join lxsh_lx l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	
	<select id="queryCbsjLmgzbgByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,l.lxbm as ghlxbh,l.lxbm,l.gpsqdzh,l.lc,l.qdmc,l.zdmc,l.gpszdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from cbsj_lmgz_tz c left join lxsh_lx_tz l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjLmsjbgByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,l.lxbm as ghlxbh,l.lxbm,l.gpsqdzh,l.lc,l.qdmc,l.zdmc,l.gpszdzh,l.lc,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc,l.jhyilc,l.jherlc,l.jhsanlc,l.jhsilc,l.jhdwlc,l.jhwllc
		from cbsj_sjgz_tz c left join lxsh_lx_tz l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjXjbgByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,l.lxbm as ghlxbh,l.lxbm,l.gpsqdzh,l.lc,l.qdmc,l.zdmc,l.gpszdzh,l.xjlxbm,l.xjqdzh,l.xjzdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from cbsj_xj_tz c left join lxsh_lx_tz l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjYhdzxbgByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*, l.qdmc,l.zdmc,l.lxbm as ghlxbh,l.lxbm,l.gpsqdzh,l.gpszdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from cbsj_yhdzx_t c left join lxsh_lx_tz l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<select id="queryCbsjShbgByXmbm" parameterType="java.util.Map" resultType="cbsj">
		select c.*,l.lxbm as ghlxbh,l.lxbm,l.gpsqdzh,l.gpszdzh,l.qdmc,l.zdmc,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from cbsj_sh_tz c left join lxsh_lx_tz l on c.xmbm=l.xmid where l.sffirst='1' and c.xmbm=#{xmbm} and l.jdbs='2'
	</select>
	<update id="updateCbsjLmgz" parameterType="cbsj">
		update cbsj_lmgz c set c.xmmc=#{xmmc},
		c.qdzh=#{qdzh},
		c.zdzh=#{zdzh},
		<if test="jsxz!=null">c.jsxz=#{jsxz},</if>
		<if test="jsjsdj!=null">c.jsjsdj=#{jsjsdj},</if>
		<if test="jsdw!=null">c.jsdw=#{jsdw},</if>
		<if test="dfzc!=null">c.dfzc=#{dfzc},</if>
		<if test="yhdk!=null">c.yhdk=#{yhdk},</if>
		<if test="lj!=null">c.lj=#{lj},</if>
		<if test="ql!=null">c.ql=#{ql},</if>
		<if test="ql_ym!=null">c.ql_ym=#{ql_ym},</if>
		<if test="hd!=null">c.hd=#{hd},</if>
		<if test="hd_m!=null">c.hd_m=#{hd_m},</if>
		<if test="mc!=null">c.mc=#{mc},</if>
		<if test="mc_lc!=null">c.mc_lc=#{mc_lc},</if>
		<if test="jc!=null">c.jc=#{jc},</if>
		<if test="jc_lc!=null">c.jc_lc=#{jc_lc},</if>
		<if test="dc!=null">c.dc=#{dc},</if>
		<if test="dc_lc!=null">c.dc_lc=#{dc_lc},</if>
		<if test="sd!=null">c.sd=#{sd},</if>
		<if test="sd_ym!=null">c.sd_ym=#{sd_ym},</if>
		<if test="dq!=null">c.dq=#{dq},</if>
		<if test="dq_cd!=null">c.dq_cd=#{dq_cd},</if>
		<if test="dq_dk!=null">c.dq_dk=#{dq_dk},</if>
		<if test="sdmc!=null">c.sdmc=#{sdmc},</if>
		<if test="sd_sfcd!=null">c.sd_sfcd=#{sd_sfcd},</if>
		<if test="sd_lx!=null">c.sd_lx=#{sd_lx},</if>
		<if test="jaf!=null">c.jaf=#{jaf},</if>
		<if test="kgsj!=null">c.kgsj=#{kgsj},</if>
		<if test="wgsj!=null">c.wgsj=#{wgsj},</if>
		<if test="gq!=null">c.gq=#{gq},</if>
		<if test="sjdw!=null">c.sjdw=#{sjdw},</if>
		<if test="sjpfwh!=null">c.sjpfwh=#{sjpfwh},</if>
		<if test="pfsj!=null">c.pfsj=#{pfsj},</if>
		<if test="gydw !=null">c.gydw=#{gydw},</if>
		<if test="xzqh !=null">c.xzqh=#{xzqh},</if>
		<if test="gydwdm !=null">c.gydwdm=#{gydwdm},</if>
		<if test="xzqhdm !=null">c.xzqhdm=#{xzqhdm},</if>
		<if test="tz !=null">c.tz=#{tz},</if>
		sfbj=#{sfbj}
		where c.xmbm=#{xmbm}
	</update>
	<update id="updateCbsjLmsj" parameterType="cbsj">
		update cbsj_sjgz c set c.xmmc=#{xmmc},
		c.jsxz=#{jsxz},c.qdzh=#{qdzh},c.zdzh=#{zdzh},
		<if test="dfzc!=null">c.dfzc=#{dfzc},</if>
		<if test="yhdk!=null">c.yhdk=#{yhdk},</if>
		<if test="jsjsdj!=null">c.jsjsdj=#{jsjsdj},</if>
		<if test="jsdw!=null">c.jsdw=#{jsdw},</if>
		<if test="lj!=null">c.lj=#{lj},</if> 
		<if test="ql!=null">c.ql=#{ql},</if>
		<if test="ql_ym!=null">c.ql_ym=#{ql_ym},</if>
		<if test="hd!=null">c.hd=#{hd},</if>
		<if test="hd_m!=null">c.hd_m=#{hd_m},</if>
		<if test="mc!=null">c.mc=#{mc},</if>
		<if test="mc_lc!=null">c.mc_lc=#{mc_lc},</if>
		<if test="jc!=null">c.jc=#{jc},</if>
		<if test="jc_lc!=null">c.jc_lc=#{jc_lc},</if>
		<if test="dc!=null">c.dc=#{dc},</if>
		<if test="dc_lc!=null">c.dc_lc=#{dc_lc},</if>
		<if test="sd!=null">c.sd=#{sd},</if>
		<if test="sd_ym!=null">c.sd_ym=#{sd_ym},</if>
		<if test="dq!=null">c.dq=#{dq},</if>
		<if test="dq_cd!=null">c.dq_cd=#{dq_cd},</if>
		<if test="dq_dk!=null">c.dq_dk=#{dq_dk},</if>
		<if test="sdmc!=null">c.sdmc=#{sdmc},</if>
		<if test="sd_sfcd!=null">c.sd_sfcd=#{sd_sfcd},</if>
		<if test="sd_lx!=null">c.sd_lx=#{sd_lx},</if>
		<if test="jaf!=null">c.jaf=#{jaf},</if>
		<if test="kgsj!=null">c.kgsj=#{kgsj},</if>
		<if test="wgsj!=null">c.wgsj=#{wgsj},</if>
		<if test="gq!=null">c.gq=#{gq},</if>
		<if test="sjdw!=null">c.sjdw=#{sjdw},</if>
		<if test="sjpfwh!=null">c.sjpfwh=#{sjpfwh},</if>
		<if test="pfsj!=null">c.pfsj=#{pfsj},</if>
		<if test="jszlc!=null">c.jszlc=#{jszlc},</if>
		<if test="gydw !=null">c.gydw=#{gydw},</if>
		<if test="xzqh !=null">c.xzqh=#{xzqh},</if>
		<if test="gydwdm !=null">c.gydwdm=#{gydwdm},</if>
		<if test="xzqhdm !=null">c.xzqhdm=#{xzqhdm},</if>
		<if test="tz !=null">c.tz=#{tz},</if>
		sfbj=#{sfbj}
		where c.xmbm=#{xmbm}
	</update>
	<update id="updateCbsjXj" parameterType="cbsj">
		update cbsj_xj c set c.xmmc=#{xmmc},
		c.qdzh=#{qdzh},c.zdzh=#{zdzh},
		<if test="dfzc!=null">c.dfzc=#{dfzc},</if>
		<if test="yhdk!=null">c.yhdk=#{yhdk},</if>
		<if test="jsdw!=null">c.jsdw=#{jsdw},</if>
		<if test="jsjsdj!=null">c.jsjsdj=#{jsjsdj},</if>
		<if test="jsxz!=null">c.jsxz=#{jsxz},</if>
		<if test="lj!=null">c.lj=#{lj},</if> 
		<if test="ql!=null">c.ql=#{ql},</if>
		<if test="ql_ym!=null">c.ql_ym=#{ql_ym},</if>
		<if test="hd!=null">c.hd=#{hd},</if>
		<if test="hd_m!=null">c.hd_m=#{hd_m},</if>
		<if test="mc!=null">c.mc=#{mc},</if>
		<if test="mc_lc!=null">c.mc_lc=#{mc_lc},</if>
		<if test="jc!=null">c.jc=#{jc},</if>
		<if test="jc_lc!=null">c.jc_lc=#{jc_lc},</if>
		<if test="dc!=null">c.dc=#{dc},</if>
		<if test="dc_lc!=null">c.dc_lc=#{dc_lc},</if>
		<if test="sd!=null">c.sd=#{sd},</if>
		<if test="sd_ym!=null">c.sd_ym=#{sd_ym},</if>
		<if test="dq!=null">c.dq=#{dq},</if>
		<if test="dq_cd!=null">c.dq_cd=#{dq_cd},</if>
		<if test="dq_dk!=null">c.dq_dk=#{dq_dk},</if>
		<if test="sdmc!=null">c.sdmc=#{sdmc},</if>
		<if test="sd_sfcd!=null">c.sd_sfcd=#{sd_sfcd},</if>
		<if test="sd_lx!=null">c.sd_lx=#{sd_lx},</if>
		<if test="jaf!=null">c.jaf=#{jaf},</if>
		<if test="kgsj!=null">c.kgsj=#{kgsj},</if>
		<if test="wgsj!=null">c.wgsj=#{wgsj},</if>
		<if test="gq!=null">c.gq=#{gq},</if>
		<if test="sjdw!=null">c.sjdw=#{sjdw},</if>
		<if test="sjpfwh!=null">c.sjpfwh=#{sjpfwh},</if>
		<if test="pfsj!=null">c.pfsj=#{pfsj},</if>
		<if test="gydw !=null">c.gydw=#{gydw},</if>
		<if test="xzqh !=null">c.xzqh=#{xzqh},</if>
		<if test="gydwdm !=null">c.gydwdm=#{gydwdm},</if>
		<if test="xzqhdm !=null">c.xzqhdm=#{xzqhdm},</if>
		<if test="tz !=null">c.tz=#{tz},</if>
		sfbj=#{sfbj}
		where c.xmbm=#{xmbm}
	</update>
	<update id="updateCbsjYhdzx" parameterType="cbsj">
		update cbsj_yhdzx c set 
		<if test="xmmc!=null">c.xmmc=#{xmmc},</if>
		<if test="jsdw!=null">c.jsdw=#{jsdw},</if>
		<if test="jsjsdj!=null">c.jsjsdj=#{jsjsdj},</if>
		<if test="jsxz!=null">c.jsxz=#{jsxz},</if>
		<if test="qdzh!=null">c.qdzh=#{qdzh},</if>
		<if test="zdzh!=null">c.zdzh=#{zdzh},</if>
		<if test="jsfa!=null">c.jsfa=#{jsfa},</if>
		<if test="kgsj!=null">c.kgsj=#{kgsj},</if>
		<if test="wgsj!=null">c.wgsj=#{wgsj},</if>
		<if test="gq!=null">c.gq=#{gq},</if>
		<if test="sjdw!=null">c.sjdw=#{sjdw},</if>
		<if test="sjpfwh!=null">c.sjpfwh=#{sjpfwh},</if>
		<if test="pfsj!=null">c.pfsj=#{pfsj},</if>
		<if test="mc!=null">c.mc=#{mc},</if>
		<if test="dc!=null">c.dc=#{dc},</if>
		<if test="jc!=null">c.jc=#{jc},</if>
		<if test="mc_lc!=null">c.mc_lc=#{mc_lc},</if>
		<if test="dc_lc!=null">c.dc_lc=#{dc_lc},</if>
		<if test="jc_lc!=null">c.jc_lc=#{jc_lc},</if>
		<if test="lc!=null">c.lc=#{lc},</if>
		<if test="gydw !=null">c.gydw=#{gydw},</if>
		<if test="xzqh !=null">c.xzqh=#{xzqh},</if>
		<if test="gydwdm !=null">c.gydwdm=#{gydwdm},</if>
		<if test="xzqhdm !=null">c.xzqhdm=#{xzqhdm},</if>
		<if test="tz !=null">c.tz=#{tz},</if>
		<if test="jaf!=null">c.jaf=#{jaf},</if>
		sfbj=#{sfbj}
		where c.xmbm=#{xmbm}
	</update>
	<update id="updateCbsjSh" parameterType="cbsj">
		update cbsj_sh c set 
		<if test="xmmc!=null">c.xmmc=#{xmmc},</if>
		<if test="jsdw!=null">c.jsdw=#{jsdw},</if>
		
		<if test="jsjsdj!=null">c.jsjsdj=#{jsjsdj},</if>
		<if test="jsxz!=null">c.jsxz=#{jsxz},</if>
		<if test="qdzh!=null">c.qdzh=#{qdzh},</if>
		<if test="zdzh!=null">c.zdzh=#{zdzh},</if>
		<if test="jsfa!=null">c.jsfa=#{jsfa},</if>
		<if test="kgsj!=null">c.kgsj=#{kgsj},</if>
		<if test="wgsj!=null">c.wgsj=#{wgsj},</if>
		<if test="gq!=null">c.gq=#{gq},</if>
		<if test="sjdw!=null">c.sjdw=#{sjdw},</if>
		<if test="sjpfwh!=null">c.sjpfwh=#{sjpfwh},</if>
		<if test="pfsj!=null">c.pfsj=#{pfsj},</if>
		<if test="mc!=null">c.mc=#{mc},</if>
		<if test="dc!=null">c.dc=#{dc},</if>
		<if test="jc!=null">c.jc=#{jc},</if>
		<if test="mc_lc!=null">c.mc_lc=#{mc_lc},</if>
		<if test="dc_lc!=null">c.dc_lc=#{dc_lc},</if>
		<if test="jc_lc!=null">c.jc_lc=#{jc_lc},</if>
		<if test="lc!=null">c.lc=#{lc},</if>
		<if test="gydw !=null">c.gydw=#{gydw},</if>
		<if test="xzqh !=null">c.xzqh=#{xzqh},</if>
		<if test="gydwdm !=null">c.gydwdm=#{gydwdm},</if>
		<if test="xzqhdm !=null">c.xzqhdm=#{xzqhdm},</if>
		<if test="tz !=null">c.tz=#{tz},</if>
		<if test="jaf!=null">c.jaf=#{jaf},</if>
		sfbj='1'
		where c.xmbm=#{xmbm}
	</update>
	
	<delete id="deleteLmgzByXmbm" parameterType="java.util.List">
		delete from cbsj_lmgz where xmbm=#{xmbm}
	</delete>
	<delete id="deleteLmsjByXmbm" parameterType="java.util.List">
		delete from cbsj_sjgz where xmbm=#{xmbm}
	</delete>
	<delete id="deleteXjByXmbm" parameterType="java.util.List">
		delete from cbsj_xj where xmbm=#{xmbm}
	</delete>
	
	<update id="shCbsjLmsjByXmbm" parameterType="java.util.List">
		update cbsj_sjgz c set c.sbzt=${sbzt},c.shzt=${shzt} where c.xmbm=#{xmbm}
	</update>
	<update id="shCbsjLmgzByXmbm" parameterType="java.util.List">
		update cbsj_lmgz c set c.sbzt=${sbzt},c.shzt=${shzt} where c.xmbm=#{xmbm}
	</update>
	<update id="shCbsjXjByXmbm" parameterType="java.util.List">
		update cbsj_xj c set c.sbzt=${sbzt},c.shzt=${shzt} where c.xmbm=#{xmbm}
	</update>
	<update id="shCbsjYhdzxByXmbm" parameterType="java.util.List">
		update cbsj_yhdzx c set c.shzt=${shzt} where c.xmbm=#{xmbm}
	</update>
	<update id="shCbsjShByXmbm" parameterType="java.util.List">
		update cbsj_sh c set c.shzt=${shzt} where c.xmbm=#{xmbm}
	</update>
	
	<!-- 文件操作部分 -->
	<select id="queryFileByXmbm" parameterType="plan_upload" resultType="plan_upload">
		select f.id,filename,xmbm,filetype,fileurl,filewh from plan_file f left join plan_upload u on f.fid=u.id
		where xmbm=#{parentid} and filetype=#{filetype}
	</select>
	<select id="queryxdFileByWh" parameterType="plan_upload" resultType="plan_upload">
		select * from plan_upload u
		where filewh=#{parentid} and filetype=#{filetype} and parentid=#{filetype}
	</select>
	<select id="getWjbyxmbm" parameterType="plan_upload" resultType="plan_upload">
		select * from plan_upload u
		where filewh in (select distinct jhxdwh from plan_zjxd where xmid=#{parentid}) and filetype=#{filetype} and parentid=#{filetype}
	</select>
	<select id="getWjbytype" parameterType="plan_upload" resultType="plan_upload">
		select * from plan_upload u
		where filewh=#{filewh} and parentid=#{filetype}
	</select>
	<insert id="insertFile" parameterType="plan_upload">
		insert into plan_upload(id,filename,
		<if test="filewh!=null">filewh,</if>
		<if test="xmbm !=null">parentid,</if>
		filetype,fileurl) values(#{id},#{filename},
		<if test="filewh!=null">#{filewh},</if><if test="xmbm !=null">#{xmbm},</if>#{filetype},#{fileurl})
	</insert>
	<select id="queryFileByWh" parameterType="plan_upload" resultType="plan_upload">
		select * from plan_upload where filetype=#{filetype} and filewh=#{filewh} and filename=#{filename}
	</select>
	<insert id="insertFileJl" parameterType="plan_upload">
		insert into plan_file (id,xmbm,fid) values (sys_guid(),#{xmbm},#{fid})
	</insert>
	<select id="queryLmgzExcel" parameterType="cbsj" resultType="elist">
		<!-- select * from (
			select rownum num,t.* from (
				select decode(lx.sffirst,'1',c.xmbm,'') xmbm,decode(lx.sffirst,'1',c.xmmc,'') xmmc,c.xzqh,c.jsdw,c.jsjsdj,c.jsxz,c.lj,c.ql,c.ql_ym,c.hd,c.hd_m,c.sd,c.sd_ym,
				c.mc,c.mc_lc,c.jc,c.jc_lc,c.dc,c.dc_lc,c.dq,c.dq_cd,c.dq_dk,c.sdmc,c.sd_lx,c.sd_sfcd,
				c.kgsj,c.wgsj,c.gq,decode(lx.sffirst,'1',c.sjdw,'') sjdw,decode(lx.sffirst,'1',c.sjpfwh,'') sjpfwh,decode(lx.sffirst,'1',c.pfsj,'') pfsj,decode(lx.sffirst,'1',c.jaf,'') jaf,decode(lx.sffirst,'1',c.dfzc,'') dfzc,decode(lx.sffirst,'1',c.yhdk,'') yhdk,lx.* from cbsj_lmgz c left join lxsh_lmgz l on c.xmbm = l.xmbm
				right join (select xmid, lxbm ylxbh,lxmc lxmc,qdzh qdzh,zdzh zdzh,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,lc lc,yilc,erlc,sanlc,silc,dwlc,wllc,sffirst from lxsh_lx where jdbs='2' ) lx
				on c.xmbm = lx.xmid 
				left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
				where 1=1 -->
				
				select rownum v_0,c.xmmc v_1,c.xmbm v_2,c.xzqh v_3,c.jsdw v_4,RemoveSameStr(lx.jsjsdjtj,',') v_5,lx.jsxz v_6,
    decode(instr(RemoveSameStr(lx.ylxbm,','),','),0,RemoveSameStr(lx.ylxbm,','),lx.ylxbm) v_7,
    decode(instr(RemoveSameStr(lx.ylxmc,','),','),0,RemoveSameStr(lx.ylxmc,','),lx.ylxmc) v_8,
    lx.qdzh v_9,lx.zdzh v_10,
    decode(instr(RemoveSameStr(lx.ghlxbm,','),','),0,RemoveSameStr(lx.ghlxbm,','),lx.ghlxbm)  v_11,
    decode(instr(RemoveSameStr(lx.ghlxmc,','),','),0,RemoveSameStr(lx.ghlxmc,','),lx.ghlxmc) v_12,
    lx.ghqdzh v_13,lx.ghzdzh v_14,
    decode(instr(RemoveSameStr(lx.gxlxbm,','),','),0,RemoveSameStr(lx.gxlxbm,','),lx.gxlxbm) v_15,
    lx.gxqdzh v_16,lx.gxzdzh v_17,
    to_char(lx.lc,'fm9999999990.000') v_18, to_char(lx.yilc,'fm9999999990.000') v_19, to_char(lx.erlc,'fm9999999990.000') v_20, 
    to_char(lx.sanlc,'fm9999999990.000') v_21, to_char(lx.silc,'fm9999999990.000') v_22, to_char(lx.dwlc,'fm9999999990.000') v_23, 
    to_char(lx.wllc,'fm9999999990.000') v_24,
    to_char(lx.jhyilc,'fm9999999990.000') v_25, to_char(lx.jherlc,'fm9999999990.000') v_26, 
    to_char(lx.jhsanlc,'fm9999999990.000') v_27, to_char(lx.jhsilc,'fm9999999990.000') v_28, to_char(lx.jhdwlc,'fm9999999990.000') v_29, 
    to_char(lx.jhwllc,'fm9999999990.000') v_30,
    c.lj v_31,c.ql v_32,c.ql_ym v_33,c.hd v_34,c.hd_m v_35,c.sd v_36,c.sd_ym v_37,c.mc v_38,c.mc_lc v_39,c.jc v_40,c.jc_lc v_41,c.dc v_42,c.dc_lc v_43,
    c.dq v_44,c.dq_cd v_45,c.dq_dk v_46,c.sdmc v_47,c.sd_sfcd v_48,c.sd_lx v_49,c.kgsj v_50,c.wgsj v_51,c.gq v_52,c.sjdw v_53,
    c.sjpfwh v_54,c.pfsj v_55,c.jaf v_56,nvl(c.dfzc,0) v_57,nvl(c.yhdk,0) v_58
    from cbsj_lmgz c 
    Left join (select xmbm xmbh,lsjl,xmklx,tsdq,lsxmbm,xzqh,xzqhdm2 from lxgsdgz) t1 on c.xmbm=t1.xmbh
    left join 
        (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2
         from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
    left join (
    select xmid,sum(jhlc) zjhlc,sum(sbzj) sbzj,sum(bzcs) bzcs,
              replace(WMSYS.WM_CONCAT(distinct(lxlmkd)),',',',') lxlmkd,replace(WMSYS.WM_CONCAT(distinct(jsxz)),',',',') jsxz,
              replace(WMSYS.WM_CONCAT(distinct(gydw)),',',',') gydw,replace(WMSYS.WM_CONCAT(distinct(xzqh)),',',',') xzqh,
              replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
              replace(WMSYS.WM_CONCAT(jsjsdj),'、',',') jsjsdjtj,
              replace(WMSYS.WM_CONCAT(xjsdj),'、',',') xjsdjtj,
              replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,
             replace(max(qdzh), ',.', ',0.') qdzh,replace(max(zdzh), ',.', ',0.') zdzh,replace(max(ghqdzh), ',.', ',0.') ghqdzh,replace(max(ghzdzh), ',.', ',0.') ghzdzh,
             replace(max(gxqdzh), ',.', ',0.') gxqdzh,replace(max(gxzdzh), ',.', ',0.') gxzdzh,
             max(ghlxbm) ghlxbm,max(ylxbm) ylxbm,max(ghlxmc) ghlxmc,max(ylxmc) ylxmc,max(gxlxbm) gxlxbm,max(qdmc) qdmc,max(zdmc) zdmc,
             sum(nvl(jhyilc,0)) jhyilc,sum(nvl(yilc,0)) yilc,sum(nvl(jherlc,0)) jherlc,sum(nvl(erlc,0)) erlc,
             sum(nvl(jhsanlc,0)) jhsanlc,sum(nvl(sanlc,0)) sanlc,sum(nvl(jhsilc,0)) jhsilc,sum(nvl(silc,0)) silc,
             sum(nvl(jhdwlc,0)) jhdwlc,sum(nvl(dwlc,0)) dwlc,sum(nvl(jhwllc,0)) jhwllc,sum(nvl(wllc,0)) wllc,sum(nvl(lc,0)) lc
              from (select  xmid,jsxz,sbzj,lxlmkd,gydw,xzqh,bzcs,
              (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)) 
              else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
              end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
              else ''
              end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,yilc,erlc,sanlc,silc,dwlc,wllc,lc,
               WMSYS.WM_CONCAT(ghlxmc)over( PARTITION BY xmid ORDER BY id,ghlxmc) ghlxmc,
               WMSYS.WM_CONCAT(lxmc)over( PARTITION BY xmid ORDER BY id,lxmc) ylxmc,
               WMSYS.WM_CONCAT(ghlxbm)over( PARTITION BY xmid ORDER BY id,ghlxbm) ghlxbm,
               WMSYS.WM_CONCAT(lxbm)over( PARTITION BY xmid ORDER BY id,lxbm) ylxbm,
               WMSYS.WM_CONCAT((case when qdzh like '.%' then 0||qdzh when qdzh like '%,.%' then replace(qdzh, ',.', ',0.') else qdzh end ))over( PARTITION BY xmid ORDER BY id,qdzh) qdzh,
               WMSYS.WM_CONCAT((case when zdzh like '.%' then 0||zdzh when zdzh like '%,.%' then replace(zdzh, ',.', ',0.') else zdzh end ))over( PARTITION BY xmid ORDER BY id,zdzh) zdzh,
               WMSYS.WM_CONCAT((case when ghqdzh like '.%' then 0||ghqdzh when ghqdzh like '%,.%' then replace(ghqdzh, ',.', ',0.') else ghqdzh end ))over( PARTITION BY xmid ORDER BY id,ghqdzh) ghqdzh,
               WMSYS.WM_CONCAT((case when ghzdzh like '.%' then 0||ghzdzh when ghzdzh like '%,.%' then replace(ghzdzh, ',.', ',0.') else ghzdzh end ))over( PARTITION BY xmid ORDER BY id,ghzdzh) ghzdzh,
               WMSYS.WM_CONCAT(gxlxbm)over( PARTITION BY xmid ORDER BY id,gxlxbm) gxlxbm,
               WMSYS.WM_CONCAT((case when gxqdzh like '.%' then 0||gxqdzh when gxqdzh like '%,.%' then replace(gxqdzh, ',.', ',0.') else gxqdzh end ))over( PARTITION BY xmid ORDER BY id,gxqdzh) gxqdzh,
               WMSYS.WM_CONCAT((case when gxzdzh like '.%' then 0||gxzdzh when gxzdzh like '%,.%' then replace(gxzdzh, ',.', ',0.') else gxzdzh end ))over( PARTITION BY xmid ORDER BY id,gxzdzh) gxzdzh,
               WMSYS.WM_CONCAT(qdmc)over( PARTITION BY xmid ORDER BY id,qdmc) qdmc,
               WMSYS.WM_CONCAT(zdmc)over( PARTITION BY xmid ORDER BY id,zdmc) zdmc
              from LXSH_LX lx where jdbs='1') group by xmid
    ) lx on c.xmbm=lx.xmid
    where 1=1 
				
				<if test="xzqhdm!=null and xzqhdm!=''">
					and ${xzqhdm}
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghlxbm!=null and ghlxbm!=''">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
					)
				</if>
				<if test="ylxbh!=null and ylxbh!=''">and c.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%2___' and jdbs='2')
				</if>
				<if test="xjsdj!=null and xjsdj!=''">and ${xjsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{lsjl}</if>
				<if test="tsdq!=null and tsdq!=''">${tsdq}</if>
				<if test="xmnf!=null and xmnf!=''">and ${xmnf}</if>
				<if test="xmbm!=null and xmbm!=''">and c.xmbm like '%'||#{xmbm}||'%'</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
				<if test="lxmc!=null and lxmc!=''">and lx.lxmc like '%'||#{lxmc}||'%'</if>
				<if test="ghlxmc!=null and ghlxmc!=''">and lx.ghlxmc like '%'||#{ghlxmc}||'%'</if>
				
				<!-- <if test="sbzt>=0">
					and c.sbzt=${sbzt}
				</if> -->
				<if test="shzt>=0">and c.shzt=${shzt}</if>
<!-- 				<if test="sbzt!=null and sbzt!=''">and c.sbzt=#{sbzt}</if> -->
				<if test="lsxmnf !='' and lsxmnf != null ">
					${lsxmnf}
				</if>
				<if test="lsxmlx !='' and lsxmlx != null ">
					${lsxmlx}
				</if>
	</select>
	<select id="queryYhdzxExcel" parameterType="cbsj" resultType="elist">
		select * from (
			select rownum num,t.* from (
				select decode(lx.sffirst,'1',c.xmbm,'') xmbm,decode(lx.sffirst,'1',c.xmmc,'') xmmc,c.xzqh,c.jsdw,c.jsjsdj,c.jsxz,c.mc,c.mc_lc,c.jc,c.jc_lc,c.dc,c.dc_lc,
				c.kgsj,c.wgsj,c.gq,decode(lx.sffirst,'1',c.sjdw,'') sjdw,decode(lx.sffirst,'1',c.sjpfwh,'') sjpfwh,decode(lx.sffirst,'1',c.pfsj,'') pfsj,decode(lx.sffirst,'1',c.jsfa,'') jsfa,lx.* from cbsj_yhdzx c left join xmsq_yhdzx l on c.xmbm=l.xmbm right join 
				(select xmid,lxbm ylxbh,lxmc lxmc,qdzh qdzh,zdzh zdzh,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,lc lc,yilc,erlc,sanlc,silc,dwlc,wllc,sffirst from lxsh_lx where jdbs='2' ) lx 
				on c.xmbm=lx.xmid 
				left join (select xmid, WMSYS.WM_CONCAT(distinct to_char(l.xzqhdm2))||';'||WMSYS.WM_CONCAT(distinct to_char(x.xzqhdm2)) xzqhdm2
               from lxsh_lx l,xmsq_yhdzx x
               where l.xmid=x.xmbm
              group by xmid) myxz on c.xmbm=myxz.xmid
				where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
				</if>
				<if test="ylxbh!=null and ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%4___' and jdbs='2')
				</if>
				<if test="xjsdj!=null and xjsdj!=''">and ${xjsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{lsjl}</if>
				<if test="tsdq!=null and tsdq!=''">${tsdq}</if>
				<if test="xmnf!=null and xmnf!=''">and ${xmnf}</if>
				<if test="xmbm!=null and xmbm!=''">and c.xmbm like '%'||#{xmbm}||'%'</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
				<if test="lxmc!=null and lxmc!=''">and lx.lxmc like '%'||#{lxmc}||'%'</if>
				<if test="ghlxbm!=null and ghlxbm!=''">and  lx.ghlxbm like '%'||#{ghlxbm}||'%'</if>
				<if test="ghlxmc!=null and ghlxmc!=''">and lx.ghlxmc like '%'||#{ghlxmc}||'%'</if>
		
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="shzt>=0">
					and c.shzt=${shzt}
				</if>
				<if test="xmlx1 !=null and xmlx1 !=''"> ${xmlx1}</if>
				<if test="gcfl!=null and gcfl!=''">and ${gcfl}</if>
				<if test="lsxmnf !='' and lsxmnf != null ">
					${lsxmnf}
				</if>
				<if test="lsxmlx !='' and lsxmlx != null ">
					${lsxmlx}
				</if>
				order by c.shzt,c.xmbm desc,lx.sffirst desc) t 
		)
	</select>
	<select id="queryShExcel" parameterType="cbsj" resultType="elist">
		select * from (
			select rownum num,t.* from (
			select decode(lx.sffirst,'1',c.xmbm,'') xmbm,decode(lx.sffirst,'1',c.xmmc,'') xmmc,c.xzqh,c.jsdw,c.jsjsdj,c.jsxz,c.mc,c.mc_lc,c.jc,c.jc_lc,c.dc,c.dc_lc,
			c.kgsj,c.wgsj,c.gq,decode(lx.sffirst,'1',c.sjdw,'') sjdw,decode(lx.sffirst,'1',c.sjpfwh,'') sjpfwh,decode(lx.sffirst,'1',c.pfsj,'') pfsj,decode(lx.sffirst,'1',c.jsfa,'') jsfa,lx.* from cbsj_sh c left join xmsq_sh l on c.xmbm=l.xmbm right join 
			(select xmid,lxbm ylxbh,lxmc lxmc,qdzh qdzh,zdzh zdzh,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,lc lc,yilc,erlc,sanlc,silc,dwlc,wllc,sffirst from lxsh_lx where jdbs='2'  ) lx 
			on c.xmbm=lx.xmid 
			left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
			where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="ylxbh!=null and ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%5___' and jdbs='2')
				</if>
				<if test="xjsdj!=null and xjsdj!=''">and ${xjsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{lsjl}</if>
				<if test="tsdq!=null and tsdq!=''">${tsdq}</if>
				<if test="xmnf!=null and xmnf!=''">and ${xmnf}</if>
				<if test="xmbm!=null and xmbm!=''">and c.xmbm like '%'||#{xmbm}||'%'</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
				<if test="lxmc!=null and lxmc!=''">and lx.lxmc like '%'||#{lxmc}||'%'</if>
				<if test="ghlxmc!=null and ghlxmc!=''">and lx.ghlxmc like '%'||#{ghlxmc}||'%'</if>
				
				<if test="shzt>=0">and c.shzt=${shzt}</if>
				
<!-- 				<if test="sbzt!=null and sbzt!=''">and c.sbzt=#{sbzt}</if> -->
				<if test="lsxmnf !='' and lsxmnf != null ">
					${lsxmnf}
				</if>
				<if test="lsxmlx !='' and lsxmlx != null ">
					${lsxmlx}
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghlxbm!=null and ghlxbm!=''">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
					)
				</if>
				order by c.shzt,c.xmbm desc,lx.sffirst desc) t 
		)
	</select>
	<select id="queryLmsjExcel" parameterType="cbsj" resultType="elist">
		<!-- select * from (
			select rownum num,t.* from (
				select decode(lx.sffirst,'1',c.xmbm,'') xmbm,decode(lx.sffirst,'1',c.xmmc,'') xmmc,c.xzqh,c.jsdw,c.jsjsdj,c.jsxz,c.lj,c.ql,c.ql_ym,c.hd,c.hd_m,c.sd,c.sd_ym,
				c.mc,c.mc_lc,c.jc,c.jc_lc,c.dc,c.dc_lc,c.dq,c.dq_cd,c.dq_dk,c.sdmc,c.sd_lx,c.sd_sfcd,
				c.kgsj,c.wgsj,c.gq,decode(lx.sffirst,'1',c.sjdw,'') sjdw,decode(lx.sffirst,'1',c.sjpfwh,'') sjpfwh,decode(lx.sffirst,'1',c.pfsj,'') pfsj,decode(lx.sffirst,'1',c.jaf,'') jaf,decode(lx.sffirst,'1',c.dfzc,'') dfzc,decode(lx.sffirst,'1',c.yhdk,'') yhdk,lx.* from cbsj_sjgz c left join lxsh_sjgz l on c.xmbm = l.xmbm
				right join (select xmid, lxbm ylxbh,lxmc lxmc,qdzh qdzh,zdzh zdzh,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,lc,yilc,erlc,sanlc,silc,dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,sffirst from lxsh_lx where jdbs='2' ) lx
				on c.xmbm = lx.xmid
				left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
				 where 1=1 -->
				 
				 select rownum v_0,c.xmmc v_1,c.xmbm v_2,c.xzqh v_3,c.jsdw v_4,RemoveSameStr(lx.jsjsdjtj,',') v_5,lx.jsxz v_6,
    decode(instr(RemoveSameStr(lx.ylxbm,','),','),0,RemoveSameStr(lx.ylxbm,','),lx.ylxbm) v_7,
    decode(instr(RemoveSameStr(lx.ylxmc,','),','),0,RemoveSameStr(lx.ylxmc,','),lx.ylxmc) v_8,
    lx.qdzh v_9,lx.zdzh v_10,
    decode(instr(RemoveSameStr(lx.ghlxbm,','),','),0,RemoveSameStr(lx.ghlxbm,','),lx.ghlxbm)  v_11,
    decode(instr(RemoveSameStr(lx.ghlxmc,','),','),0,RemoveSameStr(lx.ghlxmc,','),lx.ghlxmc) v_12,
    lx.ghqdzh v_13,lx.ghzdzh v_14,
    decode(instr(RemoveSameStr(lx.gxlxbm,','),','),0,RemoveSameStr(lx.gxlxbm,','),lx.gxlxbm) v_15,
    lx.gxqdzh v_16,lx.gxzdzh v_17,
    to_char(lx.lc,'fm9999999990.000') v_18, to_char(lx.yilc,'fm9999999990.000') v_19, to_char(lx.erlc,'fm9999999990.000') v_20, 
    to_char(lx.sanlc,'fm9999999990.000') v_21, to_char(lx.silc,'fm9999999990.000') v_22, to_char(lx.dwlc,'fm9999999990.000') v_23, 
    to_char(lx.wllc,'fm9999999990.000') v_24,
    to_char(lx.jhyilc,'fm9999999990.000') v_25, to_char(lx.jherlc,'fm9999999990.000') v_26, 
    to_char(lx.jhsanlc,'fm9999999990.000') v_27, to_char(lx.jhsilc,'fm9999999990.000') v_28, to_char(lx.jhdwlc,'fm9999999990.000') v_29, 
    to_char(lx.jhwllc,'fm9999999990.000') v_30,
    c.lj v_31,c.ql v_32,c.ql_ym v_33,c.hd v_34,c.hd_m v_35,c.sd v_36,c.sd_ym v_37,c.mc v_38,c.mc_lc v_39,c.jc v_40,c.jc_lc v_41,c.dc v_42,c.dc_lc v_43,
    c.dq v_44,c.dq_cd v_45,c.dq_dk v_46,c.sdmc v_47,c.sd_sfcd v_48,c.sd_lx v_49,c.kgsj v_50,c.wgsj v_51,c.gq v_52,c.sjdw v_53,
    c.sjpfwh v_54,c.pfsj v_55,c.jaf v_56,nvl(c.dfzc,0) v_57,nvl(c.yhdk,0) v_58
    from cbsj_sjgz c 
    Left join (select xmbm xmbh,lsjl,xmklx,tsdq,lsxmbm,xzqh,xzqhdm2 from lxgsdgz) t1 on c.xmbm=t1.xmbh
    left join 
        (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2
         from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
    left join (
    select xmid,sum(jhlc) zjhlc,sum(sbzj) sbzj,sum(bzcs) bzcs,
              replace(WMSYS.WM_CONCAT(distinct(lxlmkd)),',',',') lxlmkd,replace(WMSYS.WM_CONCAT(distinct(jsxz)),',',',') jsxz,
              replace(WMSYS.WM_CONCAT(distinct(gydw)),',',',') gydw,replace(WMSYS.WM_CONCAT(distinct(xzqh)),',',',') xzqh,
              replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
              replace(WMSYS.WM_CONCAT(jsjsdj),'、',',') jsjsdjtj,
              replace(WMSYS.WM_CONCAT(xjsdj),'、',',') xjsdjtj,
              replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,
             replace(max(qdzh), ',.', ',0.') qdzh,replace(max(zdzh), ',.', ',0.') zdzh,replace(max(ghqdzh), ',.', ',0.') ghqdzh,replace(max(ghzdzh), ',.', ',0.') ghzdzh,
             replace(max(gxqdzh), ',.', ',0.') gxqdzh,replace(max(gxzdzh), ',.', ',0.') gxzdzh,
             max(ghlxbm) ghlxbm,max(ylxbm) ylxbm,max(ghlxmc) ghlxmc,max(ylxmc) ylxmc,max(gxlxbm) gxlxbm,max(qdmc) qdmc,max(zdmc) zdmc,
             sum(nvl(jhyilc,0)) jhyilc,sum(nvl(yilc,0)) yilc,sum(nvl(jherlc,0)) jherlc,sum(nvl(erlc,0)) erlc,
             sum(nvl(jhsanlc,0)) jhsanlc,sum(nvl(sanlc,0)) sanlc,sum(nvl(jhsilc,0)) jhsilc,sum(nvl(silc,0)) silc,
             sum(nvl(jhdwlc,0)) jhdwlc,sum(nvl(dwlc,0)) dwlc,sum(nvl(jhwllc,0)) jhwllc,sum(nvl(wllc,0)) wllc,sum(nvl(lc,0)) lc
              from (select  xmid,jsxz,sbzj,lxlmkd,gydw,xzqh,bzcs,
              (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)) 
              else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
              end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
              else ''
              end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,yilc,erlc,sanlc,silc,dwlc,wllc,lc,
               WMSYS.WM_CONCAT(ghlxmc)over( PARTITION BY xmid ORDER BY id,ghlxmc) ghlxmc,
               WMSYS.WM_CONCAT(lxmc)over( PARTITION BY xmid ORDER BY id,lxmc) ylxmc,
               WMSYS.WM_CONCAT(ghlxbm)over( PARTITION BY xmid ORDER BY id,ghlxbm) ghlxbm,
               WMSYS.WM_CONCAT(lxbm)over( PARTITION BY xmid ORDER BY id,lxbm) ylxbm,
               WMSYS.WM_CONCAT((case when qdzh like '.%' then 0||qdzh when qdzh like '%,.%' then replace(qdzh, ',.', ',0.') else qdzh end ))over( PARTITION BY xmid ORDER BY id,qdzh) qdzh,
               WMSYS.WM_CONCAT((case when zdzh like '.%' then 0||zdzh when zdzh like '%,.%' then replace(zdzh, ',.', ',0.') else zdzh end ))over( PARTITION BY xmid ORDER BY id,zdzh) zdzh,
               WMSYS.WM_CONCAT((case when ghqdzh like '.%' then 0||ghqdzh when ghqdzh like '%,.%' then replace(ghqdzh, ',.', ',0.') else ghqdzh end ))over( PARTITION BY xmid ORDER BY id,ghqdzh) ghqdzh,
               WMSYS.WM_CONCAT((case when ghzdzh like '.%' then 0||ghzdzh when ghzdzh like '%,.%' then replace(ghzdzh, ',.', ',0.') else ghzdzh end ))over( PARTITION BY xmid ORDER BY id,ghzdzh) ghzdzh,
               WMSYS.WM_CONCAT(gxlxbm)over( PARTITION BY xmid ORDER BY id,gxlxbm) gxlxbm,
               WMSYS.WM_CONCAT((case when gxqdzh like '.%' then 0||gxqdzh when gxqdzh like '%,.%' then replace(gxqdzh, ',.', ',0.') else gxqdzh end ))over( PARTITION BY xmid ORDER BY id,gxqdzh) gxqdzh,
               WMSYS.WM_CONCAT((case when gxzdzh like '.%' then 0||gxzdzh when gxzdzh like '%,.%' then replace(gxzdzh, ',.', ',0.') else gxzdzh end ))over( PARTITION BY xmid ORDER BY id,gxzdzh) gxzdzh,
               WMSYS.WM_CONCAT(qdmc)over( PARTITION BY xmid ORDER BY id,qdmc) qdmc,
               WMSYS.WM_CONCAT(zdmc)over( PARTITION BY xmid ORDER BY id,zdmc) zdmc
              from LXSH_LX lx where jdbs='1') group by xmid
    ) lx on c.xmbm=lx.xmid
    where 1=1 
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="ylxbh!=null and ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%1___' and jdbs='2')
				</if>
				<if test="xjsdj!=null and xjsdj!=''">and ${xjsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{lsjl}</if>
				<if test="tsdq!=null and tsdq!=''">${tsdq}</if>
				<if test="xmnf!=null and xmnf!=''">and ${xmnf}</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
				<if test="lxmc!=null and lxmc!=''">and lx.lxmc like '%'||#{lxmc}||'%'</if>
				<if test="xmbm!=null and xmbm!=''">and c.xmbm like '%'||#{xmbm}||'%'</if>
				
				<if test="ghlxmc!=null and ghlxmc!=''">and lx.ghlxmc like '%'||#{ghlxmc}||'%'</if>
				
				<if test="shzt>=0">and c.shzt=${shzt}</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghlxbm!=null and ghlxbm!=''">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
					)
				</if>
<!-- 				<if test="sbzt!=null and sbzt!=''">and c.sbzt=#{sbzt}</if> -->
				<if test="lsxmnf !='' and lsxmnf != null ">
					${lsxmnf}
				</if>
				<if test="lsxmlx !='' and lsxmlx != null ">
					${lsxmlx}
				</if>
	</select>
	<select id="queryXjExcel" parameterType="cbsj" resultType="elist">
		<!-- select * from (
			select rownum num,t.* from (
				select decode(lx.sffirst,'1',c.xmbm,'') xmbm,decode(lx.sffirst,'1',c.xmmc,'') xmmc,c.xzqh,c.jsdw,c.jsjsdj,c.jsxz,c.lj,c.ql,c.ql_ym,c.hd,c.hd_m,c.sd,c.sd_ym,
				c.mc,c.mc_lc,c.jc,c.jc_lc,c.dc,c.dc_lc,c.dq,c.dq_cd,c.dq_dk,c.sdmc,c.sd_lx,c.sd_sfcd,
				c.kgsj,c.wgsj,c.gq,decode(lx.sffirst,'1',c.sjdw,'') sjdw,decode(lx.sffirst,'1',c.sjpfwh,'') sjpfwh,decode(lx.sffirst,'1',c.pfsj,'') pfsj,decode(lx.sffirst,'1',c.jaf,'') jaf,decode(lx.sffirst,'1',c.dfzc,'') dfzc,decode(lx.sffirst,'1',c.yhdk,'') yhdk,lx.* from cbsj_xj c left join lxsh_xj l on c.xmbm = l.xmbm
				right join (select xmid, lxbm ylxbh,lxmc lxmc,qdzh qdzh,zdzh zdzh,lc,xjlxbm xjlxbm, xjqdzh xjqdzh,xjzdzh xjzdzh,yilc,erlc,sanlc,silc,dwlc,wllc,sffirst from lxsh_lx where jdbs='2' ) lx
				on c.xmbm = lx.xmid 
				left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
				where 1=1 -->
				select rownum v_0,c.xmmc v_1,c.xmbm v_2,c.xzqh v_3,c.jsdw v_4,RemoveSameStr(lx.jsjsdjtj,',') v_5,lx.jsxz v_6,
    decode(instr(RemoveSameStr(lx.ylxbm,','),','),0,RemoveSameStr(lx.ylxbm,','),lx.ylxbm) v_7,
    decode(instr(RemoveSameStr(lx.ylxmc,','),','),0,RemoveSameStr(lx.ylxmc,','),lx.ylxmc) v_8,
    lx.qdzh v_9,lx.zdzh v_10,
    decode(instr(RemoveSameStr(lx.ghlxbm,','),','),0,RemoveSameStr(lx.ghlxbm,','),lx.ghlxbm)  v_11,
    decode(instr(RemoveSameStr(lx.ghlxmc,','),','),0,RemoveSameStr(lx.ghlxmc,','),lx.ghlxmc) v_12,
    lx.ghqdzh v_13,lx.ghzdzh v_14,
    decode(instr(RemoveSameStr(lx.gxlxbm,','),','),0,RemoveSameStr(lx.gxlxbm,','),lx.gxlxbm) v_15,
    lx.gxqdzh v_16,lx.gxzdzh v_17,
    to_char(lx.lc,'fm9999999990.000') v_18, to_char(lx.yilc,'fm9999999990.000') v_19, to_char(lx.erlc,'fm9999999990.000') v_20, 
    to_char(lx.sanlc,'fm9999999990.000') v_21, to_char(lx.silc,'fm9999999990.000') v_22, to_char(lx.dwlc,'fm9999999990.000') v_23, 
    to_char(lx.wllc,'fm9999999990.000') v_24,
    to_char(lx.jhyilc,'fm9999999990.000') v_25, to_char(lx.jherlc,'fm9999999990.000') v_26, 
    to_char(lx.jhsanlc,'fm9999999990.000') v_27, to_char(lx.jhsilc,'fm9999999990.000') v_28, to_char(lx.jhdwlc,'fm9999999990.000') v_29, 
    to_char(lx.jhwllc,'fm9999999990.000') v_30,
    c.lj v_31,c.ql v_32,c.ql_ym v_33,c.hd v_34,c.hd_m v_35,c.sd v_36,c.sd_ym v_37,c.mc v_38,c.mc_lc v_39,c.jc v_40,c.jc_lc v_41,c.dc v_42,c.dc_lc v_43,
    c.dq v_44,c.dq_cd v_45,c.dq_dk v_46,c.sdmc v_47,c.sd_sfcd v_48,c.sd_lx v_49,c.kgsj v_50,c.wgsj v_51,c.gq v_52,c.sjdw v_53,
    c.sjpfwh v_54,c.pfsj v_55,c.jaf v_56,nvl(c.dfzc,0) v_57,nvl(c.yhdk,0) v_58
    from cbsj_xj c 
    Left join (select xmbm xmbh,lsjl,xmklx,tsdq,lsxmbm,xzqh,xzqhdm2 from lxgsdgz) t1 on c.xmbm=t1.xmbh
    left join 
        (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2
         from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
    left join (
    select xmid,sum(jhlc) zjhlc,sum(sbzj) sbzj,sum(bzcs) bzcs,
              replace(WMSYS.WM_CONCAT(distinct(lxlmkd)),',',',') lxlmkd,replace(WMSYS.WM_CONCAT(distinct(jsxz)),',',',') jsxz,
              replace(WMSYS.WM_CONCAT(distinct(gydw)),',',',') gydw,replace(WMSYS.WM_CONCAT(distinct(xzqh)),',',',') xzqh,
              replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
              replace(WMSYS.WM_CONCAT(jsjsdj),'、',',') jsjsdjtj,
              replace(WMSYS.WM_CONCAT(xjsdj),'、',',') xjsdjtj,
              replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,
             replace(max(qdzh), ',.', ',0.') qdzh,replace(max(zdzh), ',.', ',0.') zdzh,replace(max(ghqdzh), ',.', ',0.') ghqdzh,replace(max(ghzdzh), ',.', ',0.') ghzdzh,
             replace(max(gxqdzh), ',.', ',0.') gxqdzh,replace(max(gxzdzh), ',.', ',0.') gxzdzh,
             max(ghlxbm) ghlxbm,max(ylxbm) ylxbm,max(ghlxmc) ghlxmc,max(ylxmc) ylxmc,max(gxlxbm) gxlxbm,max(qdmc) qdmc,max(zdmc) zdmc,
             sum(nvl(jhyilc,0)) jhyilc,sum(nvl(yilc,0)) yilc,sum(nvl(jherlc,0)) jherlc,sum(nvl(erlc,0)) erlc,
             sum(nvl(jhsanlc,0)) jhsanlc,sum(nvl(sanlc,0)) sanlc,sum(nvl(jhsilc,0)) jhsilc,sum(nvl(silc,0)) silc,
             sum(nvl(jhdwlc,0)) jhdwlc,sum(nvl(dwlc,0)) dwlc,sum(nvl(jhwllc,0)) jhwllc,sum(nvl(wllc,0)) wllc,sum(nvl(lc,0)) lc
              from (select  xmid,jsxz,sbzj,lxlmkd,gydw,xzqh,bzcs,
              (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)) 
              else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
              end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
              else ''
              end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,yilc,erlc,sanlc,silc,dwlc,wllc,lc,
               WMSYS.WM_CONCAT(ghlxmc)over( PARTITION BY xmid ORDER BY id,ghlxmc) ghlxmc,
               WMSYS.WM_CONCAT(lxmc)over( PARTITION BY xmid ORDER BY id,lxmc) ylxmc,
               WMSYS.WM_CONCAT(ghlxbm)over( PARTITION BY xmid ORDER BY id,ghlxbm) ghlxbm,
               WMSYS.WM_CONCAT(lxbm)over( PARTITION BY xmid ORDER BY id,lxbm) ylxbm,
               WMSYS.WM_CONCAT((case when qdzh like '.%' then 0||qdzh when qdzh like '%,.%' then replace(qdzh, ',.', ',0.') else qdzh end ))over( PARTITION BY xmid ORDER BY id,qdzh) qdzh,
               WMSYS.WM_CONCAT((case when zdzh like '.%' then 0||zdzh when zdzh like '%,.%' then replace(zdzh, ',.', ',0.') else zdzh end ))over( PARTITION BY xmid ORDER BY id,zdzh) zdzh,
               WMSYS.WM_CONCAT((case when ghqdzh like '.%' then 0||ghqdzh when ghqdzh like '%,.%' then replace(ghqdzh, ',.', ',0.') else ghqdzh end ))over( PARTITION BY xmid ORDER BY id,ghqdzh) ghqdzh,
               WMSYS.WM_CONCAT((case when ghzdzh like '.%' then 0||ghzdzh when ghzdzh like '%,.%' then replace(ghzdzh, ',.', ',0.') else ghzdzh end ))over( PARTITION BY xmid ORDER BY id,ghzdzh) ghzdzh,
               WMSYS.WM_CONCAT(gxlxbm)over( PARTITION BY xmid ORDER BY id,gxlxbm) gxlxbm,
               WMSYS.WM_CONCAT((case when gxqdzh like '.%' then 0||gxqdzh when gxqdzh like '%,.%' then replace(gxqdzh, ',.', ',0.') else gxqdzh end ))over( PARTITION BY xmid ORDER BY id,gxqdzh) gxqdzh,
               WMSYS.WM_CONCAT((case when gxzdzh like '.%' then 0||gxzdzh when gxzdzh like '%,.%' then replace(gxzdzh, ',.', ',0.') else gxzdzh end ))over( PARTITION BY xmid ORDER BY id,gxzdzh) gxzdzh,
               WMSYS.WM_CONCAT(qdmc)over( PARTITION BY xmid ORDER BY id,qdmc) qdmc,
               WMSYS.WM_CONCAT(zdmc)over( PARTITION BY xmid ORDER BY id,zdmc) zdmc
              from LXSH_LX lx where jdbs='1') group by xmid
    ) lx on c.xmbm=lx.xmid
    where 1=1 
				
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="ylxbh!=null and ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%3___' and jdbs='2')
				</if>
				<if test="xjsdj!=null and xjsdj!=''">and ${xjsdj}</if>
				<if test="tsdq!=null and tsdq!=''">${tsdq}</if>
				<if test="xmnf!=null and xmnf!=''">and ${xmnf}</if>
				<if test="xmbm!=null and xmbm!=''">and c.xmbm like '%'||#{xmbm}||'%'</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
				<if test="lxmc!=null and lxmc!=''">and lx.lxmc like '%'||#{lxmc}||'%'</if>
				<if test="ghlxmc!=null and ghlxmc!=''">and lx.ghlxmc like '%'||#{ghlxmc}||'%'</if>
		
				<if test="shzt>=0">and c.shzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and c.sbzt=#{sbzt}</if>
				<if test="lsxmnf !='' and lsxmnf != null ">
					${lsxmnf}
				</if>
				<if test="lsxmlx !='' and lsxmlx != null ">
					${lsxmlx}
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghlxbm!=null and ghlxbm!=''">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
					)
				</if>
	</select>
	<select id="queryFj" resultType="plan_upload">
		select filename,substr(parentid,0,4) xmbm from plan_upload where fileurl is null and filetype='设计批复文件' group by filename,substr(parentid,0,4)
	</select>
	<select id="queryFjByName" resultType="plan_upload">
		select * from plan_upload where filename=#{filename} and
		parentid = (select max(parentid) from plan_upload where filename=#{filename} and parentid like #{xmbm}||'%')
	</select>
	<select id="queryGkXm" resultType="plan_upload" parameterType="java.util.Map">
		select * from (
		select k.xmbm parentid,k.gkpfwh filewh from kxxyj_lmgz k
		union all
		select k.xmbm,k.gkpfwh from kxxyj_sjgz k
		union all
		select k.xmbm,k.gkpfwh from kxxyj_xj k) where filewh like '%'||#{gkwh}||'%'
	</select>
	<select id="queryJhXm" resultType="plan_upload" parameterType="java.util.Map">
		select * from (
		select j.xmbm parentid,j.xdwh filewh from jhsh_lmgz j
		union all
		select j.xmbm,j.xdwh from jhsh_sjgz j
		union all
		select xj.xmbm,xj.xdwh from jhsh_xj xj
		union all
		select yh.xmbm,yh.xdwh from jhsh_yhdzx yh
		union all
		select sh.xmbm,sh.xdwh from jhsh_sh sh) where filewh like '%'||#{jhwh}||'%'
	</select>
	<select id="queryCbsjLjYhdzx" parameterType="cbsj" resultType="java.util.Map">
		select count(*) sl,nvl(sum(c.tz),0) tz,nvl(sum(l1.lc),0) lc,nvl(sum(l1.sbzj),0) sbz,'0' sjl,'0' bzcs,'0' dftz from cbsj_yhdzx c left join 
		xmsq_yhdzx l on c.xmbm=l.xmbm 
		left join (select xmid, WMSYS.WM_CONCAT(distinct to_char(l.xzqhdm2))||';'||WMSYS.WM_CONCAT(distinct to_char(x.xzqhdm2)) xzqhdm2
               from lxsh_lx l,xmsq_yhdzx x
               where l.xmid=x.xmbm
               group by xmid) myxz on c.xmbm=myxz.xmid
               left join lxsh_lx lx
     		   on c.xmbm = lx.xmid
		left join 
		(select xmid,(sum(nvl(yilc,0))+sum(nvl(erlc,0))+sum(nvl(sanlc,0))+sum(nvl(silc,0))+sum(nvl(dwlc,0))+sum(nvl(wllc,0))) lc,to_char(nvl(sum(sbzj),0)) sbzj 
		from lxsh_lx where substr(xmid,11,1)=4 and jdbs='2'
		 group by xmid) l1 on c.xmbm=l1.xmid
		where 1=1
		and lx.jdbs = '2'
   		and lx.sffirst = '1'
   		<if test="ghlxmc!='' and ghlxmc!= null ">
			and lx.ghlxmc=#{ghlxmc}
		</if>
<!-- 		<if test="ghlxbm!='' and ghlxbm!= null "> -->
<!-- 			and lx.ghlxbm=#{ghlxbm} -->
<!-- 		</if> -->
		<if test="lxmc!='' and lxmc!= null ">
			and lx.lxmc=#{lxmc}
		</if>
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		
		<if test="ylxbh!=null and ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%4___' and jdbs='2')
		</if>
		<if test="xjsdj!=null and xjsdj!=''">and ${xjsdj}</if>
		<if test="xmnf!=null and xmnf!=''">and ${xmnf}</if>
		<if test="sbzt!=null and sbzt!=''">and c.sbzt=#{sbzt}</if>
		<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
		<if test="tsdq!=null and tsdq!=''">${tsdq}</if>
		<if test="xmmc !=null and xmmc !=''">and c.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmbm !=null and xmbm !=''">and c.xmbm like '%'||#{xmbm}||'%'</if>
		<if test="xmlx1!=null and xmlx1!=''">${xmlx1}</if>
		<if test="shzt>=0">and c.shzt=${shzt}</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			or c.xmbm in (select distinct xmid from lx_clsd where ghlxmc like '%'||#{ghlxmc}||'%')
			)
		</if>
		
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
		<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{lsjl}</if>
		<if test="gcfl!=null and gcfl!=''">and ${gcfl}</if>
	</select>
	<select id="queryCbsjbgLjYhdzx" parameterType="cbsj" resultType="java.util.Map">
		select sum(l.ntz) ntz,sum(l1.lc) lc from cbsj_yhdzx_tz c left join 
		xmsq_yhdzx l on c.xmbm=l.xmbm left join 
		(select xmid,(sum(nvl(yilc,0))+sum(nvl(erlc,0))+sum(nvl(sanlc,0))+sum(nvl(silc,0))+sum(nvl(dwlc,0))+sum(nvl(wllc,0))) lc from lxsh_lx_tz where xmid like '%4___' and jdbs='2' group by xmid) l1 on c.xmbm=l1.xmid
		where 1=1
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where ${ylxbh} and xmid like '%4___' and jdbs='2')
		</if>
		<if test="xjsdj!=null and xjsdj!=''">and ${xjsdj}</if>
		<if test="gcfl!=null and gcfl!=''">and ${gcfl}</if>
		<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
		<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
		<if test="tsdq!=null and tsdq!=''">${tsdq}</if>
		<if test="shzt>=0">and c.shzt=${shzt}</if>
		<if test="tzxz !=null and tzxz !=''">and c.tzxz like '%'||#{tzxz}||'%'</if>
		<if test="xmmc !=null and xmmc !=''">and c.xmmc like '%'||#{xmmc}||'%'</if>
	</select>
	
	<select id="queryCbsjLjSh" parameterType="cbsj" resultType="java.util.Map">
		select count(*) sl,nvl(sum(c.tz),0) tz,nvl(sum(l1.lc),0) lc,'0' sbz,'0' sjl,'0' bzcs,'0' dftz from cbsj_sh c left join 
		xmsq_sh l on c.xmbm=l.xmbm left join lxsh_lx lx
     		   on c.xmbm = lx.xmid
		left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(xzqhdm2))  xzqhdm2 from lxsh_lx 
<!-- 		where jdbs = '2'  -->
		group by xmid) myxz on c.xmbm=myxz.xmid
		left join 
		(select xmid,(sum(nvl(yilc,0))+sum(nvl(erlc,0))+sum(nvl(sanlc,0))+sum(nvl(silc,0))+sum(nvl(dwlc,0))+sum(nvl(wllc,0))) lc from lxsh_lx where substr(xmid,11,1)=5 and jdbs='2' group by xmid) l1 on c.xmbm=l1.xmid
		where lx.jdbs='2' and lx.sffirst='1'
				<if test="ghlxmc!='' and ghlxmc!= null ">
					and lx.ghlxmc=#{ghlxmc}
				</if>
				<!-- <if test="ghlxbm!='' and ghlxbm!= null ">
					and lx.ghlxbm=#{ghlxbm}
				</if> -->
				<if test="lxmc!='' and lxmc!= null ">
					and lx.lxmc=#{lxmc}
				</if>
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				<if test="ylxbh!=null and ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%5___' and jdbs='2')
				</if>
				<if test="xjsdj!=null and xjsdj!=''">and ${xjsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{lsjl}</if>
				<if test="tsdq!=null and tsdq!=''">${tsdq}</if>
				<if test="xmnf!=null and xmnf!=''">and ${xmnf}</if>
				<if test="sbzt!=null and sbzt!=''">and c.sbzt=#{sbzt}</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
				<if test="xmmc !=null and xmmc !=''">and c.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xmbm !=null and xmbm !=''">and c.xmbm like '%'||#{xmbm}||'%'</if>
				<!-- <if test="sbzt>=0">
					and c.sbzt=${sbzt}
				</if> -->
				<if test="shzt>=0">and c.shzt=${shzt}</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghlxbm!=null and ghlxbm!=''">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
					)
				</if>
				<if test="ghlxmc!='' and ghlxmc!= null ">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
					or c.xmbm in (select distinct xmid from lx_clsd where ghlxmc like '%'||#{ghlxmc}||'%')
					)
				</if>
				<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
	</select>
	<select id="queryCbsjbgLjSh" parameterType="cbsj" resultType="java.util.Map">
		select sum(l.ntz) ntz,sum(l1.lc) lc from cbsj_sh_tz c left join 
		xmsq_sh l on c.xmbm=l.xmbm left join 
		(select xmid,(sum(nvl(yilc,0))+sum(nvl(erlc,0))+sum(nvl(sanlc,0))+sum(nvl(silc,0))+sum(nvl(dwlc,0))+sum(nvl(wllc,0))) lc from lxsh_lx_tz where xmid like '%5___' and jdbs='2' group by xmid) l1 on c.xmbm=l1.xmid
		where 1=1
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where ${ylxbh} and xmid like '%5___' and jdbs='2')
		</if>
		<if test="xjsdj!=null and xjsdj!=''">and ${xjsdj}</if>
		<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
		<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
		<if test="tsdq!=null and tsdq!=''">${tsdq}</if>
		<if test="shzt>=0">and c.shzt=${shzt}</if>
		<if test="xmmc !=null and xmmc !=''">and c.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="tzxz !=null and tzxz !=''">and c.tzxz like '%'||#{tzxz}||'%'</if>
	</select>
	
	<select id="loadsjcbsjTjxx" parameterType="java.util.Map" resultType="lxsh">
		select count(*) sl,round(nvl(sum(c.tz),0),3) tz,round(nvl(sum(lx.lc),0),3) lc,round(nvl(sum(lx.bzcs),0),3) bzcs,'0' sbz,'0' sjl,round(nvl((sum(c.tz)-sum(bzys)),0),3) dftz from cbsj_sjgz c left join lxsh_sjgz l on c.xmbm=l.xmbm
		left join (select xmid, sum(nvl(jhyilc,0))+sum(nvl(jherlc,0))+sum(nvl(jhsanlc,0))+sum(nvl(jhsilc,0))+sum(nvl(jhdwlc,0))+sum(nvl(jhwllc,0)) lc, min(xjsdj) xjsdj, min(jsjsdj) jsjsdj, min(lxbm) lxbm, min(bzcs) bzcs from lxsh_lx where jdbs = '2' group by xmid ) lx on c.xmbm=lx.xmid left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
		where 1=1
		
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%1___')
		</if>
		<if test="cbsj.xmklx!='' and cbsj.xmklx!= null ">
					and xmklx like '%'||#{cbsj.xmklx}||'%'
				</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmnf!=null and cbsj.xmnf!=''">and ${cbsj.xmnf}</if>
		<if test="cbsj.sbzt!=null and cbsj.sbzt!=''">and c.sbzt=#{cbsj.sbzt}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			${cbsj.tsdq}
		</if>
		<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
		<if test="cbsj.xmbm !=null and cbsj.xmbm !=''">and c.xmbm like '%'||#{cbsj.xmbm}||'%'</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
		<if test="cbsj.lsxmnf !='' and cbsj.lsxmnf != null ">
				${cbsj.lsxmnf}
			</if>
			<if test="cbsj.lsxmlx !='' and cbsj.lsxmlx != null ">
				${cbsj.lsxmlx}
			</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbh})
		</if>
		<if test="cbsj.ghlxbm!=null and cbsj.ghlxbm!=''">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbm})
			)
		</if>
	</select>
	<select id="loadsjcbsjbgTjxx" parameterType="java.util.Map" resultType="lxsh">
		select count(*) sl,nvl(sum(l.tz),0) tz,nvl(sum(lx.lc),0) lc,nvl(sum(lx.bzcs),0) bzcs from cbsj_sjgz_tz c left join lxsh_sjgz l on c.xmbm=l.xmbm
		left join (select xmid,jhlc lc,xjsdj,jsjsdj,lxbm,bzcs from lxsh_lx_tz where jdbs='2' ) lx on c.xmbm=lx.xmid left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
		where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
		</if>
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where ${cbsj.ylxbh} and xmid like '%1___')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			${cbsj.tsdq}
		</if>
		<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
		<if test="cbsj.tzxz !=null and cbsj.tzxz !=''">and c.tzxz like '%'||#{cbsj.tzxz}||'%'</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
	</select>
	
	<select id="loadlmcbsjTjxx" parameterType="java.util.Map" resultType="lxsh">
		select count(*) sl,round(nvl(sum(c.tz),0),3) tz,round(nvl(sum(lx.lc),0),3) lc,round(nvl(sum(lx.bzcs),0),3) bzcs,'0' sbz,'0' sjl,round(nvl((sum(c.tz)-sum(bzys)),0),3) dftz from cbsj_lmgz c left join lxsh_lmgz l on c.xmbm=l.xmbm
		left join (select xmid, sum(nvl(yilc,0))+sum(nvl(erlc,0))+sum(nvl(sanlc,0))+sum(nvl(silc,0))+sum(nvl(dwlc,0))+sum(nvl(wllc,0)) lc, min(xjsdj) xjsdj, min(jsjsdj) jsjsdj, min(lxbm) lxbm, min(bzcs) bzcs from lxsh_lx where jdbs = '2' group by xmid ) lx on c.xmbm=lx.xmid left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
		where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%1___')
		</if>
		<if test="cbsj.xmklx!='' and cbsj.xmklx!= null ">
					and xmklx like '%'||#{cbsj.xmklx}||'%'
				</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmnf!=null and cbsj.xmnf!=''">and ${cbsj.xmnf}</if>
		<if test="cbsj.sbzt!=null and cbsj.sbzt!=''">and c.sbzt=#{cbsj.sbzt}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			${cbsj.tsdq}
		</if>
		<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
		<if test="cbsj.xmbm !=null and cbsj.xmbm !=''">and c.xmbm like '%'||#{cbsj.xmbm}||'%'</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbh})
		</if>
		<if test="cbsj.ghlxbm!=null and cbsj.ghlxbm!=''">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbm})
			)
		</if>
			<if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
				and (c.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{cbsj.ghlxmc}||'%')

				)
			</if>
			<if test="cbsj.lsxmnf !='' and cbsj.lsxmnf != null ">
			${cbsj.lsxmnf}
		</if>
			<if test="cbsj.lsxmlx !='' and cbsj.lsxmlx != null ">
				${cbsj.lsxmlx}
			</if>
	</select>
	<select id="loadlmcbsjbgTjxx" parameterType="java.util.Map" resultType="lxsh">
		select count(*) sl,nvl(sum(l.tz),0) tz,nvl(sum(lx.lc),0) lc,nvl(sum(lx.bzcs),0) bzcs from cbsj_lmgz_tz c left join lxsh_lmgz l on c.xmbm=l.xmbm
		left join (select xmid,lc,xjsdj,jsjsdj,lxbm,bzcs from lxsh_lx_tz where jdbs='2' ) lx on c.xmbm=lx.xmid left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
		where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
		</if>
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where ${cbsj.ylxbh} and xmid like '%1___')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			${cbsj.tsdq}
		</if>
		<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
		<if test="cbsj.tzxz !=null and cbsj.tzxz !=''">and c.tzxz like '%'||#{cbsj.tzxz}||'%'</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
	</select>
	
	<select id="loadxjcbsjTjxx" parameterType="java.util.Map" resultType="lxsh">
		select count(*) sl,round(nvl(sum(c.tz),0),3) tz,round(nvl(sum(lx.lc),0),3) lc,round(nvl(sum(lx.bzcs),0),3) bzcs,'0' sbz,'0' sjl,round(nvl((sum(c.tz)-sum(bzys)),0),3) dftz 
		from cbsj_xj c left join lxsh_xj l on c.xmbm=l.xmbm left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
		left join (select xmid, sum(nvl(yilc,0))+sum(nvl(erlc,0))+sum(nvl(sanlc,0))+sum(nvl(silc,0))+sum(nvl(dwlc,0))+sum(nvl(wllc,0)) lc, min(xjsdj) xjsdj, min(jsjsdj) jsjsdj, min(lxbm) lxbm, min(bzcs) bzcs 
		from lxsh_lx where jdbs = '2' group by xmid ) lx on c.xmbm=lx.xmid
		where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%1___')
		</if>
		<if test="cbsj.xmklx!='' and cbsj.xmklx!= null ">
					and xmklx like '%'||#{cbsj.xmklx}||'%'
				</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmnf!=null and cbsj.xmnf!=''">and ${cbsj.xmnf}</if>
		<if test="cbsj.sbzt!=null and cbsj.sbzt!=''">and c.sbzt=#{cbsj.sbzt}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			${cbsj.tsdq}
		</if>
		<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
		<if test="cbsj.xmbm !=null and cbsj.xmbm !=''">and c.xmbm like '%'||#{cbsj.xmbm}||'%'</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbh})
		</if>
		<if test="cbsj.ghlxbm!=null and cbsj.ghlxbm!=''">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbm})
			)
		</if>
				<if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{cbsj.ghlxmc}||'%')

					)
				</if>
				<if test="cbsj.lsxmnf !='' and cbsj.lsxmnf != null ">
				${cbsj.lsxmnf}
			</if>
			<if test="cbsj.lsxmlx !='' and cbsj.lsxmlx != null ">
				${cbsj.lsxmlx}
			</if>
	</select>
	<select id="loadxjcbsjbgTjxx" parameterType="java.util.Map" resultType="lxsh">
		select count(*) sl,nvl(sum(l.tz),0) tz,nvl(sum(lx.lc),0) lc,nvl(sum(lx.bzcs),0) bzcs from cbsj_xj_tz c left join lxsh_xj l on c.xmbm=l.xmbm
		left join (select xmid, min(jhlc) lc, min(xjsdj) xjsdj, min(jsjsdj) jsjsdj, min(lxbm) lxbm, min(bzcs) bzcs from lxsh_lx_tz where jdbs = '1' group by xmid ) lx on c.xmbm=lx.xmid left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
		where 1=1
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where lx.lxbm like '%'||#{cbsj.ghlxbh}||'%')
		</if>
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx_tz lx where ${cbsj.ylxbh} and xmid like '%1___')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmbm!=null and cbsj.xmbm!=''">and ${cbsj.xmbm}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			${cbsj.tsdq}
		</if>
		<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
		<if test="cbsj.tzxz !=null and cbsj.tzxz !=''">and c.tzxz like '%'||#{cbsj.tzxz}||'%'</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
	</select>
	<select id="selectSjsgt" parameterType="cbsj" resultType="cbsj">
 		select * from SGT_SJGZ where xmbm=#{xmbm}
 	</select>
 	<insert id="insertsjsgt" parameterType="cbsj">
 		insert into SGT_SJGZ(xmbm) values(#{xmbm})
 	</insert>
 	<select id="selectXjsgt" parameterType="cbsj" resultType="cbsj">
 		select * from SGT_XJ where xmbm=#{xmbm}
 	</select>
 	<select id="selectLmsgt" parameterType="cbsj" resultType="cbsj">
 		select * from SGT_LMGZ where xmbm=#{xmbm}
 	</select>
 	<insert id="insertxjsgt" parameterType="cbsj">
 		insert into SGT_XJ(xmbm) values(#{xmbm})
 	</insert>
 	<insert id="insertlmsgt" parameterType="cbsj">
 		insert into SGT_LMGZ(xmbm) values(#{xmbm})
 	</insert>
 	<update id="updatesjsgt" parameterType="cbsj">
		update sgt_sjgz c set c.xmmc=#{xmmc},c.xzqh=#{xzqh},
		c.jsxz=#{jsxz},c.qdzh=#{qdzh},c.zdzh=#{zdzh},
		<if test="dfzc!=null">c.dfzc=#{dfzc},</if>
		<if test="yhdk!=null">c.yhdk=#{yhdk},</if>
		<if test="jsjsdj!=null">c.jsjsdj=#{jsjsdj},</if>
		<if test="jsdw!=null">c.jsdw=#{jsdw},</if>
		<if test="lj!=null">c.lj=#{lj},</if> 
		<if test="ql!=null">c.ql=#{ql},</if>
		<if test="ql_ym!=null">c.ql_ym=#{ql_ym},</if>
		<if test="hd!=null">c.hd=#{hd},</if>
		<if test="hd_m!=null">c.hd_m=#{hd_m},</if>
		<if test="mc!=null">c.mc=#{mc},</if>
		<if test="mc_lc!=null">c.mc_lc=#{mc_lc},</if>
		<if test="jc!=null">c.jc=#{jc},</if>
		<if test="jc_lc!=null">c.jc_lc=#{jc_lc},</if>
		<if test="dc!=null">c.dc=#{dc},</if>
		<if test="dc_lc!=null">c.dc_lc=#{dc_lc},</if>
		<if test="sd!=null">c.sd=#{sd},</if>
		<if test="sd_ym!=null">c.sd_ym=#{sd_ym},</if>
		<if test="dq!=null">c.dq=#{dq},</if>
		<if test="dq_cd!=null">c.dq_cd=#{dq_cd},</if>
		<if test="dq_dk!=null">c.dq_dk=#{dq_dk},</if>
		<if test="sdmc!=null">c.sdmc=#{sdmc},</if>
		<if test="sd_sfcd!=null">c.sd_sfcd=#{sd_sfcd},</if>
		<if test="sd_lx!=null">c.sd_lx=#{sd_lx},</if>
		<if test="jaf!=null">c.jaf=#{jaf},</if>
		<if test="kgsj!=null">c.kgsj=#{kgsj},</if>
		<if test="wgsj!=null">c.wgsj=#{wgsj},</if>
		<if test="gq!=null">c.gq=#{gq},</if>
		<if test="sjdw!=null">c.sjdw=#{sjdw},</if>
		<if test="sjpfwh!=null">c.sjpfwh=#{sjpfwh},</if>
		<if test="pfsj!=null">c.pfsj=#{pfsj},</if>
		<if test="jszlc!=null">c.jszlc=#{jszlc},</if>
		<if test="yilc != null">c.yilc=#{yilc},</if>
		<if test="erlc != null">c.erlc=#{erlc},</if>
		<if test="sanlc != null">c.sanlc=#{sanlc},</if>
		<if test="silc != null">c.silc=#{silc},</if>
		<if test="dwlc != null">c.dwlc=#{dwlc},</if>
		<if test="wllc != null">c.wllc=#{wllc},</if>
		<if test="jhyilc != null">c.jhyilc=#{jhyilc},</if>
		<if test="jherlc != null">c.jherlc=#{jherlc},</if>
		<if test="jhsanlc != null">c.jhsanlc=#{jhsanlc},</if>
		<if test="jhsilc != null">c.jhsilc=#{jhsilc},</if>
		<if test="jhdwlc != null">c.jhdwlc=#{jhdwlc},</if>
		<if test="jhwllc != null">c.jhwllc=#{jhwllc},</if>
		<if test="lc != null">c.lc=#{lc},</if>
		<if test="gys != null">c.gys=#{gys},</if>
		sfbj=#{sfbj}
		where c.xmbm=#{xmbm}
	</update>
	<update id="updatelmsgt" parameterType="cbsj">
		update sgt_lmgz c set c.xmmc=#{xmmc},c.xzqh=#{xzqh},
		c.jsxz=#{jsxz},c.qdzh=#{qdzh},c.zdzh=#{zdzh},
		<if test="dfzc!=null">c.dfzc=#{dfzc},</if>
		<if test="yhdk!=null">c.yhdk=#{yhdk},</if>
		<if test="jsjsdj!=null">c.jsjsdj=#{jsjsdj},</if>
		<if test="jsdw!=null">c.jsdw=#{jsdw},</if>
		<if test="lj!=null">c.lj=#{lj},</if> 
		<if test="ql!=null">c.ql=#{ql},</if>
		<if test="ql_ym!=null">c.ql_ym=#{ql_ym},</if>
		<if test="hd!=null">c.hd=#{hd},</if>
		<if test="hd_m!=null">c.hd_m=#{hd_m},</if>
		<if test="mc!=null">c.mc=#{mc},</if>
		<if test="mc_lc!=null">c.mc_lc=#{mc_lc},</if>
		<if test="jc!=null">c.jc=#{jc},</if>
		<if test="jc_lc!=null">c.jc_lc=#{jc_lc},</if>
		<if test="dc!=null">c.dc=#{dc},</if>
		<if test="dc_lc!=null">c.dc_lc=#{dc_lc},</if>
		<if test="sd!=null">c.sd=#{sd},</if>
		<if test="sd_ym!=null">c.sd_ym=#{sd_ym},</if>
		<if test="dq!=null">c.dq=#{dq},</if>
		<if test="dq_cd!=null">c.dq_cd=#{dq_cd},</if>
		<if test="dq_dk!=null">c.dq_dk=#{dq_dk},</if>
		<if test="sdmc!=null">c.sdmc=#{sdmc},</if>
		<if test="sd_sfcd!=null">c.sd_sfcd=#{sd_sfcd},</if>
		<if test="sd_lx!=null">c.sd_lx=#{sd_lx},</if>
		<if test="jaf!=null">c.jaf=#{jaf},</if>
		<if test="kgsj!=null">c.kgsj=#{kgsj},</if>
		<if test="wgsj!=null">c.wgsj=#{wgsj},</if>
		<if test="gq!=null">c.gq=#{gq},</if>
		<if test="sjdw!=null">c.sjdw=#{sjdw},</if>
		<if test="sjpfwh!=null">c.sjpfwh=#{sjpfwh},</if>
		<if test="pfsj!=null">c.pfsj=#{pfsj},</if>
		<if test="jszlc!=null">c.jszlc=#{jszlc},</if>
		<if test="yilc != null">c.yilc=#{yilc},</if>
		<if test="erlc != null">c.erlc=#{erlc},</if>
		<if test="sanlc != null">c.sanlc=#{sanlc},</if>
		<if test="silc != null">c.silc=#{silc},</if>
		<if test="dwlc != null">c.dwlc=#{dwlc},</if>
		<if test="wllc != null">c.wllc=#{wllc},</if>
		<if test="jhyilc != null">c.jhyilc=#{jhyilc},</if>
		<if test="jherlc != null">c.jherlc=#{jherlc},</if>
		<if test="jhsanlc != null">c.jhsanlc=#{jhsanlc},</if>
		<if test="jhsilc != null">c.jhsilc=#{jhsilc},</if>
		<if test="jhdwlc != null">c.jhdwlc=#{jhdwlc},</if>
		<if test="jhwllc != null">c.jhwllc=#{jhwllc},</if>
		<if test="lc != null">c.lc=#{lc},</if>
		<if test="gys != null">c.gys=#{gys},</if>
		sfbj=#{sfbj}
		where c.xmbm=#{xmbm}
	</update>
	<update id="updatexjsgt" parameterType="cbsj">
		update sgt_xj c set c.xmmc=#{xmmc},c.xzqh=#{xzqh},
		c.qdzh=#{qdzh},c.zdzh=#{zdzh},
		<if test="dfzc!=null">c.dfzc=#{dfzc},</if>
		<if test="yhdk!=null">c.yhdk=#{yhdk},</if>
		<if test="jsdw!=null">c.jsdw=#{jsdw},</if>
		<if test="jsjsdj!=null">c.jsjsdj=#{jsjsdj},</if>
		<if test="jsxz!=null">c.jsxz=#{jsxz},</if>
		<if test="lj!=null">c.lj=#{lj},</if> 
		<if test="ql!=null">c.ql=#{ql},</if>
		<if test="ql_ym!=null">c.ql_ym=#{ql_ym},</if>
		<if test="hd!=null">c.hd=#{hd},</if>
		<if test="hd_m!=null">c.hd_m=#{hd_m},</if>
		<if test="mc!=null">c.mc=#{mc},</if>
		<if test="mc_lc!=null">c.mc_lc=#{mc_lc},</if>
		<if test="jc!=null">c.jc=#{jc},</if>
		<if test="jc_lc!=null">c.jc_lc=#{jc_lc},</if>
		<if test="dc!=null">c.dc=#{dc},</if>
		<if test="dc_lc!=null">c.dc_lc=#{dc_lc},</if>
		<if test="sd!=null">c.sd=#{sd},</if>
		<if test="sd_ym!=null">c.sd_ym=#{sd_ym},</if>
		<if test="dq!=null">c.dq=#{dq},</if>
		<if test="dq_cd!=null">c.dq_cd=#{dq_cd},</if>
		<if test="dq_dk!=null">c.dq_dk=#{dq_dk},</if>
		<if test="sdmc!=null">c.sdmc=#{sdmc},</if>
		<if test="sd_sfcd!=null">c.sd_sfcd=#{sd_sfcd},</if>
		<if test="sd_lx!=null">c.sd_lx=#{sd_lx},</if>
		<if test="jaf!=null">c.jaf=#{jaf},</if>
		<if test="kgsj!=null">c.kgsj=#{kgsj},</if>
		<if test="wgsj!=null">c.wgsj=#{wgsj},</if>
		<if test="gq!=null">c.gq=#{gq},</if>
		<if test="sjdw!=null">c.sjdw=#{sjdw},</if>
		<if test="sjpfwh!=null">c.sjpfwh=#{sjpfwh},</if>
		<if test="pfsj!=null">c.pfsj=#{pfsj},</if>
		<if test="yilc != null">c.yilc=#{yilc},</if>
		<if test="erlc != null">c.erlc=#{erlc},</if>
		<if test="sanlc != null">c.sanlc=#{sanlc},</if>
		<if test="silc != null">c.silc=#{silc},</if>
		<if test="dwlc != null">c.dwlc=#{dwlc},</if>
		<if test="wllc != null">c.wllc=#{wllc},</if>
		<if test="xjlxbm != null">c.xjlxbm=#{xjlxbm},</if>
		<if test="xjqdzh != null">c.xjqdzh=#{xjqdzh},</if>
		<if test="xjzdzh != null">c.xjzdzh=#{xjzdzh},</if>
		<if test="xjlc != null">c.xjlc=#{xjlc},</if>
		<if test="lc != null">c.lc=#{lc},</if>
		<if test="gys != null">c.gys=#{gys},</if>
		sfbj=#{sfbj}
		where c.xmbm=#{xmbm}
	</update>
	
	
	<select id="queryCbsjgsd" parameterType="java.util.Map" resultType="cbsj">
		select * from (
			select rownum num,t.* from (
				select c.id, c.xmmc, c.xmbm, c.jsdw, c.xzqh, c.jsxz, c.lj, c.ql, c.hd, c.mc, c.jc, c.dc, c.sd, c.dq, c.sdmc,k.kgny kgsj,k.wgny wgsj, c.gq, c.sjdw, c.sjpfwh, c.pfsj, c.jaf,l.gydw,l.tz,l.tsdq,k.gkpfwh, 
		        c.shzt, c.sbzt, ql_ym, hd_m, sd_ym, dq_cd, dq_dk, sd_sfcd, sd_lx, sfbj, mc_lc, jc_lc, dc_lc, c.dfzc, c.yhdk,l.ghlxbh,l.lsjl,
		        lx.qdzh,lx.zdzh,lx.jsjsdj,lx.lc,sl.xmsl,decode(substr(c.xmbm,11,1),'3',lx.xjlxbm,lx.ghlxbm) ghlxbm,lx.ghlxmc,decode(substr(c.xmbm,11,1),'3',lx.xjqdzh,lx.ghqdzh) ghqdzh,decode(substr(c.xmbm,11,1),'3',lx.xjzdzh,lx.ghzdzh) ghzdzh,sl.zlc
		        from cbgsdgz c left join lxgsdgz l on c.xmbm=l.xmbm left join kxgsdgz k on c.xmbm=k.xmbm left join lxsh_lx lx on c.xmbm=lx.xmid left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
		        left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on c.xmbm=sl.xmid
		        where lx.jdbs='2' and lx.sffirst='1'
		       
<!-- 				<if test="cbsj.ghlxbm!='' and cbsj.ghlxbm!= null "> -->
<!-- 					and lx.ghlxbm=#{cbsj.ghlxbm} -->
<!-- 				</if> -->
				<if test="cbsj.lxmc!='' and cbsj.lxmc!= null ">
					and lx.lxmc=#{cbsj.lxmc}
				</if>
				<if test="cbsj.xmklx!='' and cbsj.xmklx!= null ">
					and xmklx like '%'||#{cbsj.xmklx}||'%'
				</if>
				<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
				
				<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%1___')
				</if>
				<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
				<if test="cbsj.lsjl!=null and cbsj.lsjl!=''">and l.lsjl=#{cbsj.lsjl}</if>
				<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
					${cbsj.tsdq}
				</if>
				<if test="cbsj.xmnf!=null and cbsj.xmnf!=''">and ${cbsj.xmnf}</if>
				<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
				<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
				<if test="cbsj.xmbm !=null and cbsj.xmbm !=''">and c.xmbm like '%'||#{cbsj.xmbm}||'%'</if>
				<!-- <if test="cbsj.sbzt>=0">
					and c.sbzt=${cbsj.sbzt}
				</if> -->
				<if test="cbsj.xmlx1 !=null and cbsj.xmlx1 !=''"> ${cbsj.xmlx1}</if>
				<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
				<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbh})
		</if>
		<if test="cbsj.ghlxbm!=null and cbsj.ghlxbm!=''">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbm})
			)
		</if>
				<if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{cbsj.ghlxmc}||'%')

					)
				</if>
				<if test="cbsj.lsxmnf !='' and cbsj.lsxmnf != null ">
				${cbsj.lsxmnf}
			</if>
			<if test="cbsj.lsxmlx !='' and cbsj.lsxmlx != null ">
				${cbsj.lsxmlx}
			</if>
				order by c.shzt,c.xmbm desc) t 
		) where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
	</select>
	<select id="queryCbsjgsdCount" parameterType="java.util.Map" resultType="int">
		select count(c.id) from cbgsdgz c left join lxgsdgz l on c.xmbm=l.xmbm
		left join lxsh_lx lx
		     on c.xmbm = lx.xmid  left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
		left join (select xmid, count(xmid) xmsl
		                              from lxsh_lx
		                             where jdbs = '2'
		                             group by xmid) sl
		                              on c.xmbm = sl.xmid
		where 1 = 1 and lx.jdbs = '2'
                   and lx.sffirst = '1'
       
		<if test="cbsj.lxmc!='' and cbsj.lxmc!= null ">
			and lx.lxmc=#{cbsj.lxmc}
		</if>
		<if test="cbsj.xmklx!='' and cbsj.xmklx!= null ">
					and xmklx like '%'||#{cbsj.xmklx}||'%'
				</if>
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%1___')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmnf!=null and cbsj.xmnf!=''">and ${cbsj.xmnf}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			${cbsj.tsdq}
		</if>
		<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
		<if test="cbsj.xmbm !=null and cbsj.xmbm !=''">and c.xmbm like '%'||#{cbsj.xmbm}||'%'</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.xmlx1 !=null and cbsj.xmlx1 !=''"> ${cbsj.xmlx1}</if>
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbh})
		</if>
		<if test="cbsj.ghlxbm!=null and cbsj.ghlxbm!=''">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbm})
			)
		</if>
		<if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{cbsj.ghlxmc}||'%')

			)
		</if>
		<if test="cbsj.lsxmnf !='' and cbsj.lsxmnf != null ">
			${cbsj.lsxmnf}
		</if>
		<if test="cbsj.lsxmlx !='' and cbsj.lsxmlx != null ">
			${cbsj.lsxmlx}
		</if>
	</select>
	<select id="loadgsdcbsjTjxx" parameterType="java.util.Map" resultType="lxsh">
		select count(*) sl,round(nvl(sum(c.tz),0),3) tz,round(nvl(sum(lx.lc),0),3) lc,round(nvl(sum(l.bzys),0),3) bzcs,'0' sbz,'0' sjl,round(nvl((sum(c.tz)-sum(bzys)),0),3) dftz from cbgsdgz c left join lxgsdgz l on c.xmbm=l.xmbm left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
		left join (select xmid,sum(lc) lc,min(xjsdj) xjsdj,min(jsjsdj) jsjsdj,min(lxbm) lxbm,sum(bzcs) bzcs from (select  xmid,jsxz,xjsdj,jsjsdj,lxbm,bzcs,
		(case when jsxz like '%改建%' then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)
		when jsxz like '%新建%' then to_number(xjlc)
		else to_number(lc)
<!-- 		nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)  -->
		end) lc
	   from lxsh_lx where jdbs='2'
	   
		
		<if test="cbsj.lxmc!='' and cbsj.lxmc!= null ">
			and lxmc=#{cbsj.lxmc}
		</if>) group by xmid) lx on c.xmbm=lx.xmid
		where 1=1
		<if test="cbsj.xmklx!='' and cbsj.xmklx!= null ">
					and xmklx like '%'||#{cbsj.xmklx}||'%'
				</if>
		<if test="cbsj.xzqhdm!=null and cbsj.xzqhdm!=''">and ${cbsj.xzqhdm}</if>
		
		<if test="cbsj.ylxbh!=null and cbsj.ylxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where ${cbsj.ylxbh} and xmid like '%1___')
		</if>
		<if test="cbsj.xjsdj!=null and cbsj.xjsdj!=''">and ${cbsj.xjsdj}</if>
		<if test="cbsj.xmnf!=null and cbsj.xmnf!=''">and ${cbsj.xmnf}</if>
		<if test="cbsj.jsjsdj!=null and cbsj.jsjsdj!=''">and ${cbsj.jsjsdj}</if>
		<if test="cbsj.tsdq!=null and cbsj.tsdq!=''">
			${cbsj.tsdq}
		</if>
		<if test="cbsj.xmmc !=null and cbsj.xmmc !=''">and c.xmmc like '%'||#{cbsj.xmmc}||'%'</if>
		<if test="cbsj.xmbm !=null and cbsj.xmbm !=''">and c.xmbm like '%'||#{cbsj.xmbm}||'%'</if>
		<!-- <if test="cbsj.sbzt>=0">
			and c.sbzt=${cbsj.sbzt}
		</if> -->
		<if test="cbsj.xmlx1 !=null and cbsj.xmlx1 !=''"> ${cbsj.xmlx1}</if>
		<if test="cbsj.shzt>=0">and c.shzt=${cbsj.shzt}</if>
		<if test="cbsj.ghlxbh!=null and cbsj.ghlxbh!=''">
			and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbh})
		</if>
		<if test="cbsj.ghlxbm!=null and cbsj.ghlxbm!=''">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${cbsj.ghlxbm})
			)
		</if>
		<if test="cbsj.ghlxmc!='' and cbsj.ghlxmc!= null ">
			and (c.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{cbsj.ghlxmc}||'%')

			)
		</if>
		<if test="cbsj.lsxmnf !='' and cbsj.lsxmnf != null ">
			${cbsj.lsxmnf}
		</if>
		<if test="cbsj.lsxmlx !='' and cbsj.lsxmlx != null ">
			${cbsj.lsxmlx}
		</if>
	</select>
	
	<select id="querygsdExcel" parameterType="cbsj" resultType="elist">
		<!-- select * from (
			select rownum num,t.* from (
				select decode(lx.sffirst,'1',c.xmbm,'') xmbm,decode(lx.sffirst,'1',c.xmmc,'') xmmc,c.xzqh,c.jsdw,c.jsjsdj,c.jsxz,c.lj,c.ql,c.ql_ym,c.hd,c.hd_m,c.sd,c.sd_ym,
				c.mc,c.mc_lc,c.jc,c.jc_lc,c.dc,c.dc_lc,c.dq,c.dq_cd,c.dq_dk,c.sdmc,c.sd_lx,c.sd_sfcd,
				c.kgsj,c.wgsj,c.gq,decode(lx.sffirst,'1',c.sjdw,'') sjdw,decode(lx.sffirst,'1',c.sjpfwh,'') sjpfwh,decode(lx.sffirst,'1',c.pfsj,'') pfsj,decode(lx.sffirst,'1',c.jaf,'') jaf,decode(lx.sffirst,'1',c.dfzc,'') dfzc,decode(lx.sffirst,'1',c.yhdk,'') yhdk,lx.* from cbgsdgz c left join lxgsdgz l on c.xmbm = l.xmbm
				right join (select xmid, lxbm ylxbh,lxmc lxmc,qdzh qdzh,zdzh zdzh,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,lc lc,yilc,erlc,sanlc,silc,dwlc,wllc,sffirst from lxsh_lx where jdbs='2' ) lx
				on c.xmbm = lx.xmid 
				left join (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2 from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
				where 1=1 -->
			select rownum v_0,c.xmmc v_1,c.xmbm v_2,c.xzqh v_3,c.jsdw v_4,RemoveSameStr(lx.jsjsdjtj,',') v_5,lx.jsxz v_6,
    decode(instr(RemoveSameStr(lx.ylxbm,','),','),0,RemoveSameStr(lx.ylxbm,','),lx.ylxbm) v_7,
    decode(instr(RemoveSameStr(lx.ylxmc,','),','),0,RemoveSameStr(lx.ylxmc,','),lx.ylxmc) v_8,
    lx.qdzh v_9,lx.zdzh v_10,
    decode(instr(RemoveSameStr(lx.ghlxbm,','),','),0,RemoveSameStr(lx.ghlxbm,','),lx.ghlxbm)  v_11,
    decode(instr(RemoveSameStr(lx.ghlxmc,','),','),0,RemoveSameStr(lx.ghlxmc,','),lx.ghlxmc) v_12,
    lx.ghqdzh v_13,lx.ghzdzh v_14,
    decode(instr(RemoveSameStr(lx.gxlxbm,','),','),0,RemoveSameStr(lx.gxlxbm,','),lx.gxlxbm) v_15,
    lx.gxqdzh v_16,lx.gxzdzh v_17,
    to_char(lx.lc,'fm9999999990.000') v_18, to_char(lx.yilc,'fm9999999990.000') v_19, to_char(lx.erlc,'fm9999999990.000') v_20, 
    to_char(lx.sanlc,'fm9999999990.000') v_21, to_char(lx.silc,'fm9999999990.000') v_22, to_char(lx.dwlc,'fm9999999990.000') v_23, 
    to_char(lx.wllc,'fm9999999990.000') v_24,
    to_char(lx.jhyilc,'fm9999999990.000') v_25, to_char(lx.jherlc,'fm9999999990.000') v_26, 
    to_char(lx.jhsanlc,'fm9999999990.000') v_27, to_char(lx.jhsilc,'fm9999999990.000') v_28, to_char(lx.jhdwlc,'fm9999999990.000') v_29, 
    to_char(lx.jhwllc,'fm9999999990.000') v_30,
    c.lj v_31,c.ql v_32,c.ql_ym v_33,c.hd v_34,c.hd_m v_35,c.sd v_36,c.sd_ym v_37,c.mc v_38,c.mc_lc v_39,c.jc v_40,c.jc_lc v_41,c.dc v_42,c.dc_lc v_43,
    c.dq v_44,c.dq_cd v_45,c.dq_dk v_46,c.sdmc v_47,c.sd_sfcd v_48,c.sd_lx v_49,c.kgsj v_50,c.wgsj v_51,c.gq v_52,c.sjdw v_53,
    c.sjpfwh v_54,c.pfsj v_55,nvl(c.jaf,0) v_56,nvl(c.dfzc,0) v_57,nvl(c.yhdk,0) v_58
    from cbgsdgz c 
    Left join (select xmbm xmbh,lsjl,xmklx,tsdq,lsxmbm,xzqh,xzqhdm2 from lxgsdgz) t1 on c.xmbm=t1.xmbh
    left join 
        (select xmid,WMSYS.WM_CONCAT(distinct to_char(decode(xzqhdm2,null,xzqhdm,xzqhdm2))) xzqhdm2
         from lxsh_lx group by xmid) myxz on c.xmbm=myxz.xmid
    left join (
    select xmid,sum(jhlc) zjhlc,sum(sbzj) sbzj,sum(bzcs) bzcs,
              replace(WMSYS.WM_CONCAT(distinct(lxlmkd)),',',',') lxlmkd,replace(WMSYS.WM_CONCAT(distinct(jsxz)),',',',') jsxz,
              replace(WMSYS.WM_CONCAT(distinct(gydw)),',',',') gydw,replace(WMSYS.WM_CONCAT(distinct(xzqh)),',',',') xzqh,
              replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
              replace(WMSYS.WM_CONCAT(jsjsdj),'、',',') jsjsdjtj,
              replace(WMSYS.WM_CONCAT(xjsdj),'、',',') xjsdjtj,
              replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,
             replace(max(qdzh), ',.', ',0.') qdzh,replace(max(zdzh), ',.', ',0.') zdzh,replace(max(ghqdzh), ',.', ',0.') ghqdzh,replace(max(ghzdzh), ',.', ',0.') ghzdzh,
             replace(max(gxqdzh), ',.', ',0.') gxqdzh,replace(max(gxzdzh), ',.', ',0.') gxzdzh,
             max(ghlxbm) ghlxbm,max(ylxbm) ylxbm,max(ghlxmc) ghlxmc,max(ylxmc) ylxmc,max(gxlxbm) gxlxbm,max(qdmc) qdmc,max(zdmc) zdmc,
             sum(nvl(jhyilc,0)) jhyilc,sum(nvl(yilc,0)) yilc,sum(nvl(jherlc,0)) jherlc,sum(nvl(erlc,0)) erlc,
             sum(nvl(jhsanlc,0)) jhsanlc,sum(nvl(sanlc,0)) sanlc,sum(nvl(jhsilc,0)) jhsilc,sum(nvl(silc,0)) silc,
             sum(nvl(jhdwlc,0)) jhdwlc,sum(nvl(dwlc,0)) dwlc,sum(nvl(jhwllc,0)) jhwllc,sum(nvl(wllc,0)) wllc,sum(nvl(lc,0)) lc
              from (select  xmid,jsxz,sbzj,lxlmkd,gydw,xzqh,bzcs,
              (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)) 
              else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
              end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
              else ''
              end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,yilc,erlc,sanlc,silc,dwlc,wllc,lc,
               WMSYS.WM_CONCAT(ghlxmc)over( PARTITION BY xmid ORDER BY id,ghlxmc) ghlxmc,
               WMSYS.WM_CONCAT(lxmc)over( PARTITION BY xmid ORDER BY id,lxmc) ylxmc,
               WMSYS.WM_CONCAT(ghlxbm)over( PARTITION BY xmid ORDER BY id,ghlxbm) ghlxbm,
               WMSYS.WM_CONCAT(lxbm)over( PARTITION BY xmid ORDER BY id,lxbm) ylxbm,
               WMSYS.WM_CONCAT((case when qdzh like '.%' then 0||qdzh when qdzh like '%,.%' then replace(qdzh, ',.', ',0.') else qdzh end ))over( PARTITION BY xmid ORDER BY id,qdzh) qdzh,
               WMSYS.WM_CONCAT((case when zdzh like '.%' then 0||zdzh when zdzh like '%,.%' then replace(zdzh, ',.', ',0.') else zdzh end ))over( PARTITION BY xmid ORDER BY id,zdzh) zdzh,
               WMSYS.WM_CONCAT((case when ghqdzh like '.%' then 0||ghqdzh when ghqdzh like '%,.%' then replace(ghqdzh, ',.', ',0.') else ghqdzh end ))over( PARTITION BY xmid ORDER BY id,ghqdzh) ghqdzh,
               WMSYS.WM_CONCAT((case when ghzdzh like '.%' then 0||ghzdzh when ghzdzh like '%,.%' then replace(ghzdzh, ',.', ',0.') else ghzdzh end ))over( PARTITION BY xmid ORDER BY id,ghzdzh) ghzdzh,
               WMSYS.WM_CONCAT(gxlxbm)over( PARTITION BY xmid ORDER BY id,gxlxbm) gxlxbm,
               WMSYS.WM_CONCAT((case when gxqdzh like '.%' then 0||gxqdzh when gxqdzh like '%,.%' then replace(gxqdzh, ',.', ',0.') else gxqdzh end ))over( PARTITION BY xmid ORDER BY id,gxqdzh) gxqdzh,
               WMSYS.WM_CONCAT((case when gxzdzh like '.%' then 0||gxzdzh when gxzdzh like '%,.%' then replace(gxzdzh, ',.', ',0.') else gxzdzh end ))over( PARTITION BY xmid ORDER BY id,gxzdzh) gxzdzh,
               WMSYS.WM_CONCAT(qdmc)over( PARTITION BY xmid ORDER BY id,qdmc) qdmc,
               WMSYS.WM_CONCAT(zdmc)over( PARTITION BY xmid ORDER BY id,zdmc) zdmc
              from LXSH_LX lx where jdbs='1') group by xmid
    ) lx on c.xmbm=lx.xmid
    where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">
					and ${xzqhdm}
				</if>
				<if test="ylxbh!=null and ylxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%1___')
				</if>
				<if test="xjsdj!=null and xjsdj!=''">and ${xjsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{lsjl}</if>
				<if test="tsdq!=null and tsdq!=''">${tsdq}</if>
				<if test="xmnf!=null and xmnf!=''">and ${xmnf}</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
                <if test="xmbm!=null and xmbm!=''">and c.xmbm like '%'||#{xmbm}||'%'</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="shzt>=0">and c.shzt=${shzt}</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
				<if test="lxmc!=null and lxmc!=''">and lx.lxmc like '%'||#{lxmc}||'%'</if>
				<if test="ghlxmc!=null and ghlxmc!=''">and lx.ghlxmc like '%'||#{ghlxmc}||'%'</if>
<!-- 				<if test="sbzt!=null and sbzt!=''">and c.sbzt=#{sbzt}</if> -->
				<if test="lsxmnf !='' and lsxmnf != null ">
					${lsxmnf}
				</if>
				<if test="lsxmlx !='' and lsxmlx != null ">
					${lsxmlx}
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghlxbm!=null and ghlxbm!=''">
					and (c.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
					)
				</if>
	</select>
	<update id="shangbaoCbsj" parameterType="cbsj">
	update ${bz} set sbzt='1',sbthcd=#{sbthcd} where xmbm in (${xmbm})
	</update>
	<update id="thCbsjByXmbm" parameterType="lxsh">
	update ${bz} set thyy=#{thyy},sbzt=#{sbzt},sbthcd=#{sbthcd} where xmbm in (${xmbm})
	</update>
	
	<select id="sfkythcbsjwsh" parameterType="lxsh" resultType="lxsh">
		select * from ${bzcs} where xmbm in (${xmbm}) and xdzt = 1
	</select>
	<update id="thwshcbsj" parameterType="lxsh">
		update ${bz} set shzt='0' where xmbm in (${xmbm})
	</update>
	<delete id="thwshkxxcbsj" parameterType="lxsh">
		delete from ${bzcs} where xmbm in (${xmbm}) 
	</delete>
	
</mapper>
