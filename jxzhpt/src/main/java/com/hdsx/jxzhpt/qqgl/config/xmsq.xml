<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.xmsq">
	<select id="queryAutoghList" parameterType="xmsq" resultType="lx">
		select distinct substr(ylxbm,0,4) ylxbm,to_char(yqdzh,'FM9999990.000') yqdzh,to_char(yzdzh,'FM9999990.000') yzdzh,substr(xlxbm,0,4) xlxbm,to_char(xqdzh,'FM9999990.000') xqdzh,to_char(xzdzh,'FM9999990.000') xzdzh,xlxmc xlxmc,ylxmc lxmc,cfld,cfqd,cfzd,lmkd,lmlx,xzqh from ghlx where xlxbm like #{ylxbh}||'%'||#{xzqhdm}||'%'
		order by to_number(xqdzh)
	</select>
	<select id="querySjgzNextXmbm" resultType="string">
		select NVL(max(substr(c.xmbm,11)),1000)+1 from lxsh_sjgz c where c.xmbm like #{xmnf}||#{xzqhdm}||'%'
	</select>
	<select id="queryLmgzNextXmbm" resultType="string">
		select NVL(max(substr(c.xmbm,11)),2000)+1 from lxsh_lmgz c where c.xmbm like #{xmnf}||#{xzqhdm}||'%'
	</select>
	<select id="queryXjNextXmbm" resultType="string">
		select NVL(max(substr(c.xmbm,11)),3000)+1 from lxsh_xj c where c.xmbm like #{xmnf}||#{xzqhdm}||'%'
	</select>
	
	<select id="queryYhdzxNextXmbm" resultType="string">
		select NVL(max(substr(c.xmbm,11)),4000)+1 from xmsq_yhdzx c where c.xmbm like #{xmnf}||#{xzqhdm}||'%'
	</select>
	<select id="queryShNextXmbm" resultType="string">
		select NVL(max(substr(c.xmbm,11)),5000)+1 from xmsq_sh c where c.xmbm like #{xmnf}||#{xzqhdm}||'%'
	</select>
	
	<select id="queryAutoList" parameterType="xmsq" resultType="lx">
		<!-- select x.lxbm,x.lxmc,x.qdzh,x.zdzh,x.qzlc lc,x.qdmc,x.zdmc,x.yjsdj xjsdj,x.ylmlx,x.ylmkd lmkd from (
		select * from table(funlmkd(#{ylxbh},#{xzqhdm})) order by lxbm,qdzh) x
		 -->
		select distinct substr(ylxbm,0,4) lxbm,yqdzh qdzh,yzdzh zdzh,substr(xlxbm,0,4) xlxbm,xqdzh,xzdzh,xlxmc,ylxmc lxmc,cfld from ghlx where ylxbm like #{ylxbh}||'%'||#{xzqhdm}||'%'
		order by to_number(yqdzh)
	</select>
	
	<select id="queryAutoList1" parameterType="xmsq" resultType="lx">
	
		select replace(WMSYS.WM_CONCAT(ylmlx),',','、') ylmlx from(
			select x.lxbm,x.lxmc,x.qdzh,x.zdzh,x.qzlc lc,x.qdmc,x.zdmc,x.yjsdj xjsdj,x.ylmlx from (
			select * from table(funlmkd(#{ylxbh},#{xzqhdm})) order by lxbm,qdzh) x
		) where to_number(qdzh)&lt;=to_number(#{qdzh}) and to_number(zdzh)>=to_number(#{zdzh})
		
	</select>
	<select id="queryLsjl" parameterType="java.util.Map" resultType="int">
		<![CDATA[
		select c1_x.CON1+c1_y.CON2 + c2_x.CON1+c2_y.CON2 + c3_x.CON1+c3_y.CON2 + c4_x.CON1+c4_y.CON2 + c5_x.CON1+c5_y.CON2 from
			(select count(lx.id) CON1 from lxsh_lx lx,jhsh_sjgz sj 
		       where lx.xmid=sj.xmbm and lx.jdbs='2' and lx.lxbm like #{lxbm}||'%'
		       and (((to_number(lx.zdzh) >= ${qdzh} and ${qdzh} >= to_number(lx.qdzh)) or 
		       (to_number(lx.zdzh) >= ${zdzh} and ${zdzh} >= to_number(lx.qdzh))) or
		       (to_number(lx.qdzh) = ${qdzh} or to_number(lx.zdzh) = ${zdzh}))
		       and to_number(substr(lx.xmid,0,4))<to_number(substr(#{xmbm},0,4))) c1_x,
		   	(select count(*) CON2 from 
		       (select lx.lxbm,lx.qdzh,lx.zdzh,lx.jdbs,lx.xmid from lxsh_lx lx,jhsh_sjgz sj where lx.xmid=sj.xmbm and jdbs='2') j,
		       (select ylxbm,yqdzh,yzdzh from ghlx 
		       where xlxbm like #{lxbm}||'%' and ((to_number(xzdzh) >= ${qdzh} and ${qdzh} >= to_number(xqdzh)) or 
		       (to_number(xzdzh) >= ${zdzh} and ${zdzh} >= to_number(xqdzh))) or
		       (to_number(xqdzh) = ${qdzh} or to_number(xzdzh) = ${zdzh})) k
		       where j.lxbm=k.ylxbm and j.jdbs='2' and to_number(substr(j.xmid,0,4))<to_number(substr(#{xmbm},0,4)) 
		       and j.qdzh<k.yzdzh and j.zdzh>k.yqdzh) c1_y,
		       
		   	(select count(lx.id) CON1 from lxsh_lx lx,jhsh_lmgz sj 
		       where lx.xmid=sj.xmbm and lx.jdbs='2' and lx.lxbm like #{lxbm}||'%'
		       and (((to_number(lx.zdzh) >= ${qdzh} and ${qdzh} >= to_number(lx.qdzh)) or 
		       (to_number(lx.zdzh) >= ${zdzh} and ${zdzh} >= to_number(lx.qdzh))) or
		       (to_number(lx.qdzh) = ${qdzh} or to_number(lx.zdzh) = ${zdzh}))
		       and to_number(substr(lx.xmid,0,4))<to_number(substr(#{xmbm},0,4))) c2_x,
		   	(select count(*) CON2 from 
		       (select lx.lxbm,lx.qdzh,lx.zdzh,lx.jdbs,lx.xmid from lxsh_lx lx,jhsh_lmgz sj where lx.xmid=sj.xmbm and jdbs='2') j,
		       (select ylxbm,yqdzh,yzdzh from ghlx 
		       where xlxbm like #{lxbm}||'%' and ((to_number(xzdzh) >= ${qdzh} and ${qdzh} >= to_number(xqdzh)) or 
		       (to_number(xzdzh) >= ${zdzh} and ${zdzh} >= to_number(xqdzh))) or
		       (to_number(xqdzh) = ${qdzh} or to_number(xzdzh) = ${zdzh})) k
		       where j.lxbm=k.ylxbm and j.jdbs='2' and to_number(substr(j.xmid,0,4))<to_number(substr(#{xmbm},0,4)) 
		       and j.qdzh<k.yzdzh and j.zdzh>k.yqdzh) c2_y,
		       
		   	(select count(lx.id) CON1 from lxsh_lx lx,jhsh_xj sj 
		       where lx.xmid=sj.xmbm and lx.jdbs='2' and lx.lxbm like #{lxbm}||'%'
		       and (((to_number(lx.zdzh) >= ${qdzh} and ${qdzh} >= to_number(lx.qdzh)) or 
		       (to_number(lx.zdzh) >= ${zdzh} and ${zdzh} >= to_number(lx.qdzh))) or
		       (to_number(lx.qdzh) = ${qdzh} or to_number(lx.zdzh) = ${zdzh}))
		       and to_number(substr(lx.xmid,0,4))<to_number(substr(#{xmbm},0,4))) c3_x,
		   	(select count(*) CON2 from 
		       (select lx.lxbm,lx.qdzh,lx.zdzh,lx.jdbs,lx.xmid from lxsh_lx lx,jhsh_xj sj where lx.xmid=sj.xmbm and jdbs='2') j,
		       (select ylxbm,yqdzh,yzdzh from ghlx 
		       where xlxbm like #{lxbm}||'%' and ((to_number(xzdzh) >= ${qdzh} and ${qdzh} >= to_number(xqdzh)) or 
		       (to_number(xzdzh) >= ${zdzh} and ${zdzh} >= to_number(xqdzh))) or
		       (to_number(xqdzh) = ${qdzh} or to_number(xzdzh) = ${zdzh})) k
		       where j.lxbm=k.ylxbm and j.jdbs='2' and to_number(substr(j.xmid,0,4))<to_number(substr(#{xmbm},0,4)) 
		       and j.qdzh<k.yzdzh and j.zdzh>k.yqdzh) c3_y,
		       
		   	(select count(lx.id) CON1 from lxsh_lx lx,jhsh_yhdzx sj 
		       where lx.xmid=sj.xmbm and lx.jdbs='2' and lx.lxbm like #{lxbm}||'%'
		       and (((to_number(lx.zdzh) >= ${qdzh} and ${qdzh} >= to_number(lx.qdzh)) or 
		       (to_number(lx.zdzh) >= ${zdzh} and ${zdzh} >= to_number(lx.qdzh))) or
		       (to_number(lx.qdzh) = ${qdzh} or to_number(lx.zdzh) = ${zdzh}))
		       and to_number(substr(lx.xmid,0,4))<to_number(substr(#{xmbm},0,4))) c4_x,
		   	(select count(*) CON2 from 
		       (select lx.lxbm,lx.qdzh,lx.zdzh,lx.jdbs,lx.xmid from lxsh_lx lx,jhsh_yhdzx sj where lx.xmid=sj.xmbm and jdbs='2') j,
		       (select ylxbm,yqdzh,yzdzh from ghlx 
		       where xlxbm like #{lxbm}||'%' and ((to_number(xzdzh) >= ${qdzh} and ${qdzh} >= to_number(xqdzh)) or 
		       (to_number(xzdzh) >= ${zdzh} and ${zdzh} >= to_number(xqdzh))) or
		       (to_number(xqdzh) = ${qdzh} or to_number(xzdzh) = ${zdzh})) k
		       where j.lxbm=k.ylxbm and j.jdbs='2' and to_number(substr(j.xmid,0,4))<to_number(substr(#{xmbm},0,4)) 
		       and j.qdzh<k.yzdzh and j.zdzh>k.yqdzh) c4_y,
		       
		   	(select count(lx.id) CON1 from lxsh_lx lx,jhsh_sh sj 
		       where lx.xmid=sj.xmbm and lx.jdbs='2' and lx.lxbm like #{lxbm}||'%'
		       and (((to_number(lx.zdzh) >= ${qdzh} and ${qdzh} >= to_number(lx.qdzh)) or 
		       (to_number(lx.zdzh) >= ${zdzh} and ${zdzh} >= to_number(lx.qdzh))) or
		       (to_number(lx.qdzh) = ${qdzh} or to_number(lx.zdzh) = ${zdzh}))
		       and to_number(substr(lx.xmid,0,4))<to_number(substr(#{xmbm},0,4))) c5_x,
		   	(select count(*) CON2 from 
		       (select lx.lxbm,lx.qdzh,lx.zdzh,lx.jdbs,lx.xmid from lxsh_lx lx,jhsh_sh sj where lx.xmid=sj.xmbm and jdbs='2') j,
		       (select ylxbm,yqdzh,yzdzh from ghlx 
		       where xlxbm like #{lxbm}||'%' and ((to_number(xzdzh) >= ${qdzh} and ${qdzh} >= to_number(xqdzh)) or 
		       (to_number(xzdzh) >= ${zdzh} and ${zdzh} >= to_number(xqdzh))) or
		       (to_number(xqdzh) = ${qdzh} or to_number(xzdzh) = ${zdzh})) k
		       where j.lxbm=k.ylxbm and j.jdbs='2' and to_number(substr(j.xmid,0,4))<to_number(substr(#{xmbm},0,4)) 
		       and j.qdzh<k.yzdzh and j.zdzh>k.yqdzh) c5_y
		]]>
	</select>
	<select id="querysfyLsjl" parameterType="java.util.Map" resultType="int">
	select decode(fun_bzls(#{xmbm},#{lxbm},#{qdzh},#{zdzh}),'是',1,0) from dual
	
	</select>
	
	<select id="queryTsdq" parameterType="xmsq" resultType="string">
		<![CDATA[SELECT DISTINCT X.NAME FROM XTGL_XZQHTSDQ T,XTGL_TSDQ X WHERE T.XZQHDM IN(
		select distinct substr(roadcode,-6) from gpsroad where substr(roadcode,1,length(roadcode)-6) =#{ylxbh}
		AND ROADSTART<=${zdzh} AND ROADENDS>=${qdzh}) AND X.ID=T.PARENT  AND X.NAME NOT LIKE '省直管试点县']]> 
	</select>
	
	<insert id="insertXmsqYhdzx" parameterType="java.util.List">
		insert into xmsq_yhdzx (
		<if test="xmbm!=null">xmbm</if>
		<if test="xmmc!=null">,xmmc</if>
		<if test="gcfl!=null">,gcfl</if>
		<if test="ghlxbm!=null">,ghlxbh</if>
		<if test="ylxbh!=null">,ylxbh</if>
		<if test="xzqh!=null">,xzqh</if>
		<if test="xzqhdm!=null">,xzqhdm</if>
		<if test="xzqhdm2!=null">,xzqhdm2</if>
		<if test="qdzh!=null">,qdzh</if>
		<if test="zdzh!=null">,zdzh</if>
		<if test="lc!=null">,lc</if>
		<if test="lmkd!=null">,lmkd</if>
		<if test="jsdj!=null">,jsdj</if>
		<if test="ntz!=null">,ntz</if>
		<if test="jhkgsj!=null">,jhkgsj</if>
		<if test="jhwgsj!=null">,jhwgsj</if>
		<if test="gq!=null">,gq</if>
		<if test="tsdq!=null">,TSDQ</if>
		<if test="gydw!=null">,gydw</if>
		<if test="gydwdm!=null">,gydwdm</if>
		<if test="jsfa!=null">,JSFA</if>
		<if test="lsjl!=null">,LSJL</if>
		<if test="qdmc!=null">,qdmc</if>
		<if test="zdmc!=null">,zdmc</if>
		<if test="lxmc!=null">,lxmc</if>
		<if test="bz!=null">,bz</if>
		<if test="wnxmk!=null">,wnxmk</if>
		<if test="ylmlx != null">,ylmlx</if>
		<if test="ylmjg != null">,ylmjg</if>
		<if test="lsxmbm !=null">,lsxmbm</if>
		<if test="lsxmid !=null">,lsxmid</if>
		<if test="wnxmbm !=null">,wnxmbm</if>
		<if test="wnxmid !=null">,wnxmid</if>
		<if test="wnnfxz !=null">,wnnfxz</if>
		) 
		values (
		<if test="xmbm!=null">#{xmbm}</if>
		<if test="xmmc!=null">,#{xmmc}</if>
		<if test="gcfl!=null">,#{gcfl}</if>
		<if test="ghlxbm!=null">,#{ghlxbm}</if>
		<if test="ylxbh!=null">,#{ylxbh}</if>
		<if test="xzqh!=null">,#{xzqh}</if>
		<if test="xzqhdm!=null">,#{xzqhdm}</if>
		<if test="xzqhdm2!=null">,#{xzqhdm2}</if>
		<if test="qdzh!=null">,#{qdzh}</if>
		<if test="zdzh!=null">,#{zdzh}</if>
		<if test="lc!=null">,#{lc}</if>
		<if test="lmkd!=null">,#{lmkd}</if>
		<if test="jsdj!=null">,#{jsdj}</if>
		<if test="ntz!=null">,#{ntz}</if>
		<if test="jhkgsj!=null">,#{jhkgsj}</if>
		<if test="jhwgsj!=null">,#{jhwgsj}</if>
		<if test="gq!=null">,#{gq}</if>
		<if test="tsdq!=null">,#{tsdq}</if>
		<if test="gydw!=null">,#{gydw}</if>
		<if test="gydwdm!=null">,#{gydwdm}</if>
		<if test="jsfa!=null">,#{jsfa}</if>
		<if test="lsjl!=null">,#{lsjl}</if>
		<if test="qdmc!=null">,#{qdmc}</if>
		<if test="zdmc!=null">,#{zdmc}</if>
		<if test="lxmc!=null">,#{lxmc}</if>
		<if test="bz!=null">,#{bz}</if>
		<if test="wnxmk!=null">,#{wnxmk}</if>
		<if test="ylmlx != null">,#{ylmlx}</if>
		<if test="ylmjg != null">,#{ylmjg}</if>
		<if test="lsxmbm !=null">,#{lsxmbm}</if>
		<if test="lsxmid !=null">,#{lsxmid}</if>
		<if test="wnxmbm !=null">,#{wnxmbm}</if>
		<if test="wnxmid !=null">,#{wnxmid}</if>
		<if test="wnnfxz !=null">,#{wnnfxz}</if>
		)
	</insert>
	<insert id="insertXmsqSh" parameterType="java.util.List">
		insert into xmsq_sh (
		<if test="xmbm!=null">xmbm</if>
		<if test="xmmc!=null">,xmmc</if>
		<if test="gcfl!=null">,gcfl</if>
		<if test="ghlxbm!=null">,ghlxbh</if>
		<if test="ylxbh!=null">,ylxbh</if>
		<if test="xzqh!=null">,xzqh</if>
		<if test="xzqhdm!=null">,xzqhdm</if>
		<if test="xzqhdm2!=null">,xzqhdm2</if>
		<if test="qdzh!=null">,qdzh</if>
		<if test="zdzh!=null">,zdzh</if>
		<if test="lc!=null">,lc</if>
		<if test="lmkd!=null">,lmkd</if>
		<if test="jsdj!=null">,jsdj</if>
		<if test="ntz!=null">,ntz</if>
		<if test="jhkgsj!=null">,jhkgsj</if>
		<if test="jhwgsj!=null">,jhwgsj</if>
		<if test="gq!=null">,gq</if>
		<if test="tsdq!=null">,TSDQ</if>
		<if test="gydw!=null">,gydw</if>
		<if test="gydwdm!=null">,gydwdm</if>
		<if test="jsfa!=null">,JSFA</if>
		<if test="lsjl!=null">,LSJL</if>
		<if test="qdmc!=null">,qdmc</if>
		<if test="zdmc!=null">,zdmc</if>
		<if test="lxmc!=null">,lxmc</if>
		<if test="wnxmk!=null">,wnxmk</if>
		<if test="lsxmbm !=null">,lsxmbm</if>
		<if test="lsxmid !=null">,lsxmid</if>
		<if test="wnxmbm !=null">,wnxmbm</if>
		<if test="wnxmid !=null">,wnxmid</if>
		<if test="wnnfxz !=null">,wnnfxz</if>
		) 
		values (
		<if test="xmbm!=null">#{xmbm}</if>
		<if test="xmmc!=null">,#{xmmc}</if>
		<if test="gcfl!=null">,#{gcfl}</if>
		<if test="ghlxbm!=null">,#{ghlxbm}</if>
		<if test="ylxbh!=null">,#{ylxbh}</if>
		<if test="xzqh!=null">,#{xzqh}</if>
		<if test="xzqhdm!=null">,#{xzqhdm}</if>
		<if test="xzqhdm2!=null">,#{xzqhdm2}</if>
		<if test="qdzh!=null">,#{qdzh}</if>
		<if test="zdzh!=null">,#{zdzh}</if>
		<if test="lc!=null">,#{lc}</if>
		<if test="lmkd!=null">,#{lmkd}</if>
		<if test="jsdj!=null">,#{jsdj}</if>
		<if test="ntz!=null">,#{ntz}</if>
		<if test="jhkgsj!=null">,#{jhkgsj}</if>
		<if test="jhwgsj!=null">,#{jhwgsj}</if>
		<if test="gq!=null">,#{gq}</if>
		<if test="tsdq!=null">,#{tsdq}</if>
		<if test="gydw!=null">,#{gydw}</if>
		<if test="gydwdm!=null">,#{gydwdm}</if>
		<if test="jsfa!=null">,#{jsfa}</if>
		<if test="lsjl!=null">,#{lsjl}</if>
		<if test="qdmc!=null">,#{qdmc}</if>
		<if test="zdmc!=null">,#{zdmc}</if>
		<if test="lxmc!=null">,#{lxmc}</if>
		<if test="wnxmk!=null">,#{wnxmk}</if>
		<if test="lsxmbm !=null">,#{lsxmbm}</if>
		<if test="lsxmid !=null">,#{lsxmid}</if>
		<if test="wnxmbm !=null">,#{wnxmbm}</if>
		<if test="wnxmid !=null">,#{wnxmid}</if>
		<if test="wnnfxz !=null">,#{wnnfxz}</if>
		)
	</insert>
	<insert id="insertLx" parameterType="lx">
		insert into lxsh_lx (id
		<if test="xmid!=null">,xmid</if><if test="lxbm!=null">,lxbm</if><if test="lxmc!=null">,lxmc</if>
		<if test="xzqh!=null">,xzqh</if><if test="xzqhdm!=null">,xzqhdm</if><if test="gydw!=null">,gydw</if>
		<if test="gydwdm!=null">,gydwdm</if><if test="qdzh!=null">,qdzh</if><if test="zdzh!=null">,zdzh</if>
		<if test="jsjsdj!=null">,jsjsdj</if><if test="lc!=null">,lc</if><if test="xjsdj!=null">,xjsdj</if>
		<if test="jsxz!=null">,jsxz</if><if test="qdmc!=null">,qdmc</if><if test="zdmc!=null">,zdmc</if>
		<if test="bzcs!=null">,bzcs</if><if test="sffirst!=null">,sffirst</if><if test="jdbs!=null">,jdbs</if>
		<if test="gpsqdzh!=null and gpsqdzh!=''">,gpsqdzh</if><if test="gpszdzh!=null and gpszdzh!=''">,gpszdzh</if><if test="jsfa!=null and jsfa!=''">,jsfa</if>
		<if test="yilc!=null">,yilc</if><if test="erlc!=null">,erlc</if><if test="sanlc!=null">,sanlc</if>
		<if test="silc!=null">,silc</if><if test="dwlc!=null">,dwlc</if><if test="wllc!=null">,wllc</if>
		<if test="ghlxbm != null">,ghlxbm</if><if test="ghqdzh != null">,ghqdzh</if><if test="ghzdzh != null">,ghzdzh</if>
		<if test="gxlxbm != null">,gxlxbm</if><if test="gxqdzh != null">,gxqdzh</if><if test="gxzdzh != null">,gxzdzh</if><if test="xzqhdm2 != null">,xzqhdm2</if>)
		values(#{id}<if test="xmid!=null">,#{xmid}</if><if test="lxbm!=null">,#{lxbm}</if><if test="lxmc!=null">,#{lxmc}</if>
		<if test="xzqh!=null">,#{xzqh}</if><if test="xzqhdm!=null">,#{xzqhdm}</if><if test="gydw!=null">,#{gydw}</if>
		<if test="gydwdm!=null">,#{gydwdm}</if><if test="qdzh!=null">,#{qdzh}</if><if test="zdzh!=null">,#{zdzh}</if>
		<if test="jsjsdj!=null">,#{jsjsdj}</if><if test="lc!=null">,#{lc}</if><if test="xjsdj!=null">,#{xjsdj}</if>
		<if test="jsxz!=null">,#{jsxz}</if><if test="qdmc!=null">,#{qdmc}</if><if test="zdmc!=null">,#{zdmc}</if>
		<if test="bzcs!=null">,#{bzcs}</if><if test="sffirst!=null">,#{sffirst}</if><if test="jdbs!=null">,#{jdbs}</if>
		<if test="gpsqdzh!=null and gpsqdzh!=''">,#{gpsqdzh}</if><if test="gpszdzh!=null and gpszdzh!=''">,#{gpszdzh}</if><if test="jsfa!=null and jsfa!=''">,#{jsfa}</if>
		<if test="yilc!=null">,#{yilc}</if><if test="erlc!=null">,#{erlc}</if><if test="sanlc!=null">,#{sanlc}</if>
		<if test="silc!=null">,#{silc}</if><if test="dwlc!=null">,#{dwlc}</if><if test="wllc!=null">,#{wllc}</if>
		<if test="ghlxbm != null">,#{ghlxbm}</if><if test="ghqdzh != null">,#{ghqdzh}</if><if test="ghzdzh != null">,#{ghzdzh}</if>
		<if test="gxlxbm != null">,#{gxlxbm}</if><if test="gxqdzh != null">,#{gxqdzh}</if><if test="gxzdzh != null">,#{gxzdzh}</if><if test="xzqhdm2 != null">,#{xzqhdm2}</if>)
	</insert>
	
	
	<insert id="insertYhdzxlx" parameterType="hashmap">
		insert into lxsh_lx (id
		<if test="lx.xmid!=null">,xmid</if><if test="lx.lxbm!=null">,lxbm</if><if test="lx.lxmc!=null">,lxmc</if>
		<if test="lx.xzqh!=null">,xzqh</if><if test="lx.xzqhdm!=null">,xzqhdm</if><if test="lx.gydw!=null">,gydw</if>
		<if test="lx.gydwdm!=null">,gydwdm</if><if test="lx.qdzh!=null">,qdzh</if><if test="lx.zdzh!=null">,zdzh</if>
		<if test="lx.jsjsdj!=null">,jsjsdj</if><if test="lx.lc!=null">,lc</if><if test="lx.xjsdj!=null">,xjsdj</if>
		<if test="lx.jsxz!=null">,jsxz</if><if test="lx.qdmc!=null">,qdmc</if><if test="lx.zdmc!=null">,zdmc</if>
		<if test="lx.bzcs!=null">,bzcs</if><if test="lx.sffirst!=null">,sffirst</if><if test="lx.jdbs!=null">,jdbs</if>
		<if test="lx.gpsqdzh!=null and lx.gpsqdzh!=''">,gpsqdzh</if><if test="lx.gpszdzh!=null and lx.gpszdzh!=''">,gpszdzh</if><if test="lx.jsfa!=null and lx.jsfa!=''">,jsfa</if>
		<if test="lx.yilc!=null">,yilc</if><if test="lx.erlc!=null">,erlc</if><if test="lx.sanlc!=null">,sanlc</if>
		<if test="lx.silc!=null">,silc</if><if test="lx.dwlc!=null">,dwlc</if><if test="lx.wllc!=null">,wllc</if>
		<if test="lx.ghlxbm != null">,ghlxbm</if><if test="lx.ghqdzh != null">,ghqdzh</if><if test="lx.ghzdzh != null">,ghzdzh</if>
		<if test="lx.gxlxbm != null">,gxlxbm</if><if test="lx.gxqdzh != null">,gxqdzh</if><if test="lx.gxzdzh != null">,gxzdzh</if>
		<if test="xmsq.lqhntmchd != null">
        ,LQHNTMCHD
	      </if>
	      <if test="xmsq.lqhntmc != null">
	        ,LQHNTMC
	      </if>
	      <if test="xmsq.gxlqhntmchd != null">
	        ,GXLQHNTMCHD
	      </if>
	      <if test="xmsq.gxlqhntmc != null">
	        ,GXLQHNTMC
	      </if>
	      <if test="xmsq.snhntmchd != null">
	        ,SNHNTMCHD
	      </if>
	      <if test="xmsq.snhntmc != null">
	        ,SNHNTMC
	      </if>
	      <if test="xmsq.lqlmjdrzshd != null">
	        ,LQLMJDRZSHD
	      </if>
	      <if test="xmsq.lqlmjdrzs != null">
	        ,LQLMJDRZS
	      </if>
	      <if test="xmsq.lqlmcbrzshd != null">
	        ,LQLMCBRZSHD
	      </if>
	      <if test="xmsq.lqlmcbrzs != null">
	        ,LQLMCBRZS
	      </if>
	      <if test="xmsq.swjchd != null">
	        ,SWJCHD
	      </if>
	      <if test="xmsq.swjc != null">
	        ,SWJC
	      </if>
	      <if test="xmsq.lqlmpmlqjdlzshd != null">
	        ,LQLMPMLQJDLZSHD
	      </if>
	      <if test="xmsq.lqlmpmlqjdlzs != null">
	        ,LQLMPMLQJDLZS
	      </if>
	      <if test="xmsq.lqlmrhlqjdlzshd != null">
	        ,LQLMRHLQJDLZSHD
	      </if>
	      <if test="xmsq.lqlmrhlqjdlzs != null">
	        ,LQLMRHLQJDLZS
	      </if>
	      <if test="xmsq.lqlmcblzshd != null">
	        ,LQLMCBLZSHD
	      </if>
	      <if test="xmsq.lqlmcblzs != null">
	        ,LQLMCBLZS
	      </if>
	      <if test="xmsq.xzrxjchd != null">
	        ,XZRXJCHD
	      </if>
	      <if test="xmsq.xzrxjc != null">
	        ,XZRXJC
	      </if>
	      <if test="xmsq.swjclzshd != null">
	        ,SWJCLZSHD
	      </if>
	      <if test="xmsq.swjclzs != null">
	        ,SWJCLZS
	      </if>
	      <if test="xmsq.xfchd != null">
	        ,XFCHD
	      </if>
	      <if test="xmsq.xfc != null">
	        ,XFC
	      </if>
	      <if test="xmsq.wcsnmbhd != null">
	        ,WCSNMBHD
	      </if>
	      <if test="xmsq.wcsnmb != null">
	        ,WCSNMB
	      </if>
	      <if test="xmsq.wcswjchd != null">
	        ,WCSWJCHD
	      </if>
	      <if test="xmsq.wcswjc != null">
	        ,WCSWJC
	      </if>
	      <if test="xmsq.snhntmchbhd != null">
	        ,SNHNTMCHBHD
	      </if>
	      <if test="xmsq.snhntmchb != null">
	        ,SNHNTMCHB
	      </if>
	      <if test="xmsq.bxhd != null">
	        ,BXHD
	      </if>
	      <if test="xmsq.bx != null">
	        ,BX
	      </if>
	      <if test="xmsq.snhntmcsshhd != null">
	        ,SNHNTMCSSHHD
	      </if>
	      <if test="xmsq.snhntmcssh != null">
	        ,SNHNTMCSSH
	      </if>
	      <if test="xmsq.sbzj != null">
	        ,SBZJ
	      </if>
	      <if test="xmsq.snhntmchbmj != null">
	        ,snhntmchbmj
	      </if>
	       <if test="xmsq.xzqhdm2 != null">
	        ,xzqhdm2
	      </if>
	      <if test="xmsq.fcbc30 != null">
	        ,fcbc30
	      </if>
	      <if test="xmsq.bc6 != null">
	        ,bc6
	      </if>
	      <if test="xmsq.bc25 != null">
	        ,bc25
	      </if>
	      <if test="xmsq.bc30 != null">
	        ,bc30
	      </if>
	      <if test="xmsq.bmc25 != null">
	        ,bmc25
	      </if>
	      <if test="xmsq.wfc != null">
	        ,wfc
	      </if>
	      <if test="xmsq.xjfc != null">
	        ,xjfc
	      </if>
	      <if test="xmsq.fcbc30hd != null">
	        ,fcbc30hd
	      </if>
	      <if test="xmsq.bc6hd != null">
	        ,bc6hd
	      </if>
	      <if test="xmsq.bc25hd != null">
	        ,bc25hd
	      </if>
	      <if test="xmsq.bc30hd != null">
	        ,bc30hd
	      </if>
	      <if test="xmsq.bmc25hd != null">
	        ,bmc25hd
	      </if>
	      <if test="xmsq.wfchd != null">
	        ,wfchd
	      </if>
	      <if test="xmsq.xjfchd != null">
	        ,xjfchd
	      </if>
	      <if test="xmsq.wbchd != null">
	        ,wbchd
	      </if>
	      <if test="xmsq.wbc != null">
	        ,wbc
	      </if>
		)
		values(#{lx.id}<if test="lx.xmid!=null">,#{lx.xmid}</if><if test="lx.lxbm!=null">,#{lx.lxbm}</if><if test="lx.lxmc!=null">,#{lx.lxmc}</if>
		<if test="lx.xzqh!=null">,#{lx.xzqh}</if><if test="lx.xzqhdm!=null">,#{lx.xzqhdm}</if><if test="lx.gydw!=null">,#{lx.gydw}</if>
		<if test="lx.gydwdm!=null">,#{lx.gydwdm}</if><if test="lx.qdzh!=null">,#{lx.qdzh}</if><if test="lx.zdzh!=null">,#{lx.zdzh}</if>
		<if test="lx.jsjsdj!=null">,#{lx.jsjsdj}</if><if test="lx.lc!=null">,#{lx.lc}</if><if test="lx.xjsdj!=null">,#{lx.xjsdj}</if>
		<if test="lx.jsxz!=null">,#{lx.jsxz}</if><if test="lx.qdmc!=null">,#{lx.qdmc}</if><if test="lx.zdmc!=null">,#{lx.zdmc}</if>
		<if test="lx.bzcs!=null">,#{lx.bzcs}</if><if test="lx.sffirst!=null">,#{lx.sffirst}</if><if test="lx.jdbs!=null">,#{lx.jdbs}</if>
		<if test="lx.gpsqdzh!=null and lx.gpsqdzh!=''">,#{lx.gpsqdzh}</if><if test="lx.gpszdzh!=null and lx.gpszdzh!=''">,#{lx.gpszdzh}</if><if test="lx.jsfa!=null and lx.jsfa!=''">,#{lx.jsfa}</if>
		<if test="lx.yilc!=null">,#{lx.yilc}</if><if test="lx.erlc!=null">,#{lx.erlc}</if><if test="lx.sanlc!=null">,#{lx.sanlc}</if>
		<if test="lx.silc!=null">,#{lx.silc}</if><if test="lx.dwlc!=null">,#{lx.dwlc}</if><if test="lx.wllc!=null">,#{lx.wllc}</if>
		<if test="lx.ghlxbm != null">,#{lx.ghlxbm}</if><if test="lx.ghqdzh != null">,#{lx.ghqdzh}</if><if test="lx.ghzdzh != null">,#{lx.ghzdzh}</if>
		<if test="lx.gxlxbm != null">,#{lx.gxlxbm}</if><if test="lx.gxqdzh != null">,#{lx.gxqdzh}</if><if test="lx.gxzdzh != null">,#{lx.gxzdzh}</if>
		<if test="xmsq.lqhntmchd != null">
	        ,#{xmsq.lqhntmchd}
	      </if>
	      <if test="xmsq.lqhntmc != null">
	        ,#{xmsq.lqhntmc}
	      </if>
	      <if test="xmsq.gxlqhntmchd != null">
	        ,#{xmsq.gxlqhntmchd}
	      </if>
	      <if test="xmsq.gxlqhntmc != null">
	        ,#{xmsq.gxlqhntmc}
	      </if>
	      <if test="xmsq.snhntmchd != null">
	        ,#{xmsq.snhntmchd}
	      </if>
	      <if test="xmsq.snhntmc != null">
	        ,#{xmsq.snhntmc}
	      </if>
	      <if test="xmsq.lqlmjdrzshd != null">
	        ,#{xmsq.lqlmjdrzshd}
	      </if>
	      <if test="xmsq.lqlmjdrzs != null">
	        ,#{xmsq.lqlmjdrzs}
	      </if>
	      <if test="xmsq.lqlmcbrzshd != null">
	        ,#{xmsq.lqlmcbrzshd}
	      </if>
	      <if test="xmsq.lqlmcbrzs != null">
	        ,#{xmsq.lqlmcbrzs}
	      </if>
	      <if test="xmsq.swjchd != null">
	        ,#{xmsq.swjchd}
	      </if>
	      <if test="xmsq.swjc != null">
	        ,#{xmsq.swjc}
	      </if>
	      <if test="xmsq.lqlmpmlqjdlzshd != null">
	        ,#{xmsq.lqlmpmlqjdlzshd}
	      </if>
	      <if test="xmsq.lqlmpmlqjdlzs != null">
	        ,#{xmsq.lqlmpmlqjdlzs}
	      </if>
	      <if test="xmsq.lqlmrhlqjdlzshd != null">
	        ,#{xmsq.lqlmrhlqjdlzshd}
	      </if>
	      <if test="xmsq.lqlmrhlqjdlzs != null">
	        ,#{xmsq.lqlmrhlqjdlzs}
	      </if>
	      <if test="xmsq.lqlmcblzshd != null">
	        ,#{xmsq.lqlmcblzshd}
	      </if>
	      <if test="xmsq.lqlmcblzs != null">
	        ,#{xmsq.lqlmcblzs}
	      </if>
	      <if test="xmsq.xzrxjchd != null">
	        ,#{xmsq.xzrxjchd}
	      </if>
	      <if test="xmsq.xzrxjc != null">
	        ,#{xmsq.xzrxjc}
	      </if>
	      <if test="xmsq.swjclzshd != null">
	        ,#{xmsq.swjclzshd}
	      </if>
	      <if test="xmsq.swjclzs != null">
	        ,#{xmsq.swjclzs}
	      </if>
	      <if test="xmsq.xfchd != null">
	        ,#{xmsq.xfchd}
	      </if>
	      <if test="xmsq.xfc != null">
	        ,#{xmsq.xfc}
	      </if>
	      <if test="xmsq.wcsnmbhd != null">
	        ,#{xmsq.wcsnmbhd}
	      </if>
	      <if test="xmsq.wcsnmb != null">
	        ,#{xmsq.wcsnmb}
	      </if>
	      <if test="xmsq.wcswjchd != null">
	        ,#{xmsq.wcswjchd}
	      </if>
	      <if test="xmsq.wcswjc != null">
	        ,#{xmsq.wcswjc}
	      </if>
	      <if test="xmsq.snhntmchbhd != null">
	        ,#{xmsq.snhntmchbhd}
	      </if>
	      <if test="xmsq.snhntmchb != null">
	        ,#{xmsq.snhntmchb}
	      </if>
	      <if test="xmsq.bxhd != null">
	        ,#{xmsq.bxhd}
	      </if>
	      <if test="xmsq.bx != null">
	        ,#{xmsq.bx}
	      </if>
	      <if test="xmsq.snhntmcsshhd != null">
	        ,#{xmsq.snhntmcsshhd}
	      </if>
	      <if test="xmsq.snhntmcssh != null">
	        ,#{xmsq.snhntmcssh}
	      </if>
		  <if test="xmsq.sbzj != null">
	        ,#{xmsq.sbzj}
	      </if>
	       <if test="xmsq.snhntmchbmj != null">
	        ,#{xmsq.snhntmchbmj}
	      </if>
	       <if test="xmsq.xzqhdm2 != null">
	        ,#{xmsq.xzqhdm2}
	      </if>
	      <if test="xmsq.fcbc30 != null">
	        ,#{xmsq.fcbc30}
	      </if>
	      <if test="xmsq.bc6 != null">
	        ,#{xmsq.bc6}
	      </if>
	      <if test="xmsq.bc25 != null">
	        ,#{xmsq.bc25}
	      </if>
	      <if test="xmsq.bc30 != null">
	        ,#{xmsq.bc30}
	      </if>
	      <if test="xmsq.bmc25 != null">
	        ,#{xmsq.bmc25}
	      </if>
	      <if test="xmsq.wfc != null">
	        ,#{xmsq.wfc}
	      </if>
	      <if test="xmsq.xjfc != null">
	        ,#{xmsq.xjfc}
	      </if>
	      <if test="xmsq.fcbc30hd != null">
	        ,#{xmsq.fcbc30hd}
	      </if>
	      <if test="xmsq.bc6hd != null">
	        ,#{xmsq.bc6hd}
	      </if>
	      <if test="xmsq.bc25hd != null">
	        ,#{xmsq.bc25hd}
	      </if>
	      <if test="xmsq.bc30hd != null">
	        ,#{xmsq.bc30hd}
	      </if>
	      <if test="xmsq.bmc25hd != null">
	        ,#{xmsq.bmc25hd}
	      </if>
	      <if test="xmsq.wfchd != null">
	        ,#{xmsq.wfchd}
	      </if>
	      <if test="xmsq.xjfchd != null">
	        ,#{xmsq.xjfchd}
	      </if>
	      <if test="xmsq.wbchd != null">
	        ,#{xmsq.wbchd}
	      </if>
	      <if test="xmsq.wbc != null">
	         ,#{xmsq.wbc}
	      </if>
		)
	</insert>
	
	<delete id="deleteLxByXmbm" parameterType="xmsq">
		delete from lxsh_lx where xmid=#{xmbm}
	</delete>
	
	<select id="queryYhdzxXmsq" parameterType="xmsq" resultType="xmsq">
		select * from (
			select rownum num,t.* from (
				select x.xmbm, x.gcfl, l.ghlxbm ghlxbh, l.lxbm ylxbh, x.xzqh, x.xzqhdm, lmkd, jsdj, ntz, jhkgsj, jhwgsj, gq, tsdq,x.thyy,  
				x.gydw, x.gydwdm, x.jsfa, lsjl, sqzt, xmmc, l.qdzh, l.zdzh, l.qdmc, l.zdmc, l.lxmc, bz,x.lc lc,sl.xmsl,sl.zlc,sl.sbzj,x.wnxmk,l.ghlxbm,l.ghlxmc,l.ghqdzh,l.ghzdzh
				from xmsq_yhdzx x left join lxsh_lx l on x.xmbm=l.xmid 
				
				left join (select xmid,count(xmid) xmsl,sum(sbzj) sbzj,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='1' 
				group by xmid) sl on x.xmbm=sl.xmid
				where l.jdbs='1' and l.sffirst='1' 
				<if test="xmsq.gydwdm!=null and xmsq.gydwdm!=''">and ${xmsq.gydwdm}</if>
				<if test="xmsq.xzqhdm!=null and xmsq.xzqhdm!=''">and ${xmsq.xzqhdm}</if>
				<if test="xmsq.xmmc!=null and xmsq.xmmc!=''">and xmmc like '%'||#{xmsq.xmmc}||'%'</if>
				<if test="xmsq.xmbm!=null and xmsq.xmbm!=''">and x.xmbm like '%'||#{xmsq.xmbm}||'%'</if>
				<if test="xmsq.jsdj!=null and xmsq.jsdj!=''">and ${xmsq.jsdj}</if>
				<if test="xmsq.sqzt>=0">and sqzt=${xmsq.sqzt}</if>
				<if test="xmsq.xmnf!=null and xmsq.xmnf!=''">and ${xmsq.xmnf}</if>
				<if test="xmsq.gcfl!=null and xmsq.gcfl!=''">and ${xmsq.gcfl}</if>
				<if test="xmsq.tsdq!=null and xmsq.tsdq!=''">${xmsq.tsdq}</if>
				<if test="xmsq.lsjl!=null and xmsq.lsjl!=''">and x.lsjl=#{xmsq.lsjl}</if>
				<if test="xmsq.wnxmk!=null and xmsq.wnxmk!=''">and x.wnxmk=#{xmsq.wnxmk}</if>
<!-- 				<if test="xmsq.jsxz!=null and xmsq.jsxz!=''">and x.jsxz=#{xmsq.jsxz}</if> -->
				<if test="xmsq.ylxbh!=null and xmsq.ylxbh!=''">
					and x.xmbm in (select xmid from lxsh_lx lx where ${xmsq.ylxbh} and xmid like '%4___')
				</if>
				
				<if test="xmsq.ghlxbh!=null and xmsq.ghlxbh!=''">
					and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${xmsq.ghlxbh})
				</if>
				<if test="xmsq.ghlxbm!=null and xmsq.ghlxbm!=''">
					and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${xmsq.ghlxbm})
				</if>
				<if test="xmsq.ghlxmc!='' and xmsq.ghlxmc!= null ">
					and (x.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{xmsq.ghlxmc}||'%')
					
					)
				</if>
				
				<if test="xmsq.lxmc !='' and xmsq.lxmc != null ">
					and X.lxmc like '%'||#{xmsq.lxmc}||'%'
				</if>
				<if test="xmsq.lsxmnf !='' and xmsq.lsxmnf != null ">
					${xmsq.lsxmnf}
				</if>
				<if test="xmsq.lsxmlx !='' and xmsq.lsxmlx != null ">
					${xmsq.lsxmlx}
				</if>
				<if test="xmsq.qdzh != null and  xmsq.qdzh != ''">
				 and l.zdzh >= #{xmsq.qdzh}
			    </if> 
			    <if test="xmsq.zdzh != null and  xmsq.zdzh != ''">
				 and l.qdzh &lt;= #{xmsq.zdzh}
			    </if>
			    <if test="xmsq.lxbm != null and  xmsq.lxbm != ''">
			     and x.ylxbh=#{xmsq.lxbm}
			    </if>
			  
				order by x.sqzt desc,x.xmbm desc) t ) t2
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryYhdzxXmsqbyyhc" parameterType="xmsq" resultType="xmsq">
		select * from (
			select rownum num,t.* from (
				select x.xmbm, x.gcfl, l.ghlxbm ghlxbh, l.lxbm ylxbh, x.xzqh, x.xzqhdm, lmkd, jsdj, ntz, jhkgsj, jhwgsj, gq, tsdq,x.thyy,x.yhcsh,  
				x.gydw, x.gydwdm, x.jsfa, lsjl, sqzt, xmmc, l.qdzh, l.zdzh, l.qdmc, l.zdmc, l.lxmc, bz,x.lc lc,sl.xmsl,sl.zlc,sl.sbzj,x.wnxmk,l.ghlxbm,l.ghlxmc,l.ghqdzh,l.ghzdzh
				from xmsq_yhdzx x left join lxsh_lx l on x.xmbm=l.xmid 
				
				left join (select xmid,count(xmid) xmsl,sum(sbzj) sbzj,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='1' 
				group by xmid) sl on x.xmbm=sl.xmid
				where l.jdbs='1' and l.sffirst='1' and x.sqzt='7'
				<if test="xmsq.gydwdm!=null and xmsq.gydwdm!=''">and ${xmsq.gydwdm}</if>
				<if test="xmsq.xzqhdm!=null and xmsq.xzqhdm!=''">and ${xmsq.xzqhdm}</if>
				<if test="xmsq.xmmc!=null and xmsq.xmmc!=''">and xmmc like '%'||#{xmsq.xmmc}||'%'</if>
				<if test="xmsq.jsdj!=null and xmsq.jsdj!=''">and ${xmsq.jsdj}</if>
				<if test="xmsq.sqzt>=0">and sqzt=${xmsq.sqzt}</if>
				<if test="xmsq.yhcsh !=null and xmsq.yhcsh !=''">and yhcsh=${xmsq.yhcsh}</if>
				<if test="xmsq.xmbm!=null and xmsq.xmbm!=''">and ${xmsq.xmbm}</if>
				<if test="xmsq.gcfl!=null and xmsq.gcfl!=''">and ${xmsq.gcfl}</if>
				<if test="xmsq.tsdq!=null and xmsq.tsdq!=''">${xmsq.tsdq}</if>
				<if test="xmsq.lsjl!=null and xmsq.lsjl!=''">and x.lsjl=#{xmsq.lsjl}</if>
				<if test="xmsq.wnxmk!=null and xmsq.wnxmk!=''">and x.wnxmk=#{xmsq.wnxmk}</if>
<!-- 				<if test="xmsq.jsxz!=null and xmsq.jsxz!=''">and x.jsxz=#{xmsq.jsxz}</if> -->
				<if test="xmsq.ylxbh!=null and xmsq.ylxbh!=''">
					and x.xmbm in (select xmid from lxsh_lx lx where ${xmsq.ylxbh} and xmid like '%4___')
				</if>
				
				<if test="xmsq.ghlxbh!=null and xmsq.ghlxbh!=''">
					and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${xmsq.ghlxbh})
				</if>
				<if test="xmsq.ghlxbm!=null and xmsq.ghlxbm!=''">
					and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${xmsq.ghlxbm})
				</if>
				<if test="xmsq.ghlxmc!='' and xmsq.ghlxmc!= null ">
					and (x.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{xmsq.ghlxmc}||'%')
					
					)
				</if>
				
				<if test="xmsq.lxmc !='' and xmsq.lxmc != null ">
					and X.lxmc like '%'||#{xmsq.lxmc}||'%'
				</if>
				<if test="xmsq.lsxmnf !='' and xmsq.lsxmnf != null ">
					${xmsq.lsxmnf}
				</if>
				<if test="xmsq.lsxmlx !='' and xmsq.lsxmlx != null ">
					${xmsq.lsxmlx}
				</if>
				order by x.sqzt desc,x.xmbm desc) t ) t2
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryShXmsq" parameterType="xmsq" resultType="xmsq">
		select * from (
			select rownum num,t.* from (
				select x.xmbm, x.gcfl, l.ghlxbm ghlxbh, l.lxbm ylxbh, x.xzqh, x.xzqhdm, lmkd, jsdj, ntz, jhkgsj, jhwgsj, gq, tsdq,x.thyy, 
				x.gydw, x.gydwdm, x.jsfa, lsjl, sqzt, xmmc, l.qdzh, l.zdzh, l.qdmc, l.zdmc, l.lxmc, bz,x.lc lc,sl.xmsl,sl.zlc,x.wnxmk,l.ghlxbm,l.ghlxmc,l.ghqdzh,l.ghzdzh
				from xmsq_sh x left join lxsh_lx l on x.xmbm=l.xmid 
				left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='0' group by xmid) sl on x.xmbm=sl.xmid
				where l.jdbs='0' and l.sffirst='1' 
				<if test="xmsq.gydwdm!=null and xmsq.gydwdm!=''">
					and ${xmsq.gydwdm}
				</if>
				<if test="xmsq.xzqhdm!=null and xmsq.xzqhdm!=''">
					and ${xmsq.xzqhdm}
				</if>
				<if test="xmsq.xmmc!=null and xmsq.xmmc!=''">
					and xmmc like '%'||#{xmsq.xmmc}||'%'
				</if>
				<if test="xmsq.xmbm!=null and xmsq.xmbm!=''">
					and x.xmbm like '%'||#{xmsq.xmbm}||'%'
				</if>
				<if test="xmsq.jsdj!=null and xmsq.jsdj!=''">
					and ${xmsq.jsdj}
				</if>
				<if test="xmsq.sqzt>=0">
					and sqzt=${xmsq.sqzt}
				</if>
				<if test="xmsq.xmnf!=null and xmsq.xmnf!=''">
					and ${xmsq.xmnf}
				</if>
				<if test="xmsq.gcfl!=null and xmsq.gcfl!=''">
					and ${xmsq.gcfl}
				</if>
				<if test="xmsq.tsdq!=null and xmsq.tsdq!=''">
					${xmsq.tsdq}
				</if>
				<if test="xmsq.lsjl!=null and xmsq.lsjl!=''">
					and x.lsjl=#{xmsq.lsjl}
				</if>
				<if test="xmsq.ylxbh!=null and xmsq.ylxbh!=''">
					and x.xmbm in (select xmid from lxsh_lx lx where ${xmsq.ylxbh} and xmid like '%5___')
				</if>
				
				<if test="xmsq.lxmc !='' and xmsq.lxmc != null ">
					and X.lxmc like '%'||#{xmsq.lxmc}||'%'
				</if>
				<if test="xmsq.ghlxbh!=null and xmsq.ghlxbh!=''">
					and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${xmsq.ghlxbh})
				</if>
				<if test="xmsq.ghlxbm!=null and xmsq.ghlxbm!=''">
					and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${xmsq.ghlxbm})
				</if>
				<if test="xmsq.ghlxmc!='' and xmsq.ghlxmc!= null ">
					and (x.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{xmsq.ghlxmc}||'%')
					
					)
				</if>
				<if test="xmsq.wnxmk!=null and xmsq.wnxmk!=''">and x.wnxmk=#{xmsq.wnxmk}</if>
				<if test="xmsq.lsxmnf !='' and xmsq.lsxmnf != null ">
					${xmsq.lsxmnf}
				</if>
				<if test="xmsq.lsxmlx !='' and xmsq.lsxmlx != null ">
					${xmsq.lsxmlx}
				</if>
				order by x.sqzt desc,x.xmbm desc) t ) t2
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryShXmsqbyyhc" parameterType="xmsq" resultType="xmsq">
		select * from (
			select rownum num,t.* from (
				select x.xmbm, x.gcfl, l.ghlxbm ghlxbh, l.lxbm ylxbh, x.xzqh, x.xzqhdm, lmkd, jsdj, ntz, jhkgsj, jhwgsj, gq, tsdq,x.thyy,x.yhcsh, 
				x.gydw, x.gydwdm, x.jsfa, lsjl, sqzt, xmmc, l.qdzh, l.zdzh, l.qdmc, l.zdmc, l.lxmc, bz,x.lc lc,sl.xmsl,sl.zlc,x.wnxmk,l.ghlxbm,l.ghlxmc,l.ghqdzh,l.ghzdzh
				from xmsq_sh x left join lxsh_lx l on x.xmbm=l.xmid 
				left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='0' group by xmid) sl on x.xmbm=sl.xmid
				where l.jdbs='0' and l.sffirst='1' and x.sqzt='7' 
				<if test="xmsq.gydwdm!=null and xmsq.gydwdm!=''">
					and ${xmsq.gydwdm}
				</if>
				<if test="xmsq.xzqhdm!=null and xmsq.xzqhdm!=''">
					and ${xmsq.xzqhdm}
				</if>
				<if test="xmsq.xmmc!=null and xmsq.xmmc!=''">
					and xmmc like '%'||#{xmsq.xmmc}||'%'
				</if>
				<if test="xmsq.jsdj!=null and xmsq.jsdj!=''">
					and ${xmsq.jsdj}
				</if>
				<if test="xmsq.sqzt>=0">
					and sqzt=${xmsq.sqzt}
				</if>
				<if test="xmsq.yhcsh !=null and xmsq.yhcsh !=''">and yhcsh=${xmsq.yhcsh}</if>
				<if test="xmsq.xmbm!=null and xmsq.xmbm!=''">
					and ${xmsq.xmbm}
				</if>
				<if test="xmsq.gcfl!=null and xmsq.gcfl!=''">
					and ${xmsq.gcfl}
				</if>
				<if test="xmsq.tsdq!=null and xmsq.tsdq!=''">
					${xmsq.tsdq}
				</if>
				<if test="xmsq.lsjl!=null and xmsq.lsjl!=''">
					and x.lsjl=#{xmsq.lsjl}
				</if>
				<if test="xmsq.ylxbh!=null and xmsq.ylxbh!=''">
					and x.xmbm in (select xmid from lxsh_lx lx where ${xmsq.ylxbh} and xmid like '%5___')
				</if>
				
				<if test="xmsq.lxmc !='' and xmsq.lxmc != null ">
					and X.lxmc like '%'||#{xmsq.lxmc}||'%'
				</if>
				<if test="xmsq.ghlxbh!=null and xmsq.ghlxbh!=''">
					and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${xmsq.ghlxbh})
				</if>
				<if test="xmsq.ghlxbm!=null and xmsq.ghlxbm!=''">
					and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${xmsq.ghlxbm})
				</if>
				<if test="xmsq.ghlxmc!='' and xmsq.ghlxmc!= null ">
					and (x.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{xmsq.ghlxmc}||'%')
					
					)
				</if>
				<if test="xmsq.wnxmk!=null and xmsq.wnxmk!=''">and x.wnxmk=#{xmsq.wnxmk}</if>
				<if test="xmsq.lsxmnf !='' and xmsq.lsxmnf != null ">
					${xmsq.lsxmnf}
				</if>
				<if test="xmsq.lsxmlx !='' and xmsq.lsxmlx != null ">
					${xmsq.lsxmlx}
				</if>
				order by x.sqzt desc,x.xmbm desc) t ) t2
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryYhdzxCount" parameterType="xmsq" resultType="int">
		select count(x.xmbm) from xmsq_yhdzx x where 1=1
		<if test="wnxmk!=null and wnxmk!=''">and x.wnxmk=#{wnxmk}</if>
		<if test="gydwdm!=null and gydwdm!=''">
			and ${gydwdm}
		</if>
		<if test="xzqhdm!=null and xzqhdm!=''">
			and ${xzqhdm}
		</if>
		<if test="xmmc!=null and xmmc!=''">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmbm!=null and xmbm!=''">
			and xmbm like '%'||#{xmbm}||'%'
		</if>
		<if test="jsdj!=null and jsdj!=''">
			and ${jsdj}
		</if>
		<if test="sqzt>=0">
			and sqzt=${sqzt}
		</if>
		<if test="xmnf!=null and xmnf!=''">
			and ${xmnf}
		</if>
		<if test="gcfl!=null and gcfl!=''">
			and ${gcfl}
		</if>
		<if test="tsdq!=null and tsdq!=''">
			${tsdq}
		</if>
		<if test="lsjl!=null and lsjl!=''">
			and x.lsjl=#{lsjl}
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and x.xmbm in (select xmid from lxsh_lx lx where ${ylxbh} and xmid like '%4___')
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (x.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			)
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and X.lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
	</select>
	<select id="queryYhdzxCountbyyhc" parameterType="xmsq" resultType="int">
		select count(x.xmbm) from xmsq_yhdzx x where 1=1 and x.sqzt='7'
		<if test="wnxmk!=null and wnxmk!=''">and x.wnxmk=#{wnxmk}</if>
		<if test="gydwdm!=null and gydwdm!=''">
			and ${gydwdm}
		</if>
		<if test="xzqhdm!=null and xzqhdm!=''">
			and ${xzqhdm}
		</if>
		<if test="xmmc!=null and xmmc!=''">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="jsdj!=null and jsdj!=''">
			and ${jsdj}
		</if>
		<if test="sqzt>=0">
			and sqzt=${sqzt}
		</if>
		<if test="yhcsh !=null and yhcsh !=''">and yhcsh=${yhcsh}</if>
		<if test="xmbm!=null and xmbm!=''">
			and ${xmbm}
		</if>
		<if test="gcfl!=null and gcfl!=''">
			and ${gcfl}
		</if>
		<if test="tsdq!=null and tsdq!=''">
			${tsdq}
		</if>
		<if test="lsjl!=null and lsjl!=''">
			and x.lsjl=#{lsjl}
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and x.xmbm in (select xmid from lxsh_lx lx where ${ylxbh} and xmid like '%4___')
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
				<if test="ghlxmc!='' and ghlxmc!= null ">
					and (x.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
					)
				</if>
		<if test="lxmc !='' and lxmc != null ">
			and X.lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
	</select>
	
	<select id="queryShCount" parameterType="xmsq" resultType="int">
		select count(x.xmbm) from xmsq_sh x 
		
		where 1=1
		<if test="wnxmk!=null and wnxmk!=''">and x.wnxmk=#{wnxmk}</if>
		<if test="gydwdm!=null and gydwdm!=''">
			and ${gydwdm}
		</if>
		<if test="xzqhdm!=null and xzqhdm!=''">
			and ${xzqhdm}
		</if>
		<if test="xmmc!=null and xmmc!=''">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmbm!=null and xmbm!=''">
			and xmbm like '%'||#{xmbm}||'%'
		</if>
		<if test="jsdj!=null and jsdj!=''">
			and ${jsdj}
		</if>
		<if test="sqzt>=0">
			and sqzt=${sqzt}
		</if>
		<if test="xmnf!=null and xmnf!=''">
			and ${xmnf}
		</if>
		<if test="gcfl!=null and gcfl!=''">
			and ${gcfl}
		</if>
		<if test="tsdq!=null and tsdq!=''">
			${tsdq}
		</if>
		<if test="lsjl!=null and lsjl!=''">
			and x.lsjl=#{lsjl}
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and x.xmbm in (select xmid from lxsh_lx lx where ${ylxbh} and xmid like '%5___')
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
				<if test="ghlxmc!='' and ghlxmc!= null ">
					and (x.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
					)
				</if>
		<if test="lxmc !='' and lxmc != null ">
			and X.lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
	</select>
	<select id="queryShCountbyyhc" parameterType="xmsq" resultType="int">
		select count(x.xmbm) from xmsq_sh x 
		
		where 1=1 and x.sqzt='7'
		<if test="wnxmk!=null and wnxmk!=''">and x.wnxmk=#{wnxmk}</if>
		<if test="gydwdm!=null and gydwdm!=''">
			and ${gydwdm}
		</if>
		<if test="xzqhdm!=null and xzqhdm!=''">
			and ${xzqhdm}
		</if>
		<if test="xmmc!=null and xmmc!=''">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="jsdj!=null and jsdj!=''">
			and ${jsdj}
		</if>
		<if test="sqzt>=0">
			and sqzt=${sqzt}
		</if>
		<if test="yhcsh !=null and yhcsh !=''">and yhcsh=${yhcsh}</if>
		<if test="xmbm!=null and xmbm!=''">
			and ${xmbm}
		</if>
		<if test="gcfl!=null and gcfl!=''">
			and ${gcfl}
		</if>
		<if test="tsdq!=null and tsdq!=''">
			${tsdq}
		</if>
		<if test="lsjl!=null and lsjl!=''">
			and x.lsjl=#{lsjl}
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and x.xmbm in (select xmid from lxsh_lx lx where ${ylxbh} and xmid like '%5___')
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
				<if test="ghlxmc!='' and ghlxmc!= null ">
					and (x.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
					)
				</if>
		<if test="lxmc !='' and lxmc != null ">
			and X.lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
	</select>
	
	<delete id="deleteYhdzxByXmbm" parameterType="xmsq">
		delete from xmsq_yhdzx where xmbm=#{xmbm}
	</delete>
	<delete id="deleteShByXmbm" parameterType="xmsq">
		delete from xmsq_sh where xmbm=#{xmbm}
	</delete>
	
	<update id="updateYhdzxSqzt" parameterType="xmsq">
		update xmsq_yhdzx set 
		sqzt=${sqzt},thyy=''
		<if test="lsjl!='' and lsjl!=null">,lsjl=#{lsjl}</if>
		<if test="wnxmk!='' and wnxmk!=null">,wnxmk=#{wnxmk}</if>
		 where xmbm in (${xmbm})
	</update>
	<update id="updateYhdzxSqztyhc" parameterType="xmsq">
		update xmsq_yhdzx set 
		yhcsh='1',thyyyhc=''
		<if test="lsjl!='' and lsjl!=null">,lsjl=#{lsjl}</if>
		<if test="wnxmk!='' and wnxmk!=null">,wnxmk=#{wnxmk}</if>
		 where xmbm in (${xmbm})
	</update>
	<update id="updateShSqzt" parameterType="xmsq">
		update xmsq_sh set sqzt=${sqzt},thyy='' where xmbm in (${xmbm})
	</update>
	<update id="updateShSqztyhc" parameterType="xmsq">
		update xmsq_sh set yhcsh='1',thyyyhc='' where xmbm in (${xmbm})
	</update>
	<insert id="insertJhshYhdzx" parameterType="xmsq">
		insert into jhsh_yhdzx (xmbm,xmmc,ylxbh,ghlxbh,gcfl,xzqh,xzqhdm,qdzh,zdzh,lc,jhkgsj,jhwgsj)
		select x.xmbm,x.xmmc,x.ylxbh,x.ghlxbh,x.gcfl,x.xzqh,x.xzqhdm,x.qdzh,x.zdzh,x.lc,x.jhkgsj,x.jhwgsj from xmsq_yhdzx x
		where x.xmbm in (${xmbm})
	</insert>
	<insert id="insertJhshSh" parameterType="xmsq">
		insert into jhsh_sh (xmbm,xmmc,ylxbh,ghlxbh,gcfl,xzqh,xzqhdm,qdzh,zdzh,lc,jhkgsj,jhwgsj)
		select x.xmbm,x.xmmc,x.ylxbh,x.ghlxbh,x.gcfl,x.xzqh,x.xzqhdm,x.qdzh,x.zdzh,x.lc,x.jhkgsj,x.jhwgsj from xmsq_sh x
		where x.xmbm in (${xmbm})
	</insert>
	
	<insert id="insertCbsjYhdzx" parameterType="xmsq">
		insert into cbsj_yhdzx c (xmmc,xmbm,jsdw,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,jsxz,kgsj,wgsj,gq,lc,jsfa,tz)
		select x.xmmc,x.xmbm,null,x.xzqh,x.xzqhdm2,x.gydw,x.gydwdm,x.qdzh,x.zdzh,x.jsdj,x.gcfl,x.jhkgsj,x.jhwgsj,x.gq,x.lc,x.jsfa,x.ntz 
		from xmsq_yhdzx x where x.xmbm in (${xmbm})
	</insert>
	<insert id="insertCbsjShls" parameterType="xmsq">
		insert into cbsj_sh c (xmmc,xmbm,jsdw,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,jsxz,kgsj,wgsj,gq,lc,jsfa,tz)
		select x.xmmc,x.xmbm,null,x.xzqh,x.xzqhdm2,x.gydw,x.gydwdm,x.qdzh,x.zdzh,x.jsdj,x.gcfl,x.jhkgsj,x.jhwgsj,x.gq,x.lc,x.jsfa,x.ntz 
		from xmsq_sh x where x.xmbm in (${xmbm})
	</insert>
	<insert id="insertCbsjSh" parameterType="xmsq">
		insert into kxxyj_sh(id,xmmc,xmbm,xzqh,xzqhdm,qdzh,zdzh,jsdj,jsxz,shzt,gcfl,gydw1,gydwdm1,tzgs)
		(select sys_guid(),x.xmmc,x.xmbm,x.xzqh,x.xzqhdm2,x.qdzh,x.zdzh,x.jsdj,x.jsfa,0,x.gcfl,gydw,gydwdm,ntz 
		from xmsq_sh x where x.xmbm in (${xmbm}))
	<!-- 
		insert into cbsj_sh c (xmmc,xmbm,jsdw,xzqh,qdzh,zdzh,jsjsdj,jsxz,kgsj,wgsj,gq,lc,jsfa)
		select x.xmmc,x.xmbm,null,x.xzqh,x.qdzh,x.zdzh,x.jsdj,x.gcfl,x.jhkgsj,x.jhwgsj,x.gq,x.lc,x.jsfa 
		from xmsq_sh x where x.xmbm in (${xmbm}) -->
	</insert>
	
	<select id="queryYhdzxByXmbm" parameterType="xmsq" resultType="xmsq">
		select x.*,decode(l.gpsqdzh,null,l.qdzh,l.gpsqdzh) gpsqdzh,decode(l.gpszdzh,null,l.zdzh,l.gpszdzh) gpszdzh,l.sffirst,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc,
		lqhntmc,gxlqhntmc,snhntmc,lqlmjdrzs,lqlmcbrzs,swjc,lqlmpmlqjdlzs,lqlmrhlqjdlzs,lqlmcblzs,
		xzrxjc,swjclzs,xfc,wcsnmb,wcswjc,snhntmchb,bx,snhntmcssh,
		lqhntmchd,gxlqhntmchd,snhntmchd,lqlmjdrzshd,lqlmcbrzshd,swjchd,lqlmpmlqjdlzshd,lqlmrhlqjdlzshd,lqlmcblzshd,
		xzrxjchd,swjclzshd,xfchd,wcsnmbhd,wcswjchd,snhntmchbhd,bxhd,snhntmcsshhd,sbzj,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,snhntmchbmj,fcbc30,bc6 ,bc25 ,bc30 ,bmc25 , wfc ,xjfc ,fcbc30hd ,bc6hd ,bc25hd ,bc30hd ,bmc25hd , wfchd ,xjfchd,wbc,wbchd   
		from xmsq_yhdzx x inner join lxsh_lx l on x.xmbm=l.xmid where xmbm=#{xmbm} and l.sffirst='1' and l.jdbs='1'
	</select>
	<select id="queryYhdzxqxByXmbm" parameterType="xmsq" resultType="xmsq">
		select x.*,decode(l.gpsqdzh,null,l.qdzh,l.gpsqdzh) gpsqdzh,decode(l.gpszdzh,null,l.zdzh,l.gpszdzh) gpszdzh,l.sffirst,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc,
		lqhntmc,gxlqhntmc,snhntmc,lqlmjdrzs,lqlmcbrzs,swjc,lqlmpmlqjdlzs,lqlmrhlqjdlzs,lqlmcblzs,
		xzrxjc,swjclzs,xfc,wcsnmb,wcswjc,snhntmchb,bx,snhntmcssh,
		lqhntmchd,gxlqhntmchd,snhntmchd,lqlmjdrzshd,lqlmcbrzshd,swjchd,lqlmpmlqjdlzshd,lqlmrhlqjdlzshd,lqlmcblzshd,
		xzrxjchd,swjclzshd,xfchd,wcsnmbhd,wcswjchd,snhntmchbhd,bxhd,snhntmcsshhd,sbzj,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,snhntmchbmj,fcbc30,bc6 ,bc25 ,bc30 ,bmc25 , wfc ,xjfc ,fcbc30hd ,bc6hd ,bc25hd ,bc30hd ,bmc25hd , wfchd ,xjfchd,wbc,wbchd      
		from xmsq_yhdzx_qx x inner join lxsh_lx l on x.xmbm=l.xmid where xmbm=#{xmbm} and l.sffirst='1' and l.jdbs='1'
	</select>
	<select id="queryShByXmbm" parameterType="xmsq" resultType="xmsq">
		select x.*,decode(l.gpsqdzh,null,l.qdzh,l.gpsqdzh) gpsqdzh,decode(l.gpszdzh,null,l.zdzh,l.gpszdzh) gpszdzh,l.sffirst,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh 
		from xmsq_sh x inner join lxsh_lx l on x.xmbm=l.xmid where xmbm=#{xmbm} and l.sffirst='1' and l.jdbs='0'
	</select>
	<select id="queryShqxByXmbm" parameterType="xmsq" resultType="xmsq">
		select x.*,decode(l.gpsqdzh,null,l.qdzh,l.gpsqdzh) gpsqdzh,decode(l.gpszdzh,null,l.zdzh,l.gpszdzh) gpszdzh,l.sffirst,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh 
		from xmsq_sh_qx x inner join lxsh_lx l on x.xmbm=l.xmid where xmbm=#{xmbm} and l.sffirst='1' and l.jdbs='0'
	</select>
	<update id="updateYhdzx" parameterType="xmsq">
		update xmsq_yhdzx set 
		<if test="xmbm!=null">xmbm=#{xmbm}</if>
		<if test="xmmc!=null">,xmmc=#{xmmc}</if>
		<if test="gcfl!=null">,gcfl=#{gcfl}</if>
		<if test="ghlxbh!=null">,ghlxbh=#{ghlxbh}</if>
		<if test="ylxbh!=null">,ylxbh=#{ylxbh}</if>
		<if test="xzqh!=null">,xzqh=#{xzqh}</if>
		<if test="xzqhdm!=null">,xzqhdm=#{xzqhdm}</if>
		<if test="xzqhdm2!=null">,xzqhdm2=#{xzqhdm2}</if>
		<if test="qdzh!=null">,qdzh=#{qdzh}</if>
		<if test="zdzh!=null">,zdzh=#{zdzh}</if>
		<if test="qdmc!=null">,qdmc=#{qdmc}</if>
		<if test="zdmc!=null">,zdmc=#{zdmc}</if>
		<if test="lc!=null">,lc=#{lc}</if>
		<if test="lmkd!=null">,lmkd=#{lmkd}</if>
		<if test="jsdj!=null">,jsdj=#{jsdj}</if>
		<if test="ntz!=null">,ntz=#{ntz}</if>
		<if test="jhkgsj!=null">,jhkgsj=#{jhkgsj}</if>
		<if test="jhwgsj!=null">,jhwgsj=#{jhwgsj}</if>
		<if test="gq!=null">,gq=#{gq}</if>
		<if test="tsdq!=null">,TSDQ=#{tsdq}</if>
		<if test="gydw!=null">,gydw=#{gydw}</if>
		<if test="gydwdm!=null">,gydwdm=#{gydwdm}</if>
		<if test="jsfa!=null">,JSFA=#{jsfa}</if>
		<if test="bz!=null">,bz=#{bz}</if>
		<if test="ylmlx!=null">,ylmlx=#{ylmlx}</if>
		<if test="ylmjg!=null">,ylmjg=#{ylmjg}</if>
		<if test="wnxmk !=null">,wnxmk=#{wnxmk}</if>
		<if test="lsjl !=null">,lsjl=#{lsjl}</if>
		<if test="lsxmbm !=null">,lsxmbm=#{lsxmbm}</if>
		<if test="lsxmid !=null">,lsxmid=#{lsxmid}</if>
		<if test="wnxmbm !=null">,wnxmbm=#{wnxmbm}</if>
		<if test="wnxmid !=null">,wnxmid=#{wnxmid}</if>
		<if test="wnnfxz !=null">,wnnfxz=#{wnnfxz}</if>
		where xmbm=#{xmbm1}
	</update>
	<update id="updateSh" parameterType="xmsq">
		update xmsq_sh set 
		<if test="xmbm!=null">xmbm=#{xmbm}</if>
		<if test="xmmc!=null">,xmmc=#{xmmc}</if>
		<if test="gcfl!=null">,gcfl=#{gcfl}</if>
		<if test="ghlxbh!=null">,ghlxbh=#{ghlxbh}</if>
		<if test="ylxbh!=null">,ylxbh=#{ylxbh}</if>
		<if test="xzqh!=null">,xzqh=#{xzqh}</if>
		<if test="xzqhdm!=null">,xzqhdm=#{xzqhdm}</if>
		<if test="xzqhdm2!=null">,xzqhdm2=#{xzqhdm2}</if>
		<if test="qdzh!=null">,qdzh=#{qdzh}</if>
		<if test="zdzh!=null">,zdzh=#{zdzh}</if>
		<if test="qdmc!=null">,qdmc=#{qdmc}</if>
		<if test="zdmc!=null">,zdmc=#{zdmc}</if>
		<if test="lc!=null">,lc=#{lc}</if>
		<if test="lmkd!=null">,lmkd=#{lmkd}</if>
		<if test="jsdj!=null">,jsdj=#{jsdj}</if>
		<if test="ntz!=null">,ntz=#{ntz}</if>
		<if test="jhkgsj!=null">,jhkgsj=#{jhkgsj}</if>
		<if test="jhwgsj!=null">,jhwgsj=#{jhwgsj}</if>
		<if test="gq!=null">,gq=#{gq}</if>
		<if test="tsdq!=null">,TSDQ=#{tsdq}</if>
		<if test="gydw!=null">,gydw=#{gydw}</if>
		<if test="gydwdm!=null">,gydwdm=#{gydwdm}</if>
		<if test="jsfa!=null">,JSFA=#{jsfa}</if>
		<if test="wnxmk !=null">,wnxmk=#{wnxmk}</if>
		<if test="lsjl !=null">,lsjl=#{lsjl}</if>
		<if test="lsxmbm !=null">,lsxmbm=#{lsxmbm}</if>
		<if test="lsxmid !=null">,lsxmid=#{lsxmid}</if>
		<if test="wnxmbm !=null">,wnxmbm=#{wnxmbm}</if>
		<if test="wnxmid !=null">,wnxmid=#{wnxmid}</if>
		<if test="wnnfxz !=null">,wnnfxz=#{wnnfxz}</if>
		where xmbm=#{xmbm1}
	</update>
	
	<select id="queryYhdzxExport" parameterType="xmsq" resultType="xmsq">
		select * from (
			select rownum num,t.* from (
				<!-- select x.* from xmsq_yhdzx x  -->
				select substr(x.xmbm,0,4) xmnf,x.xmbm,decode(l.sffirst,'1',x.xmmc,'')  xmmc,x.xzqh,x.gydw,x.lmkd,x.jsdj,x.ntz,x.jhkgsj,x.jhwgsj,x.gq,x.gcfl,x.jsfa,x.ghlxbh,x.xzqhdm,l.*
				from xmsq_yhdzx x,(select xmid,lxbm ylxbh,lxmc lxmc,qdzh qdzh,zdzh zdzh,qdmc qdmc,zdmc zdmc,
				lc lc,yilc,erlc,sanlc,silc,dwlc,wllc,sffirst,ghlxbm,ghlxmc from lxsh_lx where jdbs='1' ) l where 1=1 and x.xmbm(+)=l.xmid
				<if test="gydwdm!=null and gydwdm!=''">and ${gydwdm}</if>
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="xmmc!=null and xmmc!=''">and xmmc like '%'||#{xmmc}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="sqzt>=0">and sqzt=${sqzt}</if>
				<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
				<if test="tsdq!=null and tsdq!=''">${tsdq}</if>
				<if test="lsjl!=null and lsjl!=''">and x.lsjl=#{lsjl}</if>
				<if test="ylxbh!=null and ylxbh!=''">
					and x.xmbm in (select xmid from lxsh_lx lx where ${ylxbh} and xmid like '%4___')
				</if>
				<if test="wnxmk!=null and wnxmk!=''">
					and x.wnxmk like '%'||#{wnxmk}||'%' 
				</if>
				
				<if test="lxmc!=null and lxmc!=''">
					and l.lxmc like '%'||#{lxmc}||'%' 
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghlxbm!=null and ghlxbm!=''">
					and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
				</if>
				<if test="ghlxmc!=null and ghlxmc!=''">
					and l.ghlxmc like '%'||#{ghlxmc}||'%' 
				</if>
				<if test="wnxmk!=null and wnxmk!=''">and x.wnxmk=#{wnxmk}</if>
				<if test="lsxmnf !='' and lsxmnf != null ">
					${lsxmnf}
				</if>
				<if test="lsxmlx !='' and lsxmlx != null ">
					${lsxmlx}
				</if>
				
				order by x.sqzt desc,x.xmbm desc,l.sffirst desc) t ) t2
	</select>
	<select id="queryShExport" parameterType="xmsq" resultType="xmsq">


				select decode(l.sffirst,'1',substr(x.xmbm,0,4),substr(x.xmbm,0,4)) xmnf,decode(l.sffirst,'1',x.xmbm,'') xmbm,decode(l.sffirst,'1',x.xmmc,'') xmmc,decode(l.sffirst,'1',x.xzqh,x.xzqh) xzqh,
				decode(l.sffirst,'1',x.xzqhdm,x.xzqhdm)  xzqhdm,decode(l.sffirst,'1',x.gydw,x.gydw) gydw,
				decode(l.sffirst,'1',x.lmkd,x.lmkd)  lmkd,decode(l.sffirst,'1',x.jsdj,x.jsdj)  jsdj,decode(l.sffirst,'1',x.ntz,x.ntz)  ntz,decode(l.sffirst,'1',x.jhkgsj,x.jhkgsj)  jhkgsj,decode(l.sffirst,'1',x.jhwgsj,x.jhwgsj)  jhwgsj,decode(l.sffirst,'1',x.gq,x.gq)  gq,decode(l.sffirst,'1',x.gcfl,x.gcfl)  gcfl,decode(l.sffirst,'1',x.jsfa,x.jsfa)  jsfa,l.*
		        from xmsq_sh x,(select * from lxsh_lx where jdbs='0'   ) l where 1=1 and x.xmbm(+)=l.xmid
				<if test="gydwdm!=null and gydwdm!=''">and ${gydwdm}</if>
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="xmmc!=null and xmmc!=''">and xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xmbm!=null and xmbm!=''">and x.xmbm like '%'||#{xmbm}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and (jsdj=#{jsdj})</if>
				<if test="sqzt>=0">and sqzt=${sqzt}</if>
				<if test="xmnf!=null and xmnf!=''">and ${xmnf}</if>
				<if test="tsdq!=null and tsdq!=''">${tsdq}</if>
				<if test="lsjl!=null and lsjl!=''">and x.lsjl=#{lsjl}</if>
				<if test="ylxbh!=null and ylxbh!=''">
					and x.xmbm in (select xmid from lxsh_lx lx where ${ylxbh} and xmid like '%5___')
				</if>
				<if test="lxmc!=null and lxmc!=''">
					and l.lxmc like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghlxbm!=null and ghlxbm!=''">
					and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
				</if>
				<if test="ghlxmc!=null and ghlxmc!=''">
					and l.ghlxmc like '%'||#{ghlxmc}||'%'
				</if>
				<if test="wnxmk!=null and wnxmk!=''">and x.wnxmk=#{wnxmk}</if>
				<if test="lsxmnf !='' and lsxmnf != null ">
					${lsxmnf}
				</if>
				<if test="lsxmlx !='' and lsxmlx != null ">
					${lsxmlx}
				</if>
				order by x.sqzt desc,x.xmbm desc ,l.sffirst desc

	</select>
	
	<select id="queryZhcjExport"  parameterType="xmsq" resultType="elist">

				select rownum v_0,x.xmbm v_1,x.xmmc v_2,x.xzqhdm v_3,x.xzqh v_4,x.gydw v_5,
    decode(instr(RemoveSameStr(lx.ylxbm,','),','),0,RemoveSameStr(lx.ylxbm,','),lx.ylxbm) v_6,
    decode(instr(RemoveSameStr(lx.ylxmc,','),','),0,RemoveSameStr(lx.ylxmc,','),lx.ylxmc) v_7,
    lx.qdzh v_8,lx.zdzh v_9,
    decode(instr(RemoveSameStr(lx.ghlxbm,','),','),0,RemoveSameStr(lx.ghlxbm,','),lx.ghlxbm)  v_10,
    decode(instr(RemoveSameStr(lx.ghlxmc,','),','),0,RemoveSameStr(lx.ghlxmc,','),lx.ghlxmc) v_11,
    lx.ghqdzh v_12,lx.ghzdzh v_13,
    decode(instr(RemoveSameStr(lx.gxlxbm,','),','),0,RemoveSameStr(lx.gxlxbm,','),lx.gxlxbm) v_14,
    lx.gxqdzh v_15,lx.gxzdzh v_16,
    decode(instr(RemoveSameStr(lx.qdmc,','),','),0,RemoveSameStr(lx.qdmc,','),lx.qdmc) v_17,
    decode(instr(RemoveSameStr(lx.zdmc,','),','),0,RemoveSameStr(lx.zdmc,','),lx.zdmc) v_18,
    to_char(lx.zjhlc,'fm9999999990.000') v_19, to_char(lx.yilc,'fm9999999990.000') v_20, to_char(lx.erlc,'fm9999999990.000') v_21, 
    to_char(lx.sanlc,'fm9999999990.000') v_22, to_char(lx.silc,'fm9999999990.000') v_23, to_char(lx.dwlc,'fm9999999990.000') v_24, 
    to_char(lx.wllc,'fm9999999990.000') v_25,  RemoveSameStr(decode(lx.lxlmkd,null,x.lmkd,0,x.lmkd,lx.lxlmkd),',') v_26,
    x.jsdj v_27,substr(x.xmbm,0,4) v_28,x.gcfl v_29,x.jhkgsj v_30,x.jhwgsj v_31,x.gq v_32,x.ntz v_33,x.jsfa v_34,x.bz v_35,
    (decode(x.lsjl,'是',( select replace(WMSYS.WM_CONCAT(distinct decode(substr(xmbm,11,1),4,xdnf||xmlx,xdnf||xmmc)),',',',') from all_lsjl where 1=1 and length(xmbm)=14 and x.lsxmbm like '%'||xmbm||'%'),' ')) v_36
   from xmsq_sh x
   left join (
    select xmid,sum(jhlc) zjhlc,sum(sbzj) sbzj,sum(bzcs) bzcs,
              replace(WMSYS.WM_CONCAT(distinct(lxlmkd)),',',',') lxlmkd,replace(WMSYS.WM_CONCAT(distinct(jsxz)),',',',') jsxz,
              replace(WMSYS.WM_CONCAT(distinct(gydw)),',',',') gydw,replace(WMSYS.WM_CONCAT(distinct(xzqh)),',',',') xzqh,
              replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
              replace(WMSYS.WM_CONCAT(jsjsdj),'、',',') jsjsdjtj,
              replace(WMSYS.WM_CONCAT(xjsdj),'、',',') xjsdjtj,
              replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,
             replace(max(qdzh), ',.', ',0.') qdzh,replace(max(zdzh), ',.', ',0.') zdzh,replace(max(ghqdzh), ',.', ',0.') ghqdzh,replace(max(ghzdzh), ',.', ',0.') ghzdzh,
             replace(max(gxqdzh), ',.', ',0.') gxqdzh,replace(max(gxzdzh), ',.', ',0.') gxzdzh,
             max(ghlxbm) ghlxbm,max(ylxbm) ylxbm,max(ghlxmc) ghlxmc,max(ylxmc) ylxmc,max(gxlxbm) gxlxbm,max(qdmc) qdmc,max(zdmc) zdmc,
             decode(substr(xmid,11,1),'1',(sum(nvl(jhyilc,0))),(sum(nvl(yilc,0)))) yilc,decode(substr(xmid,11,1),'1',(sum(nvl(jherlc,0))),(sum(nvl(erlc,0)))) erlc,
             decode(substr(xmid,11,1),'1',(sum(nvl(jhsanlc,0))),(sum(nvl(sanlc,0)))) sanlc,decode(substr(xmid,11,1),'1',(sum(nvl(jhsilc,0))),(sum(nvl(silc,0)))) silc,
             decode(substr(xmid,11,1),'1',(sum(nvl(jhdwlc,0))),(sum(nvl(dwlc,0)))) dwlc,decode(substr(xmid,11,1),'1',(sum(nvl(jhwllc,0))),(sum(nvl(wllc,0)))) wllc
              from (select  xmid,jsxz,sbzj,lxlmkd,gydw,xzqh,bzcs,
              (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)) 
              else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
              end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
              else ''
              end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,yilc,erlc,sanlc,silc,dwlc,wllc,
               WMSYS.WM_CONCAT(ghlxmc)over( PARTITION BY xmid ORDER BY id,ghlxmc) ghlxmc,
               WMSYS.WM_CONCAT(lxmc)over( PARTITION BY xmid ORDER BY id,lxmc) ylxmc,
               WMSYS.WM_CONCAT(ghlxbm)over( PARTITION BY xmid ORDER BY id,ghlxbm) ghlxbm,
               WMSYS.WM_CONCAT(lxbm)over( PARTITION BY xmid ORDER BY id,lxbm) ylxbm,
               WMSYS.WM_CONCAT((case when qdzh like '.%' then 0||qdzh when qdzh like '%,.%' then replace(qdzh, ',.', ',0.') else qdzh end ))over( PARTITION BY xmid ORDER BY id,qdzh) qdzh,
               WMSYS.WM_CONCAT((case when zdzh like '.%' then 0||zdzh when zdzh like '%,.%' then replace(zdzh, ',.', ',0.') else zdzh end ))over( PARTITION BY xmid ORDER BY id,zdzh) zdzh,
               WMSYS.WM_CONCAT((case when ghqdzh like '.%' then 0||ghqdzh when ghqdzh like '%,.%' then replace(ghqdzh, ',.', ',0.') else ghqdzh end ))over( PARTITION BY xmid ORDER BY id,ghqdzh) ghqdzh,
               WMSYS.WM_CONCAT((case when ghzdzh like '.%' then 0||ghzdzh when ghzdzh like '%,.%' then replace(ghzdzh, ',.', ',0.') else ghzdzh end ))over( PARTITION BY xmid ORDER BY id,ghzdzh) ghzdzh,
               WMSYS.WM_CONCAT(gxlxbm)over( PARTITION BY xmid ORDER BY id,gxlxbm) gxlxbm,
               WMSYS.WM_CONCAT((case when gxqdzh like '.%' then 0||gxqdzh when gxqdzh like '%,.%' then replace(gxqdzh, ',.', ',0.') else gxqdzh end ))over( PARTITION BY xmid ORDER BY id,gxqdzh) gxqdzh,
               WMSYS.WM_CONCAT((case when gxzdzh like '.%' then 0||gxzdzh when gxzdzh like '%,.%' then replace(gxzdzh, ',.', ',0.') else gxzdzh end ))over( PARTITION BY xmid ORDER BY id,gxzdzh) gxzdzh,
               WMSYS.WM_CONCAT(qdmc)over( PARTITION BY xmid ORDER BY id,qdmc) qdmc,
               WMSYS.WM_CONCAT(zdmc)over( PARTITION BY xmid ORDER BY id,zdmc) zdmc
              from LXSH_LX lx where jdbs='0') group by xmid
    ) lx on x.xmbm=lx.xmid
        where 1=1 
				<if test="gydwdm!=null and gydwdm!=''">and ${gydwdm}</if>
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="xmmc!=null and xmmc!=''">and xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xmbm!=null and xmbm!=''">and x.xmbm like '%'||#{xmbm}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="sqzt>=0">and sqzt=${sqzt}</if>
				<if test="xmnf!=null and xmnf!=''">and ${xmnf}</if>
				<if test="tsdq!=null and tsdq!=''">${tsdq}</if>
				<if test="lsjl!=null and lsjl!=''">and x.lsjl=#{lsjl}</if>
				<if test="ylxbh!=null and ylxbh!=''">
					and x.xmbm in (select xmid from lxsh_lx lx where ${ylxbh} and xmid like '%5___')
				</if>
				<if test="lxmc!=null and lxmc!=''">
					and l.lxmc like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghlxbm!=null and ghlxbm!=''">
					and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
				</if>
				<if test="ghlxmc!=null and ghlxmc!=''">
					and l.ghlxmc like '%'||#{ghlxmc}||'%'
				</if>
				<if test="wnxmk!=null and wnxmk!=''">and x.wnxmk=#{wnxmk}</if>
				<if test="lsxmnf !='' and lsxmnf != null ">
					${lsxmnf}
				</if>
				<if test="lsxmlx !='' and lsxmlx != null ">
					${lsxmlx}
				</if>
	</select>
	<select id="queryAllXzqh" parameterType="string" resultType="treenode">
		select distinct x.id ,x.name text,parent ,'open' state from XTGL_XZQH x where  id like '%'||${value}||'%' order by to_number(id)
	</select>
	<select id="queryAllGydw" parameterType="string" resultType="treenode">
		select distinct x.id ,x.name text,parent ,'open' state from XTGL_DEPARTMENT x where  id like '%'||#{value}||'%' order by to_number(id)
	</select>
	<select id="queryLjYhdzx" parameterType="xmsq" resultType="java.util.Map">
		select count(*) sl,nvl(sum(ntz),0) tz,nvl(sum(lc),0) lc,nvl(sum(sbzj),0) sbz,'0' sjl,'0' bzcs,'0' dftz from (
			select xmbm,ntz,l.lc,l.sbzj from xmsq_yhdzx x left join 
			(select xmid,(sum(nvl(yilc,0))+sum(nvl(erlc,0))+sum(nvl(sanlc,0))+sum(nvl(silc,0))+sum(nvl(dwlc,0))+sum(nvl(wllc,0))) lc,to_char(nvl(sum(sbzj),0)) sbzj from lxsh_lx where jdbs=#{jdbs} and xmid like '%4___' group by xmid) l on x.xmbm=l.xmid where 1=1
			<if test="gydwdm!=null and gydwdm!=''">and ${gydwdm}</if>
			<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
			<if test="xmmc!=null and xmmc!=''">and xmmc like '%'||#{xmmc}||'%'</if>
			<if test="xmbm!=null and xmbm!=''">and x.xmbm like '%'||#{xmbm}||'%'</if>
			<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
			<if test="sqzt>=0">and sqzt=${sqzt}</if>
			<if test="xmnf!=null and xmnf!=''">and ${xmnf}</if>
			<if test="gcfl!=null and gcfl!=''">and ${gcfl}</if>
			<if test="tsdq!=null and tsdq!=''">${tsdq}</if>
			<if test="lsjl!=null and lsjl!=''">and x.lsjl=#{lsjl}</if>
			<if test="wnxmk!=null and wnxmk!=''">and x.wnxmk=#{wnxmk}</if>
			<if test="ylxbh!=null and ylxbh!=''">
				and x.xmbm in (select xmid from lxsh_lx lx where ${ylxbh} and xmid like '%4___')
			</if>
			<if test="ghlxbh!=null and ghlxbh!=''">
			and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
			<if test="ghlxmc!='' and ghlxmc!= null ">
				and (x.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
				)
			</if>
			<if test="lxmc !='' and lxmc != null ">
				and x.lxmc like '%'||#{lxmc}||'%'
			</if>
			<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
		)
	</select>
	<select id="queryLjYhdzxbyyhc" parameterType="xmsq" resultType="java.util.Map">
		select count(*) sl,nvl(sum(ntz),0) tz,nvl(sum(lc),0) lc,nvl(sum(sbzj),0) sbz,'0' sjl,'0' bzcs,'0' dftz from (
			select xmbm,ntz,l.lc,l.sbzj from xmsq_yhdzx x left join 
			(select xmid,(sum(nvl(yilc,0))+sum(nvl(erlc,0))+sum(nvl(sanlc,0))+sum(nvl(silc,0))+sum(nvl(dwlc,0))+sum(nvl(wllc,0))) lc,to_char(nvl(sum(sbzj),0)) sbzj from lxsh_lx where jdbs=#{jdbs} and xmid like '%4___' group by xmid) l on x.xmbm=l.xmid where 1=1
			and x.sqzt='7'
			<if test="gydwdm!=null and gydwdm!=''">and ${gydwdm}</if>
			<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
			<if test="xmmc!=null and xmmc!=''">and xmmc like '%'||#{xmmc}||'%'</if>
			<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
			<if test="sqzt>=0">and sqzt=${sqzt}</if>
			<if test="yhcsh !=null and yhcsh !=''">and yhcsh=${yhcsh}</if>
			<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
			<if test="gcfl!=null and gcfl!=''">and ${gcfl}</if>
			<if test="tsdq!=null and tsdq!=''">${tsdq}</if>
			<if test="lsjl!=null and lsjl!=''">and x.lsjl=#{lsjl}</if>
			<if test="wnxmk!=null and wnxmk!=''">and x.wnxmk=#{wnxmk}</if>
			<if test="ylxbh!=null and ylxbh!=''">
				and x.xmbm in (select xmid from lxsh_lx lx where ${ylxbh} and xmid like '%4___')
			</if>
			<if test="ghlxbh!=null and ghlxbh!=''">
			and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
			<if test="ghlxmc!='' and ghlxmc!= null ">
				and (x.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
				)
			</if>
			<if test="lxmc !='' and lxmc != null ">
				and x.lxmc like '%'||#{lxmc}||'%'
			</if>
			<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
		)
	</select>
	
	<select id="queryLjSh" parameterType="xmsq" resultType="java.util.Map">
		select count(*) sl,nvl(sum(ntz),0) tz,nvl(sum(lc),0) lc,'0' sbz,'0' sjl,'0' bzcs,'0' dftz from (
			select xmbm,ntz,l.lc from xmsq_sh x left join 
			(select xmid,(sum(nvl(yilc,0))+sum(nvl(erlc,0))+sum(nvl(sanlc,0))+sum(nvl(silc,0))+sum(nvl(dwlc,0))+sum(nvl(wllc,0))) lc 
			from lxsh_lx where jdbs=#{jdbs} and xmid like '%5___' group by xmid) l 
			on x.xmbm=l.xmid where 1=1
			<if test="gydwdm!=null and gydwdm!=''">and ${gydwdm}</if>
			<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
			<if test="xmmc!=null and xmmc!=''">and xmmc like '%'||#{xmmc}||'%'</if>
			<if test="xmbm!=null and xmbm!=''">and x.xmbm like '%'||#{xmbm}||'%'</if>
			<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
			<if test="sqzt>=0">and sqzt=${sqzt}</if>
			<if test="xmnf!=null and xmnf!=''">and ${xmnf}</if>
			<if test="gcfl!=null and gcfl!=''">and ${gcfl}</if>
			<if test="tsdq!=null and tsdq!=''">${tsdq}</if>
			<if test="lsjl!=null and lsjl!=''">and x.lsjl=#{lsjl}</if>
			<if test="wnxmk!=null and wnxmk!=''">and x.wnxmk=#{wnxmk}</if>
			<if test="ghlxbh!=null and ghlxbh!=''">
				and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
			</if>
			<if test="ghlxbm!=null and ghlxbm!=''">
				and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			</if>
			<if test="ghlxmc!='' and ghlxmc!= null ">
				and (x.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
				
				)
			</if>
			<if test="ylxbh!=null and ylxbh!=''">
				and x.xmbm in (select xmid from lxsh_lx lx where ${ylxbh} and xmid like '%5___')
			</if>
			<if test="ghlxbh!=null and ghlxbh!=''">
				and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
			</if>
			<if test="ghlxbm!=null and ghlxbm!=''">
				and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			</if>
			<if test="lxmc !='' and lxmc != null ">
				and x.lxmc like '%'||#{lxmc}||'%'
			</if>
			<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
		)
	</select>
	<select id="queryLjShbyyhc" parameterType="xmsq" resultType="java.util.Map">
		select count(*) sl,nvl(sum(ntz),0) tz,nvl(sum(lc),0) lc,'0' sbz,'0' sjl,'0' bzcs,'0' dftz from (
			select xmbm,ntz,l.lc from xmsq_sh x left join 
			(select xmid,(sum(nvl(yilc,0))+sum(nvl(erlc,0))+sum(nvl(sanlc,0))+sum(nvl(silc,0))+sum(nvl(dwlc,0))+sum(nvl(wllc,0))) lc 
			from lxsh_lx where jdbs=#{jdbs} and xmid like '%5___' group by xmid) l 
			on x.xmbm=l.xmid where 1=1 and x.sqzt='7'
			<if test="gydwdm!=null and gydwdm!=''">and ${gydwdm}</if>
			<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
			<if test="xmmc!=null and xmmc!=''">and xmmc like '%'||#{xmmc}||'%'</if>
			<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
			<if test="sqzt>=0">and sqzt=${sqzt}</if>
			<if test="yhcsh !=null and yhcsh !=''">and yhcsh=${yhcsh}</if>
			<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
			<if test="gcfl!=null and gcfl!=''">and ${gcfl}</if>
			<if test="tsdq!=null and tsdq!=''">${tsdq}</if>
			<if test="lsjl!=null and lsjl!=''">and x.lsjl=#{lsjl}</if>
			<if test="wnxmk!=null and wnxmk!=''">and x.wnxmk=#{wnxmk}</if>
			<if test="ghlxbm!=null and ghlxbm!=''">
				and (x.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxbm like '%'||#{ghlxbm}||'%')
				or x.xmbm in (select distinct xmid from lx_clsd where ghlxbm like '%'||#{ghlxbm}||'%')
				)
			</if>
			<if test="ghlxmc!='' and ghlxmc!= null ">
				and (x.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
				)
			</if>
			<if test="ylxbh!=null and ylxbh!=''">
				and x.xmbm in (select xmid from lxsh_lx lx where ${ylxbh} and xmid like '%5___')
			</if>
			<if test="ghlxbh!=null and ghlxbh!=''">
				and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
			</if>
			<if test="ghlxbm!=null and ghlxbm!=''">
				and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			</if>
			<if test="lxmc !='' and lxmc != null ">
				and x.lxmc like '%'||#{lxmc}||'%'
			</if>
			<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
		)
	</select>
	
	<select id="queryLxFromGpsroadByLevel" parameterType="java.util.Map" resultType="java.util.Map">
		select substr(roadcode,0,length(roadcode)-6) id,substr(roadcode,0,length(roadcode)-6) text
		<!-- ,min(g.roadstart),max(g.roadends) --> from gpsroad g where g.roadcode like #{level}||'%' 
		<if test="xzqhdm !=null and xzqhdm !=''">
		and substr(roadcode,length(roadcode)-5) like #{xzqhdm}||'%'
		</if>
		and f114 not like '高速%'
		group by substr(roadcode,0,length(roadcode)-6) order by substr(roadcode,0,length(roadcode)-6)
	</select>
	
	<select id="queryLxFromLxshlxByLevel" parameterType="java.util.Map" resultType="java.util.Map">
		select distinct lxbm id,lxbm text from lxsh_lx 
		where 1=1
		<if test="xzqhdm !=null and xzqhdm !=''">
		and xzqhdm like #{xzqhdm}||'%'
		</if>
		${level}
		order by lxbm
	</select>
	
	<select id="queryYhzxXmsq" parameterType="xmsq" resultType="xmsq">
		select * from (
			select rownum num,t.* from (
				select * from xmsq_yhzx x
				where 1=1
				<if test="xmsq.gydwdm!=null and xmsq.gydwdm!=''">
					and ${xmsq.gydwdm}
				</if>
				<if test="xmsq.xzqhdm!=null and xmsq.xzqhdm!=''">
					and ${xmsq.xzqhdm}
				</if>
				<if test="xmsq.xmmc!=null and xmsq.xmmc!=''">
					and xmmc like '%'||'${xmsq.xmmc}'||'%'
				</if>
				<if test="xmsq.xmbm!=null and xmsq.xmbm!=''">
					and xmbm like '%'||'${xmsq.xmbm}'||'%'
				</if>
				<if test="xmsq.jb!=null and xmsq.jb!=''">
					and jb like '%'||${xmsq.jb}||'%'
				</if>
				<if test="xmsq.sqzt>=0">
					and sqzt=${xmsq.sqzt}
				</if>
				<if test="xmsq.xmnf!=null and xmsq.xmnf!=''">
					and ${xmsq.xmnf}
				</if>
				<if test="xmsq.jsxz!=null and xmsq.jsxz!=''">
					and jsxz like '%'||${xmsq.jsxz}||'%'
				</if>
				<if test="xmsq.ydbmc!=null and xmsq.ydbmc!=''">
					and ydbmc like '%'||'${xmsq.ydbmc}'||'%'
				</if>
				<if test="xmsq.lxmc !='' and xmsq.lxmc != null ">
					and lxmc like '%'||'${xmsq.lxmc}'||'%'
				</if>
				order by sqzt desc,xmbm desc) t ) t2
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryYhzxCount" parameterType="xmsq" resultType="int">
		select count(x.xmbm) from xmsq_yhzx x where 1=1
		<if test="gydwdm!=null and gydwdm!=''">
			and ${gydwdm}
		</if>
		<if test="xzqhdm!=null and xzqhdm!=''">
			and ${xzqhdm}
		</if>
		<if test="xmmc!=null and xmmc!=''">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmbm!=null and xmbm!=''">
			and xmbm like '%'||#{xmbm}||'%'
		</if>
		<if test="jb!=null and jb!=''">
			and jb like '%'||#{jb}||'%'
		</if>
		<if test="sqzt>=0">
			and sqzt=${sqzt}
		</if>
		<if test="xmnf!=null and xmnf!=''">
			and ${xmnf}
		</if>
		<if test="jsxz!=null and jsxz!=''">
			and jsxz like '%'||#{jsxz}||'%'
		</if>
		<if test="ydbmc!=null and ydbmc!=''">
			and ydbmc like '%'||#{ydbmc}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
	</select>
	
	<select id="queryYhzxNextXmbm" resultType="string">
		select NVL(max(substr(c.xmbm,11)),6000)+1 from xmsq_yhzx c where c.xmbm like #{xmnf}||#{xzqhdm}||'%'
	</select>
	
	<insert id="insertXmsqYhzx" parameterType="java.util.List">
		insert into xmsq_yhzx (
		<if test="xmbm!=null">xmbm</if>
		<if test="xmmc!=null">,xmmc</if>
		<if test="jb!=null">,jb</if>
		<if test="jsxz!=null">,jsxz</if>
		<if test="ydbmc!=null">,ydbmc</if>
		<if test="xzqh!=null">,xzqh</if>
		<if test="xzqhdm!=null">,xzqhdm</if>
		<if test="ztz!=null">,ztz</if>
		<if test="zbzzj!=null">,zbzzj</if>
		<if test="sbzzj!=null">,sbzzj</if>
		<if test="zddzjl!=null">,zddzjl</if>
		<if test="dfzc!=null">,dfzc</if>
		<if test="jhkgsj!=null">,jhkgsj</if>
		<if test="jhwgsj!=null">,jhwgsj</if>
		<if test="gydw!=null">,gydw</if>
		<if test="gydwdm!=null">,gydwdm</if>
		<if test="lxmc!=null">,lxmc</if>
		<if test="lxzh!=null">,lxzh</if>
		<if test="xmnf!=null">,xmnf</if>
		<if test="bz!=null">,bz</if>) 
		values (
		<if test="xmbm!=null">#{xmbm}</if>
		<if test="xmmc!=null">,#{xmmc}</if>
		<if test="jb!=null">,#{jb}</if>
		<if test="jsxz!=null">,#{jsxz}</if>
		<if test="ydbmc!=null">,#{ydbmc}</if>
		<if test="xzqh!=null">,#{xzqh}</if>
		<if test="xzqhdm!=null">,#{xzqhdm}</if>
		<if test="ztz!=null">,#{ztz}</if>
		<if test="zbzzj!=null">,#{zbzzj}</if>
		<if test="sbzzj!=null">,#{sbzzj}</if>
		<if test="zddzjl!=null">,#{zddzjl}</if>
		<if test="dfzc!=null">,#{dfzc}</if>
		<if test="jhkgsj!=null">,#{jhkgsj}</if>
		<if test="jhwgsj!=null">,#{jhwgsj}</if>
		<if test="gydw!=null">,#{gydw}</if>
		<if test="gydwdm!=null">,#{gydwdm}</if>
		<if test="lxmc!=null">,#{lxmc}</if>
		<if test="lxzh!=null">,#{lxzh}</if>
		<if test="xmnf!=null">,#{xmnf}</if>
		<if test="bz!=null">,#{bz}</if>)
	</insert>
	<update id="updateYhzx" parameterType="xmsq">
		update xmsq_yhzx set 
		<if test="xmbm!=null">xmbm=#{xmbm}</if>
		<if test="xmmc!=null">,xmmc=#{xmmc}</if>
		<if test="jb!=null">,jb=#{jb}</if>
		<if test="jsxz!=null">,jsxz=#{jsxz}</if>
		<if test="ydbmc!=null">,ydbmc=#{ydbmc}</if>
		<if test="xzqh!=null">,xzqh=#{xzqh}</if>
		<if test="xzqhdm!=null">,xzqhdm=#{xzqhdm}</if>
		<if test="ztz!=null">,ztz=#{ztz}</if>
		<if test="zbzzj!=null">,zbzzj=#{zbzzj}</if>
		<if test="sbzzj!=null">,sbzzj=#{sbzzj}</if>
		<if test="zddzjl!=null">,zddzjl=#{zddzjl}</if>
		<if test="dfzc!=null">,dfzc=#{dfzc}</if>
		<if test="jhkgsj!=null">,jhkgsj=#{jhkgsj}</if>
		<if test="jhwgsj!=null">,jhwgsj=#{jhwgsj}</if>
		<if test="gydw!=null">,gydw=#{gydw}</if>
		<if test="gydwdm!=null">,gydwdm=#{gydwdm}</if>
		<if test="lxmc!=null">,lxmc=#{lxmc}</if>
		<if test="lxzh!=null">,lxzh=#{lxzh}</if>
		<if test="xmnf!=null">,xmnf=#{xmnf}</if>
		<if test="bz!=null">,bz=#{bz}</if>
		where xmbm=#{xmbm}
	</update>
	
	<delete id="deleteYhzxByXmbm" parameterType="xmsq">
		delete from xmsq_yhzx where xmbm=#{xmbm}
	</delete>
	
	<select id="queryYhzxByXmbm" parameterType="xmsq" resultType="xmsq">
		select x.* from xmsq_yhzx x where xmbm=#{xmbm} 
	</select>
	
	<update id="updateYhzxSqzt" parameterType="xmsq">
		update xmsq_yhzx set sqzt=${sqzt} where xmbm=#{xmbm}
	</update>
	
	<select id="queryLjYhzx" parameterType="xmsq" resultType="java.util.Map">
		select count(*) bz,sum(ztz) ntz from xmsq_yhzx x where 1=1
			    <if test="gydwdm!=null and gydwdm!=''">
					and ${gydwdm}
				</if>
				<if test="xzqhdm!=null and xzqhdm!=''">
					and ${xzqhdm}
				</if>
				<if test="xmmc!=null and xmmc!=''">
					and xmmc like '%'||#{xmmc}||'%'
				</if>
				<if test="xmbm!=null and xmbm!=''">
					and xmbm like '%'||#{xmbm}||'%'
				</if>
				<if test="jb!=null and jb!=''">
					and jb like '%'||#{jb}||'%'
				</if>
				<if test="sqzt>=0">
					and sqzt=${sqzt}
				</if>
				<if test="xmnf!=null and xmnf!=''">
					and ${xmnf}
				</if>
				<if test="jsxz!=null and jsxz!=''">
					and jsxz like '%'||#{jsxz}||'%'
				</if>
				<if test="ydbmc!=null and ydbmc!=''">
					and ydbmc like '%'||#{ydbmc}||'%'
				</if>
				<if test="lxmc !='' and lxmc != null ">
					and lxmc like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxmc!='' and ghlxmc!= null ">and ghlxmc=#{ghlxmc}</if>
				<if test="ghlxbm!='' and ghlxbm!= null ">and ghlxbm=#{ghlxbm}</if>
	</select>
	
	<insert id="insertJhshYhzx" parameterType="xmsq">
		insert into jhsh_yhzx (xmbm,ztz,ZBZZJ,SBZZJ,ZDDZJL,DFZC,jhkgsj,jhwgsj)
		select x.xmbm,x.ztz,x.ZBZZJ,x.SBZZJ,x.ZDDZJL,x.DFZC,x.jhkgsj,x.jhwgsj
		from xmsq_yhzx x where x.xmbm in (${xmbm})
	</insert>
	
	<select id="queryYhzxExport" parameterType="xmsq" resultType="xmsq">
		select * from xmsq_yhzx x
				where 1=1
				<if test="gydwdm!=null and gydwdm!=''">
					and ${gydwdm}
				</if>
				<if test="xzqhdm!=null and xzqhdm!=''">
					and ${xzqhdm}
				</if>
				<if test="xmmc!=null and xmmc!=''">
					and xmmc like '%'||#{xmmc}||'%'
				</if>
				<if test="xmbm!=null and xmbm!=''">
					and xmbm like '%'||#{xmbm}||'%'
				</if>
				<if test="jb!=null and jb!=''">
					and jb like '%'||#{jb}||'%'
				</if>
				<if test="sqzt>=0">
					and sqzt=${sqzt}
				</if>
				<if test="xmnf!=null and xmnf!=''">
					and ${xmnf}
				</if>
				<if test="jsxz!=null and jsxz!=''">
					and jsxz like '%'||#{jsxz}||'%'
				</if>
				<if test="ydbmc!=null and ydbmc!=''">
					and ydbmc like '%'||#{ydbmc}||'%'
				</if>
				<if test="lxmc !='' and lxmc != null ">
					and lxmc like '%'||#{lxmc}||'%'
				</if>
	</select>
	
	
	<select id="queryQTLx" parameterType="lx" resultType="lx">
		select * from lxsh_lx where jdbs=(select max(jdbs) from lxsh_lx t where t.xmid=#{xmid}) and to_number(qdzh)!=to_number(#{qdzh}) and to_number(zdzh)!=to_number(#{zdzh}) and xmid=#{xmid}
	</select>
	<select id="queryYLx" parameterType="lx" resultType="lx">
		<![CDATA[select ylxbm ylxbm,(case when Xqdzh<${qdzh} then YQDZH+${qdzh}-XQDZH else yqdzh end) yqdzh,
		(case when ${zdzh}<Xzdzh then YZDZH-XZDZH+${zdzh} else yzdzh end ) yzdzh ,
		xlxbm as lxbm,(case when Xqdzh<${qdzh} then ${qdzh} else xqdzh end ) qdzh,
		(case when ${zdzh}<Xzdzh then ${zdzh} else xzdzh end) zdzh 
		from XTGL_LXSJ t where  t.xlxbm like #{lxbm} || '%' and 
		t.Xqdzh<${zdzh} and t.Xzdzh>${qdzh}]]>
	</select>
	<!-- <select id="queryLsjlList" parameterType="java.util.Map" resultType="lx">
		select l.xmid,j.xmmc,l.lxbm,l.lxmc,l.qdzh,l.zdzh,'' ylxbm,'' yqdzh, '' yzdzh,j.gcfl xjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lxsh_lx l right join jhsh_yhdzx j on l.xmid=j.xmbm right join cbsj_yhdzx c on j.xmbm=c.xmbm 
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.qdzh) >= ${lx.qdzh} and ${lx.zdzh} >= to_number(l.zdzh)) or 
	    	(to_number(l.zdzh) >= ${lx.zdzh} and ${lx.zdzh} >= to_number(l.qdzh))
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		<foreach collection="ylx" item="item">
			union all
			<![CDATA[
			select lx.xmid,jh.xmmc,#{item.lxbm} as lxbm,lx.lxmc as lxmc,#{item.qdzh} as qdzh,#{item.zdzh} as zdzh,
			lx.lxbm as ylxbm,
			case when to_number(lx.qdzh)<=${item.yqdzh} then to_char(${item.yqdzh}) else to_char(lx.qdzh) end yqdzh ,
			case when to_number(lx.zdzh)>=${item.yzdzh} then to_char(${item.yzdzh}) else to_char(lx.zdzh) end  yzdzh,
			lx.xjsdj as xjsdj,lx.jsjsdj as jsjsdj
			from lxsh_lx lx,jhsh_yhdzx jh where jh.xmbm=lx.xmid and lx.lxbm like '%'||#{item.ylxbm}||'%'
	        and (((to_number(lx.zdzh) >= ${item.yqdzh} and ${item.yqdzh} >= to_number(lx.qdzh)) or 
		    (to_number(lx.zdzh) >= ${item.yzdzh} and ${item.yzdzh} >= to_number(lx.qdzh))) or
		    (to_number(lx.qdzh) = ${item.yqdzh} or to_number(lx.zdzh) = ${item.yzdzh}))
		    and (to_number(lx.qdzh) != ${item.yzdzh} and to_number(lx.zdzh) != ${item.yqdzh})
	        ]]>
		</foreach>
		union all
		select l.xmid,j.xmmc,l.lxbm,l.lxmc,l.qdzh,l.zdzh,'' ylxbm,'' yqdzh, '' yzdzh,'' xjsdj,l.jsjsdj from lxsh_lx l right join jhsh_sh j on l.xmid=j.xmbm 
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.qdzh) >= ${lx.qdzh} and ${lx.zdzh} >= to_number(l.zdzh)) or 
	    	(to_number(l.zdzh) >= ${lx.zdzh} and ${lx.zdzh} >= to_number(l.qdzh))
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		<foreach collection="ylx" item="item">
			union all
			<![CDATA[
			select lx.xmid,jh.xmmc,#{item.lxbm} as lxbm,lx.lxmc as lxmc,#{item.qdzh} as qdzh,#{item.zdzh} as zdzh,
			lx.lxbm as ylxbm,
			case when to_number(lx.qdzh)<=${item.yqdzh} then to_char(${item.yqdzh}) else to_char(lx.qdzh) end yqdzh ,
			case when to_number(lx.zdzh)>=${item.yzdzh} then to_char(${item.yzdzh}) else to_char(lx.zdzh) end  yzdzh,
			lx.xjsdj as xjsdj,lx.jsjsdj as jsjsdj
			from lxsh_lx lx,jhsh_sh jh where jh.xmbm=lx.xmid and lx.lxbm like '%'||#{item.ylxbm}||'%'
	        and (((to_number(lx.zdzh) >= ${item.yqdzh} and ${item.yqdzh} >= to_number(lx.qdzh)) or 
		    (to_number(lx.zdzh) >= ${item.yzdzh} and ${item.yzdzh} >= to_number(lx.qdzh))) or
		    (to_number(lx.qdzh) = ${item.yqdzh} or to_number(lx.zdzh) = ${item.yzdzh}))
		    and (to_number(lx.qdzh) != ${item.yzdzh} and to_number(lx.zdzh) != ${item.yqdzh})
	        ]]>
		</foreach>
		union all
		select l.xmid,j.xmmc,l.lxbm,l.lxmc,l.qdzh,l.zdzh,'' ylxbm,'' yqdzh, '' yzdzh,'' xjsdj,l.jsjsdj from lxsh_lx l right join jhsh_lmgz j on l.xmid=j.xmbm 
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.qdzh) >= ${lx.qdzh} and ${lx.zdzh} >= to_number(l.zdzh)) or 
	    	(to_number(l.zdzh) >= ${lx.zdzh} and ${lx.zdzh} >= to_number(l.qdzh))
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		<foreach collection="ylx" item="item">
			union all
			<![CDATA[
			select lx.xmid,jh.xmmc,#{item.lxbm} as lxbm,lx.lxmc as lxmc,#{item.qdzh} as qdzh,#{item.zdzh} as zdzh,
			lx.lxbm as ylxbm,
			case when to_number(lx.qdzh)<=${item.yqdzh} then to_char(${item.yqdzh}) else to_char(lx.qdzh) end yqdzh ,
			case when to_number(lx.zdzh)>=${item.yzdzh} then to_char(${item.yzdzh}) else to_char(lx.zdzh) end  yzdzh,
			lx.xjsdj as xjsdj,lx.jsjsdj as jsjsdj
			from lxsh_lx lx,jhsh_lmgz jh where jh.xmbm=lx.xmid and lx.lxbm like '%'||#{item.ylxbm}||'%'
	        and (((to_number(lx.zdzh) >= ${item.yqdzh} and ${item.yqdzh} >= to_number(lx.qdzh)) or 
		    (to_number(lx.zdzh) >= ${item.yzdzh} and ${item.yzdzh} >= to_number(lx.qdzh))) or
		    (to_number(lx.qdzh) = ${item.yqdzh} or to_number(lx.zdzh) = ${item.yzdzh}))
		    and (to_number(lx.qdzh) != ${item.yzdzh} and to_number(lx.zdzh) != ${item.yqdzh})
	        ]]>
		</foreach>
		union all
		select l.xmid,j.xmmc,l.lxbm,l.lxmc,l.qdzh,l.zdzh,'' ylxbm,'' yqdzh, '' yzdzh,'' xjsdj,l.jsjsdj from lxsh_lx l right join jhsh_sjgz j on l.xmid=j.xmbm 
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.qdzh) >= ${lx.qdzh} and ${lx.zdzh} >= to_number(l.zdzh)) or 
	    	(to_number(l.zdzh) >= ${lx.zdzh} and ${lx.zdzh} >= to_number(l.qdzh))
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		<foreach collection="ylx" item="item">
			union all
			<![CDATA[
			select lx.xmid,jh.xmmc,#{item.lxbm} as lxbm,lx.lxmc as lxmc,#{item.qdzh} as qdzh,#{item.zdzh} as zdzh,
			lx.lxbm as ylxbm,
			case when to_number(lx.qdzh)<=${item.yqdzh} then to_char(${item.yqdzh}) else to_char(lx.qdzh) end yqdzh ,
			case when to_number(lx.zdzh)>=${item.yzdzh} then to_char(${item.yzdzh}) else to_char(lx.zdzh) end  yzdzh,
			lx.xjsdj as xjsdj,lx.jsjsdj as jsjsdj
			from lxsh_lx lx,jhsh_sjgz jh where jh.xmbm=lx.xmid and lx.lxbm like '%'||#{item.ylxbm}||'%'
	        and (((to_number(lx.zdzh) >= ${item.yqdzh} and ${item.yqdzh} >= to_number(lx.qdzh)) or 
		    (to_number(lx.zdzh) >= ${item.yzdzh} and ${item.yzdzh} >= to_number(lx.qdzh))) or
		    (to_number(lx.qdzh) = ${item.yqdzh} or to_number(lx.zdzh) = ${item.yzdzh}))
		    and (to_number(lx.qdzh) != ${item.yzdzh} and to_number(lx.zdzh) != ${item.yqdzh})
	        ]]>
		</foreach>
		union all
		select l.xmid,j.xmmc,l.lxbm,l.lxmc,l.qdzh,l.zdzh,'' ylxbm,'' yqdzh, '' yzdzh,'' xjsdj,l.jsjsdj from lxsh_lx l right join jhsh_xj j on l.xmid=j.xmbm 
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.qdzh) >= ${lx.qdzh} and ${lx.zdzh} >= to_number(l.zdzh)) or 
	    	(to_number(l.zdzh) >= ${lx.zdzh} and ${lx.zdzh} >= to_number(l.qdzh))
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		<foreach collection="ylx" item="item">
			union all
			<![CDATA[
			select lx.xmid,jh.xmmc,#{item.lxbm} as lxbm,lx.lxmc as lxmc,#{item.qdzh} as qdzh,#{item.zdzh} as zdzh,
			lx.lxbm as ylxbm,
			case when to_number(lx.qdzh)<=${item.yqdzh} then to_char(${item.yqdzh}) else to_char(lx.qdzh) end yqdzh ,
			case when to_number(lx.zdzh)>=${item.yzdzh} then to_char(${item.yzdzh}) else to_char(lx.zdzh) end  yzdzh,
			lx.xjsdj as xjsdj,lx.jsjsdj as jsjsdj
			from lxsh_lx lx,jhsh_xj jh where jh.xmbm=lx.xmid and lx.lxbm like '%'||#{item.ylxbm}||'%'
	        and (((to_number(lx.zdzh) >= ${item.yqdzh} and ${item.yqdzh} >= to_number(lx.qdzh)) or 
		    (to_number(lx.zdzh) >= ${item.yzdzh} and ${item.yzdzh} >= to_number(lx.qdzh))) or
		    (to_number(lx.qdzh) = ${item.yqdzh} or to_number(lx.zdzh) = ${item.yzdzh}))
		    and (to_number(lx.qdzh) != ${item.yzdzh} and to_number(lx.zdzh) != ${item.yqdzh})
	        ]]>
		</foreach>
	</select> -->
	<select id="queryLsjlListwnxmk" parameterType="java.util.Map" resultType="lx">
		select distinct tab.* from (
		select  l.xmid,xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,'改建' xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj,decode(cl.qdzh, null, l.qdzh, cl.qdzh) jsqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) jszdzh,${lx.qdzh} xmqd,${lx.zdzh} xmzd from lx_clsd1 cl right join wnjh_lx l on cl.id=l.id right join wnjh_sjgz j on l.xmid=j.id 
		where l.lxbm like '%'||#{lx.lxbm}||'%' 
		and (${lx.zdzh} > ((case when (select f_str_or_num(l.qdzh) from dual)=1 then 9999 else to_number(l.qdzh) end))  
		 and ((case when (select f_str_or_num(l.zdzh) from dual)=1 then 0 else to_number(l.zdzh) end)) > ${lx.qdzh} )  
	     and (((case when (select f_str_or_num(l.qdzh) from dual)=1 then 9999 else to_number(l.qdzh) end))!=${lx.zdzh}) and (((case when (select f_str_or_num(l.zdzh) from dual)=1 then 0 else to_number(l.zdzh) end))!=${lx.qdzh})
		
	    
	    union all 
	    
		select l.xmid,xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,'路面改造' xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj,decode(cl.qdzh, null, l.qdzh, cl.qdzh) jsqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) jszdzh,${lx.qdzh} xmqd,${lx.zdzh} xmzd from lx_clsd1 cl right join wnjh_lx l on cl.id=l.id right join wnjh_lmgz j on l.xmid=j.id 
		where l.lxbm like '%'||#{lx.lxbm}||'%' 
		and (${lx.zdzh} > ((case when (select f_str_or_num(l.qdzh) from dual)=1 then 9999 else to_number(l.qdzh) end))  
		 and ((case when (select f_str_or_num(l.zdzh) from dual)=1 then 0 else to_number(l.zdzh) end)) > ${lx.qdzh} )  
	     and (((case when (select f_str_or_num(l.qdzh) from dual)=1 then 9999 else to_number(l.qdzh) end))!=${lx.zdzh}) and (((case when (select f_str_or_num(l.zdzh) from dual)=1 then 0 else to_number(l.zdzh) end))!=${lx.qdzh})
		
	    union all 
	    
		select l.xmid,xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,'新建' xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj,decode(cl.qdzh, null, l.qdzh, cl.qdzh) jsqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) jszdzh,${lx.qdzh} xmqd,${lx.zdzh} xmzd from lx_clsd1 cl right join wnjh_lx l on cl.id=l.id right join wnjh_xj j on l.xmid=j.id 
		where l.lxbm like '%'||#{lx.lxbm}||'%' 
		and (${lx.zdzh} > ((case when (select f_str_or_num(l.qdzh) from dual)=1 then 9999 else to_number(l.qdzh) end))  
		 and ((case when (select f_str_or_num(l.zdzh) from dual)=1 then 0 else to_number(l.zdzh) end)) > ${lx.qdzh} )  
	     and (((case when (select f_str_or_num(l.qdzh) from dual)=1 then 9999 else to_number(l.qdzh) end))!=${lx.zdzh}) and (((case when (select f_str_or_num(l.zdzh) from dual)=1 then 0 else to_number(l.zdzh) end))!=${lx.qdzh})
		
	    
	   and (to_number(l.qdzh)!=${lx.zdzh}) and (to_number(l.zdzh)!=${lx.qdzh})
	   <foreach collection="ylx" item="item">
	   union all
	   select  l.xmid,xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,'改建' xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj,decode(cl.qdzh, null, l.qdzh, cl.qdzh) jsqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) jszdzh,${item.qdzh} xmqd,${item.zdzh} xmzd from lx_clsd1 cl right join wnjh_lx l on cl.id=l.id right join wnjh_sjgz j on l.xmid=j.id 
		where l.lxbm like '%'||#{item.lxbm}||'%' 
		and (${item.zdzh} > ((case when (select f_str_or_num(l.qdzh) from dual)=1 then 9999 else to_number(l.qdzh) end))  
		 and ((case when (select f_str_or_num(l.zdzh) from dual)=1 then 0 else to_number(l.zdzh) end)) > ${item.qdzh} )  
	     and (((case when (select f_str_or_num(l.qdzh) from dual)=1 then 9999 else to_number(l.qdzh) end))!=${item.zdzh}) and (((case when (select f_str_or_num(l.zdzh) from dual)=1 then 0 else to_number(l.zdzh) end))!=${item.qdzh})
		
	    union all 
		select l.xmid,xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,'路面改造' xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj,decode(cl.qdzh, null, l.qdzh, cl.qdzh) jsqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) jszdzh,${item.qdzh} xmqd,${item.zdzh} xmzd from lx_clsd1 cl right join wnjh_lx l on cl.id=l.id right join wnjh_lmgz j on l.xmid=j.id 
		where l.lxbm like '%'||#{item.lxbm}||'%' 
		and (${item.zdzh} > ((case when (select f_str_or_num(l.qdzh) from dual)=1 then 9999 else to_number(l.qdzh) end))  
		 and ((case when (select f_str_or_num(l.zdzh) from dual)=1 then 0 else to_number(l.zdzh) end)) > ${item.qdzh} )  
	     and (((case when (select f_str_or_num(l.qdzh) from dual)=1 then 9999 else to_number(l.qdzh) end))!=${item.zdzh}) and (((case when (select f_str_or_num(l.zdzh) from dual)=1 then 0 else to_number(l.zdzh) end))!=${item.qdzh})
		
	    union all 
		select l.xmid,xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,'新建' xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj,decode(cl.qdzh, null, l.qdzh, cl.qdzh) jsqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) jszdzh,${item.qdzh} xmqd,${item.zdzh} xmzd from lx_clsd1 cl right join wnjh_lx l on cl.id=l.id right join wnjh_xj j on l.xmid=j.id 
		where l.lxbm like '%'||#{item.lxbm}||'%' 
		and (${item.zdzh} > ((case when (select f_str_or_num(l.qdzh) from dual)=1 then 9999 else to_number(l.qdzh) end))  
		 and ((case when (select f_str_or_num(l.zdzh) from dual)=1 then 0 else to_number(l.zdzh) end)) > ${item.qdzh} )  
	     and (((case when (select f_str_or_num(l.qdzh) from dual)=1 then 9999 else to_number(l.qdzh) end))!=${item.zdzh}) and (((case when (select f_str_or_num(l.zdzh) from dual)=1 then 0 else to_number(l.zdzh) end))!=${item.qdzh})
		
	   </foreach>
	   
	)tab
	
		
	    order by xmnf desc
	</select>
	
	<select id="queryLsjlListserw" parameterType="java.util.Map" resultType="lx">
		select distinct tab.* from(
	select distinct l.xmid,substr(l.xmid,0,4) xmnf,lx.jsxz,decode(substr(l.xmid,11,1),'1',(select xmmc from jhsh_sjgz where xmbm=l.xmid),
		'2',(select xmmc from jhsh_lmgz where xmbm=l.xmid),
		'3',(select xmmc from jhsh_xj where xmbm=l.xmid),
		'4',(select xmmc from jhsh_yhdzx where xmbm=l.xmid),
		'5',(select xmmc from jhsh_sh where xmbm=l.xmid)
		) xmmc,
		l.ghlxbm lxbm,l.ghlxmc lxmc,l.qcqd qdzh,l.qczd zdzh,decode(l.lxbm, null, lx.lxbm, l.lxbm) ylxbm,decode(l.qdzh, null, lx.qdzh, l.qdzh) yqdzh,decode(l.zdzh, null, lx.zdzh, l.zdzh) yzdzh,lx.jsxz  xjsdj,lx.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',lx.jsjsdj,lx.xjsdj) jsjsdj,l.qcqd jsqdzh,l.qczd jszdzh,${lx.qdzh} xmqd,${lx.zdzh} xmzd from lx_clsd l left join lxsh_lx lx on l.id=lx.id
		where 1=1 and lx.jdbs='2'
		and l.ghlxbm like '%'||#{lx.lxbm}||'%'
		and to_number(l.qczd) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qcqd)
		<if test="lx.xmid!=null and lx.xmid!=''">and lx.xmid!=#{lx.xmid}</if>
	union all
	select distinct l.xmid,substr(l.xmid,0,4) xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,j.gcfl xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj,decode(cl.qdzh, null, l.qdzh, cl.qdzh) jsqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) jszdzh,${lx.qdzh} xmqd,${lx.zdzh} xmzd from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_yhdzx j on l.xmid=j.xmbm right join cbsj_yhdzx c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(cl.qdzh)) 
	    )
	   
<!-- 	    to_number(l.qdzh)&lt;${lx.zdzh} and to_number(l.zdzh)>${lx.qdzh} -->
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		
		union all
		select distinct l.xmid,substr(l.xmid,0,4) xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj,decode(cl.qdzh, null, l.qdzh, cl.qdzh) jsqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) jszdzh,${lx.qdzh} xmqd,${lx.zdzh} xmzd from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_sh j on l.xmid=j.xmbm right join cbsj_sh c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(cl.qdzh)) 
	    )
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		union all
		select distinct l.xmid,substr(l.xmid,0,4) xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj,decode(cl.qdzh, null, l.qdzh, cl.qdzh) jsqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) jszdzh,${lx.qdzh} xmqd,${lx.zdzh} xmzd from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_lmgz j on l.xmid=j.xmbm right join cbsj_lmgz c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(cl.qdzh)) 
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		union all
		select distinct l.xmid,substr(l.xmid,0,4) xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj,decode(cl.qdzh, null, l.qdzh, cl.qdzh) jsqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) jszdzh,${lx.qdzh} xmqd,${lx.zdzh} xmzd from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_sjgz j on l.xmid=j.xmbm right join cbsj_sjgz c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qdzh))
			or
			(to_number(cl.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(cl.qdzh)) 
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		union all
		select distinct l.xmid,substr(l.xmid,0,4) xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj,decode(cl.qdzh, null, l.qdzh, cl.qdzh) jsqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) jszdzh,${lx.qdzh} xmqd,${lx.zdzh} xmzd from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_xj j on l.xmid=j.xmbm right join cbsj_xj c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(cl.qdzh)) 
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		<foreach collection="ylx" item="item">
		union all
		select distinct l.xmid,substr(l.xmid,0,4) xmnf,lx.jsxz,decode(substr(l.xmid,11,1),'1',(select xmmc from jhsh_sjgz where xmbm=l.xmid),
		'2',(select xmmc from jhsh_lmgz where xmbm=l.xmid),
		'3',(select xmmc from jhsh_xj where xmbm=l.xmid),
		'4',(select xmmc from jhsh_yhdzx where xmbm=l.xmid),
		'5',(select xmmc from jhsh_sh where xmbm=l.xmid)
		) xmmc,
		l.ghlxbm lxbm,l.ghlxmc lxmc,l.qcqd qdzh,l.qczd zdzh,decode(l.lxbm, null, lx.lxbm, l.lxbm) ylxbm,decode(l.qdzh, null, lx.qdzh, l.qdzh) yqdzh,decode(l.zdzh, null, lx.zdzh, l.zdzh) yzdzh,lx.jsxz  xjsdj,lx.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',lx.jsjsdj,lx.xjsdj) jsjsdj,l.qcqd jsqdzh,l.qczd jszdzh,${item.qdzh} xmqd,${item.zdzh} xmzd from lx_clsd l left join lxsh_lx lx on l.id=lx.id
		where 1=1 and lx.jdbs='2'
		and l.ghlxbm like '%'||#{item.lxbm}||'%'
		and to_number(l.qczd) > ${item.qdzh} and ${item.zdzh} > to_number(l.qcqd)
	union all
	select distinct l.xmid,substr(l.xmid,0,4) xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,j.gcfl xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj,decode(cl.qdzh, null, l.qdzh, cl.qdzh) jsqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) jszdzh,${item.qdzh} xmqd,${item.zdzh} xmzd from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_yhdzx j on l.xmid=j.xmbm right join cbsj_yhdzx c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{item.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(cl.qdzh)) 
	    )
	   
<!-- 	    to_number(l.qdzh)&lt;${item.zdzh} and to_number(l.zdzh)>${item.qdzh} -->
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{item.xmid}</if>
		
		union all
		select distinct l.xmid,substr(l.xmid,0,4) xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj,decode(cl.qdzh, null, l.qdzh, cl.qdzh) jsqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) jszdzh,${item.qdzh} xmqd,${item.zdzh} xmzd from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_sh j on l.xmid=j.xmbm right join cbsj_sh c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{item.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(cl.qdzh)) 
	    )
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{item.xmid}</if>
		union all
		select distinct l.xmid,substr(l.xmid,0,4) xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj,decode(cl.qdzh, null, l.qdzh, cl.qdzh) jsqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) jszdzh,${item.qdzh} xmqd,${item.zdzh} xmzd from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_lmgz j on l.xmid=j.xmbm right join cbsj_lmgz c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{item.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(cl.qdzh)) 
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{item.xmid}</if>
		union all
		select distinct l.xmid,substr(l.xmid,0,4) xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj,decode(cl.qdzh, null, l.qdzh, cl.qdzh) jsqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) jszdzh,${item.qdzh} xmqd,${item.zdzh} xmzd from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_sjgz j on l.xmid=j.xmbm right join cbsj_sjgz c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{item.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(l.qdzh))
			or
			(to_number(cl.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(cl.qdzh)) 
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{item.xmid}</if>
		union all
		select distinct l.xmid,substr(l.xmid,0,4) xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj,decode(cl.qdzh, null, l.qdzh, cl.qdzh) jsqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) jszdzh,${item.qdzh} xmqd,${item.zdzh} xmzd from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_xj j on l.xmid=j.xmbm right join cbsj_xj c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{item.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(cl.qdzh)) 
	    )
		</foreach>
		
	) tab
	 order by xmid desc
	</select>
	
	
	
	<select id="queryLsjlList" parameterType="java.util.Map" resultType="lx">
		select distinct tab.* from(
	select distinct l.xmid,substr(l.xmid,0,4) xmnf,lx.jsxz,decode(substr(l.xmid,11,1),'1',(select xmmc from jhsh_sjgz where xmbm=l.xmid),
		'2',(select xmmc from jhsh_lmgz where xmbm=l.xmid),
		'3',(select xmmc from jhsh_xj where xmbm=l.xmid),
		'4',(select xmmc from jhsh_yhdzx where xmbm=l.xmid),
		'5',(select xmmc from jhsh_sh where xmbm=l.xmid)
		) xmmc,
		l.ghlxbm lxbm,l.ghlxmc lxmc,l.qcqd qdzh,l.qczd zdzh,decode(l.lxbm, null, lx.lxbm, l.lxbm) ylxbm,decode(l.qdzh, null, lx.qdzh, l.qdzh) yqdzh,decode(l.zdzh, null, lx.zdzh, l.zdzh) yzdzh,lx.jsxz  xjsdj,lx.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',lx.jsjsdj,lx.xjsdj) jsjsdj from lx_clsd l left join lxsh_lx lx on l.id=lx.id
		where 1=1 and lx.jdbs='2'
		and l.ghlxbm like '%'||#{lx.lxbm}||'%'
		and to_number(l.qczd) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qcqd)
	union all
	select distinct l.xmid,substr(l.xmid,0,4) xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,j.gcfl xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_yhdzx j on l.xmid=j.xmbm right join cbsj_yhdzx c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qdzh))
			or
			(to_number(cl.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(cl.qdzh))  
	    )
	    
<!-- 	    to_number(l.qdzh)&lt;${lx.zdzh} and to_number(l.zdzh)>${lx.qdzh} -->
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		
		union all
		select distinct l.xmid,substr(l.xmid,0,4) xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_sh j on l.xmid=j.xmbm right join cbsj_sh c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(cl.qdzh)) 
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		union all
		select distinct l.xmid,substr(l.xmid,0,4) xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_lmgz j on l.xmid=j.xmbm right join cbsj_lmgz c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(cl.qdzh)) 
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		union all
		select distinct l.xmid,substr(l.xmid,0,4) xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_sjgz j on l.xmid=j.xmbm right join cbsj_sjgz c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qdzh))
			or
			(to_number(cl.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(cl.qdzh)) 
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		union all
		select distinct l.xmid,substr(l.xmid,0,4) xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_xj j on l.xmid=j.xmbm right join cbsj_xj c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(cl.qdzh)) 
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		
	) tab
	 order by xmid desc
	</select>
	
	<select id="queryyhdzxcb" parameterType="xmsq" resultType="xmsq">
		select * from cbsj_yhdzx where xmbm in (${xmbm})
	</select>
	
	<select id="queryyhdzxsfdj" parameterType="String" resultType="xmsq">
		select 
		(select lfmdj from XTGL_YHDZXCS where clmc='沥青混凝土面层') lqhntmcdj,
		(select lfmdj from XTGL_YHDZXCS where clmc='改性沥青混凝土面层') gxlqhntmcdj,
		(select lfmdj from XTGL_YHDZXCS where clmc='水泥混凝土面层') snhntmcdj,
		(select lfmdj from XTGL_YHDZXCS where clmc='沥青路面就地热再生') lqlmjdrzsdj,
		(select lfmdj from XTGL_YHDZXCS where clmc='沥青路面场拌热再生') lqlmcbrzsdj,
		(select lfmdj from XTGL_YHDZXCS where clmc='水稳基层') swjcdj,
		(select lfmdj from XTGL_YHDZXCS where clmc='沥青路面泡沫沥青就地冷再生') lqlmpmlqjdlzsdj,
		(select lfmdj from XTGL_YHDZXCS where clmc='沥青路面乳化沥青就地冷再生') lqlmrhlqjdlzsdj,
		(select lfmdj from XTGL_YHDZXCS where clmc='沥青路面场拌冷再生') lqlmcblzsdj,
		(select lfmdj from XTGL_YHDZXCS where clmc='新做柔性基层') xzrxjcdj,
		(select lfmdj from XTGL_YHDZXCS where clmc='水稳基层冷再生') swjclzsdj,
		(select lfmdj from XTGL_YHDZXCS where clmc='下封层') xfcdj,
		(select lfmdj from XTGL_YHDZXCS where clmc='挖除水泥面板') wcsnmbdj,
		(select lfmdj from XTGL_YHDZXCS where clmc='挖除水稳基层') wcswjcdj,
		(select lfmdj from XTGL_YHDZXCS where clmc='水泥混凝土面层换板') snhntmchbdj,
		(select lfmdj from XTGL_YHDZXCS where clmc='标线（二级及以下公路）') bxerdj,
		(select lfmdj from XTGL_YHDZXCS where clmc='标线（一级公路）') bxyidj,
		(select lfmdj from XTGL_YHDZXCS where clmc='水泥混凝土面层碎石化') snhntmcsshdj
		from dual
	</select>
	
	<select id="queryYhdzxExport1" parameterType="xmsq" resultType="elist">
	
 select rownum v_0,tb.* from (
    select 
   RemoveSameStr(func_splitstr(lx.ghlxbm, ','),',') v_1,
    x.xmbm v_2,x.xmmc v_3,
    decode(instr(RemoveSameStr(lx.ylxbm,','),','),0,RemoveSameStr(lx.ylxbm,','),lx.ylxbm) v_4,
    decode(instr(RemoveSameStr(lx.ylxmc,','),','),0,RemoveSameStr(lx.ylxmc,','),lx.ylxmc) v_5,
    lx.qdzh v_6,lx.zdzh v_7,
    decode(instr(RemoveSameStr(lx.ghlxbm,','),','),0,RemoveSameStr(lx.ghlxbm,','),lx.ghlxbm) v_8,
    decode(instr(RemoveSameStr(lx.ghlxmc,','),','),0,RemoveSameStr(lx.ghlxmc,','),lx.ghlxmc) v_9,
    lx.ghqdzh v_10,lx.ghzdzh v_11,
    decode(instr(RemoveSameStr(lx.gxlxbm,','),','),0,RemoveSameStr(lx.gxlxbm,','),lx.gxlxbm) v_12,
     lx.gxqdzh v_13,lx.gxzdzh v_14,to_char(lx.zjhlc,'fm999990.09999') v_15,
     RemoveSameStr(replace(xjsdjtj,'、',','),',') v_16,
     RemoveSameStr(decode(lx.lxlmkd,null,x.lmkd,0,x.lmkd,lx.lxlmkd),',') v_17,
     x.ylmlx v_18,x.ylmjg v_19,x.gcfl v_20,x.jsfa v_21,
     to_char(lx.sbzj,'fm999990.09999') v_22,x.ntz v_23,c.sjpfwh v_24,x.gydw v_25,
    RemoveSameStr(decode(lx.lxlmkd,null,x.lmkd,0,x.lmkd,lx.lxlmkd),',') v_26, x.bz v_27,
    (decode(x.lsjl,'是',( select replace(WMSYS.WM_CONCAT(distinct decode(substr(xmbm,11,1),4,xdnf||xmlx,xdnf||xmmc)),',',',') from all_lsjl where 1=1 and length(xmbm)=14 and x.lsxmbm like '%'||xmbm||'%'),' ')) v_28
    
    from xmsq_yhdzx x 
    left join (select sjpfwh,xmbm from cbsj_yhdzx ) c on x.xmbm=c.xmbm 
    left join (
    select xmid,sum(jhlc) zjhlc,sum(sbzj) sbzj,
              replace(WMSYS.WM_CONCAT(distinct(lxlmkd)),',',',') lxlmkd,
              replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
              replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
              replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
              replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,
             replace(max(qdzh), ',.', ',0.') qdzh,replace(max(zdzh), ',.', ',0.') zdzh,replace(max(ghqdzh), ',.', ',0.') ghqdzh,replace(max(ghzdzh), ',.', ',0.') ghzdzh,
             replace(max(gxqdzh), ',.', ',0.') gxqdzh,replace(max(gxzdzh), ',.', ',0.') gxzdzh,
             max(ghlxbm) ghlxbm,max(ylxbm) ylxbm,max(ghlxmc) ghlxmc,max(ylxmc) ylxmc,max(gxlxbm) gxlxbm
              from (select  xmid,jsxz,sbzj,lxlmkd,
              (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
              
              else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
              end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
              else ''
              end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj,
               WMSYS.WM_CONCAT(ghlxmc)over( PARTITION BY xmid ORDER BY id,ghlxmc) ghlxmc,
               WMSYS.WM_CONCAT(lxmc)over( PARTITION BY xmid ORDER BY id,lxmc) ylxmc,
               WMSYS.WM_CONCAT(ghlxbm)over( PARTITION BY xmid ORDER BY id,ghlxbm) ghlxbm,
               WMSYS.WM_CONCAT(lxbm)over( PARTITION BY xmid ORDER BY id,lxbm) ylxbm,
               WMSYS.WM_CONCAT((case when qdzh like '.%' then 0||qdzh when qdzh like '%,.%' then replace(qdzh, ',.', ',0.') else qdzh end ))over( PARTITION BY xmid ORDER BY id,qdzh) qdzh,
               WMSYS.WM_CONCAT((case when zdzh like '.%' then 0||zdzh when zdzh like '%,.%' then replace(zdzh, ',.', ',0.') else zdzh end ))over( PARTITION BY xmid ORDER BY id,zdzh) zdzh,
               WMSYS.WM_CONCAT((case when ghqdzh like '.%' then 0||ghqdzh when ghqdzh like '%,.%' then replace(ghqdzh, ',.', ',0.') else ghqdzh end ))over( PARTITION BY xmid ORDER BY id,ghqdzh) ghqdzh,
               WMSYS.WM_CONCAT((case when ghzdzh like '.%' then 0||ghzdzh when ghzdzh like '%,.%' then replace(ghzdzh, ',.', ',0.') else ghzdzh end ))over( PARTITION BY xmid ORDER BY id,ghzdzh) ghzdzh,
               WMSYS.WM_CONCAT(gxlxbm)over( PARTITION BY xmid ORDER BY id,gxlxbm) gxlxbm,
               WMSYS.WM_CONCAT((case when gxqdzh like '.%' then 0||gxqdzh when gxqdzh like '%,.%' then replace(gxqdzh, ',.', ',0.') else gxqdzh end ))over( PARTITION BY xmid ORDER BY id,gxqdzh) gxqdzh,
               WMSYS.WM_CONCAT((case when gxzdzh like '.%' then 0||gxzdzh when gxzdzh like '%,.%' then replace(gxzdzh, ',.', ',0.') else gxzdzh end ))over( PARTITION BY xmid ORDER BY id,gxzdzh) gxzdzh
              from LXSH_LX  where jdbs='1') group by xmid
    ) lx on x.xmbm=lx.xmid
        where 1=1
				<if test="gydwdm!=null and gydwdm!=''">and ${gydwdm}</if>
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="xmmc!=null and xmmc!=''">and xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xmbm!=null and xmbm!=''">and x.xmbm like '%'||#{xmbm}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="sqzt>=0">and sqzt=${sqzt}</if>
				<if test="xmnf!=null and xmnf!=''">and ${xmnf}</if>
				<if test="tsdq!=null and tsdq!=''">${tsdq}</if>
				<if test="lsjl!=null and lsjl!=''">and x.lsjl=#{lsjl}</if>
				<if test="ylxbh!=null and ylxbh!=''">
					and x.xmbm in (select xmid from lxsh_lx lx where ${ylxbh} and xmid like '%4___')
				</if>
				<if test="wnxmk!=null and wnxmk!=''">
					and x.wnxmk like '%'||#{wnxmk}||'%' 
				</if>
				
				<if test="lxmc!=null and lxmc!=''">
					and lx.lxmc like '%'||#{lxmc}||'%' 
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghlxbm!=null and ghlxbm!=''">
					and x.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
				</if>
				<if test="ghlxmc!='' and ghlxmc!= null ">
					and (x.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')

					)
				</if>
				<if test="lsxmnf !='' and lsxmnf != null ">
					${lsxmnf}
				</if>
				<if test="lsxmlx !='' and lsxmlx != null ">
					${lsxmlx}
				</if>
				<if test="gcfl!=null and gcfl!=''">and ${gcfl}</if>
		order by x.xmbm
	) tb
	
	</select>
	<select id="getghxx1" parameterType="xmsq" resultType="xmsq">
		select xmid,WMSYS.WM_CONCAT(distinct ghlxbm||'('||qcqd||','||qczd||')') ghlxbm from LX_CLSD1 t where xmid=#{xmbm} and cfld='是' group by xmid
	</select>
	<select id="getghxx2" parameterType="xmsq" resultType="xmsq">
		select xmid,WMSYS.WM_CONCAT(distinct ghlxbm||'('||qcqd||','||qczd||')') ghlxbm from LX_CLSD t where xmid=#{xmbm} and cfld='是' group by xmid
	</select>
	<select id="getghxxbyone1" parameterType="xmsq" resultType="xmsq">
		select distinct xmid,WMSYS.WM_CONCAT(distinct ghlxbm) ghlxbm,WMSYS.WM_CONCAT(distinct qcqd) ghqdzh,WMSYS.WM_CONCAT(distinct qczd) ghzdzh from LX_CLSD1 t 
		where 1=1
		and xmid=#{xmbm} 
		and qdzh=#{qdzh}
		and zdzh=#{zdzh}
		group by xmid
	</select>
	<select id="getghxxbyone2" parameterType="xmsq" resultType="xmsq">
		select distinct xmid,WMSYS.WM_CONCAT(distinct ghlxbm) ghlxbm,WMSYS.WM_CONCAT(distinct qcqd) ghqdzh,WMSYS.WM_CONCAT(distinct qczd) ghzdzh from LX_CLSD t 
		where 1=1
		and xmid=#{xmbm} 
		and qdzh=#{qdzh}
		and zdzh=#{zdzh}
		group by xmid
	</select>
	
	<select id="getghlxinfo" parameterType="xmsq" resultType="xmsq">
		
	select t.*,abs(to_number(qdzh)-to_number(zdzh)) lc,
	(case when to_number(yqdzh)&lt;to_number(yzdzh) then to_number(xqdzh)+to_number(qdzh)-to_number(yqdzh)
          else to_number(yqdzh)-to_number(qdzh)+to_number(xqdzh)
     end ) qd,
     (case when to_number( yqdzh)&lt;to_number(yzdzh) then to_number(xzdzh)-(to_number(yzdzh)-to_number(zdzh))
          else to_number(xzdzh)-(to_number(zdzh)-to_number(yzdzh))
     end ) zd from(
    select 
    ylxbm,yqdzh,yzdzh,xlxbm,xqdzh,xzdzh,xlxmc,cfld,
    (case when to_number( yqdzh)&lt;to_number(yzdzh) and to_number(yqdzh)&lt;=to_number(#{qdzh}) then to_number(#{qdzh})
          when to_number( yqdzh)&lt;to_number(yzdzh) and to_number(yqdzh)>to_number(#{qdzh}) then to_number(yqdzh)
          when to_number( yqdzh)>to_number(yzdzh) and to_number(yzdzh)>to_number(#{qdzh}) then to_number(yzdzh)
          when to_number( yqdzh)>to_number(yzdzh) and to_number(yzdzh)&lt;=to_number(#{qdzh}) then to_number(#{qdzh})
     end ) qdzh,
    (case when to_number( yqdzh)&lt;to_number(yzdzh) and to_number(yzdzh)&lt;=to_number(#{zdzh}) then to_number(yzdzh)
          when to_number( yqdzh)&lt;to_number(yzdzh) and to_number(yzdzh)>to_number(#{zdzh}) then to_number(#{zdzh})
          when to_number( yqdzh)>to_number(yzdzh) and to_number(yqdzh)>to_number(#{zdzh}) then to_number(#{zdzh})
          when to_number( yqdzh)>to_number(yzdzh) and to_number(yqdzh)&lt;=to_number(#{zdzh}) then to_number(yqdzh)
     end ) zdzh
     from ghlx g where g.ylxbm like #{ylxbm}||'%'||#{xzqh}||'%' 
    and (case when to_number(g.yqdzh)&lt;to_number(g.yzdzh) then to_number(g.yqdzh) else to_number(g.yzdzh) end)&lt;(case when to_number(#{qdzh})&lt;to_number(#{zdzh}) then to_number(#{zdzh}) else to_number(#{qdzh}) end) 
 	and (case when to_number(g.yqdzh)&lt;to_number(g.yzdzh) then to_number(g.yzdzh) else to_number(g.yqdzh) end)>(case when to_number(#{qdzh})&lt;to_number(#{zdzh}) then to_number(#{qdzh}) else to_number(#{zdzh}) end) 
 
    )t order by (case when to_number(yzdzh)>to_number(yqdzh) AND to_number(zdzh)>to_number(qdzh) then '1' when to_number(yqdzh)>to_number(yzdzh) AND to_number(qdzh)>to_number(zdzh) then '2' else '3' end),decode(lc,null,0,lc) desc
	
	
	</select>
	<select id="getylxinfo" parameterType="xmsq" resultType="xmsq">
		select * from ghlx where xlxbm like #{ylxbm}||'%'||#{xzqh}||'%' and to_number(xzdzh)>to_number(#{qdzh}) and to_number(#{zdzh})>to_number(xqdzh)
		
	</select>
	<select id="getylxlminfo" parameterType="xmsq" resultType="lx">
	
		<![CDATA[
		select max(f116) ylmlx,round(min(to_number(f018)),2) lmkd,min(lxmc) lxmc
		from (select substr(f114,1,2) f114,f014,max(f116) f116,min(to_number(f018)) f018,min(roadname) lxmc
		from (select g.roadcode,to_char(decode(g.f114,null,'无路',g.f114)) f114,f014,f116,f018,roadname,
		case when g.roadstart < ${qdzh} then ${qdzh} when g.roadstart > ${qdzh} then g.roadstart when g.roadstart = ${qdzh} then g.roadstart end roadstart,
		case when g.roadends < ${zdzh} then g.roadends when g.roadends > ${zdzh} then ${zdzh} when g.roadends = ${zdzh} then g.roadends end roadends from gpsroad g
		where substr(g.roadcode, 1, 1) in ('G', 'S', 'X', 'Y', 'C', 'Z') and g.roadcode like #{lxbm} || '%'
		and ((g.roadstart <= ${qdzh} and ${qdzh} < g.roadends) or (g.roadstart > ${qdzh} and g.roadends < ${zdzh}) or (g.roadstart < ${zdzh} and g.roadends >= ${zdzh})))
		group by f114,f014 order by f014)
		]]>
	</select>
	
	<select id="getgxlxinfo" parameterType="xmsq" resultType="xmsq">
		select * from table(fun_cfld(#{ylxbm},${qdzh},${zdzh}))
	</select>
	
	<select id="getylxinfo1" parameterType="xmsq" resultType="xmsq">
		select ylxbm,(
		case when to_number(yzdzh)>to_number(yqdzh)
		 then 
		 to_number(#{qdzh})-to_number(xqdzh)+to_number(yqdzh)
		 else
		 to_number(#{zdzh})-to_number(xzdzh)+to_number(yqdzh)
		  end
		) yqdzh,(
		case when to_number(yzdzh)>to_number(yqdzh)
		 then 
		 to_number(#{qdzh})-to_number(xqdzh)+to_number(yqdzh)+to_number(#{zdzh})-to_number(#{qdzh})
		 else
		 to_number(#{zdzh})-to_number(xzdzh)+to_number(yqdzh)-(to_number(#{zdzh})-to_number(#{qdzh}))
		  end
		) yzdzh,xlxbm,xqdzh,xzdzh from ghlx where xlxbm like #{ylxbm}||'%'||#{xzqh}||'%' and to_number(xzdzh)>to_number(#{qdzh}) and to_number(#{zdzh})>to_number(xqdzh)
		
	</select>
	<select id="queryLsjlxxxmbm" parameterType="xmsq" resultType="xmsq">
		select decode(cfbm,null,'否','是') lsjl,cfbm lsxmbm,cfid lsxmid from  table(fun_xbzls(#{xmbm},#{ylxbh},#{qdzh},#{zdzh}))
		union all
		select decode(cfbm,null,'否','是') lsjl,cfbm lsxmbm,cfid lsxmid from  table(fun_cfld(#{ylxbh},#{qdzh},#{zdzh})) t1,table(fun_xbzls(#{xmbm},t1.lxbm,t1.qdzh,t1.zdzh)) t2
	</select>
	<select id="queryLsjlxx" parameterType="xmsq" resultType="lx">
		select distinct xmlx,xmmc,xmbm from jhsh_lsjl where id in(${lsxmid})
	</select>
	<select id="querysfwnxmkxmbm" parameterType="xmsq" resultType="lx">
		select decode(cfbm,null,'否','是') wnxmk,cfbm wnxmbm,cfid wnxmid,'' wnnfxz from  table(fun_xwnxm(substr(#{xmbm},5,4),#{ylxbh},#{qdzh},#{zdzh}))
		union all
		select decode(cfbm,null,'否','是') wnxmk,cfbm wnxmbm,cfid wnxmid,'' wnnfxz from  table(fun_cfld(#{ylxbh},#{qdzh},#{zdzh})) t1,table(fun_xwnxm(substr(#{xmbm},5,4),t1.lxbm,t1.qdzh,t1.zdzh)) t2
	</select>
	<select id="querysflsjlxmbm" parameterType="xmsq" resultType="lx">
		select decode(cfbm,null,'否','是') lsjl,cfbm lsxmbm,cfid lsxmid from  table(fun_xbzls(#{xmbm},#{ylxbh},#{qdzh},#{zdzh}))
		union all
		select decode(cfbm,null,'否','是') lsjl,cfbm lsxmbm,cfid lsxmid from  table(fun_cfld(#{ylxbh},#{qdzh},#{zdzh})) t1,table(fun_xbzls(#{xmbm},t1.lxbm,t1.qdzh,t1.zdzh)) t2
	
	</select>
	<select id="queryLxbyxmsq" parameterType="xmsq" resultType="lx">
		select * from ${bz} and xmid=#{xmbm}
	</select>
	<select id="querysfwnlsjlxmbm" parameterType="xmsq" resultType="lx">
		select decode(cfbm,null,'否','是') lsjl,cfbm lsxmbm,cfid lsxmid from  table(fun_xwnls(substr(#{xzqhdm},0,4),#{xmbm},#{ylxbh},#{qdzh},#{zdzh}))
		union all
		select decode(cfbm,null,'否','是') lsjl,cfbm lsxmbm,cfid lsxmid from  table(fun_cfld(#{ylxbh},#{qdzh},#{zdzh})) t1,table(fun_xwnls(substr(#{xzqhdm},0,4),#{xmbm},t1.lxbm,t1.qdzh,t1.zdzh)) t2
	</select>
	
</mapper>
