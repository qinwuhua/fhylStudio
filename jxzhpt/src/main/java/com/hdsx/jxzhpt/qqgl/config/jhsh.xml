<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.jhsh">
 <select id="querySzxmList" parameterType="jhsh" resultType="hashMap">
       
      select * from (
      select rownum num,jh.*,sz.XMKID,sz.XLXBM,sz.XLXMC,sz.YLXBM,sz.YLXMC,sz.sz.XZQHDM xzqhdm2,sz.XZQH,sz.GHQDZH,sz.GHZDZH,sz.YQDZH,sz.YZDZH,sz.JSDJ,sz.ZLC,sz.XMLX,sz.XLXZH,sz.LLXZH,sz.XYSSLX,sz.sz.FWNR,sz.ZDMJ,sz.BZ,sz.sz.JSSSLX,sz.YDBMC
   	  ,sg.pfwh
      ${tiaojian}
      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="gydw !='' and gydw != null">${gydw}</if>
      <if test="jhxdwh !='' and jhxdwh != null">${jhxdwh}</if>
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="scxdnf !='' and scxdnf != null">${scxdnf}</if>
      <if test="xmmc !='' and xmmc != null">and jh.xmmc like '%${xmmc}%'</if>
      <if test="ghlxbm !='' and ghlxbm != null">and sz.xlxbm like '%${ghlxbm}%'</if>
      <if test="ghlxmc !='' and ghlxmc != null">and sz.xlxmc like '%${ghlxmc}%'</if>
      <if test="ylxbm !='' and ylxbm != null">and sz.ylxbm like '%${ylxbm}%'</if>
      <if test="ylxmc !='' and ylxmc != null">and sz.ylxmc like '%${ylxmc}%'</if>
      <if test="sbzt !='' and sbzt != null">and jh.sbzt like '%${sbzt}%'</if>
      <if test="shzt !='' and shzt != null">and jh.shzt like '%${shzt}%'</if>
      <if test="xdzttj !='' and xdzttj != null">and jh.xdzt like '%${xdzttj}%'</if>
       
      and rownum &lt;=(#{page} * #{rows})  
      ) t 
      where t.num>(#{page}-1)*#{rows}
    </select>
    <select id="querySzxmListCount" parameterType="jhsh" resultType="int">
      select count(*)
      ${tiaojian}
      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="gydw !='' and gydw != null">${gydw}</if>
      <if test="jhxdwh !='' and jhxdwh != null">${jhxdwh}</if>
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="scxdnf !='' and scxdnf != null">${scxdnf}</if>
      <if test="xmmc !='' and xmmc != null">and jh.xmmc like '%${xmmc}%'</if>
      <if test="ghlxbm !='' and ghlxbm != null">and sz.xlxbm like '%${ghlxbm}%'</if>
      <if test="ghlxmc !='' and ghlxmc != null">and sz.xlxmc like '%${ghlxmc}%'</if>
      <if test="ylxbm !='' and ylxbm != null">and sz.ylxbm like '%${ylxbm}%'</if>
      <if test="ylxmc !='' and ylxmc != null">and sz.ylxmc like '%${ylxmc}%'</if>
      <if test="sbzt !='' and sbzt != null">and jh.sbzt like '%${sbzt}%'</if>
      <if test="shzt !='' and shzt != null">and jh.shzt like '%${shzt}%'</if>
      <if test="xdzttj !='' and xdzttj != null">and jh.xdzt like '%${xdzttj}%'</if>
        
    </select>

	<select id="queryJhshLjSzxm" parameterType="jhsh" resultType="hashMap">
      select count(*) xmsl
      ${tiaojian}
      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="gydw !='' and gydw != null">${gydw}</if>
      <if test="jhxdwh !='' and jhxdwh != null">${jhxdwh}</if>
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="scxdnf !='' and scxdnf != null">${scxdnf}</if>
      <if test="xmmc !='' and xmmc != null">and jh.xmmc like '%${xmmc}%'</if>
      <if test="ghlxbm !='' and ghlxbm != null">and sz.xlxbm like '%${ghlxbm}%'</if>
      <if test="ghlxmc !='' and ghlxmc != null">and sz.xlxmc like '%${ghlxmc}%'</if>
      <if test="ylxbm !='' and ylxbm != null">and sz.ylxbm like '%${ylxbm}%'</if>
      <if test="ylxmc !='' and ylxmc != null">and sz.ylxmc like '%${ylxmc}%'</if>
      <if test="sbzt !='' and sbzt != null">and jh.sbzt like '%${sbzt}%'</if>
      <if test="shzt !='' and shzt != null">and jh.shzt like '%${shzt}%'</if>
      <if test="xdzttj !='' and xdzttj != null">and jh.xdzt like '%${xdzttj}%'</if>    
    </select>


<!--  -->

    <select id="queryszxm" parameterType="jhsh" resultType="hashMap">
       
      select * from (
      select rownum num,s.*
      ${tiaojian}
      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="gydw !='' and gydw != null">${gydw}</if>
      <if test="jhxdwh !='' and jhxdwh != null">${jhxdwh}</if>
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="xmmc !='' and xmmc != null">and xmmc like '%${xmmc}%'</if>
      <if test="ghlxbm !='' and ghlxbm != null">and ghlxbm like '%${ghlxbm}%'</if>
      <if test="ghlxmc !='' and ghlxmc != null">and ghlxmc like '%${ghlxmc}%'</if>
      <if test="ylxbm !='' and ylxbm != null">and ylxbm like '%${ylxbm}%'</if>
      <if test="ylxmc !='' and ylxmc != null">and ylxmc like '%${ylxmc}%'</if>
      <if test="sbzt !='' and sbzt != null">and sbzt like '%${sbzt}%'</if>
      <if test="shzt !='' and shzt != null">and shzt like '%${shzt}%'</if>
      <if test="xdzttj !='' and xdzttj != null">and xdzt like '%${xdzttj}%'</if>
      
      and rownum &lt;=(#{page} * #{rows})  
      ) t 
      where t.num>(#{page}-1)*#{rows}
    </select>
    <select id="queryszxmCount" parameterType="jhsh" resultType="int">
      select count(*)
      ${tiaojian}
      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="gydw !='' and gydw != null">${gydw}</if>
      <if test="jhxdwh !='' and jhxdwh != null">${jhxdwh}</if>
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="xmmc !='' and xmmc != null">and xmmc like '%${xmmc}%'</if>
      <if test="ghlxbm !='' and ghlxbm != null">and ghlxbm like '%${ghlxbm}%'</if>
      <if test="ghlxmc !='' and ghlxmc != null">and ghlxmc like '%${ghlxmc}%'</if>
      <if test="ylxbm !='' and ylxbm != null">and ylxbm like '%${ylxbm}%'</if>
      <if test="ylxmc !='' and ylxmc != null">and ylxmc like '%${ylxmc}%'</if>
      <if test="sbzt !='' and sbzt != null">and sbzt like '%${sbzt}%'</if>
      <if test="shzt !='' and shzt != null">and shzt like '%${shzt}%'</if>
      <if test="xdzttj !='' and xdzttj != null">and xdzt like '%${xdzttj}%'</if>
        
    </select>
    <select id="queryszxmlj" parameterType="jhsh" resultType="hashMap">
      select count(*) xmsl,nvl(sum(ztz),0) ztz
      ${tiaojian}
      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="gydw !='' and gydw != null">${gydw}</if>
      <if test="jhxdwh !='' and jhxdwh != null">${jhxdwh}</if>
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="xmmc !='' and xmmc != null">and xmmc like '%${xmmc}%'</if>
      <if test="ghlxbm !='' and ghlxbm != null">and ghlxbm like '%${ghlxbm}%'</if>
      <if test="ghlxmc !='' and ghlxmc != null">and ghlxmc like '%${ghlxmc}%'</if>
      <if test="ylxbm !='' and ylxbm != null">and ylxbm like '%${ylxbm}%'</if>
      <if test="ylxmc !='' and ylxmc != null">and ylxmc like '%${ylxmc}%'</if>
      <if test="sbzt !='' and sbzt != null">and sbzt like '%${sbzt}%'</if>
      <if test="shzt !='' and shzt != null">and shzt like '%${shzt}%'</if>
      <if test="xdzttj !='' and xdzttj != null">and xdzt like '%${xdzttj}%'</if>
       
    </select>
    
    
    
    <!-- *服务区* -->
    <!-- 查询服务区所有信息 -->
    <select id="listFwq" parameterType="jhsh" resultType="jhsh">
       
      select * from (
      select rownum num,ss.xmbm, ss.xlxbm, ss.pfwh, ss.xzh, ss.lzh, ss.sjpfdw, ss.sjpfsj, ss.zyjsnr, ss.gcsl, js.ztz,
      js.cgs, js.dfzc, js.zydpx, js.xzqh, js.sbzt,js.xdzt
      FROM SGT_fwq ss
      left join jhsh_fwq js on ss.xmbm = js.xmbm
      left join wnjh_fwq wn on ss.xmkid=wn.id
      where 1 = 1 and ss.shzt='已审核'
      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="xmmc !='' and xmmc != null">and xmmc like '%${xmmc}%'</if>
      <if test="lxmc !='' and lxmc != null">and lxmc like '%${lxmc}%'</if>
      <if test="xmbm !='' and xmbm != null">and xmbm like '%${xmbm}%'</if>
      <if test="sbzt !='' and sbzt != null">and sbzt like '%${sbzt}%'</if>
      
      and rownum &lt;=(#{page} * #{rows})  
      ) t 
      where t.num>(#{page}-1)*#{rows}
    </select>
    <select id="listFwqCount" parameterType="jhsh" resultType="int">
      select count(*)
      FROM SGT_fwq ss
      left join jhsh_fwq js on ss.xmbm = js.xmbm
      left join wnjh_fwq wn on ss.xmkid=wn.id
      where 1 = 1 and ss.shzt='已审核'
      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="xmmc !='' and xmmc != null">and xmmc like '%${xmmc}%'</if>
      <if test="lxmc !='' and lxmc != null">and lxmc like '%${lxmc}%'</if>
      <if test="xmbm !='' and xmbm != null">and xmbm like '%${xmbm}%'</if>
      <if test="sbzt !='' and sbzt != null">and sbzt like '%${sbzt}%'</if>
        
    </select>
    <select id="queryJhshLjfwqsb" parameterType="jhsh" resultType="hashMap">
      select count(*) xmsl,nvl(sum(js.ztz),0) ztz,nvl(sum(tbz),0) tbz,nvl(sum(dfzc),0) dfzc
      FROM SGT_fwq ss
      left join jhsh_fwq js on ss.xmbm = js.xmbm
      left join wnjh_fwq wn on ss.xmkid=wn.id
      where 1 = 1 and ss.shzt='已审核'
      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="xmmc !='' and xmmc != null">and xmmc like '%${xmmc}%'</if>
      <if test="lxmc !='' and lxmc != null">and lxmc like '%${lxmc}%'</if>
      <if test="xmbm !='' and xmbm != null">and xmbm like '%${xmbm}%'</if>
      <if test="sbzt !='' and sbzt != null">and sbzt like '%${sbzt}%'</if>
        
    </select>
    
    
    <!-- 查询服务区中上报状态为“已上报”的状态 -->
    <select id="listFwqSbzt" parameterType="jhsh" resultType="jhsh">
       select * from (
	     select rownum num,ss.xmbm, ss.xlxbm, ss.pfwh, ss.xzh, ss.lzh, ss.sjpfdw, ss.sjpfsj, ss.zyjsnr, ss.gcsl, js.ztz,
	     js.cgs, js.dfzc, js.zydpx, js.xzqh, js.sbzt,js.xdzt
	     FROM SGT_fwq ss
	     left join jhsh_fwq js on ss.xmbm = js.xmbm
	     left join wnjh_fwq wn on ss.xmkid=wn.id
	     where 1 = 1 and ss.shzt='已审核' and sbzt='1'
	     <if test="xzqh !='' and xzqh != null">${xzqh}</if>
	     <if test="xmnf !='' and xmnf != null">${xmnf}</if>
	     <if test="xmmc !='' and xmmc != null">and xmmc like '%${xmmc}%'</if>
	     <if test="lxmc !='' and lxmc != null">and lxmc like '%${lxmc}%'</if>
	     <if test="xmbm !='' and xmbm != null">and xmbm like '%${xmbm}%'</if>
	     <if test="sbzt !='' and sbzt != null">and sbzt like '%${sbzt}%'</if>
	     and rownum &lt;=(#{page} * #{rows})  
	     ) t 
	     where t.num>(#{page}-1)*#{rows}
    </select>
    
    <select id="listFwqSbztCount" parameterType="jhsh" resultType="int">
      select count(*)
      FROM SGT_fwq ss
      left join jhsh_fwq js on ss.xmbm = js.xmbm
      left join wnjh_fwq wn on ss.xmkid=wn.id
      where 1 = 1 and ss.shzt='已审核' and sbzt='1'
      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="xmmc !='' and xmmc != null">and xmmc like '%${xmmc}%'</if>
      <if test="lxmc !='' and lxmc != null">and lxmc like '%${lxmc}%'</if>
      <if test="xmbm !='' and xmbm != null">and xmbm like '%${xmbm}%'</if>
      <if test="sbzt !='' and sbzt != null">and sbzt like '%${sbzt}%'</if>
        
    </select>
    <select id="queryJhshLjfwqsh" parameterType="jhsh" resultType="hashMap">
      select count(*) xmsl,nvl(sum(js.ztz),0) ztz,nvl(sum(tbz),0) tbz,nvl(sum(dfzc),0) dfzc
      FROM SGT_fwq ss
      left join jhsh_fwq js on ss.xmbm = js.xmbm
      left join wnjh_fwq wn on ss.xmkid=wn.id
      where 1 = 1 and ss.shzt='已审核' and sbzt='1'
      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="xmmc !='' and xmmc != null">and xmmc like '%${xmmc}%'</if>
      <if test="lxmc !='' and lxmc != null">and lxmc like '%${lxmc}%'</if>
      <if test="xmbm !='' and xmbm != null">and xmbm like '%${xmbm}%'</if>
      <if test="sbzt !='' and sbzt != null">and sbzt like '%${sbzt}%'</if>
        
    </select>
    
    
    <!-- 查询服务区中上报上报状态为“已上报”并且下达状态（审批状态）为“已审批”的状态 -->
    <select id="listFwqXdzt" parameterType="jhsh" resultType="jhsh">
       select * from (
	     select rownum num,ss.xmbm, ss.xlxbm, ss.pfwh, ss.xzh, ss.lzh, ss.sjpfdw, ss.sjpfsj, ss.zyjsnr, ss.gcsl, js.ztz,
	     js.cgs, js.dfzc, js.zydpx, js.xzqh, js.sbzt,js.xdzt
	     FROM SGT_fwq ss
	     left join jhsh_fwq js on ss.xmbm = js.xmbm
	     left join wnjh_fwq wn on ss.xmkid=wn.id
	     where 1 = 1 and ss.shzt='已审核' and xdzt='1'
	     <if test="xzqh !='' and xzqh != null">${xzqh}</if>
	     <if test="xmnf !='' and xmnf != null">${xmnf}</if>
	     <if test="xmmc !='' and xmmc != null">and xmmc like '%${xmmc}%'</if>
	     <if test="lxmc !='' and lxmc != null">and lxmc like '%${lxmc}%'</if>
	     <if test="xmbm !='' and xmbm != null">and xmbm like '%${xmbm}%'</if>
	     <if test="sbzt !='' and sbzt != null">and sbzt like '%${sbzt}%'</if>
	     and rownum &lt;=(#{page} * #{rows})  
	     ) t 
	     where t.num>(#{page}-1)*#{rows}
    </select>
    
    <select id="listFwqXdztCount" parameterType="jhsh" resultType="int">
      select count(*)
      FROM SGT_fwq ss
      left join jhsh_fwq js on ss.xmbm = js.xmbm
      left join wnjh_fwq wn on ss.xmkid=wn.id
      where 1 = 1 and ss.shzt='已审核'  and xdzt='1'
      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="xmmc !='' and xmmc != null">and xmmc like '%${xmmc}%'</if>
      <if test="lxmc !='' and lxmc != null">and lxmc like '%${lxmc}%'</if>
      <if test="xmbm !='' and xmbm != null">and xmbm like '%${xmbm}%'</if>
      <if test="sbzt !='' and sbzt != null">and sbzt like '%${sbzt}%'</if>
        
    </select>
    <select id="queryJhshLjfwqxd" parameterType="jhsh" resultType="hashMap">
      select count(*) xmsl,nvl(sum(js.ztz),0) ztz,nvl(sum(tbz),0) tbz,nvl(sum(dfzc),0) dfzc
      FROM SGT_fwq ss
      left join jhsh_fwq js on ss.xmbm = js.xmbm
      left join wnjh_fwq wn on ss.xmkid=wn.id
      where 1 = 1 and ss.shzt='已审核'  and xdzt='1'
      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="xmmc !='' and xmmc != null">and xmmc like '%${xmmc}%'</if>
      <if test="lxmc !='' and lxmc != null">and lxmc like '%${lxmc}%'</if>
      <if test="xmbm !='' and xmbm != null">and xmbm like '%${xmbm}%'</if>
      <if test="sbzt !='' and sbzt != null">and sbzt like '%${sbzt}%'</if>
        
    </select>
    <!-- 根据Id查询服务区数据 -->
    <select id="queryFwqById" parameterType="jhsh" resultType="jhsh">
       SELECT * FROM jhsh_fwq jf WHERE jf.id = #{id}
    </select>
    <!-- 更新服务区数据 -->
     <update id="updateFwq" parameterType="jhsh">
	  update jhsh_fwq jf
		<set>
		  <if test="ztz!=null">ztz=#{ztz},</if>
		  <if test="cgs!=null">cgs=#{cgs},</if>
		  <if test="dfzc!=null">dfzc=#{dfzc},</if>
		  <if test="zydpx!=null">zydpx=#{zydpx},</if>
		  <if test="sbzt!=null">sbzt=#{sbzt},</if>
		  <if test="xdzt!=null">xdzt=#{xdzt}</if>
		</set>
	  where jf.id=#{id}
	</update>
	<update id="fwqXmth" parameterType="jhsh">
        update jhsh_fwq jf set jf.sbzt='0', jf.thyy=#{thyy} where jf.id=#{id}
    </update>
    <!-- #服务区# -->
    
    <select id="queryYhzxshJhxd" parameterType="jhsh" resultType="jhsh">
       select * from jhsh_yhzx jy where jy.sbzt='1' and jy.xdzt='1'
    </select>
    <select id="queryYhzxshYap" parameterType="jhsh" resultType="jhsh">
       select * from jhsh_yhzx jy where jy.sbzt='1'
    </select>
    <!-- 根据id查询综合养护中心信息 -->
    <select id="queryYhzxshById" parameterType="jhsh" resultType="jhsh">
       SELECT * FROM jhsh_yhzx jy WHERE jy.id = #{id}
    </select>
    <!-- 更新综合养护中心信息 -->
     <update id="updateZhzxsh" parameterType="jhsh">
	  update jhsh_yhzx
		<set>
		  <if test="ztz!=null">ztz=#{ztz},</if>
		  <if test="jbzj!=null">jbzj=#{jbzj},</if>
		  <if test="dfzc!=null">dfzc=#{dfzc},</if>
		  <if test="zydpx!=null">zydpx=#{zydpx},</if>
		  <if test="sbzt!=null">sbzt=#{sbzt},</if>
		  <if test="xdzt!=null">xdzt=#{xdzt}</if>
		</set>
	  where id=#{id}
	</update>
	
	<update id="yhzxshXmth" parameterType="jhsh">
        update jhsh_yhzx jy set jy.sbzt='0', jy.thyy=#{thyy} where jy.id=#{id}
    </update>
    <!-- 综合养护中心 -->
    <select id="queryYhzxshSb" parameterType="jhsh" resultType="jhsh">
           select * from jhsh_yhzx where 1 = 1
    </select>
    
    <!-- 更改示范路工程审批状态 -->
    <update id="updateSflgcXdzt" parameterType="jhsh">
        update jhsh_sfl js set js.xdzt='0' where js.id=#{id}
    </update>
    <!-- 示范路 -->
    <update id="sflgcXmth" parameterType="jhsh">
        update jhsh_sfl js set js.sbzt='0', js.thyy=#{thyy} where js.id=#{id}
    </update>
    <!-- 示范路下达查询计划编号 -->
    <select id="querySflgcXdJhbz" parameterType="jhsh" resultType="jhsh">
SELECT js.xmbm, ss.xlxbm, js.xzqh, ss.pfwh, ss.xqdzh, ss.xzdzh, js.xdsj, ss.sjpfdw, ss.sjpfsj, ss.zyjsnr, ss.gcsl,
(case when pz.xmid is null then '未完成'
      when nvl(js.ztz, 0) = nvl(pz.ztz, 0) and
           nvl(js.dfzc, 0) = nvl(pz.dfzc, 0) and
           nvl(js.tbz, 0) = nvl(pz.tbz, 0) then '已完成'
      else '未完成' end) xdzttj, 
(nvl(js.ztz, 0) - nvl(pz.ztz, 0)) ztz,
(nvl(js.tbz, 0) - nvl(pz.tbz, 0)) stz,
(nvl(js.dfzc, 0) - nvl(pz.dfzc, 0)) dfzc              
FROM jhsh_sfl js
LEFT JOIN SGT_SFL ss ON js.xmbm = ss.xmbm
LEFT JOIN (SELECT xmid, SUM(ztz) ztz, SUM(stz) tbz, SUM(dfzc) dfzc
FROM plan_zjxd GROUP BY xmid) pz ON js.xmbm = pz.xmid
    </select>
    <!-- 示范路下达查询 -->
    <select id="querySflgcXdXmlb" parameterType="jhsh" resultType="jhsh">
       select * from jhsh_sfl sfl where sfl.sbzt='1' and sfl.xdzt='1'
    </select>
    <!-- 示范路预安排查询 -->
    <select id="querySflgcYap" parameterType="jhsh" resultType="jhsh">
       select * from jhsh_sfl sfl where sfl.sbzt='1'
    </select>
    <!-- 根据项目编号查询示范路工程数据 -->
    <select id="querySflgcByXmbm" parameterType="jhsh" resultType="jhsh">
       SELECT * FROM jhsh_sfl sfl WHERE sfl.xmbm = #{xmbm}
    </select>
    
    <!-- 示范路工程查询Jhsh_sfl -->
    <select id="querySflgc" parameterType="jhsh" resultType="jhsh">
      
      select * from (
      select rownum num,ss.xmbm, ss.xlxbm, ss.pfwh, ss.xqdzh, ss.xzdzh, ss.sjpfdw, ss.sjpfsj, ss.zyjsnr, ss.gcsl, js.ztz,
      js.tbz, js.tbz_jaf, js.tbz_gcjlf, js.tbz_qqgzf, js.dfzc, js.zydpx, js.sbzt,js.xdzt
      FROM SGT_SFL ss
      left join jhsh_sfl js on ss.xmbm = js.xmbm
      left join wnjh_sfl wn on ss.xmkid=wn.id
      where 1 = 1 and ss.shzt='已审核'
      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="xmmc !='' and xmmc != null">and xmmc like '%${xmmc}%'</if>
      <if test="lxmc !='' and lxmc != null">and lxmc like '%${lxmc}%'</if>
      <if test="xmbm !='' and xmbm != null">and xmbm like '%${xmbm}%'</if>
      <if test="sbzt !='' and sbzt != null">and sbzt like '%${sbzt}%'</if>
      
      and rownum &lt;=(#{page} * #{rows})  
      ) t 
      where t.num>(#{page}-1)*#{rows}
        
    </select>
	<select id="querySflgcCount" parameterType="jhsh" resultType="int">
      select count(*)
      FROM SGT_SFL ss
      left join jhsh_sfl js on ss.xmbm = js.xmbm
      left join wnjh_sfl wn on ss.xmkid=wn.id
      where 1 = 1 and ss.shzt='已审核'
      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="xmmc !='' and xmmc != null">and xmmc like '%${xmmc}%'</if>
      <if test="lxmc !='' and lxmc != null">and lxmc like '%${lxmc}%'</if>
      <if test="xmbm !='' and xmbm != null">and xmbm like '%${xmbm}%'</if>
      <if test="sbzt !='' and sbzt != null">and sbzt like '%${sbzt}%'</if>
        
    </select>
    <select id="queryJhshLjsflsb" parameterType="jhsh" resultType="hashMap">
      select count(*) xmsl,nvl(sum(js.ztz),0) ztz,nvl(sum(tbz),0) tbz,nvl(sum(dfzc),0) dfzc
      FROM SGT_SFL ss
      left join jhsh_sfl js on ss.xmbm = js.xmbm
      left join wnjh_sfl wn on ss.xmkid=wn.id
      where 1 = 1 and ss.shzt='已审核'
      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="xmmc !='' and xmmc != null">and xmmc like '%${xmmc}%'</if>
      <if test="lxmc !='' and lxmc != null">and lxmc like '%${lxmc}%'</if>
      <if test="xmbm !='' and xmbm != null">and xmbm like '%${xmbm}%'</if>
      <if test="sbzt !='' and sbzt != null">and sbzt like '%${sbzt}%'</if>
        
    </select>
    
    
    <!-- 示范路更新Jhsh_sfl -->
    <update id="updateJhshSflgc" parameterType="jhsh">
	  update jhsh_sfl
		<set>
		  <if test="xmbm!=null">xmbm=#{xmbm},</if>
		  <if test="ztz!=null">ztz=#{ztz},</if>
		  <if test="tbz!=null">tbz=#{tbz},</if>
		  <if test="tbz_jaf!=null">tbz_jaf=#{tbz_jaf},</if>
		  <if test="tbz_gcjlf!=null">tbz_gcjlf=#{tbz_gcjlf},</if>
		  <if test="tbz_qqgzf!=null">tbz_qqgzf=#{tbz_qqgzf},</if>
		  <if test="dfzc!=null">dfzc=#{dfzc},</if>
		  <if test="zydpx!=null">zydpx=#{zydpx}</if>
		</set>
	  where xmbm=#{xmbm}
	</update>
        
	<insert id="insertJhshLmsjFromCbsj" parameterType="java.util.List">
		<!-- insert into jhsh_sjgz (id,xmbm,xmmc, xzqh, qdzh, zdzh, kgsj, wgsj, gq, gkpfwh, sjpfwh,jszlc)
		select sys_guid(),c.xmbm,c.xmmc,c.xzqh,c.qdzh,c.zdzh,c.kgsj,c.wgsj,c.gq,k.gkpfwh,c.sjpfwh,c.jszlc
		from cbsj_sjgz c left join kxxyj_sjgz k on c.xmbm=k.xmbm where c.xmbm=#{xmbm} -->
		update jhsh_sjgz j set xmmc=(select xmmc from cbsj_sjgz c where c.xmbm=#{xmbm}), 
	     xzqh=(select xzqh from cbsj_sjgz c where c.xmbm=#{xmbm}),
	     qdzh=(select qdzh from cbsj_sjgz c where c.xmbm=#{xmbm}),
	     zdzh=(select zdzh from cbsj_sjgz c where c.xmbm=#{xmbm}),
	     kgsj=(select kgsj from cbsj_sjgz c where c.xmbm=#{xmbm}),
	     wgsj=(select wgsj from cbsj_sjgz c where c.xmbm=#{xmbm}),
	     gq=(select gq from cbsj_sjgz c where c.xmbm=#{xmbm}),
	     sjpfwh=(select sjpfwh from cbsj_sjgz c where c.xmbm=#{xmbm}),
	     jszlc=(select jszlc from cbsj_sjgz c where c.xmbm=#{xmbm})
	    where j.xmbm=#{xmbm}	
	</insert>
	
	<insert id="insertJhshLmgzFromCbsj" parameterType="java.util.List">
		<!-- insert into jhsh_lmgz (id,xmbm,xmmc, xzqh, qdzh, zdzh, kgsj, wgsj, gq, gkpfwh, sjpfwh)
		select sys_guid(),c.xmbm,c.xmmc,c.xzqh,c.qdzh,c.zdzh,c.kgsj,c.wgsj,c.gq,k.gkpfwh,c.sjpfwh
		from cbsj_lmgz c left join kxxyj_lmgz k on c.xmbm=k.xmbm where c.xmbm=#{xmbm} -->
		update jhsh_lmgz j set xmmc=(select xmmc from cbsj_lmgz c where c.xmbm=#{xmbm}), 
	     xzqh=(select xzqh from cbsj_lmgz c where c.xmbm=#{xmbm}),
	     qdzh=(select qdzh from cbsj_lmgz c where c.xmbm=#{xmbm}),
	     zdzh=(select zdzh from cbsj_lmgz c where c.xmbm=#{xmbm}),
	     kgsj=(select kgsj from cbsj_lmgz c where c.xmbm=#{xmbm}),
	     wgsj=(select wgsj from cbsj_lmgz c where c.xmbm=#{xmbm}),
	     gq=(select gq from cbsj_lmgz c where c.xmbm=#{xmbm}),
	     sjpfwh=(select sjpfwh from cbsj_lmgz c where c.xmbm=#{xmbm}),
	    where j.xmbm=#{xmbm}
	</insert>
	<insert id="insertJhshXjFromCbsj" parameterType="java.util.List">
		<!-- insert into jhsh_xj (id,xmbm,xmmc, xzqh, qdzh, zdzh, kgsj, wgsj, gq, gkpfwh, sjpfwh)
		select sys_guid(),c.xmbm,c.xmmc,c.xzqh,c.qdzh,c.zdzh,c.kgsj,c.wgsj,c.gq,k.gkpfwh,c.sjpfwh
		from cbsj_xj c left join kxxyj_xj k on c.xmbm=k.xmbm where c.xmbm=#{xmbm} -->
		update jhsh_xj j set xmmc=(select xmmc from cbsj_xj c where c.xmbm=#{xmbm}), 
	     xzqh=(select xzqh from cbsj_xj c where c.xmbm=#{xmbm}),
	     qdzh=(select qdzh from cbsj_xj c where c.xmbm=#{xmbm}),
	     zdzh=(select zdzh from cbsj_xj c where c.xmbm=#{xmbm}),
	     kgsj=(select kgsj from cbsj_xj c where c.xmbm=#{xmbm}),
	     wgsj=(select wgsj from cbsj_xj c where c.xmbm=#{xmbm}),
	     gq=(select gq from cbsj_xj c where c.xmbm=#{xmbm}),
	     sjpfwh=(select sjpfwh from cbsj_xj c where c.xmbm=#{xmbm}),
	    where j.xmbm=#{xmbm}
	</insert>
	<insert id="insertJhshYhdzxFromCbsj" parameterType="cbsj">
		insert into jhsh_yhdzx (xmbm,xmmc,ylxbh,ghlxbh,gcfl,xzqh,xzqhdm,qdzh,zdzh,lc,jhkgsj,jhwgsj)
		select c.xmbm,c.xmmc,x.ylxbh,x.ghlxbh,x.gcfl,c.xzqh,x.xzqhdm,c.qdzh,c.zdzh,c.lc,c.kgsj,c.wgsj 
		from cbsj_yhdzx c left join xmsq_yhdzx x on c.xmbm=x.xmbm where c.xmbm in (${xmbm})
	</insert>
	<insert id="insertJhshShFromCbsj" parameterType="cbsj">
		insert into jhsh_sh (xmbm,xmmc,ylxbh,ghlxbh,gcfl,xzqh,xzqhdm,qdzh,zdzh,lc,jhkgsj,jhwgsj)
		select c.xmbm,c.xmmc,x.ylxbh,x.ghlxbh,x.gcfl,c.xzqh,x.xzqhdm,c.qdzh,c.zdzh,c.lc,c.kgsj,c.wgsj 
		from cbsj_sh c left join xmsq_sh x on c.xmbm=x.xmbm where c.xmbm in (${xmbm})
	</insert>
	
	<select id="queryJhshLmsj" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,l.ghlxbh,l.lsjl,l.gydw,lx.lc,sl.zlc,sl.xmsl xmsl from jhsh_sjgz j left join lxsh_sjgz l on j.xmbm=l.xmbm
				left join (select xmid,lc from lxsh_lx where jdbs='2' and xmid like '%1___' and sffirst=1) lx on j.xmbm = lx.xmid
				left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
				where 1=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh.ghlxbh}||'%')
				</if>
				<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh.ylxbh} and xmid like '%1___' and jdbs='2')
				</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and l.lsjl=#{jhsh.lsjl}</if>
				<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
				<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and ${jhsh.xmbm}</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xdzt>=0">and j.xdzt=${jhsh.xdzt}</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and l.lsjl=#{jhsh.lsjl}</if>
				order by j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryJhshLmsj1" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,l.ghlxbh,l.lsjl,l.gydw,lx.lc,sl.zlc,sl.xmsl xmsl from jhsh_sjgz_qx j left join lxsh_sjgz l on j.xmbm=l.xmbm
				left join (select xmid,lc from lxsh_lx where jdbs='2' and xmid like '%1___' and sffirst=1) lx on j.xmbm = lx.xmid
				left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
				where 1=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh.ghlxbh}||'%')
				</if>
				<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh.ylxbh} and xmid like '%1___' and jdbs='2')
				</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and l.lsjl=#{jhsh.lsjl}</if>
				<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
				<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and ${jhsh.xmbm}</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xdzt>=0">and j.xdzt=${jhsh.xdzt}</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and l.lsjl=#{jhsh.lsjl}</if>
				order by j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryJhshLmgz" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,l.ghlxbh,l.lsjl,l.gydw,lx.lc,sl.zlc,sl.xmsl xmsl from jhsh_lmgz j left join lxsh_lmgz l on j.xmbm=l.xmbm
				left join (select xmid,lc from lxsh_lx where jdbs='2' and xmid like '%2___' and sffirst=1) lx on j.xmbm = lx.xmid
				left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
				where 1=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">
					and ${jhsh.xzqhdm}
				</if>
				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh.ghlxbh}||'%')
				</if>
				<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh.ylxbh} and xmid like '%2___' and jdbs='2')
				</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">
					and l.lsjl=#{jhsh.lsjl}
				</if>
				<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">
					and l.tsdq like '%'||#{jhsh.tsdq}||'%'
				</if>
				<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">
					and ${jhsh.xmbm}
				</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">
					and ${jhsh.jsdj}
				</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">
					and j.xmmc like '%'||#{jhsh.xmmc}||'%'
				</if>
				<if test="jhsh.xdzt>=0">
					and j.xdzt=${jhsh.xdzt}
				</if>
				order by j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryJhshLmgz1" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,l.ghlxbh,l.lsjl,l.gydw,lx.lc,sl.zlc,sl.xmsl xmsl from jhsh_lmgz_qx j left join lxsh_lmgz l on j.xmbm=l.xmbm
				left join (select xmid,lc from lxsh_lx where jdbs='2' and xmid like '%2___' and sffirst=1) lx on j.xmbm = lx.xmid
				left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
				where 1=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">
					and ${jhsh.xzqhdm}
				</if>
				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh.ghlxbh}||'%')
				</if>
				<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh.ylxbh} and xmid like '%2___' and jdbs='2')
				</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">
					and l.lsjl=#{jhsh.lsjl}
				</if>
				<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">
					and l.tsdq like '%'||#{jhsh.tsdq}||'%'
				</if>
				<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">
					and ${jhsh.xmbm}
				</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">
					and ${jhsh.jsdj}
				</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">
					and j.xmmc like '%'||#{jhsh.xmmc}||'%'
				</if>
				<if test="jhsh.xdzt>=0">
					and j.xdzt=${jhsh.xdzt}
				</if>
				order by j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryJhshXj" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,l.ghlxbh,l.lsjl,l.gydw,lx.lc,sl.zlc,sl.xmsl from jhsh_xj j left join lxsh_xj l on j.xmbm=l.xmbm
				left join (select xmid,lc from lxsh_lx where jdbs='2' and xmid like '%3___' and sffirst=1) lx on j.xmbm = lx.xmid
				left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
				where 1=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh.ghlxbh}||'%')
				</if>
				<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh.ylxbh} and xmid like '%3___' and jdbs='2')
				</if>
				<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
				<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and ${jhsh.xmbm}</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xdzt>=0">and j.xdzt=${jhsh.xdzt}</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and l.lsjl=#{jhsh.lsjl}</if>
				order by j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryJhshXj1" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,l.ghlxbh,l.lsjl,l.gydw,lx.lc,sl.zlc,sl.xmsl from jhsh_xj_qx j left join lxsh_xj l on j.xmbm=l.xmbm
				left join (select xmid,lc from lxsh_lx where jdbs='2' and xmid like '%3___' and sffirst=1) lx on j.xmbm = lx.xmid
				left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
				where 1=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh.ghlxbh}||'%')
				</if>
				<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh.ylxbh} and xmid like '%3___' and jdbs='2')
				</if>
				<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
				<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and ${jhsh.xmbm}</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xdzt>=0">and j.xdzt=${jhsh.xdzt}</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and l.lsjl=#{jhsh.lsjl}</if>
				order by j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryJhshYhdzx" parameterType="jhsh" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,lxbm,qdzh1,zdzh1,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,to_char(lx.lc,'fm9999999990.000') jhlc,
				sl.zlc,sl.xmsl xmsl,lxg.ntz tz,lxg.jsdj,cb.sjpfwh,lxg.tsdq,lxg.lxmc
				,wh.bcxdwh bcxdwh,wh.bcxdsj bcxdsj,wh.bcztz,wh.bccgs,wh.bcstz
				 from jhxdyh j  left join (select xmbm,sjpfwh from cbsj_yhdzx) cb on j.xmbm=cb.xmbm  left join xmsq_yhdzx lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,lxbm,lxmc,qdzh qdzh1,zdzh zdzh1
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
		           left join (select j.xmid,
	                sum(j.btzzj) bcxd,
	              	replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
	              	replace(WMSYS.WM_CONCAT(j.xdnf),',',',') bcxdsj,
	             	sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  bcztz,
	             	nvl(sum(j.rys),0) + nvl(sum(j.dk),0) + nvl(sum(j.gz),0)+ nvl(sum(j.sz),0)+ nvl(sum(j.zq),0) bcstz,
	            	sum(j.btzzj) bccgs
	          		from jhxdyh g
	          		left join plan_zjxd j
	          		on g.xmbm = j.xmid
	         		where 1 = 1 
	         		<if test="jhxdwh !=null and jhxdwh !=''">
	         		${jhxdwh}  
	         		</if>
	         		group by j.xmid) wh on j.xmbm=wh.xmid
	            
	             where 1=1  and j.jhxdwh  like '%'
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')

				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and ${scxdnf} in (${xmnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
				order by <if test="zydpx=='升序'">to_number(j.zydpx),</if>
				<if test="zydpx=='降序'">to_number(j.zydpx) desc,</if>
				j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryJhshYhdzx_qx" parameterType="jhsh" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,lxbm,qdzh1,zdzh1,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,to_char(lx.lc,'fm9999999990.000') jhlc,sl.zlc,sl.xmsl xmsl,lxg.ntz tz,lxg.jsdj,cb.sjpfwh,lxg.tsdq,lxg.lxmc<if test="jhxdwh !=null and jhxdwh !=''">,wh.bcxdwh bcxdwh,wh.bcxdsj bcxdsj,wh.bcztz,wh.bccgs,wh.bcstz</if> from jhxdyh_qx j  left join (select xmbm,sjpfwh from cbsj_yhdzx) cb on j.xmbm=cb.xmbm  left join xmsq_yhdzx lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,lxbm,lxmc,qdzh qdzh1,zdzh zdzh1
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	             <if test="jhxdwh !=null and jhxdwh !=''">
		           left join (select j.xmid,
	                sum(j.btzzj) bcxd,
	              	replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
	              	replace(WMSYS.WM_CONCAT(j.xdnf),',',',') bcxdsj,
	             	sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  bcztz,
	             	nvl(sum(j.rys),0) + nvl(sum(j.dk),0) + nvl(sum(j.gz),0)+ nvl(sum(j.sz),0)+ nvl(sum(j.zq),0) bcstz,
	            	sum(j.btzzj) bccgs
	          		from jhxdyh g
	          		left join plan_zjxd j
	          		on g.xmbm = j.xmid
	         		where 1 = 1 ${jhxdwh}  group by j.xmid) wh on j.xmbm=wh.xmid
		        </if>
	              where 1=1 
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				<!-- <if test="ghxlxbm!=null and ghxlxbm!=''">
					and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
				</if> -->
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<!-- <if test="ghxlxmc !=null and ghxlxmc !=''">
					and ghxlxmctj like '%'||#{ghxlxmc}||'%'
				</if> -->
				
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(j.xmbm,0,4) in (${xmnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				order by <if test="zydpx=='升序'">j.zydpx,</if><if test="zydpx=='降序'">j.zydpx desc,</if>j.xdzt,j.xmbm desc
				
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	
	<select id="queryJhshYhdzx1" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,c.kgsj,c.wgsj,c.gq,l.lsjl,l.gydw,l.qdmc,l.zdmc,l.jsdj,sl.zlc,sl.xmsl 
				from jhsh_yhdzx_qx j left join cbsj_yhdzx c on j.xmbm=c.xmbm left join xmsq_yhdzx l on c.xmbm = l.xmbm
				left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
				where 1=1
				<if test="jhsh2.xzqhdm!=null and jhsh2.xzqhdm!=''">
					and ${jhsh2.xzqhdm}
				</if>
				<if test="jhsh2.ghlxbh!=null and jhsh2.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh2.ghlxbh}||'%')
				</if>
				<if test="jhsh2.ylxbh!=null and jhsh2.ylxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh2.ylxbh} and xmid like '%4___' and jdbs='2')
				</if>
				<if test="jhsh2.lsjl!=null and jhsh2.lsjl!=''">
					and l.lsjl=#{jhsh2.lsjl}
				</if>
				<if test="jhsh2.tsdq!=null and jhsh2.tsdq!=''">
					and l.tsdq like '%'||#{jhsh2.tsdq}||'%'
				</if>
				<if test="jhsh2.jsdj!=null and jhsh2.jsdj!=''">
					and ${jhsh2.jsdj}
				</if>
				<if test="jhsh2.xmbm!=null and jhsh2.xmbm!=''">
					and ${jhsh2.xmbm}
				</if>
				<if test="jhsh2.xmmc!=null and jhsh2.xmmc!=''">
					and j.xmmc like '%'||#{jhsh2.xmmc}||'%'
				</if>
				<if test="jhsh2.xdzt>=0">
					and j.xdzt=${jhsh2.xdzt}
				</if>
				order by j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryJhshSh" parameterType="jhsh" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,lxbm,qdzh1,zdzh1,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,to_char(lx.lc,'fm9999999990.000') jhlc,sl.zlc,sl.xmsl xmsl,lxg.jsdj,lxg.xzqh xzqhmc,cb.sjpfwh,lxg.tsdq,lxg.lxmc
				,wh.bcxdwh bcxdwh,wh.bcxdsj bcxdsj,j.pfztz bcztz,wh.bccgs,wh.stz bcstz 
				from jhxdsh j left join (select xmbm,sjpfwh from cbsj_sh) cb on j.xmbm=cb.xmbm  left join xmsq_sh lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx where jdbs='2' group by lx.xmid) l on j.xmbm=l.xmbm 
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,lxbm,lxmc,qdzh qdzh1,zdzh zdzh1
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	             left join (select j.xmid,
	                sum(j.btzzj) bcxd,
	              	replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
	              	replace(WMSYS.WM_CONCAT(j.xdnf),',',',') bcxdsj,
	             	sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  bcztz,
	             	nvl(sum(j.rys),0) + nvl(sum(j.dk),0) + nvl(sum(j.gz),0)+ nvl(sum(j.sz),0)+ nvl(sum(j.zq),0) bcstz,
	            	sum(j.btzzj) bccgs,sum(j.dk) stz
	          		from jhxdsh g
	          		left join plan_zjxd j
	          		on g.xmbm = j.xmid
	         		where 1 = 1 
	         		<if test="jhxdwh !=null and jhxdwh !=''">
	         		${jhxdwh}  
	         		</if>
	         		group by j.xmid) wh on j.xmbm=wh.xmid
		        
	              where 1=1 and j.jhxdwh  like '%'
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and ${scxdnf} in (${xmnf})
				</if>
				
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
				order by <if test="zydpx=='升序'">to_number(j.zydpx),</if><if test="zydpx=='降序'">to_number(j.zydpx) desc,</if>j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryJhshSh_qx" parameterType="jhsh" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,lxbm,qdzh1,zdzh1,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,to_char(lx.lc,'fm9999999990.000') jhlc,sl.zlc,sl.xmsl xmsl,lxg.jsdj,lxg.xzqh xzqhmc,cb.sjpfwh,lxg.tsdq,lxg.lxmc<if test="jhxdwh !=null and jhxdwh !=''">,wh.bcxdwh bcxdwh,wh.bcxdsj bcxdsj,wh.bcztz,wh.bccgs,wh.bcstz</if> from jhxdsh_qx j left join (select xmbm,sjpfwh from cbsj_sh) cb on j.xmbm=cb.xmbm  left join xmsq_sh lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx where jdbs='2' group by lx.xmid) l on j.xmbm=l.xmbm 
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,lxbm,lxmc,qdzh qdzh1,zdzh zdzh1
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	             <if test="jhxdwh !=null and jhxdwh !=''">
	             left join (select j.xmid,
	                sum(j.btzzj) bcxd,
	              	replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
	              	replace(WMSYS.WM_CONCAT(j.xdnf),',',',') bcxdsj,
	             	sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  bcztz,
	             	nvl(sum(j.rys),0) + nvl(sum(j.dk),0) + nvl(sum(j.gz),0)+ nvl(sum(j.sz),0)+ nvl(sum(j.zq),0) bcstz,
	            	sum(j.btzzj) bccgs
	          		from jhxdsh g
	          		left join plan_zjxd j
	          		on g.xmbm = j.xmid
	         		where 1 = 1 ${jhxdwh}  group by j.xmid) wh on j.xmbm=wh.xmid
		        </if>
	              where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				<!-- <if test="ghxlxbm!=null and ghxlxbm!=''">
					and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
				</if> -->
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<!-- <if test="ghxlxmc !=null and ghxlxmc !=''">
					and ghxlxmctj like '%'||#{ghxlxmc}||'%'
				</if> -->
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(j.xmbm,0,4) in (${xmnf})
				</if>
				
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				order by <if test="zydpx=='升序'">j.zydpx,</if><if test="zydpx=='降序'">j.zydpx desc,</if>j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryJhshSh_dc" parameterType="jhsh" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select decode(l_.sffirst,'1',j.xmbm,'') xmbm,decode(l_.sffirst,'1',j.xmmc,'') xmmc,decode(l_.sffirst,'1',j.xzqh,l_.xzqh) xzqh,j.jhkgsj kgsj,j.jhwgsj wgsj,decode(l_.sffirst,'1',j.lc,l_.lc) lc ,j.xdwh xdwh,j.xdsj,j.PFZTZ,j.SBZZJ,j.BBZZJ, l_.lxbm ylxbh ,l_.qdzh,l_.zdzh,l_.qdmc,l_.zdmc,sl.zlc,sl.xmsl xmsl,lxg.jsdj,lxg.xzqh xzqhmc,cb.sjpfwh,cb.gq,
				l_.lxmc,l_.ghlxbm,l_.ghlxmc,l_.ghqdzh,l_.ghzdzh,l_.gxlxbm,l_.gxqdzh,l_.gxzdzh
				 from jhxdsh j 
					left join (select xmbm,sjpfwh,gq from cbsj_sh) cb on j.xmbm=cb.xmbm 
					left join xmsq_sh lxg on j.xmbm=lxg.xmbm 
					left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx where jdbs='2' group by lx.xmid) l on j.xmbm=l.xmbm 
					left join (select xmid,jsxz, (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)) 
					 else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc from lxsh_lx where jdbs='2' 
					and sffirst='1' ) lx on j.xmbm=lx.xmid left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid 
					left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj, 
					replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj, replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj, replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,
					replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj from (select xmid,jsxz, (case when jsxsubstr(xmid,11,1)=1en to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)
					+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))  else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm else '' end)
					 ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj from LXSH_LX where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid 
					 right  join (select * from lxsh_lx lx where lx.jdbs='2') l_ on j.xmbm=l_.xmid 
	              where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and ghlxbmtj like '%'||#{ghlxbh}||'%'
				</if>
				<if test="ghxlxbm!=null and ghxlxbm!=''">
					and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
				</if>
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghxlxmc !=null and ghxlxmc !=''">
					and ghxlxmctj like '%'||#{ghxlxmc}||'%'
				</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(j.xmbm,0,4) in (${xmnf})
				</if>
				
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				order by j.xdzt,j.xmbm desc,l_.sffirst desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryJhshSh_qx_dc" parameterType="jhsh" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select decode(l_.sffirst,'1',j.xmbm,'') xmbm,decode(l_.sffirst,'1',j.xmmc,'') xmmc,decode(l_.sffirst,'1',j.xzqh,l_.xzqh) xzqh,j.jhkgsj kgsj,j.jhwgsj wgsj,decode(l_.sffirst,'1',j.lc,l_.lc) lc ,j.xdwh xdwh,j.xdsj,j.PFZTZ,j.SBZZJ,j.BBZZJ, l_.lxbm ylxbh ,l_.qdzh,l_.zdzh,l_.qdmc,l_.zdmc,sl.zlc,sl.xmsl xmsl,lxg.jsdj,lxg.xzqh xzqhmc,cb.sjpfwh,cb.gq,
				l_.lxmc,l_.ghlxbm,l_.ghlxmc,l_.ghqdzh,l_.ghzdzh,l_.gxlxbm,l_.gxqdzh,l_.gxzdzh
				 from jhxdsh_qx j 
					left join (select xmbm,sjpfwh,gq from cbsj_sh) cb on j.xmbm=cb.xmbm 
					left join xmsq_sh lxg on j.xmbm=lxg.xmbm 
					left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx where jdbs='2' group by lx.xmid) l on j.xmbm=l.xmbm 
					left join (select xmid,jsxz, (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)) 
					 else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc from lxsh_lx where jdbs='2' 
					and sffirst='1' ) lx on j.xmbm=lx.xmid left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid 
					left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj, 
					replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj, replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj, replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,
					replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj from (select xmid,jsxz, (case when jsxsubstr(xmid,11,1)=1en to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)
					+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))  else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm else '' end)
					 ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj from LXSH_LX where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid 
					 right  join (select * from lxsh_lx lx where lx.jdbs='2') l_ on j.xmbm=l_.xmid 
	              where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and ghlxbmtj like '%'||#{ghlxbh}||'%'
				</if>
				<if test="ghxlxbm!=null and ghxlxbm!=''">
					and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
				</if>
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghxlxmc !=null and ghxlxmc !=''">
					and ghxlxmctj like '%'||#{ghxlxmc}||'%'
				</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(j.xmbm,0,4) in (${xmnf})
				</if>
				
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				order by j.xdzt,j.xmbm desc,l_.sffirst desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	
	<select id="queryJhshYhdzx_dc" parameterType="jhsh" resultType="jhsh">
			     select decode(l_.sffirst,'1',j.XMMC,'') xmmc,decode(l_.sffirst,'1',j.XMBM,'') xmbm,j.XZQH,j.JHKGSJ kgsj,j.JHWGSJ wgsj,j.XDWH,j.XDSJ,j.ZTZ,j.SYSBBZJ,j.YQDBCGS,j.YLXBH,l_.qdmc,l_.zdmc,l_.qdzh,l_.zdzh,l_.lc
				 ,j.MCLMLX,j.MCLX,j.MCSL,j.MCJE,j.JCLX,j.JCSL,j.MCSL,j.XFCSL,j.XFCJE,j.BXSL,j.BXJE,j.GFCD,j.GFJE,j.LLCL,
				 lx.lc, jhlc,sl.xmsl xmsl,lxg.ntz tz,lxg.jsdj,cb.sjpfwh,cb.gq,
				 l_.lxmc,l_.ghlxbm,l_.ghlxmc,l_.ghqdzh,l_.ghzdzh,l_.gxlxbm,l_.gxqdzh,l_.gxzdzh
				 from jhxdyh j 
				 left join (select xmbm,sjpfwh,gq from cbsj_yhdzx) cb on j.xmbm=cb.xmbm left join xmsq_yhdzx lxg on j.xmbm=lxg.xmbm 
				 left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx where jdbs='2' group by lx.xmid) l on j.xmbm=l.xmbm 
				 left join (select xmid,jsxz, (case when substr(xmid,11,1)=1 then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0) 
				 when substr(xmid,11,1)=3 then to_number(xjlc) else nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) end) lc from lxsh_lx where jdbs='2' 
			   	 and sffirst='1' ) lx on j.xmbm=lx.xmid left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid 
			     left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
			     replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj, replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj, replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,
			     replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj from (select xmid,jsxz, (case when substr(xmid,11,1)=1 then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+
			     nvl(jhdwlc,0)+nvl(jhwllc,0) when substr(xmid,11,1)=3 then to_number(xjlc) else to_number(lc) end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm else '' end) 
			     ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj from LXSH_LX where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid 
			     right join (select * from lxsh_lx lx where jdbs='2') l_ on j.xmbm=l_.xmid
	              where 1=1 
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and ghlxbmtj like '%'||#{ghlxbh}||'%'
				</if>
				<if test="ghxlxbm!=null and ghxlxbm!=''">
					and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
				</if>
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghxlxmc !=null and ghxlxmc !=''">
					and ghxlxmctj like '%'||#{ghxlxmc}||'%'
				</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(j.xmbm,0,4) in (${xmnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">and xmlx1 like '%'||#{xmlx1}||'%'</if>
				<if test="jhxdwh !=null and jhxdwh !=''">and (jhxdwh like '%'||#{jhxdwh}||'%' or xdwh like '%'||#{jhxdwh}||'%')</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				order by j.xdzt,j.xmbm desc,l_.sffirst desc
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryJhshYhdzx_qx_dc" parameterType="jhsh" resultType="jhsh">
			     select decode(l_.sffirst,'1',j.XMMC,'') xmmc,decode(l_.sffirst,'1',j.XMBM,'') xmbm,j.XZQH,j.JHKGSJ kgsj,j.JHWGSJ wgsj,j.XDWH,j.XDSJ,j.ZTZ,j.SYSBBZJ,j.YQDBCGS,j.YLXBH,l_.qdmc,l_.zdmc,l_.qdzh,l_.zdzh,l_.lc
				 ,j.MCLMLX,j.MCLX,j.MCSL,j.MCJE,j.JCLX,j.JCSL,j.MCSL,j.XFCSL,j.XFCJE,j.BXSL,j.BXJE,j.GFCD,j.GFJE,j.LLCL,
				 lx.lc, jhlc,sl.xmsl xmsl,lxg.ntz tz,lxg.jsdj,cb.sjpfwh,cb.gq,
				 l_.lxmc,l_.ghlxbm,l_.ghlxmc,l_.ghqdzh,l_.ghzdzh,l_.gxlxbm,l_.gxqdzh,l_.gxzdzh
				 from jhxdyh_qx j 
				 left join (select xmbm,sjpfwh,gq from cbsj_yhdzx) cb on j.xmbm=cb.xmbm left join xmsq_yhdzx lxg on j.xmbm=lxg.xmbm 
				 left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx where jdbs='2' group by lx.xmid) l on j.xmbm=l.xmbm 
				 left join (select xmid,jsxz, (case when substr(xmid,11,1)=1 then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0) 
				 when substr(xmid,11,1)=3 then to_number(xjlc) else nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) end) lc from lxsh_lx where jdbs='2' 
			   	 and sffirst='1' ) lx on j.xmbm=lx.xmid left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid 
			     left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
			     replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj, replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj, replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,
			     replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj from (select xmid,jsxz, (case when substr(xmid,11,1)=1 then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+
			     nvl(jhdwlc,0)+nvl(jhwllc,0) when substr(xmid,11,1)=3 then to_number(xjlc) else to_number(lc) end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm else '' end) 
			     ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj from LXSH_LX where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid 
			     right join (select * from lxsh_lx lx where jdbs='2') l_ on j.xmbm=l_.xmid
	              where 1=1 
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and ghlxbmtj like '%'||#{ghlxbh}||'%'
				</if>
				<if test="ghxlxbm!=null and ghxlxbm!=''">
					and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
				</if>
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghxlxmc !=null and ghxlxmc !=''">
					and ghxlxmctj like '%'||#{ghxlxmc}||'%'
				</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(j.xmbm,0,4) in (${xmnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">and xmlx1 like '%'||#{xmlx1}||'%'</if>
				<if test="jhxdwh !=null and jhxdwh !=''">and (jhxdwh like '%'||#{jhxdwh}||'%' or xdwh like '%'||#{jhxdwh}||'%')</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				order by j.xdzt,j.xmbm desc,l_.sffirst desc
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryJhshSh1" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*, c.kgsj,c.wgsj,c.gq,l.lsjl, l.gydw, l.qdmc, l.zdmc,l.jsdj,sl.zlc,sl.xmsl  
				from jhsh_sh_qx j left join cbsj_sh c on j.xmbm=c.xmbm left join xmsq_sh l on c.xmbm = l.xmbm
				left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
				where 1=1
				<if test="jhsh2.xzqhdm!=null and jhsh2.xzqhdm!=''">and ${jhsh2.xzqhdm}</if>
				<if test="jhsh2.ghlxbh!=null and jhsh2.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh2.ghlxbh}||'%')
				</if>
				<if test="jhsh2.ylxbh!=null and jhsh2.ylxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh2.ylxbh} and xmid like '%5___' and jdbs='2')
				</if>
				<if test="jhsh2.lsjl!=null and jhsh2.lsjl!=''">and l.lsjl=#{jhsh2.lsjl}</if>
				<if test="jhsh2.tsdq!=null and jhsh2.tsdq!=''">
					and l.tsdq like '%'||#{jhsh2.tsdq}||'%'
				</if>
				<if test="jhsh2.xmbm!=null and jhsh2.xmbm!=''">and ${jhsh2.xmbm}</if>
				<if test="jhsh2.jsdj!=null and jhsh2.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where jdbs='2' and ${jhsh2.jsdj})</if>
				<if test="jhsh2.xmmc!=null and jhsh2.xmmc!=''">and j.xmmc like '%'||#{jhsh2.xmmc}||'%'</if>
				<if test="jhsh2.xdzt>=0">and j.xdzt=${jhsh2.xdzt}</if>
				order by j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryJhshYhdzxCount" parameterType="jhsh" resultType="int">
		select count(t.xmbm) from (
				select j.*,lx.lc jhlc,sl.zlc,sl.xmsl xmsl,lxg.ntz tz,lxg.jsdj,cb.sjpfwh from jhxdyh j  left join (select xmbm,sjpfwh from cbsj_yhdzx) cb on j.xmbm=cb.xmbm  left join xmsq_yhdzx lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	             
					left join (select j.xmid,
	                sum(j.btzzj) bcxd,
	              	replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
	              	replace(WMSYS.WM_CONCAT(j.xdnf),',',',') bcxdsj,
	             	sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  bcztz,
	             	nvl(sum(j.rys),0) + nvl(sum(j.dk),0) + nvl(sum(j.gz),0)+ nvl(sum(j.sz),0)+ nvl(sum(j.zq),0) bcstz,
	            	sum(j.btzzj) bccgs
	          		from jhxdyh g
	          		left join plan_zjxd j
	          		on g.xmbm = j.xmid
	         		where 1 = 1 
	         		<if test="jhxdwh !=null and jhxdwh !=''">
	         		${jhxdwh}  
	         		</if>
	         		group by j.xmid) wh on j.xmbm=wh.xmid		        
	              where 1=1  and j.jhxdwh  like '%'
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				<!-- <if test="ghxlxbm!=null and ghxlxbm!=''">
					and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
				</if> -->
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<!-- <if test="ghxlxmc !=null and ghxlxmc !=''">
					and ghxlxmctj like '%'||#{ghxlxmc}||'%'
				</if> -->
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and ${scxdnf} in (${xmnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
				order by j.xdzt,j.xmbm desc
			) t 
	</select>
	<select id="queryJhshYhdzx_qxCount" parameterType="jhsh" resultType="int">
		select count(t.xmbm) from (
				select j.*,lx.lc jhlc,sl.zlc,sl.xmsl xmsl,lxg.ntz tz,lxg.jsdj,cb.sjpfwh from jhxdyh_qx j  left join (select xmbm,sjpfwh from cbsj_yhdzx) cb on j.xmbm=cb.xmbm  left join xmsq_yhdzx lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	             <if test="jhxdwh !=null and jhxdwh !=''">
					left join (select j.xmid,
	                sum(j.btzzj) bcxd,
	              	replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
	              	replace(WMSYS.WM_CONCAT(j.xdnf),',',',') bcxdsj,
	             	sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  bcztz,
	             	nvl(sum(j.rys),0) + nvl(sum(j.dk),0) + nvl(sum(j.gz),0)+ nvl(sum(j.sz),0)+ nvl(sum(j.zq),0) bcstz,
	            	sum(j.btzzj) bccgs
	          		from jhxdyh g
	          		left join plan_zjxd j
	          		on g.xmbm = j.xmid
	         		where 1 = 1 ${jhxdwh}  group by j.xmid) wh on j.xmbm=wh.xmid		        </if>
	              where 1=1 
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				<!-- <if test="ghxlxbm!=null and ghxlxbm!=''">
					and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
				</if> -->
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<!-- <if test="ghxlxmc !=null and ghxlxmc !=''">
					and ghxlxmctj like '%'||#{ghxlxmc}||'%'
				</if> -->
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(j.xmbm,0,4) in (${xmnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				order by j.xdzt,j.xmbm desc
			) t 
	</select>
	
	<select id="queryJhshYhdzxCount1" parameterType="java.util.Map" resultType="int">
		select count(t.xmbm) from (
			select j.* from jhsh_yhdzx_qx j left join xmsq_yhdzx l on j.xmbm=l.xmbm
			where 1=1
			<if test="jhsh2.xzqhdm!=null and jhsh2.xzqhdm!=''">and ${jhsh2.xzqhdm}</if>
			<if test="jhsh2.ghlxbh!=null and jhsh2.ghlxbh!=''">
				and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh2.ghlxbh}||'%')
			</if>
			<if test="jhsh2.ylxbh!=null and jhsh2.ylxbh!=''">
				and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh2.ylxbh} and xmid like '%4___' and jdbs='2')
			</if>
			<if test="jhsh2.xmbm!=null and jhsh2.xmbm!=''">and ${jhsh2.xmbm}</if>
			<if test="jhsh2.xmmc!=null and jhsh2.xmmc!=''">and j.xmmc like '%'||#{jhsh2.xmmc}||'%'</if>
			<if test="jhsh2.tsdq!=null and jhsh2.tsdq!=''">and l.tsdq like '%'||#{jhsh2.tsdq}||'%'</if>
			<if test="jhsh2.jsdj!=null and jhsh2.jsdj!=''">and ${jhsh2.jsdj}</if>
			<if test="jhsh2.xdzt>=0">and j.xdzt=${jhsh2.xdzt}</if>
			order by j.xdzt,j.xmbm desc
		) t 
	</select>
	<select id="queryJhshShCount" parameterType="jhsh" resultType="int">
		select count(*) from (
				select j.*,lx.lc jhlc,sl.zlc,sl.xmsl xmsl,lxg.jsdj,lxg.xzqh xzqhmc,cb.sjpfwh from jhxdsh j left join (select xmbm,sjpfwh from cbsj_sh) cb on j.xmbm=cb.xmbm  left join xmsq_sh lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx where jdbs='2' group by lx.xmid) l on j.xmbm=l.xmbm 
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	            
	             left join (select j.xmid,
	                sum(j.btzzj) bcxd,
	              	replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
	              	replace(WMSYS.WM_CONCAT(j.xdnf),',',',') bcxdsj,
	             	sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  bcztz,
	             	nvl(sum(j.rys),0) + nvl(sum(j.dk),0) + nvl(sum(j.gz),0)+ nvl(sum(j.sz),0)+ nvl(sum(j.zq),0) bcstz,
	            	sum(j.btzzj) bccgs
	          		from jhxdsh g
	          		left join plan_zjxd j
	          		on g.xmbm = j.xmid
	         		where 1 = 1 
	         		 <if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh} </if> 
	         		group by j.xmid) wh on j.xmbm=wh.xmid
	              where 1=1 and j.jhxdwh  like '%'
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xmnf !=null and xmnf !=''">
					and ${scxdnf} in (${xmnf})
				</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				
				<!-- <if test="ghxlxbm!=null and ghxlxbm!=''">
					and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
				</if> -->
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<!-- <if test="ghxlxmc !=null and ghxlxmc !=''">
					and ghxlxmctj like '%'||#{ghxlxmc}||'%'
				</if> -->
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
				order by j.xdzt,j.xmbm desc
			) t 
	</select>
	<select id="queryJhshSh_qxCount" parameterType="jhsh" resultType="int">
		select count(*) from (
				select j.*,lx.lc jhlc,sl.zlc,sl.xmsl xmsl,lxg.jsdj,lxg.xzqh xzqhmc,cb.sjpfwh from jhxdsh_qx j left join (select xmbm,sjpfwh from cbsj_sh) cb on j.xmbm=cb.xmbm  left join xmsq_sh lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx where jdbs='2' group by lx.xmid) l on j.xmbm=l.xmbm 
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	             <if test="jhxdwh !=null and jhxdwh !=''">
	             left join (select j.xmid,
	                sum(j.btzzj) bcxd,
	              	replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
	              	replace(WMSYS.WM_CONCAT(j.xdnf),',',',') bcxdsj,
	             	sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  bcztz,
	             	nvl(sum(j.rys),0) + nvl(sum(j.dk),0) + nvl(sum(j.gz),0)+ nvl(sum(j.sz),0)+ nvl(sum(j.zq),0) bcstz,
	            	sum(j.btzzj) bccgs
	          		from jhxdsh g
	          		left join plan_zjxd j
	          		on g.xmbm = j.xmid
	         		where 1 = 1 ${jhxdwh}  group by j.xmid) wh on j.xmbm=wh.xmid
		        </if>
	              where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(j.xmbm,0,4) in (${xmnf})
				</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				
				<!-- <if test="ghxlxbm!=null and ghxlxbm!=''">
					and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
				</if> -->
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<!-- <if test="ghxlxmc !=null and ghxlxmc !=''">
					and ghxlxmctj like '%'||#{ghxlxmc}||'%'
				</if> -->
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				order by j.xdzt,j.xmbm desc
			) t 
	</select>
	
	<select id="queryJhshShCount1" parameterType="java.util.Map" resultType="int">
		select count(t.xmbm) from (
			select j.* from jhsh_sh_qx j left join xmsq_sh l on j.xmbm=l.xmbm
			where 1=1
			<if test="jhsh2.xzqhdm!=null and jhsh2.xzqhdm!=''">and ${jhsh2.xzqhdm}</if>
			<if test="jhsh2.ghlxbh!=null and jhsh2.ghlxbh!=''">
				and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh2.ghlxbh}||'%')
			</if>
			<if test="jhsh2.ylxbh!=null and jhsh2.ylxbh!=''">
				and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh2.ylxbh} and xmid like '%5___' and jdbs='2')
			</if>
			<if test="jhsh2.xmbm!=null and jhsh2.xmbm!=''">and ${jhsh2.xmbm}</if>
			<if test="jhsh2.jsdj!=null and jhsh2.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where jdbs='2' and ${jhsh2.jsdj})</if>
			<if test="jhsh2.xmmc!=null and jhsh2.xmmc!=''">
				and j.xmmc like '%'||#{jhsh2.xmmc}||'%'
			</if>
			<if test="jhsh2.tsdq!=null and jhsh2.tsdq!=''">and l.tsdq like '%'||#{jhsh2.tsdq}||'%'</if>
			<if test="jhsh2.xdzt>=0">and j.xdzt=${jhsh2.xdzt}</if>
			order by j.xdzt,j.xmbm desc
		) t 
	</select>
	<select id="queryJhshCountLmsj" parameterType="java.util.Map" resultType="int">
		select count(j.xmbm) from jhsh_sjgz j left join lxsh_sjgz l on j.xmbm=l.xmbm where 1=1
		<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">
			and ${jhsh.xzqhdm}
		</if>
		<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh.ghlxbh}||'%')
		</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh.ylxbh} and xmid like '%1___' and jdbs='2')
		</if>
		<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">
			and ${jhsh.xmbm}
		</if>
		<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">
			and j.xmmc like '%'||#{jhsh.xmmc}||'%'
		</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">
			and l.tsdq like '%'||#{jhsh.tsdq}||'%'
		</if>
		<if test="jhsh.xdzt>=0">
			and j.xdzt=${jhsh.xdzt}
		</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">
			and ${jhsh.jsdj}
		</if>
		<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">
			and l.lsjl=#{jhsh.lsjl}
		</if>
	</select>
	<select id="queryJhshCountLmsj1" parameterType="java.util.Map" resultType="int">
		select count(j.xmbm) from jhsh_sjgz_qx j left join lxsh_sjgz l on j.xmbm=l.xmbm where 1=1
		<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">
			and ${jhsh.xzqhdm}
		</if>
		<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh.ghlxbh}||'%')
		</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh.ylxbh} and xmid like '%1___' and jdbs='2')
		</if>
		<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">
			and ${jhsh.xmbm}
		</if>
		<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">
			and j.xmmc like '%'||#{jhsh.xmmc}||'%'
		</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">
			and l.tsdq like '%'||#{jhsh.tsdq}||'%'
		</if>
		<if test="jhsh.xdzt>=0">
			and j.xdzt=${jhsh.xdzt}
		</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">
			and ${jhsh.jsdj}
		</if>
		<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">
			and l.lsjl=#{jhsh.lsjl}
		</if>
	</select>
	<select id="queryJhshCountLmgz" parameterType="java.util.Map" resultType="int">
		select count(j.xmbm) from jhsh_lmgz j left join lxsh_lmgz l on j.xmbm=l.xmbm where 1=1
		<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">
			and ${jhsh.xzqhdm}
		</if>
		<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh.ghlxbh}||'%')
		</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh.ylxbh} and xmid like '%2___' and jdbs='2')
		</if>
		<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">
			and ${jhsh.xmbm}
		</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">
			and ${jhsh.jsdj}
		</if>
		<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">
			and j.xmmc like '%'||#{jhsh.xmmc}||'%'
		</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">
			and l.tsdq like '%'||#{jhsh.tsdq}||'%'
		</if>
		<if test="jhsh.xdzt>=0">
			and j.xdzt=${jhsh.xdzt}
		</if>
	</select>
	<select id="queryJhshCountLmgz1" parameterType="java.util.Map" resultType="int">
		select count(j.xmbm) from jhsh_lmgz_qx j left join lxsh_lmgz l on j.xmbm=l.xmbm where 1=1
		<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">
			and ${jhsh.xzqhdm}
		</if>
		<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh.ghlxbh}||'%')
		</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh.ylxbh} and xmid like '%2___' and jdbs='2')
		</if>
		<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">
			and ${jhsh.xmbm}
		</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">
			and ${jhsh.jsdj}
		</if>
		<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">
			and j.xmmc like '%'||#{jhsh.xmmc}||'%'
		</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">
			and l.tsdq like '%'||#{jhsh.tsdq}||'%'
		</if>
		<if test="jhsh.xdzt>=0">
			and j.xdzt=${jhsh.xdzt}
		</if>
	</select>
	<select id="queryJhshCountXj" parameterType="java.util.Map" resultType="int">
		select count(j.xmbm) from jhsh_xj j left join lxsh_xj l on j.xmbm=l.xmbm where 1=1
		<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
		<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh.ghlxbh}||'%')
		</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh.ylxbh} and xmid like '%3___' and jdbs='2')
		</if>
		<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and ${jhsh.xmbm}</if>
		<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
		<if test="jhsh.xdzt>=0">and j.xdzt=${jhsh.xdzt}</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
		<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and l.lsjl=#{jhsh.lsjl}</if>
	</select>
	<select id="queryJhshCountXj1" parameterType="java.util.Map" resultType="int">
		select count(j.xmbm) from jhsh_xj_qx j left join lxsh_xj l on j.xmbm=l.xmbm where 1=1
		<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
		<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{jhsh.ghlxbh}||'%')
		</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${jhsh.ylxbh} and xmid like '%3___' and jdbs='2')
		</if>
		<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and ${jhsh.xmbm}</if>
		<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
		<if test="jhsh.xdzt>=0">and j.xdzt=${jhsh.xdzt}</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
		<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and l.lsjl=#{jhsh.lsjl}</if>
	</select>
	<update id="updateJhshxxLmsj" parameterType="java.util.List">
		update jhsh_sjgz c set 
		<if test="pfztz!=null">c.pfztz=#{pfztz},</if>
		<if test="bbzzj!=null">c.bbzzj=#{bbzzj},</if>
		<if test="sbzzj!=null">c.sbzzj=#{sbzzj},</if>
		<if test="xdwh!=null">c.xdwh=#{xdwh},</if>
		<if test="xdsj!=null">c.xdsj=#{xdsj},</if>
		<if test="gldj != null">c.gldj=#{gldj},</if>
		<if test="gz != null">c.gz=#{gz},</if>
		<if test="sz != null">c.sz=#{sz},</if>
		<if test="zq != null">c.zq=#{zq},</if>
		<if test="dk != null">c.dk=#{dk},</if>
		<if test="jl != null">c.jl=#{jl},</if>
		<if test="qt != null">c.qt=#{qt},</if>
		<if test="zydpx != null">c.zydpx=#{zydpx},</if>
		<if test="yhdk != null">c.yhdk=to_number(#{yhdk}),</if>
		<if test="dfzc != null">c.dfzc=to_number(#{dfzc}),</if>
		<if test="zyjsnr != null">c.zyjsnr=#{zyjsnr},</if>
		<if test="xzscnl != null">c.xzscnl=#{xzscnl},</if>
		c.xmbm=#{xmbm}
<!-- 		c.xdzt='0' -->
		where c.xmbm=#{xmbm}
	</update>
	<update id="updateJhshxxLmgz" parameterType="java.util.List">
		update jhsh_lmgz c set 
		<if test="pfztz!=null">c.pfztz=#{pfztz},</if>
		<if test="bbzzj!=null">c.bbzzj=#{bbzzj},</if>
		<if test="sbzzj!=null">c.sbzzj=#{sbzzj},</if>
		<if test="xdwh!=null">c.xdwh=#{xdwh},</if>
		<if test="xdsj!=null">c.xdsj=#{xdsj},</if>
		<if test="gldj != null">c.gldj=#{gldj},</if>
		<if test="gz != null">c.gz=#{gz},</if>
		<if test="sz != null">c.sz=#{sz},</if>
		<if test="zq != null">c.zq=#{zq},</if>
		<if test="dk != null">c.dk=#{dk},</if>
		<if test="jl != null">c.jl=#{jl},</if>
		<if test="qt != null">c.qt=#{qt},</if>
		<if test="zydpx != null">c.zydpx=#{zydpx},</if>
		<if test="yhdk != null">c.yhdk=to_number(#{yhdk}),</if>
		<if test="dfzc != null">c.dfzc=to_number(#{dfzc}),</if>
		<if test="zyjsnr != null">c.zyjsnr=#{zyjsnr},</if>
		<if test="xzscnl != null">c.xzscnl=#{xzscnl},</if>
		c.xmbm=#{xmbm}
<!-- 		c.xdzt='0' -->
		where c.xmbm=#{xmbm}
	</update>
	<update id="updateJhshxxXj" parameterType="java.util.List">
		update jhsh_xj c set 
		<if test="pfztz!=null">c.pfztz=#{pfztz},</if>
		<if test="bbzzj!=null">c.bbzzj=#{bbzzj},</if>
		<if test="sbzzj!=null">c.sbzzj=#{sbzzj},</if>
		<if test="xdwh!=null">c.xdwh=#{xdwh},</if>
		<if test="xdsj!=null">c.xdsj=#{xdsj},</if>
		<if test="gldj != null">c.gldj=#{gldj},</if>
		<if test="gz != null">c.gz=#{gz},</if>
		<if test="sz != null">c.sz=#{sz},</if>
		<if test="zq != null">c.zq=#{zq},</if>
		<if test="dk != null">c.dk=#{dk},</if>
		<if test="jl != null">c.jl=#{jl},</if>
		<if test="qt != null">c.qt=#{qt},</if>
		<if test="zydpx != null">c.zydpx=#{zydpx},</if>
		<if test="yhdk != null">c.yhdk=to_number(#{yhdk}),</if>
		<if test="dfzc != null">c.dfzc=to_number(#{dfzc}),</if>
		<if test="zyjsnr != null">c.zyjsnr=#{zyjsnr},</if>
		<if test="xzscnl != null">c.xzscnl=#{xzscnl},</if>
		c.xmbm=#{xmbm}
<!-- 		c.xdzt='0'  -->
		where c.xmbm=#{xmbm}
	</update>
	<update id="updateJhshxxYhdzx" parameterType="jhsh">
		update jhsh_yhdzx c set 
		<if test="ztz!=null">ztz=#{ztz},</if>
		<if test="yqdbcgs!=null">yqdbcgs=#{yqdbcgs},</if>
		<if test="sysbbzj!=null">sysbbzj=#{sysbbzj},</if>
		<if test="qdzh!=null">qdzh=#{qdzh},</if>
		<if test="zdzh!=null">zdzh=#{zdzh},</if>
		<if test="lc!=null">lc=#{lc},</if>
		<if test="mclmlx!=null">mclmlx=#{mclmlx},</if>
		<if test="mclx!=null">mclx=#{mclx},</if>
		<if test="mcsl!=null">mcsl=#{mcsl},</if>
		<if test="mcje!=null">mcje=#{mcje},</if>
		<if test="jclx!=null">jclx=#{jclx},</if>
		<if test="jcsl!=null">jcsl=#{jcsl},</if>
		<if test="jcje!=null">jcje=#{jcje},</if>
		<if test="xfcsl!=null">xfcsl=#{xfcsl},</if>
		<if test="xfcje!=null">xfcje=#{xfcje},</if>
		<if test="bxsl!=null">bxsl=#{bxsl},</if>
		<if test="bxje!=null">bxje=#{bxje},</if>
		<if test="gfcd!=null">gfcd=#{gfcd},</if>
		<if test="gfje!=null">gfje=#{gfje},</if>
		<if test="llcl!=null">llcl=#{llcl},</if>
		<if test="xdwh!=null">xdwh=#{xdwh},</if>
		<if test="xdsj!=null">xdsj=#{xdsj},</if>
		<if test="dk != null">c.dk=#{dk},</if>
		<if test="rys != null">c.rys=#{rys},</if>
		<if test="qt != null">c.qt=#{qt},</if>
		<if test="zydpx != null">c.zydpx=#{zydpx},</if>
		<if test="sfsycgs != null">c.sfsycgs=#{sfsycgs},</if>
		xdzt='0' where c.xmbm=#{xmbm}
	</update>
	<update id="updateJhshxxSh" parameterType="jhsh">
		update jhsh_sh c set 
		<if test="pfztz!=null">c.pfztz=#{pfztz},</if>
		<if test="bbzzj!=null">c.bbzzj=#{bbzzj},</if>
		<if test="sbzzj!=null">c.sbzzj=#{sbzzj},</if>
		<if test="xdwh!=null">c.xdwh=#{xdwh},</if>
		<if test="xdsj!=null">c.xdsj=#{xdsj},</if>
		<if test="qdzh!=null">qdzh=#{qdzh},</if>
		<if test="zdzh!=null">zdzh=#{zdzh},</if>
		<if test="lc!=null">lc=#{lc},</if>
		<if test="gz != null">c.gz=#{gz},</if>
		<if test="sz != null">c.sz=#{sz},</if>
		<if test="zq != null">c.zq=#{zq},</if>
		<if test="dk != null">c.dk=#{dk},</if>
		<if test="jl != null">c.jl=#{jl},</if>
		<if test="qt != null">c.qt=#{qt},</if>
		<if test="dfzc != null">c.dfzc=#{dfzc},</if>
		<if test="zydpx != null">c.zydpx=#{zydpx},</if>
		xdzt='0' where c.xmbm=#{xmbm}
	</update>
	
	<select id="queryLxshLmsjByXmbm" parameterType="java.util.Map" resultType="lxsh">
		select xmmc,xmklx,l1.lxbm ghlxbh, jhkgn, jhwgn, l.jsjsdj, l.xjsdj,l.wnid,l.sfbflx,
		xmbm, tz, bzys, dfzc, tsdq, l.xzqh, l.gydw, l.xzqhdm,l.xzqhdm2,l.gydwdm, tbbmbm, tbbmmc, tbsj, shzt, sbzt, xmnf, sbthcd,  lsjl, bz, yhdk, 
		xmid, lxbm, l1.lxmc,l1.qdzh, l1.zdzh, l1.jsjsdj, nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) lc, l1.xjsdj, l1.jsxz, l1.qdmc, l1.zdmc, bzcs, sffirst, jdbs, 
		decode(gpsqdzh,null,l1.qdzh,gpsqdzh) gpsqdzh,decode(gpszdzh,null,l1.zdzh,gpszdzh) gpszdzh, jsfa, yilc, erlc, sanlc, silc, dwlc, wllc,jhyilc, jherlc, jhsanlc, jhsilc, jhdwlc, jhwllc,nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0) jszlc,l1.ghlxbm,l1.ghlxmc,l1.ghqdzh,l1.ghzdzh,l1.gxlxbm,l1.gxqdzh,l1.gxzdzh
		from lxsh_sjgz l left join lxsh_lx l1 on l.xmbm=l1.xmid where l.xmbm=#{xmbm} and l1.jdbs='0' and l1.sffirst='1'
	</select>
	<select id="queryLxshLmgzByXmbm" parameterType="java.util.Map" resultType="lxsh">
		select xmmc,xmklx,l1.lxbm ghlxbh, jhkgn, jhwgn, l.jsjsdj, l.xjsdj,l.wnid,l.sfbflx,
		xmbm, tz, bzys, dfzc, tsdq, l.xzqh, l.gydw, l.xzqhdm,l.xzqhdm2, l.gydwdm, tbbmbm, tbbmmc, tbsj, shzt, sbzt, xmnf, sbthcd,  lsjl, bz, yhdk, 
		xmid, lxbm, l1.lxmc,l1.qdzh, l1.zdzh, l1.jsjsdj,(nvl(l1.yilc,0)+nvl(l1.erlc,0)+nvl(l1.sanlc,0)+nvl(l1.silc,0)+nvl(l1.dwlc,0)+nvl(l1.wllc,0)) lc, l1.xjsdj, l1.jsxz, l1.qdmc, l1.zdmc, bzcs, sffirst, jdbs, 
		decode(gpsqdzh,null,l1.qdzh,gpsqdzh) gpsqdzh,decode(gpszdzh,null,l1.zdzh,gpszdzh) gpszdzh, jsfa, yilc, erlc, sanlc, silc, dwlc, wllc,l1.ghlxbm,l1.ghlxmc,l1.ghqdzh,l1.ghzdzh,l1.gxlxbm,l1.gxqdzh,l1.gxzdzh
		 from lxsh_lmgz l left join lxsh_lx l1 on l.xmbm=l1.xmid where l.xmbm=#{xmbm} and l1.jdbs='0' and l1.sffirst='1'
	</select>
	<select id="queryLxshXjByXmbm" parameterType="java.util.Map" resultType="lxsh">
		select xmmc,xmklx,l1.lxbm ghlxbh, jhkgn, jhwgn, l.jsjsdj, l.xjsdj, xmbm, tz, bzys, dfzc, tsdq, l.xzqh, l.gydw, l.xzqhdm,l.xzqhdm2,l.wnid,l.sfbflx,
		l.gydwdm, tbbmbm, tbbmmc, tbsj, shzt, sbzt, xmnf, sbthcd,  lsjl, bz, yhdk, xmid, lxbm, l1.lxmc,l1.qdzh, 
		l1.zdzh, l1.jsjsdj, nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) lc, l1.xjsdj, l1.jsxz, l1.qdmc, l1.zdmc, bzcs, sffirst, jdbs, 
		decode(gpsqdzh,null,l1.qdzh,gpsqdzh) gpsqdzh,decode(gpszdzh,null,l1.zdzh,gpszdzh) gpszdzh, jsfa, yilc, erlc, sanlc, silc, dwlc, wllc,l1.xjlxbm,l1.xjqdzh,l1.xjzdzh,l1.xjlc,l1.ghlxbm,l1.ghlxmc,l1.ghqdzh,l1.ghzdzh,l1.gxlxbm,l1.gxqdzh,l1.gxzdzh 
		from lxsh_xj l left join lxsh_lx l1 on l.xmbm=l1.xmid where l.xmbm=#{xmbm} and l1.jdbs='0' and l1.sffirst='1'
	</select>
	<select id="queryLxshLmsjqxByXmbm" parameterType="java.util.Map" resultType="lxsh">
		select xmmc,xmklx,l1.lxbm ghlxbh, jhkgn, jhwgn, l.jsjsdj, l.xjsdj,l.wnid,l.sfbflx,
		xmbm, tz, bzys, dfzc, tsdq, l.xzqh, l.gydw, l.xzqhdm,l.xzqhdm2,l.gydwdm, tbbmbm, tbbmmc, tbsj, shzt, sbzt, xmnf, sbthcd,  lsjl, bz, yhdk, 
		xmid, lxbm, l1.lxmc,l1.qdzh, l1.zdzh, l1.jsjsdj, nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) lc, l1.xjsdj, l1.jsxz, l1.qdmc, l1.zdmc, bzcs, sffirst, jdbs, 
		decode(gpsqdzh,null,l1.qdzh,gpsqdzh) gpsqdzh,decode(gpszdzh,null,l1.zdzh,gpszdzh) gpszdzh, jsfa, yilc, erlc, sanlc, silc, dwlc, wllc,jhyilc, jherlc, jhsanlc, jhsilc, jhdwlc, jhwllc,nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0) jszlc,l1.ghlxbm,l1.ghlxmc,l1.ghqdzh,l1.ghzdzh,l1.gxlxbm,l1.gxqdzh,l1.gxzdzh
		from lxsh_sjgz_qx l left join lxsh_lx l1 on l.xmbm=l1.xmid where l.xmbm=#{xmbm} and l1.jdbs='0' and l1.sffirst='1'
	</select>
	<select id="queryLxshLmgzqxByXmbm" parameterType="java.util.Map" resultType="lxsh">
		select xmmc,xmklx,l1.lxbm ghlxbh, jhkgn, jhwgn, l.jsjsdj, l.xjsdj,l.wnid,l.sfbflx,
		xmbm, tz, bzys, dfzc, tsdq, l.xzqh, l.gydw, l.xzqhdm,l.xzqhdm2, l.gydwdm, tbbmbm, tbbmmc, tbsj, shzt, sbzt, xmnf, sbthcd,  lsjl, bz, yhdk, 
		xmid, lxbm, l1.lxmc,l1.qdzh, l1.zdzh, l1.jsjsdj,(nvl(l1.yilc,0)+nvl(l1.erlc,0)+nvl(l1.sanlc,0)+nvl(l1.silc,0)+nvl(l1.dwlc,0)+nvl(l1.wllc,0)) lc, l1.xjsdj, l1.jsxz, l1.qdmc, l1.zdmc, bzcs, sffirst, jdbs, 
		decode(gpsqdzh,null,l1.qdzh,gpsqdzh) gpsqdzh,decode(gpszdzh,null,l1.zdzh,gpszdzh) gpszdzh, jsfa, yilc, erlc, sanlc, silc, dwlc, wllc,l1.ghlxbm,l1.ghlxmc,l1.ghqdzh,l1.ghzdzh,l1.gxlxbm,l1.gxqdzh,l1.gxzdzh
		 from lxsh_lmgz_qx l left join lxsh_lx l1 on l.xmbm=l1.xmid where l.xmbm=#{xmbm} and l1.jdbs='0' and l1.sffirst='1'
	</select>
	<select id="queryLxshXjqxByXmbm" parameterType="java.util.Map" resultType="lxsh">
		select xmmc,xmklx,l1.lxbm ghlxbh, jhkgn, jhwgn, l.jsjsdj, l.xjsdj, xmbm, tz, bzys, dfzc, tsdq, l.xzqh, l.gydw, l.xzqhdm,l.xzqhdm2,l.wnid,l.sfbflx,
		l.gydwdm, tbbmbm, tbbmmc, tbsj, shzt, sbzt, xmnf, sbthcd,  lsjl, bz, yhdk, xmid, lxbm, l1.lxmc,l1.qdzh, 
		l1.zdzh, l1.jsjsdj, nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) lc, l1.xjsdj, l1.jsxz, l1.qdmc, l1.zdmc, bzcs, sffirst, jdbs, 
		decode(gpsqdzh,null,l1.qdzh,gpsqdzh) gpsqdzh,decode(gpszdzh,null,l1.zdzh,gpszdzh) gpszdzh, jsfa, yilc, erlc, sanlc, silc, dwlc, wllc,l1.xjlxbm,l1.xjqdzh,l1.xjzdzh,l1.xjlc,l1.ghlxbm,l1.ghlxmc,l1.ghqdzh,l1.ghzdzh,l1.gxlxbm,l1.gxqdzh,l1.gxzdzh 
		from lxsh_xj_qx l left join lxsh_lx l1 on l.xmbm=l1.xmid where l.xmbm=#{xmbm} and l1.jdbs='0' and l1.sffirst='1'
	</select>
	<select id="queryJhshxxLmsjByXmbm" parameterType="java.util.Map" resultType="jhsh">
       select k.*,xmklx,t.tsdq,j.*,nvl(lg.yilc,0) yilc,nvl(lg.erlc,0) erlc,nvl(ls.yj,0) yj,nvl(ls.ej,0) ej,nvl(ls.sj,0) sj 
       from jhsh_sjgz k 
       left join lxsh_sjgz t on k.xmbm=t.xmbm
       left join jhsh_dj j on j.xmbm = k.xmbm
       left join(select l.xmid xmid,nvl(sum(l.jhyilc),0) yilc, nvl(sum(l.jherlc)+sum(l.jhsanlc)+sum(l.jhsilc)+sum(l.jhdwlc)+sum(l.jhwllc),0) erlc 
                  from lxsh_lx l where l.ghlxbm like 'G%' and jdbs='2' group by l.xmid) lg on lg.xmid = k.xmbm
       left join (select l.xmid xmid,nvl(sum(l.jhyilc),0) yj, nvl(sum(l.jherlc),0) ej, nvl(sum(l.jhsanlc)+sum(l.jhsilc)+sum(l.jhdwlc)+sum(l.jhwllc),0) sj 
                  from lxsh_lx l where l.ghlxbm like 'S%' and jdbs='2' group by l.xmid) ls on ls.xmid = k.xmbm
		where k.xmbm=#{xmbm}
	</select>
	<select id="queryJhshxxLmgzByXmbm" parameterType="java.util.Map" resultType="jhsh">
       select k.*,xmklx,t.tsdq,j.*,nvl(lg.yilc,0) yilc,nvl(lg.erlc,0) erlc,nvl(ls.yj,0) yj,nvl(ls.ej,0) ej,nvl(ls.sj,0) sj 
       from jhsh_lmgz k 
       left join lxsh_lmgz t on k.xmbm=t.xmbm
       left join jhsh_dj j on j.xmbm = k.xmbm    
       left join(select l.xmid xmid,nvl(sum(l.yilc),0) yilc, nvl(sum(l.erlc)+sum(l.sanlc)+sum(l.silc)+sum(l.dwlc)+sum(l.wllc),0) erlc 
                  from lxsh_lx l where l.ghlxbm like 'G%' and jdbs='2' group by l.xmid) lg on lg.xmid = k.xmbm
       left join (select l.xmid xmid,nvl(sum(l.yilc),0) yj, nvl(sum(l.erlc),0) ej, nvl(sum(l.sanlc)+sum(l.silc)+sum(l.dwlc)+sum(l.wllc),0) sj 
                  from lxsh_lx l where l.ghlxbm like 'S%' and jdbs='2' group by l.xmid) ls on ls.xmid = k.xmbm		
		where k.xmbm=#{xmbm}
	</select>
	<select id="queryJhshxxXjByXmbm" parameterType="java.util.Map" resultType="jhsh">
		select k.*,xmklx,t.tsdq,j.*,nvl(lg.yilc,0) yilc,nvl(lg.erlc,0) erlc,nvl(ls.yj,0) yj,nvl(ls.ej,0) ej,nvl(ls.sj,0) sj 
		from jhsh_xj k 
		left join lxsh_xj t on k.xmbm=t.xmbm 
		left join jhsh_dj j on j.xmbm=k.xmbm 
		left join(select l.xmid xmid,nvl(sum(l.yilc),0) yilc, nvl(sum(l.erlc)+sum(l.sanlc)+sum(l.silc)+sum(l.dwlc)+sum(l.wllc),0) erlc 
                  from lxsh_lx l where l.ghlxbm like 'G%' and jdbs='2' group by l.xmid) lg on lg.xmid = k.xmbm
        left join (select l.xmid xmid,nvl(sum(l.yilc),0) yj, nvl(sum(l.erlc),0) ej, nvl(sum(l.sanlc)+sum(l.silc)+sum(l.dwlc)+sum(l.wllc),0) sj 
                  from lxsh_lx l where l.ghlxbm like 'S%' and jdbs='2' group by l.xmid) ls on ls.xmid = k.xmbm
		where k.xmbm=#{xmbm}
	</select>
	<select id="queryJhshxxYhdzxByXmbm" parameterType="jhsh" resultType="jhsh">
	  select j.*, l.lxbm as ylxbh, l.gpsqdzh, l.gpszdzh, l.yilc, l.erlc, l.sanlc,
           l.silc, l.dwlc, l.wllc, lbz.lxsbzj, sbz.sgtsbzj, sgtxx.tz, sgtxx.bz
      from jhsh_yhdzx j
      left join (select sum(sbzj) lxsbzj,xmid from lxsh_lx where jdbs='1' group by xmid) lbz on lbz.xmid = j.xmbm 
      left join (select sum(sbzj) sgtsbzj,xmid from lxsh_lx where jdbs='2' group by xmid) sbz on sbz.xmid = j.xmbm
      left join (select xmbm, tz, bz from cbsj_yhdzx) sgtxx on sgtxx.xmbm = j.xmbm
      left join lxsh_lx l on j.xmbm = l.xmid
      where jdbs = '2' and l.sffirst = '1' and j.xmbm=#{xmbm}
	</select>
	<select id="queryJhshxxShByXmbm" parameterType="jhsh" resultType="jhsh">
		select j.*,l.lxbm as ylxbh,l.gpsqdzh,l.gpszdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from jhsh_sh j left join lxsh_lx l on j.xmbm=l.xmid where jdbs='2' and l.sffirst='1' and j.xmbm=#{xmbm}
	</select>
	<select id="queryLmsjKxxyjByXmbm" parameterType="jhsh" resultType="kxxyj">
		select k.XMMC,k.XMBM,k.JSDW,k.XZQH,k.QDZH,k.ZDZH,k.DQ,k.SD,k.KGNY,k.WGNY,k.JSJSDJ,k.JSXZ,k.GKPFWH,k.PFSJ,k.TZGS,k.BZDW,k.XZQHDM,k.SHZT,k.SBZT,k.SBTHCD,k.DQ_M,k.SD_M,k.TBBMBM,k.DFZC,k.YHDK,k.TZXZ,k.TZSJ,k.GYDW1,k.GYDWDM1,k.THYY,k.BZ,k.KXXYJ_SJGZ,nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0) jszlc,t.xmklx,l.XMID, l.LXBM, l.LXMC, l.XZQH, l.XZQHDM, l.GYDW, decode(k.gydwdm1,null,l.gydwdm) gydwdm, l.QDZH, l.ZDZH, l.JSJSDJ,nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) LC, l.XJSDJ, l.JSXZ, l.QDMC, l.ZDMC, l.BZCS, l.SFFIRST, l.JDBS, l.JSFA, l.YILC, l.ERLC, l.SANLC, l.SILC, l.DWLC, l.WLLC, l.JHYILC, l.JHERLC, l.JHSANLC, l.JHSILC, l.JHDWLC, l.JHWLLC, l.XJLXBM, l.XJQDZH, l.XJZDZH, l.XJLC, l.JHLC, l.GHLXBM, l.GHLXMC, l.LXLMKD, l.XZQHDM2, l.XZQHMC2, l.GXLXBM, l.GXQDZH, l.GXZDZH, l.GHQDZH, l.GHZDZH ,
		decode(gpsqdzh,null,l.qdzh,gpsqdzh) gpsqdzh,decode(gpszdzh,null,l.zdzh,gpszdzh) gpszdzh from kxxyj_sjgz k left join lxsh_sjgz t on k.xmbm=t.xmbm left join lxsh_lx l on k.xmbm=l.xmid
		left join(select max(gpszdzh) gpszdzh1,min(gpsqdzh) gpsqdzh1,xmid from LXSH_LX group by xmid) lxx on k.xmbm=lxx.xmid
	    where k.xmbm =#{xmbm} and l.jdbs='1' and l.sffirst='1'
	</select>
	<select id="queryLmgzKxxyjByXmbm" parameterType="jhsh" resultType="kxxyj">
		select k.*,t.xmklx,l.XMID, l.LXBM, l.LXMC, l.XZQH, l.XZQHDM, l.GYDW, decode(k.gydwdm1,null,l.gydwdm) gydwdm, l.QDZH, l.ZDZH, l.JSJSDJ, nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) LC, l.XJSDJ, l.JSXZ, l.QDMC, l.ZDMC, l.BZCS, l.SFFIRST, l.JDBS, l.JSFA, l.YILC, l.ERLC, l.SANLC, l.SILC, l.DWLC, l.WLLC, l.JHYILC, l.JHERLC, l.JHSANLC, l.JHSILC, l.JHDWLC, l.JHWLLC, l.XJLXBM, l.XJQDZH, l.XJZDZH, l.XJLC, l.JHLC, l.GHLXBM, l.GHLXMC, l.LXLMKD, l.XZQHDM2, l.XZQHMC2, l.GXLXBM, l.GXQDZH, l.GXZDZH, l.GHQDZH, l.GHZDZH ,
		decode(gpsqdzh,null,l.qdzh,gpsqdzh) gpsqdzh,decode(gpszdzh,null,l.zdzh,gpszdzh) gpszdzh from kxxyj_lmgz k left join lxsh_lmgz t on k.xmbm=t.xmbm  left join lxsh_lx l on k.xmbm=l.xmid
		left join(select max(gpszdzh) gpszdzh1,min(gpsqdzh) gpsqdzh1,xmid from LXSH_LX group by xmid) lxx on k.xmbm=lxx.xmid
	    where k.xmbm =#{xmbm} and l.jdbs='1' and l.sffirst='1'
	</select>
	<select id="queryXjKxxyjByXmbm" parameterType="jhsh" resultType="kxxyj">
		select k.*,t.xmklx,l.XMID, l.LXBM, l.LXMC, l.XZQH, l.XZQHDM, l.GYDW, decode(k.gydwdm1,null,l.gydwdm) gydwdm, l.QDZH, l.ZDZH, l.JSJSDJ, nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) LC, l.XJSDJ, l.JSXZ, l.QDMC, l.ZDMC, l.BZCS, l.SFFIRST, l.JDBS, l.JSFA, l.YILC, l.ERLC, l.SANLC, l.SILC, l.DWLC, l.WLLC, l.JHYILC, l.JHERLC, l.JHSANLC, l.JHSILC, l.JHDWLC, l.JHWLLC, l.XJLXBM, l.XJQDZH, l.XJZDZH, l.XJLC, l.JHLC, l.GHLXBM, l.GHLXMC, l.LXLMKD, l.XZQHDM2, l.XZQHMC2, l.GXLXBM, l.GXQDZH, l.GXZDZH, l.GHQDZH, l.GHZDZH ,
		decode(gpsqdzh,null,l.qdzh,gpsqdzh) gpsqdzh,decode(gpszdzh,null,l.zdzh,gpszdzh) gpszdzh from kxxyj_xj k left join lxsh_xj t on k.xmbm=t.xmbm  left join lxsh_lx l on k.xmbm=l.xmid
		left join(select max(gpszdzh) gpszdzh1,min(gpsqdzh) gpsqdzh1,xmid from LXSH_LX group by xmid) lxx on k.xmbm=lxx.xmid
		where k.xmbm =#{xmbm} and l.jdbs='1' and l.sffirst='1'
	</select>
	
	<select id="queryLmsjKxxyjqxByXmbm" parameterType="jhsh" resultType="kxxyj">
		select k.*,t.xmklx,l.XMID, l.LXBM, l.LXMC, l.XZQH, l.XZQHDM, l.GYDW, decode(k.gydwdm1,null,l.gydwdm) gydwdm, l.QDZH, l.ZDZH, l.JSJSDJ, nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) LC, l.XJSDJ, l.JSXZ, l.QDMC, l.ZDMC, l.BZCS, l.SFFIRST, l.JDBS, l.JSFA, l.YILC, l.ERLC, l.SANLC, l.SILC, l.DWLC, l.WLLC, l.JHYILC, l.JHERLC, l.JHSANLC, l.JHSILC, l.JHDWLC, l.JHWLLC, l.XJLXBM, l.XJQDZH, l.XJZDZH, l.XJLC, l.JHLC, l.GHLXBM, l.GHLXMC, l.LXLMKD, l.XZQHDM2, l.XZQHMC2, l.GXLXBM, l.GXQDZH, l.GXZDZH, l.GHQDZH, l.GHZDZH ,
		decode(gpsqdzh,null,l.qdzh,gpsqdzh) gpsqdzh,decode(gpszdzh,null,l.zdzh,gpszdzh) gpszdzh from kxxyj_sjgz_qx k left join lxsh_sjgz_qx t on k.xmbm=t.xmbm left join lxsh_lx l on k.xmbm=l.xmid
		left join(select max(gpszdzh) gpszdzh1,min(gpsqdzh) gpsqdzh1,xmid from LXSH_LX group by xmid) lxx on k.xmbm=lxx.xmid
	    where k.xmbm =#{xmbm} and l.jdbs='1' and l.sffirst='1'
	</select>
	<select id="queryLmgzKxxyjqxByXmbm" parameterType="jhsh" resultType="kxxyj">
		select k.*,t.xmklx,l.XMID, l.LXBM, l.LXMC, l.XZQH, l.XZQHDM, l.GYDW, decode(k.gydwdm1,null,l.gydwdm) gydwdm, l.QDZH, l.ZDZH, l.JSJSDJ, nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) LC, l.XJSDJ, l.JSXZ, l.QDMC, l.ZDMC, l.BZCS, l.SFFIRST, l.JDBS, l.JSFA, l.YILC, l.ERLC, l.SANLC, l.SILC, l.DWLC, l.WLLC, l.JHYILC, l.JHERLC, l.JHSANLC, l.JHSILC, l.JHDWLC, l.JHWLLC, l.XJLXBM, l.XJQDZH, l.XJZDZH, l.XJLC, l.JHLC, l.GHLXBM, l.GHLXMC, l.LXLMKD, l.XZQHDM2, l.XZQHMC2, l.GXLXBM, l.GXQDZH, l.GXZDZH, l.GHQDZH, l.GHZDZH ,
		decode(gpsqdzh,null,l.qdzh,gpsqdzh) gpsqdzh,decode(gpszdzh,null,l.zdzh,gpszdzh) gpszdzh from kxxyj_lmgz_qx k left join lxsh_lmgz_qx t on k.xmbm=t.xmbm  left join lxsh_lx l on k.xmbm=l.xmid
		left join(select max(gpszdzh) gpszdzh1,min(gpsqdzh) gpsqdzh1,xmid from LXSH_LX group by xmid) lxx on k.xmbm=lxx.xmid
	    where k.xmbm =#{xmbm} and l.jdbs='1' and l.sffirst='1'
	</select>
	<select id="queryXjKxxyjqxByXmbm" parameterType="jhsh" resultType="kxxyj">
		select k.*,t.xmklx,l.XMID, l.LXBM, l.LXMC, l.XZQH, l.XZQHDM, l.GYDW, decode(k.gydwdm1,null,l.gydwdm) gydwdm, l.QDZH, l.ZDZH, l.JSJSDJ, nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) LC, l.XJSDJ, l.JSXZ, l.QDMC, l.ZDMC, l.BZCS, l.SFFIRST, l.JDBS, l.JSFA, l.YILC, l.ERLC, l.SANLC, l.SILC, l.DWLC, l.WLLC, l.JHYILC, l.JHERLC, l.JHSANLC, l.JHSILC, l.JHDWLC, l.JHWLLC, l.XJLXBM, l.XJQDZH, l.XJZDZH, l.XJLC, l.JHLC, l.GHLXBM, l.GHLXMC, l.LXLMKD, l.XZQHDM2, l.XZQHMC2, l.GXLXBM, l.GXQDZH, l.GXZDZH, l.GHQDZH, l.GHZDZH ,
		decode(gpsqdzh,null,l.qdzh,gpsqdzh) gpsqdzh,decode(gpszdzh,null,l.zdzh,gpszdzh) gpszdzh from kxxyj_xj_qx k left join lxsh_xj_qx t on k.xmbm=t.xmbm  left join lxsh_lx l on k.xmbm=l.xmid
		left join(select max(gpszdzh) gpszdzh1,min(gpsqdzh) gpsqdzh1,xmid from LXSH_LX group by xmid) lxx on k.xmbm=lxx.xmid
		where k.xmbm =#{xmbm} and l.jdbs='1' and l.sffirst='1'
	</select>
	
	<select id="queryShKxxyjByXmbm" parameterType="jhsh" resultType="kxxyj">
		select k.*,l.XMID, l.LXBM, l.LXMC, l.XZQH, l.XZQHDM, l.GYDW, decode(k.gydwdm1,null,l.gydwdm) gydwdm, l.QDZH, l.ZDZH, l.JSJSDJ, nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) LC, l.XJSDJ, l.JSXZ, l.QDMC, l.ZDMC, l.BZCS, l.SFFIRST, l.JDBS, l.JSFA, l.YILC, l.ERLC, l.SANLC, l.SILC, l.DWLC, l.WLLC, l.JHYILC, l.JHERLC, l.JHSANLC, l.JHSILC, l.JHDWLC, l.JHWLLC, l.XJLXBM, l.XJQDZH, l.XJZDZH, l.XJLC, l.JHLC, l.GHLXBM, l.GHLXMC, l.LXLMKD, l.XZQHDM2, l.XZQHMC2, l.GXLXBM, l.GXQDZH, l.GXZDZH, l.GHQDZH, l.GHZDZH ,
		decode(gpsqdzh,null,l.qdzh,gpsqdzh) gpsqdzh,decode(gpszdzh,null,l.zdzh,gpszdzh) gpszdzh from kxxyj_sh k left join lxsh_lx l on k.xmbm=l.xmid
		left join(select max(gpszdzh) gpszdzh1,min(gpsqdzh) gpsqdzh1,xmid from LXSH_LX group by xmid) lxx on k.xmbm=lxx.xmid
	    where xmbm =#{xmbm} and l.jdbs='1' and l.sffirst='1'
	</select>
	
	
	<!-- 路线操作部分 -->
	<update id="updateLx" parameterType="lx">
		update lxsh_lx l set 
		<if test="jsxz!=null">l.jsxz=#{jsxz},</if>
		<if test="jsfa!=null">l.jsfa=#{jsfa},</if>
		<if test="lxmc!=null">l.lxmc=#{lxmc},</if>
		<if test="qdmc!=null">l.qdmc=#{qdmc},</if>
		<if test="zdmc!=null">l.zdmc=#{zdmc},</if>
		<if test="yilc!=null and yilc!=''">l.yilc=#{yilc},</if>
		<if test="erlc!=null and erlc!=''">l.erlc=#{erlc},</if>
		<if test="sanlc!=null and sanlc!=''">l.sanlc=#{sanlc},</if>
		<if test="silc!=null and silc!=''">l.silc=#{silc},</if>
		<if test="dwlc!=null and dwlc!=''">l.dwlc=#{dwlc},</if>
		<if test="wllc!=null and wllc!=''">l.wllc=#{wllc},</if>
		<if test="jhyilc!=null and jhyilc!=''">l.jhyilc=#{jhyilc},</if>
		<if test="jherlc!=null and jherlc!=''">l.jherlc=#{jherlc},</if>
		<if test="jhsanlc!=null and jhsanlc!=''">l.jhsanlc=#{jhsanlc},</if>
		<if test="jhsilc!=null and jhsilc!=''">l.jhsilc=#{jhsilc},</if>
		<if test="jhdwlc!=null and jhdwlc!=''">l.jhdwlc=#{jhdwlc},</if>
		<if test="jhwllc!=null and jhwllc!=''">l.jhwllc=#{jhwllc},</if>
		<if test="xjlxbm!=null and xjlxbm!=''">l.xjlxbm=#{xjlxbm},</if>
		<if test="xjqdzh!=null">l.xjqdzh=#{xjqdzh},</if>
		<if test="xjzdzh!=null">l.xjzdzh=#{xjzdzh},</if>
		<if test="xjlc!=null and xjlc!=''">l.xjlc=#{xjlc},</if>
		<if test="lxbm!=null and lxbm!=''">l.lxbm=#{lxbm},</if>
		<if test="qdzh!=null and qdzh!=''">l.qdzh=#{qdzh},</if>
		<if test="zdzh!=null and zdzh!=''">l.zdzh=#{zdzh},</if>
		<if test="gydw!=null and gydw!=''">l.gydw=#{gydw},</if>
		<if test="gydwdm!=null and gydwdm!=''">l.gydwdm=#{gydwdm},</if>
		<if test="xzqh!=null and xzqh!=''">l.xzqh=#{xzqh},</if>
		<if test="xzqhdm!=null and xzqhdm!=''">l.xzqhdm=#{xzqhdm},</if>
		<if test="jsjsdj!=null and jsjsdj!=''">l.jsjsdj=#{jsjsdj},</if>
		<if test="xjsdj!=null and xjsdj!=''">l.xjsdj=#{xjsdj},</if>
<!-- 		<if test="bzcs!=null and bzcs!=''">l.bzcs=#{bzcs},</if> -->
		<if test="jszlc!=null and jszlc!=''">l.jhlc=#{jszlc},</if>
		<if test="ghlxbm != null">l.ghlxbm=#{ghlxbm},</if>
		<if test="ghlxmc != null">l.ghlxmc=#{ghlxmc},</if>
		<if test="ghqdzh != null">l.ghqdzh=#{ghqdzh},</if>
		<if test="ghzdzh != null">l.ghzdzh=#{ghzdzh},</if>
		<if test="gxlxbm != null">l.gxlxbm=#{gxlxbm},</if>
		<if test="gxqdzh != null">l.gxqdzh=#{gxqdzh},</if>
		<if test="gxzdzh != null">l.gxzdzh=#{gxzdzh},</if>
		<if test="gpsqdzh != null">l.gpsqdzh=#{gpsqdzh},</if>
		<if test="gpszdzh != null">l.gpszdzh=#{gpszdzh},</if>
		<if test="lqhntmchd != null">
        LQHNTMCHD = #{lqhntmchd},
      </if>
      <if test="lqhntmc != null">
        LQHNTMC = #{lqhntmc},
      </if>
      <if test="gxlqhntmchd != null">
        GXLQHNTMCHD = #{gxlqhntmchd},
      </if>
      <if test="gxlqhntmc != null">
        GXLQHNTMC = #{gxlqhntmc},
      </if>
      <if test="snhntmchd != null">
        SNHNTMCHD = #{snhntmchd},
      </if>
      <if test="snhntmc != null">
        SNHNTMC = #{snhntmc},
      </if>
      <if test="lqlmjdrzshd != null">
        LQLMJDRZSHD = #{lqlmjdrzshd},
      </if>
      <if test="lqlmjdrzs != null">
        LQLMJDRZS = #{lqlmjdrzs},
      </if>
      <if test="lqlmcbrzshd != null">
        LQLMCBRZSHD = #{lqlmcbrzshd},
      </if>
      <if test="lqlmcbrzs != null">
        LQLMCBRZS = #{lqlmcbrzs},
      </if>
      <if test="swjchd != null">
        SWJCHD = #{swjchd},
      </if>
      <if test="swjc != null">
        SWJC = #{swjc},
      </if>
      <if test="lqlmpmlqjdlzshd != null">
        LQLMPMLQJDLZSHD = #{lqlmpmlqjdlzshd},
      </if>
      <if test="lqlmpmlqjdlzs != null">
        LQLMPMLQJDLZS = #{lqlmpmlqjdlzs},
      </if>
      <if test="lqlmrhlqjdlzshd != null">
        LQLMRHLQJDLZSHD = #{lqlmrhlqjdlzshd},
      </if>
      <if test="lqlmrhlqjdlzs != null">
        LQLMRHLQJDLZS = #{lqlmrhlqjdlzs},
      </if>
      <if test="lqlmcblzshd != null">
        LQLMCBLZSHD = #{lqlmcblzshd},
      </if>
      <if test="lqlmcblzs != null">
        LQLMCBLZS = #{lqlmcblzs},
      </if>
      <if test="xzrxjchd != null">
        XZRXJCHD = #{xzrxjchd},
      </if>
      <if test="xzrxjc != null">
        XZRXJC = #{xzrxjc},
      </if>
      <if test="swjclzshd != null">
        SWJCLZSHD = #{swjclzshd},
      </if>
      <if test="swjclzs != null">
        SWJCLZS = #{swjclzs},
      </if>
      <if test="xfchd != null">
        XFCHD = #{xfchd},
      </if>
      <if test="xfc != null">
        XFC = #{xfc},
      </if>
      <if test="wcsnmbhd != null">
        WCSNMBHD = #{wcsnmbhd},
      </if>
      <if test="wcsnmb != null">
        WCSNMB = #{wcsnmb},
      </if>
      <if test="wcswjchd != null">
        WCSWJCHD = #{wcswjchd},
      </if>
      <if test="wcswjc != null">
        WCSWJC = #{wcswjc},
      </if>
      <if test="snhntmchbhd != null">
        SNHNTMCHBHD = #{snhntmchbhd},
      </if>
      <if test="snhntmchb != null">
        SNHNTMCHB = #{snhntmchb},
      </if>
      <if test="bxhd != null">
        BXHD = #{bxhd},
      </if>
      <if test="bx != null">
        BX = #{bx},
      </if>
      <if test="snhntmcsshhd != null">
        SNHNTMCSSHHD = #{snhntmcsshhd},
      </if>
      <if test="snhntmcssh != null">
        SNHNTMCSSH = #{snhntmcssh},
      </if>
		<if test="lmkd != null">
        lxlmkd = #{lmkd},
      </if>
		<if test="sbzj != null">
        sbzj = #{sbzj},
      </if>
		<if test="snhntmchbmj != null">
        snhntmchbmj = #{snhntmchbmj},
      </if>
      <if test="fcbc30 != null">
	        fcbc30=#{fcbc30},
	      </if>
	      <if test="bc6 != null">
	        bc6=#{bc6},
	      </if>
	      <if test="bc25 != null">
	        bc25=#{bc25},
	      </if>
	      <if test="bc30 != null">
	        bc30=#{bc30},
	      </if>
	      <if test="bmc25 != null">
	        bmc25=#{bmc25},
	      </if>
	      <if test="wfc != null">
	        wfc=#{wfc},
	      </if>
	      <if test="xjfc != null">
	        xjfc=#{xjfc},
	      </if>
	      <if test="fcbc30hd != null">
	        fcbc30hd=#{fcbc30hd},
	      </if>
	      <if test="bc6hd != null">
	        bc6hd=#{bc6hd},
	      </if>
	      <if test="bc25hd != null">
	        bc25hd=#{bc25hd},
	      </if>
	      <if test="bc30hd != null">
	        bc30hd=#{bc30hd},
	      </if>
	      <if test="bmc25hd != null">
	        bmc25hd=#{bmc25hd},
	      </if>
	      <if test="wfchd != null">
	        wfchd=#{wfchd},
	      </if>
	      <if test="xjfchd != null">
	        xjfchd=#{xjfchd},
	      </if>
		<if test="wbchd != null">
	        wbchd=#{wbchd},
	      </if>
	      <if test="wbc != null">
	        wbc=#{wbc},
	      </if>
		<if test="lc!=null and lc!=''">l.lc=#{lc},</if>
		l.xmid=#{xmid} 
		where l.xmid=#{xmid} 
		<if test="jdbs!=null and jdbs!=''">and jdbs=#{jdbs}</if>
		<if test="sffirst==1">and sffirst=1</if>
		<if test="id!=null and id!=''">and id=#{id}</if>
	</update>
	<select id="querylxshlxid" parameterType="lxsh" resultType="string">
	select id from lxsh_lx where xmid=#{xmid}  and sffirst='1' and jdbs=#{jdbs}
	</select>
	
	<update id="updateLxqwh" parameterType="lx">
		update lxsh_lx l set 
		<if test="jsxz!=null">l.jsxz=#{jsxz},</if>
		<if test="jsfa!=null">l.jsfa=#{jsfa},</if>
		<if test="lxmc!=null">l.lxmc=#{lxmc},</if>
		<if test="qdmc!=null">l.qdmc=#{qdmc},</if>
		<if test="zdmc!=null">l.zdmc=#{zdmc},</if>
		<if test="yilc!=null and yilc!=''">l.yilc=#{yilc},</if>
		<if test="erlc!=null and erlc!=''">l.erlc=#{erlc},</if>
		<if test="sanlc!=null and sanlc!=''">l.sanlc=#{sanlc},</if>
		<if test="silc!=null and silc!=''">l.silc=#{silc},</if>
		<if test="dwlc!=null and dwlc!=''">l.dwlc=#{dwlc},</if>
		<if test="wllc!=null and wllc!=''">l.wllc=#{wllc},</if>
		<if test="jhyilc!=null and jhyilc!=''">l.jhyilc=#{jhyilc},</if>
		<if test="jherlc!=null and jherlc!=''">l.jherlc=#{jherlc},</if>
		<if test="jhsanlc!=null and jhsanlc!=''">l.jhsanlc=#{jhsanlc},</if>
		<if test="jhsilc!=null and jhsilc!=''">l.jhsilc=#{jhsilc},</if>
		<if test="jhdwlc!=null and jhdwlc!=''">l.jhdwlc=#{jhdwlc},</if>
		<if test="jhwllc!=null and jhwllc!=''">l.jhwllc=#{jhwllc},</if>
		<if test="xjlxbm!=null and xjlxbm!=''">l.xjlxbm=#{xjlxbm},</if>
		<if test="xjqdzh!=null">l.xjqdzh=#{xjqdzh},</if>
		<if test="xjzdzh!=null">l.xjzdzh=#{xjzdzh},</if>
		<if test="xjlc!=null and xjlc!=''">l.xjlc=#{xjlc},</if>
		<if test="lxbm!=null and lxbm!=''">l.lxbm=#{lxbm},</if>
		<if test="qdzh!=null and qdzh!=''">l.qdzh=#{qdzh},</if>
		<if test="zdzh!=null and zdzh!=''">l.zdzh=#{zdzh},</if>
		<if test="gydw!=null and gydw!=''">l.gydw=#{gydw},</if>
		<if test="gydwdm!=null and gydwdm!=''">l.gydwdm=#{gydwdm},</if>
		<if test="xzqh!=null and xzqh!=''">l.xzqh=#{xzqh},</if>
		<if test="xzqhdm!=null and xzqhdm!=''">l.xzqhdm=#{xzqhdm},</if>
		<if test="jsjsdj!=null and jsjsdj!=''">l.jsjsdj=#{jsjsdj},</if>
		<if test="xjsdj!=null and xjsdj!=''">l.xjsdj=#{xjsdj},</if>
<!-- 		<if test="bzcs!=null and bzcs!=''">l.bzcs=#{bzcs},</if> -->
		<if test="jszlc!=null and jszlc!=''">l.jhlc=#{jszlc},</if>
		<if test="ghlxbm != null">l.ghlxbm=#{ghlxbm},</if>
		<if test="ghlxmc != null">l.ghlxmc=#{ghlxmc},</if>
		<if test="ghqdzh != null">l.ghqdzh=#{ghqdzh},</if>
		<if test="ghzdzh != null">l.ghzdzh=#{ghzdzh},</if>
		<if test="gxlxbm != null">l.gxlxbm=#{gxlxbm},</if>
		<if test="gxqdzh != null">l.gxqdzh=#{gxqdzh},</if>
		<if test="gxzdzh != null">l.gxzdzh=#{gxzdzh},</if>
		<if test="gpsqdzh != null">l.gpsqdzh=#{gpsqdzh},</if>
		<if test="gpszdzh != null">l.gpszdzh=#{gpszdzh},</if>
		<if test="lqhntmchd != null">
        LQHNTMCHD = #{lqhntmchd},
      </if>
      <if test="lqhntmc != null">
        LQHNTMC = #{lqhntmc},
      </if>
      <if test="gxlqhntmchd != null">
        GXLQHNTMCHD = #{gxlqhntmchd},
      </if>
      <if test="gxlqhntmc != null">
        GXLQHNTMC = #{gxlqhntmc},
      </if>
      <if test="snhntmchd != null">
        SNHNTMCHD = #{snhntmchd},
      </if>
      <if test="snhntmc != null">
        SNHNTMC = #{snhntmc},
      </if>
      <if test="lqlmjdrzshd != null">
        LQLMJDRZSHD = #{lqlmjdrzshd},
      </if>
      <if test="lqlmjdrzs != null">
        LQLMJDRZS = #{lqlmjdrzs},
      </if>
      <if test="lqlmcbrzshd != null">
        LQLMCBRZSHD = #{lqlmcbrzshd},
      </if>
      <if test="lqlmcbrzs != null">
        LQLMCBRZS = #{lqlmcbrzs},
      </if>
      <if test="swjchd != null">
        SWJCHD = #{swjchd},
      </if>
      <if test="swjc != null">
        SWJC = #{swjc},
      </if>
      <if test="lqlmpmlqjdlzshd != null">
        LQLMPMLQJDLZSHD = #{lqlmpmlqjdlzshd},
      </if>
      <if test="lqlmpmlqjdlzs != null">
        LQLMPMLQJDLZS = #{lqlmpmlqjdlzs},
      </if>
      <if test="lqlmrhlqjdlzshd != null">
        LQLMRHLQJDLZSHD = #{lqlmrhlqjdlzshd},
      </if>
      <if test="lqlmrhlqjdlzs != null">
        LQLMRHLQJDLZS = #{lqlmrhlqjdlzs},
      </if>
      <if test="lqlmcblzshd != null">
        LQLMCBLZSHD = #{lqlmcblzshd},
      </if>
      <if test="lqlmcblzs != null">
        LQLMCBLZS = #{lqlmcblzs},
      </if>
      <if test="xzrxjchd != null">
        XZRXJCHD = #{xzrxjchd},
      </if>
      <if test="xzrxjc != null">
        XZRXJC = #{xzrxjc},
      </if>
      <if test="swjclzshd != null">
        SWJCLZSHD = #{swjclzshd},
      </if>
      <if test="swjclzs != null">
        SWJCLZS = #{swjclzs},
      </if>
      <if test="xfchd != null">
        XFCHD = #{xfchd},
      </if>
      <if test="xfc != null">
        XFC = #{xfc},
      </if>
      <if test="wcsnmbhd != null">
        WCSNMBHD = #{wcsnmbhd},
      </if>
      <if test="wcsnmb != null">
        WCSNMB = #{wcsnmb},
      </if>
      <if test="wcswjchd != null">
        WCSWJCHD = #{wcswjchd},
      </if>
      <if test="wcswjc != null">
        WCSWJC = #{wcswjc},
      </if>
      <if test="snhntmchbhd != null">
        SNHNTMCHBHD = #{snhntmchbhd},
      </if>
      <if test="snhntmchb != null">
        SNHNTMCHB = #{snhntmchb},
      </if>
      <if test="bxhd != null">
        BXHD = #{bxhd},
      </if>
      <if test="bx != null">
        BX = #{bx},
      </if>
      <if test="snhntmcsshhd != null">
        SNHNTMCSSHHD = #{snhntmcsshhd},
      </if>
      <if test="snhntmcssh != null">
        SNHNTMCSSH = #{snhntmcssh},
      </if>
		<if test="lmkd != null">
        lxlmkd = #{lmkd},
      </if>
		<if test="sbzj != null">
        sbzj = #{sbzj},
      </if>
		<if test="snhntmchbmj != null">
        snhntmchbmj = #{snhntmchbmj},
      </if>
      <if test="fcbc30 != null">
	        fcbc30=#{fcbc30},
	      </if>
	      <if test="bc6 != null">
	        bc6=#{bc6},
	      </if>
	      <if test="bc25 != null">
	        bc25=#{bc25},
	      </if>
	      <if test="bc30 != null">
	        bc30=#{bc30},
	      </if>
	      <if test="bmc25 != null">
	        bmc25=#{bmc25},
	      </if>
	      <if test="wfc != null">
	        wfc=#{wfc},
	      </if>
	      <if test="xjfc != null">
	        xjfc=#{xjfc},
	      </if>
	      <if test="fcbc30hd != null">
	        fcbc30hd=#{fcbc30hd},
	      </if>
	      <if test="bc6hd != null">
	        bc6hd=#{bc6hd},
	      </if>
	      <if test="bc25hd != null">
	        bc25hd=#{bc25hd},
	      </if>
	      <if test="bc30hd != null">
	        bc30hd=#{bc30hd},
	      </if>
	      <if test="bmc25hd != null">
	        bmc25hd=#{bmc25hd},
	      </if>
	      <if test="wfchd != null">
	        wfchd=#{wfchd},
	      </if>
	      <if test="xjfchd != null">
	        xjfchd=#{xjfchd},
	      </if>
		<if test="wbchd != null">
	        wbchd=#{wbchd},
	      </if>
	      <if test="wbc != null">
	        wbc=#{wbc},
	      </if>
      
		<if test="lc!=null and lc!=''">l.lc=#{lc},</if>
		l.xmid=#{xmid} 
		where l.xmid=#{xmbm1} 
		<if test="jdbs!=null and jdbs!=''">and jdbs=#{jdbs}</if>
		<if test="sffirst==1">and sffirst=1</if>
		<if test="id!=null and id!=''">and id=#{id}</if>
	</update>
	<update id="updateLxqwhxmbm" parameterType="lx">
	update lxsh_lx set xmid=#{xmid} where xmid=#{xmbm1} 
	</update>
	
	
	
	
	
	<update id="updateyhdzxLx" parameterType="hashmap">
		update lxsh_lx l set 
		<if test="lx.jsxz!=null">l.jsxz=#{lx.jsxz},</if>
		<if test="lx.lxmc!=null">l.lxmc=#{lx.lxmc},</if>
		<if test="lx.qdmc!=null">l.qdmc=#{lx.qdmc},</if>
		<if test="lx.zdmc!=null">l.zdmc=#{lx.zdmc},</if>
		<if test="lx.yilc!=null and lx.yilc!=''">l.yilc=#{lx.yilc},</if>
		<if test="lx.erlc!=null and lx.erlc!=''">l.erlc=#{lx.erlc},</if>
		<if test="lx.sanlc!=null and lx.sanlc!=''">l.sanlc=#{lx.sanlc},</if>
		<if test="lx.silc!=null and lx.silc!=''">l.silc=#{lx.silc},</if>
		<if test="lx.dwlc!=null and lx.dwlc!=''">l.dwlc=#{lx.dwlc},</if>
		<if test="lx.wllc!=null and lx.wllc!=''">l.wllc=#{lx.wllc},</if>
		<if test="lx.jhyilc!=null and lx.jhyilc!=''">l.jhyilc=#{lx.jhyilc},</if>
		<if test="lx.jherlc!=null and lx.jherlc!=''">l.jherlc=#{lx.jherlc},</if>
		<if test="lx.jhsanlc!=null and lx.jhsanlc!=''">l.jhsanlc=#{lx.jhsanlc},</if>
		<if test="lx.jhsilc!=null and lx.jhsilc!=''">l.jhsilc=#{lx.jhsilc},</if>
		<if test="lx.jhdwlc!=null and lx.jhdwlc!=''">l.jhdwlc=#{lx.jhdwlc},</if>
		<if test="lx.jhwllc!=null and lx.jhwllc!=''">l.jhwllc=#{lx.jhwllc},</if>
		<if test="lx.xjlxbm!=null and lx.xjlxbm!=''">l.xjlxbm=#{lx.xjlxbm},</if>
		<if test="lx.xjqdzh!=null">l.xjqdzh=#{lx.xjqdzh},</if>
		<if test="lx.xjzdzh!=null">l.xjzdzh=#{lx.xjzdzh},</if>
		<if test="lx.xjlc!=null and lx.xjlc!=''">l.xjlc=#{lx.xjlc},</if>
		<if test="lx.lxbm!=null and lx.lxbm!=''">l.lxbm=#{lx.lxbm},</if>
		<if test="lx.qdzh!=null and lx.qdzh!=''">l.qdzh=#{lx.qdzh},</if>
		<if test="lx.zdzh!=null and lx.zdzh!=''">l.zdzh=#{lx.zdzh},</if>
		<if test="lx.gydw!=null and lx.gydw!=''">l.gydw=#{lx.gydw},</if>
		<if test="lx.gydwdm!=null and lx.gydwdm!=''">l.gydwdm=#{lx.gydwdm},</if>
		<if test="lx.xzqh!=null and lx.xzqh!=''">l.xzqh=#{lx.xzqh},</if>
		<if test="lx.xzqhdm!=null and lx.xzqhdm!=''">l.xzqhdm=#{lx.xzqhdm},</if>
		<if test="lx.jsjsdj!=null and lx.jsjsdj!=''">l.jsjsdj=#{lx.jsjsdj},</if>
		<if test="lx.xjsdj!=null and lx.xjsdj!=''">l.xjsdj=#{lx.xjsdj},</if>
<!-- 		<if test="lx.bzcs!=null and lx.bzcs!=''">l.bzcs=#{lx.bzcs},</if> -->
		<if test="lx.jszlc!=null and lx.jszlc!=''">l.jhlc=#{lx.jszlc},</if>
		<if test="xmsq.ghlxbm != null">l.ghlxbm=#{xmsq.ghlxbm},</if>
		<if test="xmsq.ghlxmc != null">l.ghlxmc=#{xmsq.ghlxmc},</if>
		<if test="xmsq.ghqdzh != null">l.ghqdzh=#{xmsq.ghqdzh},</if>
		<if test="xmsq.ghzdzh != null">l.ghzdzh=#{xmsq.ghzdzh},</if>
		<if test="xmsq.gxlxbm != null">l.gxlxbm=#{xmsq.gxlxbm},</if>
		<if test="xmsq.gxqdzh != null">l.gxqdzh=#{xmsq.gxqdzh},</if>
		<if test="xmsq.gxzdzh != null">l.gxzdzh=#{xmsq.gxzdzh},</if>
		
		<if test="xmsq.lqhntmchd != null">
        LQHNTMCHD = #{xmsq.lqhntmchd},
      </if>
      
      <if test="xmsq.lqhntmc != null">
        LQHNTMC = #{xmsq.lqhntmc},
      </if>
      <if test="xmsq.gxlqhntmchd != null">
        GXLQHNTMCHD = #{xmsq.gxlqhntmchd},
      </if>
      <if test="xmsq.gxlqhntmc != null">
        GXLQHNTMC = #{xmsq.gxlqhntmc},
      </if>
      <if test="xmsq.snhntmchd != null">
        SNHNTMCHD = #{xmsq.snhntmchd},
      </if>
      <if test="xmsq.snhntmc != null">
        SNHNTMC = #{xmsq.snhntmc},
      </if>
      <if test="xmsq.lqlmjdrzshd != null">
        LQLMJDRZSHD = #{xmsq.lqlmjdrzshd},
      </if>
      <if test="xmsq.lqlmjdrzs != null">
        LQLMJDRZS = #{xmsq.lqlmjdrzs},
      </if>
      <if test="xmsq.lqlmcbrzshd != null">
        LQLMCBRZSHD = #{xmsq.lqlmcbrzshd},
      </if>
      <if test="xmsq.lqlmcbrzs != null">
        LQLMCBRZS = #{xmsq.lqlmcbrzs},
      </if>
      <if test="xmsq.swjchd != null">
        SWJCHD = #{xmsq.swjchd},
      </if>
      <if test="xmsq.swjc != null">
        SWJC = #{xmsq.swjc},
      </if>
      <if test="xmsq.lqlmpmlqjdlzshd != null">
        LQLMPMLQJDLZSHD = #{xmsq.lqlmpmlqjdlzshd},
      </if>
      <if test="xmsq.lqlmpmlqjdlzs != null">
        LQLMPMLQJDLZS = #{xmsq.lqlmpmlqjdlzs},
      </if>
      <if test="xmsq.lqlmrhlqjdlzshd != null">
        LQLMRHLQJDLZSHD = #{xmsq.lqlmrhlqjdlzshd},
      </if>
      <if test="xmsq.lqlmrhlqjdlzs != null">
        LQLMRHLQJDLZS = #{xmsq.lqlmrhlqjdlzs},
      </if>
      <if test="xmsq.lqlmcblzshd != null">
        LQLMCBLZSHD = #{xmsq.lqlmcblzshd},
      </if>
      <if test="xmsq.lqlmcblzs != null">
        LQLMCBLZS = #{xmsq.lqlmcblzs},
      </if>
      <if test="xmsq.xzrxjchd != null">
        XZRXJCHD = #{xmsq.xzrxjchd},
      </if>
      <if test="xmsq.xzrxjc != null">
        XZRXJC = #{xmsq.xzrxjc},
      </if>
      <if test="xmsq.swjclzshd != null">
        SWJCLZSHD = #{xmsq.swjclzshd},
      </if>
      <if test="xmsq.swjclzs != null">
        SWJCLZS = #{xmsq.swjclzs},
      </if>
      <if test="xmsq.xfchd != null">
        XFCHD = #{xmsq.xfchd},
      </if>
      <if test="xmsq.xfc != null">
        XFC = #{xmsq.xfc},
      </if>
      <if test="xmsq.wcsnmbhd != null">
        WCSNMBHD = #{xmsq.wcsnmbhd},
      </if>
      <if test="xmsq.wcsnmb != null">
        WCSNMB = #{xmsq.wcsnmb},
      </if>
      <if test="xmsq.wcswjchd != null">
        WCSWJCHD = #{xmsq.wcswjchd},
      </if>
      <if test="xmsq.wcswjc != null">
        WCSWJC = #{xmsq.wcswjc},
      </if>
      <if test="xmsq.snhntmchbhd != null">
        SNHNTMCHBHD = #{xmsq.snhntmchbhd},
      </if>
      <if test="xmsq.snhntmchb != null">
        SNHNTMCHB = #{xmsq.snhntmchb},
      </if>
      <if test="xmsq.bxhd != null">
        BXHD = #{xmsq.bxhd},
      </if>
      <if test="xmsq.bx != null">
        BX = #{xmsq.bx},
      </if>
      <if test="xmsq.snhntmcsshhd != null">
        SNHNTMCSSHHD = #{xmsq.snhntmcsshhd},
      </if>
      <if test="xmsq.snhntmcssh != null">
        SNHNTMCSSH = #{xmsq.snhntmcssh},
      </if>
      <if test="xmsq.snhntmchbmj != null">
        SNHNTMCHBMJ = #{xmsq.snhntmchbmj},
      </if>
		<if test="xmsq.sbzj != null">
        sbzj = #{xmsq.sbzj},
      </if>
		<if test="xmsq.fcbc30 != null">
	        fcbc30=#{xmsq.fcbc30},
	      </if>
	      <if test="xmsq.bc6 != null">
	        bc6=#{xmsq.bc6},
	      </if>
	      <if test="xmsq.bc25 != null">
	        bc25=#{xmsq.bc25},
	      </if>
	      <if test="xmsq.bc30 != null">
	        bc30=#{xmsq.bc30},
	      </if>
	      <if test="xmsq.bmc25 != null">
	        bmc25=#{xmsq.bmc25},
	      </if>
	      <if test="xmsq.wfc != null">
	        wfc=#{xmsq.wfc},
	      </if>
	      <if test="xmsq.xjfc != null">
	        xjfc=#{xmsq.xjfc},
	      </if>
	      <if test="xmsq.fcbc30hd != null">
	        fcbc30hd=#{xmsq.fcbc30hd},
	      </if>
	      <if test="xmsq.bc6hd != null">
	        bc6hd=#{xmsq.bc6hd},
	      </if>
	      <if test="xmsq.bc25hd != null">
	        bc25hd=#{xmsq.bc25hd},
	      </if>
	      <if test="xmsq.bc30hd != null">
	        bc30hd=#{xmsq.bc30hd},
	      </if>
	      <if test="xmsq.bmc25hd != null">
	        bmc25hd=#{xmsq.bmc25hd},
	      </if>
	      <if test="xmsq.wfchd != null">
	        wfchd=#{xmsq.wfchd},
	      </if>
	      <if test="xmsq.xjfchd != null">
	        xjfchd=#{xmsq.xjfchd},
	      </if>
		<if test="xmsq.wbchd != null">
	        wbchd=#{xmsq.wbchd},
	      </if>
	      <if test="xmsq.wbc != null">
	        wbc=#{xmsq.wbc},
	      </if>
		<if test="lx.lc!=null and lx.lc!=''">l.lc=#{lx.lc},</if>
		
		l.xmid=#{lx.xmid} 
		where l.xmid=#{lx.xmid} 
		<if test="lx.jdbs!=null and lx.jdbs!=''">and jdbs=#{lx.jdbs}</if>
		<if test="lx.sffirst==1">and sffirst=1</if>
		<if test="lx.id!=null and lx.id!=''">and id=#{lx.id}</if>
	</update>
	<update id="updateLxshm" parameterType="hashmap">
		update lxsh_lx l set 
		<if test="lx.jsxz!=null">l.jsxz=#{lx.jsxz},</if>
		<if test="lx.lxmc!=null">l.lxmc=#{lx.lxmc},</if>
		<if test="lx.qdmc!=null">l.qdmc=#{lx.qdmc},</if>
		<if test="lx.zdmc!=null">l.zdmc=#{lx.zdmc},</if>
		<if test="lx.yilc!=null and lx.yilc!=''">l.yilc=#{lx.yilc},</if>
		<if test="lx.erlc!=null and lx.erlc!=''">l.erlc=#{lx.erlc},</if>
		<if test="lx.sanlc!=null and lx.sanlc!=''">l.sanlc=#{lx.sanlc},</if>
		<if test="lx.silc!=null and lx.silc!=''">l.silc=#{lx.silc},</if>
		<if test="lx.dwlc!=null and lx.dwlc!=''">l.dwlc=#{lx.dwlc},</if>
		<if test="lx.wllc!=null and lx.wllc!=''">l.wllc=#{lx.wllc},</if>
		<if test="lx.jhyilc!=null and lx.jhyilc!=''">l.jhyilc=#{lx.jhyilc},</if>
		<if test="lx.jherlc!=null and lx.jherlc!=''">l.jherlc=#{lx.jherlc},</if>
		<if test="lx.jhsanlc!=null and lx.jhsanlc!=''">l.jhsanlc=#{lx.jhsanlc},</if>
		<if test="lx.jhsilc!=null and lx.jhsilc!=''">l.jhsilc=#{lx.jhsilc},</if>
		<if test="lx.jhdwlc!=null and lx.jhdwlc!=''">l.jhdwlc=#{lx.jhdwlc},</if>
		<if test="lx.jhwllc!=null and lx.jhwllc!=''">l.jhwllc=#{lx.jhwllc},</if>
		<if test="lx.xjlxbm!=null and lx.xjlxbm!=''">l.xjlxbm=#{lx.xjlxbm},</if>
		<if test="lx.xjqdzh!=null">l.xjqdzh=#{lx.xjqdzh},</if>
		<if test="lx.xjzdzh!=null">l.xjzdzh=#{lx.xjzdzh},</if>
		<if test="lx.xjlc!=null and lx.xjlc!=''">l.xjlc=#{lx.xjlc},</if>
		<if test="lx.lxbm!=null and lx.lxbm!=''">l.lxbm=#{lx.lxbm},</if>
		<if test="lx.qdzh!=null and lx.qdzh!=''">l.qdzh=#{lx.qdzh},</if>
		<if test="lx.zdzh!=null and lx.zdzh!=''">l.zdzh=#{lx.zdzh},</if>
		<if test="lx.gydw!=null and lx.gydw!=''">l.gydw=#{lx.gydw},</if>
		<if test="lx.gydwdm!=null and lx.gydwdm!=''">l.gydwdm=#{lx.gydwdm},</if>
		<if test="lx.xzqh!=null and lx.xzqh!=''">l.xzqh=#{lx.xzqh},</if>
		<if test="lx.xzqhdm!=null and lx.xzqhdm!=''">l.xzqhdm=#{lx.xzqhdm},</if>
		<if test="lx.jsjsdj!=null and lx.jsjsdj!=''">l.jsjsdj=#{lx.jsjsdj},</if>
		<if test="lx.xjsdj!=null and lx.xjsdj!=''">l.xjsdj=#{lx.xjsdj},</if>
<!-- 		<if test="lx.bzcs!=null and lx.bzcs!=''">l.bzcs=#{lx.bzcs},</if> -->
		<if test="lx.jszlc!=null and lx.jszlc!=''">l.jhlc=#{lx.jszlc},</if>
		<if test="xmsq.ghlxbm != null">l.ghlxbm=#{xmsq.ghlxbm},</if>
		<if test="xmsq.ghlxmc != null">l.ghlxmc=#{xmsq.ghlxmc},</if>
		<if test="xmsq.ghqdzh != null">l.ghqdzh=#{xmsq.ghqdzh},</if>
		<if test="xmsq.ghzdzh != null">l.ghzdzh=#{xmsq.ghzdzh},</if>
		<if test="xmsq.gxlxbm != null">l.gxlxbm=#{xmsq.gxlxbm},</if>
		<if test="xmsq.gxqdzh != null">l.gxqdzh=#{xmsq.gxqdzh},</if>
		<if test="xmsq.gxzdzh != null">l.gxzdzh=#{xmsq.gxzdzh},</if>
		
		<if test="xmsq.lqhntmchd != null">
        LQHNTMCHD = #{xmsq.lqhntmchd},
      </if>
      
      <if test="xmsq.lqhntmc != null">
        LQHNTMC = #{xmsq.lqhntmc},
      </if>
      <if test="xmsq.gxlqhntmchd != null">
        GXLQHNTMCHD = #{xmsq.gxlqhntmchd},
      </if>
      <if test="xmsq.gxlqhntmc != null">
        GXLQHNTMC = #{xmsq.gxlqhntmc},
      </if>
      <if test="xmsq.snhntmchd != null">
        SNHNTMCHD = #{xmsq.snhntmchd},
      </if>
      <if test="xmsq.snhntmc != null">
        SNHNTMC = #{xmsq.snhntmc},
      </if>
      <if test="xmsq.lqlmjdrzshd != null">
        LQLMJDRZSHD = #{xmsq.lqlmjdrzshd},
      </if>
      <if test="xmsq.lqlmjdrzs != null">
        LQLMJDRZS = #{xmsq.lqlmjdrzs},
      </if>
      <if test="xmsq.lqlmcbrzshd != null">
        LQLMCBRZSHD = #{xmsq.lqlmcbrzshd},
      </if>
      <if test="xmsq.lqlmcbrzs != null">
        LQLMCBRZS = #{xmsq.lqlmcbrzs},
      </if>
      <if test="xmsq.swjchd != null">
        SWJCHD = #{xmsq.swjchd},
      </if>
      <if test="xmsq.swjc != null">
        SWJC = #{xmsq.swjc},
      </if>
      <if test="xmsq.lqlmpmlqjdlzshd != null">
        LQLMPMLQJDLZSHD = #{xmsq.lqlmpmlqjdlzshd},
      </if>
      <if test="xmsq.lqlmpmlqjdlzs != null">
        LQLMPMLQJDLZS = #{xmsq.lqlmpmlqjdlzs},
      </if>
      <if test="xmsq.lqlmrhlqjdlzshd != null">
        LQLMRHLQJDLZSHD = #{xmsq.lqlmrhlqjdlzshd},
      </if>
      <if test="xmsq.lqlmrhlqjdlzs != null">
        LQLMRHLQJDLZS = #{xmsq.lqlmrhlqjdlzs},
      </if>
      <if test="xmsq.lqlmcblzshd != null">
        LQLMCBLZSHD = #{xmsq.lqlmcblzshd},
      </if>
      <if test="xmsq.lqlmcblzs != null">
        LQLMCBLZS = #{xmsq.lqlmcblzs},
      </if>
      <if test="xmsq.xzrxjchd != null">
        XZRXJCHD = #{xmsq.xzrxjchd},
      </if>
      <if test="xmsq.xzrxjc != null">
        XZRXJC = #{xmsq.xzrxjc},
      </if>
      <if test="xmsq.swjclzshd != null">
        SWJCLZSHD = #{xmsq.swjclzshd},
      </if>
      <if test="xmsq.swjclzs != null">
        SWJCLZS = #{xmsq.swjclzs},
      </if>
      <if test="xmsq.xfchd != null">
        XFCHD = #{xmsq.xfchd},
      </if>
      <if test="xmsq.xfc != null">
        XFC = #{xmsq.xfc},
      </if>
      <if test="xmsq.wcsnmbhd != null">
        WCSNMBHD = #{xmsq.wcsnmbhd},
      </if>
      <if test="xmsq.wcsnmb != null">
        WCSNMB = #{xmsq.wcsnmb},
      </if>
      <if test="xmsq.wcswjchd != null">
        WCSWJCHD = #{xmsq.wcswjchd},
      </if>
      <if test="xmsq.wcswjc != null">
        WCSWJC = #{xmsq.wcswjc},
      </if>
      <if test="xmsq.snhntmchbhd != null">
        SNHNTMCHBHD = #{xmsq.snhntmchbhd},
      </if>
      <if test="xmsq.snhntmchb != null">
        SNHNTMCHB = #{xmsq.snhntmchb},
      </if>
      <if test="xmsq.bxhd != null">
        BXHD = #{xmsq.bxhd},
      </if>
      <if test="xmsq.bx != null">
        BX = #{xmsq.bx},
      </if>
      <if test="xmsq.snhntmcsshhd != null">
        SNHNTMCSSHHD = #{xmsq.snhntmcsshhd},
      </if>
      <if test="xmsq.snhntmcssh != null">
        SNHNTMCSSH = #{xmsq.snhntmcssh},
      </if>
      <if test="xmsq.snhntmchbmj != null">
        SNHNTMCHBMJ = #{xmsq.snhntmchbmj},
      </if>
		<if test="xmsq.sbzj != null">
        sbzj = #{xmsq.sbzj},
      </if>
		<if test="xmsq.fcbc30 != null">
	        fcbc30=#{xmsq.fcbc30},
	      </if>
	      <if test="xmsq.bc6 != null">
	        bc6=#{xmsq.bc6},
	      </if>
	      <if test="xmsq.bc25 != null">
	        bc25=#{xmsq.bc25},
	      </if>
	      <if test="xmsq.bc30 != null">
	        bc30=#{xmsq.bc30},
	      </if>
	      <if test="xmsq.bmc25 != null">
	        bmc25=#{xmsq.bmc25},
	      </if>
	      <if test="xmsq.wfc != null">
	        wfc=#{xmsq.wfc},
	      </if>
	      <if test="xmsq.xjfc != null">
	        xjfc=#{xmsq.xjfc},
	      </if>
	      <if test="xmsq.fcbc30hd != null">
	        fcbc30hd=#{xmsq.fcbc30hd},
	      </if>
	      <if test="xmsq.bc6hd != null">
	        bc6hd=#{xmsq.bc6hd},
	      </if>
	      <if test="xmsq.bc25hd != null">
	        bc25hd=#{xmsq.bc25hd},
	      </if>
	      <if test="xmsq.bc30hd != null">
	        bc30hd=#{xmsq.bc30hd},
	      </if>
	      <if test="xmsq.bmc25hd != null">
	        bmc25hd=#{xmsq.bmc25hd},
	      </if>
	      <if test="xmsq.wfchd != null">
	        wfchd=#{xmsq.wfchd},
	      </if>
	      <if test="xmsq.xjfchd != null">
	        xjfchd=#{xmsq.xjfchd},
	      </if>
		<if test="xmsq.wbchd != null">
	        wbchd=#{xmsq.wbchd},
	      </if>
	      <if test="wbc != null">
	        wbc=#{xmsq.wbc},
	      </if>
		
		<if test="lx.lc!=null and lx.lc!=''">l.lc=#{lx.lc},</if>
		
		l.xmid=#{lx.xmid} 
		where l.xmid=#{lx.xmbm1} 
		<if test="lx.jdbs!=null and lx.jdbs!=''">and jdbs=#{lx.jdbs}</if>
		<if test="lx.sffirst==1">and sffirst=1</if>
		<if test="lx.id!=null and lx.id!=''">and id=#{lx.id}</if>
	</update>
	 <update id="updateyhdzxcbsjLx" parameterType="hashmap">
		update lxsh_lx l set 
		<if test="jsxz!=null">l.jsxz=#{jsxz},</if>
		<if test="lxmc!=null">l.lxmc=#{lxmc},</if>
		<if test="lx.qdmc!=null">l.qdmc=#{lx.qdmc},</if>
		<if test="lx.zdmc!=null">l.zdmc=#{lx.zdmc},</if>
		<if test="lx.yilc!=null and lx.yilc!=''">l.yilc=#{lx.yilc},</if>
		<if test="lx.erlc!=null and lx.erlc!=''">l.erlc=#{lx.erlc},</if>
		<if test="lx.sanlc!=null and lx.sanlc!=''">l.sanlc=#{lx.sanlc},</if>
		<if test="lx.silc!=null and lx.silc!=''">l.silc=#{lx.silc},</if>
		<if test="lx.dwlc!=null and lx.dwlc!=''">l.dwlc=#{lx.dwlc},</if>
		<if test="lx.wllc!=null and lx.wllc!=''">l.wllc=#{lx.wllc},</if>
		<if test="lx.jhyilc!=null and lx.jhyilc!=''">l.jhyilc=#{lx.jhyilc},</if>
		<if test="lx.jherlc!=null and lx.jherlc!=''">l.jherlc=#{lx.jherlc},</if>
		<if test="lx.jhsanlc!=null and lx.jhsanlc!=''">l.jhsanlc=#{lx.jhsanlc},</if>
		<if test="lx.jhsilc!=null and lx.jhsilc!=''">l.jhsilc=#{lx.jhsilc},</if>
		<if test="lx.jhdwlc!=null and lx.jhdwlc!=''">l.jhdwlc=#{lx.jhdwlc},</if>
		<if test="lx.jhwllc!=null and lx.jhwllc!=''">l.jhwllc=#{lx.jhwllc},</if>
		<if test="lx.xjlxbm!=null and lx.xjlxbm!=''">l.xjlxbm=#{lx.xjlxbm},</if>
		<if test="lx.xjqdzh!=null">l.xjqdzh=#{lx.xjqdzh},</if>
		<if test="lx.xjzdzh!=null">l.xjzdzh=#{lx.xjzdzh},</if>
		<if test="lx.xjlc!=null and lx.xjlc!=''">l.xjlc=#{lx.xjlc},</if>
		<if test="lx.lxbm!=null and lx.lxbm!=''">l.lxbm=#{lx.lxbm},</if>
		<if test="lx.qdzh!=null and lx.qdzh!=''">l.qdzh=#{lx.qdzh},</if>
		<if test="lx.zdzh!=null and lx.zdzh!=''">l.zdzh=#{lx.zdzh},</if>
		<if test="lx.gydw!=null and lx.gydw!=''">l.gydw=#{lx.gydw},</if>
		<if test="lx.gydwdm!=null and lx.gydwdm!=''">l.gydwdm=#{lx.gydwdm},</if>
		<if test="lx.xzqh!=null and lx.xzqh!=''">l.xzqh=#{lx.xzqh},</if>
		<if test="lx.xzqhdm!=null and lx.xzqhdm!=''">l.xzqhdm=#{lx.xzqhdm},</if>
		<if test="lx.jsjsdj!=null and lx.jsjsdj!=''">l.jsjsdj=#{lx.jsjsdj},</if>
		<if test="lx.xjsdj!=null and lx.xjsdj!=''">l.xjsdj=#{lx.xjsdj},</if>
		<if test="lx.bzcs!=null and lx.bzcs!=''">l.bzcs=#{lx.bzcs},</if>
		<if test="lx.jszlc!=null and lx.jszlc!=''">l.jhlc=#{lx.jszlc},</if>
		<if test="cbsj.ghlxbm != null">l.ghlxbm=#{cbsj.ghlxbm},</if>
		<if test="cbsj.ghlxmc != null">l.ghlxmc=#{cbsj.ghlxmc},</if>
		<if test="cbsj.ghqdzh != null">l.ghqdzh=#{cbsj.ghqdzh},</if>
		<if test="cbsj.ghzdzh != null">l.ghzdzh=#{cbsj.ghzdzh},</if>
		<if test="cbsj.gxlxbm != null">l.gxlxbm=#{cbsj.gxlxbm},</if>
		<if test="cbsj.gxqdzh != null">l.gxqdzh=#{cbsj.gxqdzh},</if>
		<if test="cbsj.gxzdzh != null">l.gxzdzh=#{cbsj.gxzdzh},</if>
		
		<if test="cbsj.lqhntmchd != null">
        LQHNTMCHD = #{cbsj.lqhntmchd},
      </if>
      
      <if test="cbsj.lqhntmc != null">
        LQHNTMC = #{cbsj.lqhntmc},
      </if>
      <if test="cbsj.gxlqhntmchd != null">
        GXLQHNTMCHD = #{cbsj.gxlqhntmchd},
      </if>
      <if test="cbsj.gxlqhntmc != null">
        GXLQHNTMC = #{cbsj.gxlqhntmc},
      </if>
      <if test="cbsj.snhntmchd != null">
        SNHNTMCHD = #{cbsj.snhntmchd},
      </if>
      <if test="cbsj.snhntmc != null">
        SNHNTMC = #{cbsj.snhntmc},
      </if>
      <if test="cbsj.lqlmjdrzshd != null">
        LQLMJDRZSHD = #{cbsj.lqlmjdrzshd},
      </if>
      <if test="cbsj.lqlmjdrzs != null">
        LQLMJDRZS = #{cbsj.lqlmjdrzs},
      </if>
      <if test="cbsj.lqlmcbrzshd != null">
        LQLMCBRZSHD = #{cbsj.lqlmcbrzshd},
      </if>
      <if test="cbsj.lqlmcbrzs != null">
        LQLMCBRZS = #{cbsj.lqlmcbrzs},
      </if>
      <if test="cbsj.swjchd != null">
        SWJCHD = #{cbsj.swjchd},
      </if>
      <if test="cbsj.swjc != null">
        SWJC = #{cbsj.swjc},
      </if>
      <if test="cbsj.lqlmpmlqjdlzshd != null">
        LQLMPMLQJDLZSHD = #{cbsj.lqlmpmlqjdlzshd},
      </if>
      <if test="cbsj.lqlmpmlqjdlzs != null">
        LQLMPMLQJDLZS = #{cbsj.lqlmpmlqjdlzs},
      </if>
      <if test="cbsj.lqlmrhlqjdlzshd != null">
        LQLMRHLQJDLZSHD = #{cbsj.lqlmrhlqjdlzshd},
      </if>
      <if test="cbsj.lqlmrhlqjdlzs != null">
        LQLMRHLQJDLZS = #{cbsj.lqlmrhlqjdlzs},
      </if>
      <if test="cbsj.lqlmcblzshd != null">
        LQLMCBLZSHD = #{cbsj.lqlmcblzshd},
      </if>
      <if test="cbsj.lqlmcblzs != null">
        LQLMCBLZS = #{cbsj.lqlmcblzs},
      </if>
      <if test="cbsj.xzrxjchd != null">
        XZRXJCHD = #{cbsj.xzrxjchd},
      </if>
      <if test="cbsj.xzrxjc != null">
        XZRXJC = #{cbsj.xzrxjc},
      </if>
      <if test="cbsj.swjclzshd != null">
        SWJCLZSHD = #{cbsj.swjclzshd},
      </if>
      <if test="cbsj.swjclzs != null">
        SWJCLZS = #{cbsj.swjclzs},
      </if>
      <if test="cbsj.xfchd != null">
        XFCHD = #{cbsj.xfchd},
      </if>
      <if test="cbsj.xfc != null">
        XFC = #{cbsj.xfc},
      </if>
      <if test="cbsj.wcsnmbhd != null">
        WCSNMBHD = #{cbsj.wcsnmbhd},
      </if>
      <if test="cbsj.wcsnmb != null">
        WCSNMB = #{cbsj.wcsnmb},
      </if>
      <if test="cbsj.wcswjchd != null">
        WCSWJCHD = #{cbsj.wcswjchd},
      </if>
      <if test="cbsj.wcswjc != null">
        WCSWJC = #{cbsj.wcswjc},
      </if>
      <if test="cbsj.snhntmchbhd != null">
        SNHNTMCHBHD = #{cbsj.snhntmchbhd},
      </if>
      <if test="cbsj.snhntmchb != null">
        SNHNTMCHB = #{cbsj.snhntmchb},
      </if>
      <if test="cbsj.bxhd != null">
        BXHD = #{cbsj.bxhd},
      </if>
      <if test="cbsj.bx != null">
        BX = #{cbsj.bx},
      </if>
      <if test="cbsj.snhntmcsshhd != null">
        SNHNTMCSSHHD = #{cbsj.snhntmcsshhd},
      </if>
      <if test="cbsj.snhntmcssh != null">
        SNHNTMCSSH = #{cbsj.snhntmcssh},
      </if>
      <if test="cbsj.snhntmchbmj != null">
        SNHNTMCHBMJ = #{cbsj.snhntmchbmj},
      </if>
		<if test="cbsj.sbzj != null">
        sbzj = #{cbsj.sbzj},
      </if>
		<if test="cbsj.fcbc30 != null">
	        fcbc30=#{cbsj.fcbc30},
	      </if>
	      <if test="cbsj.bc6 != null">
	        bc6=#{cbsj.bc6},
	      </if>
	      <if test="cbsj.bc25 != null">
	        bc25=#{cbsj.bc25},
	      </if>
	      <if test="cbsj.bc30 != null">
	        bc30=#{cbsj.bc30},
	      </if>
	      <if test="cbsj.bmc25 != null">
	        bmc25=#{cbsj.bmc25},
	      </if>
	      <if test="cbsj.wfc != null">
	        wfc=#{cbsj.wfc},
	      </if>
	      <if test="cbsj.xjfc != null">
	        xjfc=#{cbsj.xjfc},
	      </if>
	      <if test="cbsj.fcbc30hd != null">
	        fcbc30hd=#{cbsj.fcbc30hd},
	      </if>
	      <if test="cbsj.bc6hd != null">
	        bc6hd=#{cbsj.bc6hd},
	      </if>
	      <if test="cbsj.bc25hd != null">
	        bc25hd=#{cbsj.bc25hd},
	      </if>
	      <if test="cbsj.bc30hd != null">
	        bc30hd=#{cbsj.bc30hd},
	      </if>
	      <if test="cbsj.bmc25hd != null">
	        bmc25hd=#{cbsj.bmc25hd},
	      </if>
	      <if test="cbsj.wfchd != null">
	        wfchd=#{cbsj.wfchd},
	      </if>
	      <if test="cbsj.xjfchd != null">
	        xjfchd=#{cbsj.xjfchd},
	      </if>
	      <if test="cbsj.wbchd != null">
	        wbchd=#{cbsj.wbchd},
	      </if>
	      <if test="cbsj.wbc != null">
	        wbc=#{cbsj.wbc},
	      </if>
	      
		<if test="lx.lc!=null and lx.lc!=''">l.lc=#{lx.lc},</if>
		
		l.xmid=#{lx.xmid} 
		where l.xmid=#{lx.xmid} 
		<if test="lx.jdbs!=null and lx.jdbs!=''">and jdbs=#{lx.jdbs}</if>
		<if test="lx.sffirst==1">and sffirst=1</if>
		<if test="lx.id!=null and lx.id!=''">and id=#{lx.id}</if>
	</update>
	
	
	
	<insert id="insertLx" parameterType="lx">
		insert into lxsh_lx (id
		<if test="xmid!=null">,xmid</if>
		<if test="lxbm!=null">,lxbm</if>
		<if test="lxmc!=null">,lxmc</if>
		<if test="xzqh!=null">,xzqh</if>
		<if test="xzqhdm!=null">,xzqhdm</if>
		<if test="gydw!=null">,gydw</if>
		<if test="gydwdm!=null">,gydwdm</if>
		<if test="qdzh!=null">,qdzh</if>
		<if test="zdzh!=null">,zdzh</if>
		<if test="jsjsdj!=null">,jsjsdj</if>
		<if test="lc!=null">,lc</if>
		<if test="xjsdj!=null">,xjsdj</if>
		<if test="jsxz!=null">,jsxz</if>
		<if test="qdmc!=null">,qdmc</if>
		<if test="zdmc!=null">,zdmc</if>
		<if test="bzcs!=null">,bzcs</if>
		<if test="sffirst!=null">,sffirst</if>
		<if test="jdbs!=null">,jdbs</if>
		<if test="gpsqdzh!=null and gpsqdzh!=''">,gpsqdzh</if>
		<if test="gpszdzh!=null and gpszdzh!=''">,gpszdzh</if>
		<if test="jsfa!=null and jsfa!=''">,jsfa</if>
		<if test="yilc!=null">,yilc</if>
		<if test="erlc!=null">,erlc</if>
		<if test="sanlc!=null">,sanlc</if>
		<if test="silc!=null">,silc</if>
		<if test="dwlc!=null">,dwlc</if>
		<if test="wllc!=null">,wllc</if>
		<if test="jhyilc!=null">,jhyilc</if>
		<if test="jherlc!=null">,jherlc</if>
		<if test="jhsanlc!=null">,jhsanlc</if>
		<if test="jhsilc!=null">,jhsilc</if>
		<if test="jhdwlc!=null">,jhdwlc</if>
		<if test="jhwllc!=null">,jhwllc</if>
		<if test="lqhntmchd != null">
        ,LQHNTMCHD
	      </if>
	      <if test="lqhntmc != null">
	        ,LQHNTMC
	      </if>
	      <if test="gxlqhntmchd != null">
	        ,GXLQHNTMCHD
	      </if>
	      <if test="gxlqhntmc != null">
	        ,GXLQHNTMC
	      </if>
	      <if test="snhntmchd != null">
	        ,SNHNTMCHD
	      </if>
	      <if test="snhntmc != null">
	        ,SNHNTMC
	      </if>
	      <if test="lqlmjdrzshd != null">
	        ,LQLMJDRZSHD
	      </if>
	      <if test="lqlmjdrzs != null">
	        ,LQLMJDRZS
	      </if>
	      <if test="lqlmcbrzshd != null">
	        ,LQLMCBRZSHD
	      </if>
	      <if test="lqlmcbrzs != null">
	        ,LQLMCBRZS
	      </if>
	      <if test="swjchd != null">
	        ,SWJCHD
	      </if>
	      <if test="swjc != null">
	        ,SWJC
	      </if>
	      <if test="lqlmpmlqjdlzshd != null">
	        ,LQLMPMLQJDLZSHD
	      </if>
	      <if test="lqlmpmlqjdlzs != null">
	        ,LQLMPMLQJDLZS
	      </if>
	      <if test="lqlmrhlqjdlzshd != null">
	        ,LQLMRHLQJDLZSHD
	      </if>
	      <if test="lqlmrhlqjdlzs != null">
	        ,LQLMRHLQJDLZS
	      </if>
	      <if test="lqlmcblzshd != null">
	        ,LQLMCBLZSHD
	      </if>
	      <if test="lqlmcblzs != null">
	        ,LQLMCBLZS
	      </if>
	      <if test="xzrxjchd != null">
	        ,XZRXJCHD
	      </if>
	      <if test="xzrxjc != null">
	        ,XZRXJC
	      </if>
	      <if test="swjclzshd != null">
	        ,SWJCLZSHD
	      </if>
	      <if test="swjclzs != null">
	        ,SWJCLZS
	      </if>
	      <if test="xfchd != null">
	        ,XFCHD
	      </if>
	      <if test="xfc != null">
	        ,XFC
	      </if>
	      <if test="wcsnmbhd != null">
	        ,WCSNMBHD
	      </if>
	      <if test="wcsnmb != null">
	        ,WCSNMB
	      </if>
	      <if test="wcswjchd != null">
	        ,WCSWJCHD
	      </if>
	      <if test="wcswjc != null">
	        ,WCSWJC
	      </if>
	      <if test="snhntmchbhd != null">
	        ,SNHNTMCHBHD
	      </if>
	      <if test="snhntmchb != null">
	        ,SNHNTMCHB
	      </if>
	      <if test="bxhd != null">
	        ,BXHD
	      </if>
	      <if test="bx != null">
	        ,BX
	      </if>
	      <if test="snhntmcsshhd != null">
	        ,SNHNTMCSSHHD
	      </if>
	      <if test="snhntmcssh != null">
	        ,SNHNTMCSSH
	      </if>
	      <if test="sbzj != null">
	        ,SBZJ
	      </if>
		<if test="lmkd != null">
	        ,lxlmkd
	      </if>
	      <if test="snhntmchbmj != null">
	        ,snhntmchbmj
	      </if>
	      <if test="fcbc30 != null">
	        ,fcbc30
	      </if>
	      <if test="bc6 != null">
	        ,bc6
	      </if>
	      <if test="bc25 != null">
	        ,bc25
	      </if>
	      <if test="bc30 != null">
	        ,bc30
	      </if>
	      <if test="bmc25 != null">
	        ,bmc25
	      </if>
	      <if test="wfc != null">
	        ,wfc
	      </if>
	      <if test="xjfc != null">
	        ,xjfc
	      </if>
	      <if test="fcbc30hd != null">
	        ,fcbc30hd
	      </if>
	      <if test="bc6hd != null">
	        ,bc6hd
	      </if>
	      <if test="bc25hd != null">
	        ,bc25hd
	      </if>
	      <if test="bc30hd != null">
	        ,bc30hd
	      </if>
	      <if test="bmc25hd != null">
	        ,bmc25hd
	      </if>
	      <if test="wfchd != null">
	        ,wfchd
	      </if>
	      <if test="xjfchd != null">
	        ,xjfchd
	      </if>
	      <if test="wbchd != null">
	        ,wbchd
	      </if>
	      <if test="wbc != null">
	        ,wbc
	      </if>
	      
	     <if test="ghlxbm != null">,ghlxbm</if>
		<if test="ghlxmc != null">,ghlxmc</if>
		<if test="ghqdzh != null">,ghqdzh</if>
		<if test="ghzdzh != null">,ghzdzh</if>
		<if test="gxlxbm != null">,gxlxbm</if>
		<if test="gxqdzh != null">,gxqdzh</if>
		<if test="gxzdzh != null">,gxzdzh</if>
		)
		values(sys_guid()
		<if test="xmid!=null">,#{xmid}</if>
		<if test="lxbm!=null">,#{lxbm}</if>
		<if test="lxmc!=null">,#{lxmc}</if>
		<if test="xzqh!=null">,#{xzqh}</if>
		<if test="xzqhdm!=null">,#{xzqhdm}</if>
		<if test="gydw!=null">,#{gydw}</if>
		<if test="gydwdm!=null">,#{gydwdm}</if>
		<if test="qdzh!=null">,#{qdzh}</if>
		<if test="zdzh!=null">,#{zdzh}</if>
		<if test="jsjsdj!=null">,#{jsjsdj}</if>
		<if test="lc!=null">,#{lc}</if>
		<if test="xjsdj!=null">,#{xjsdj}</if>
		<if test="jsxz!=null">,#{jsxz}</if>
		<if test="qdmc!=null">,#{qdmc}</if>
		<if test="zdmc!=null">,#{zdmc}</if>
		<if test="bzcs!=null">,#{bzcs}</if>
		<if test="sffirst!=null">,#{sffirst}</if>
		<if test="jdbs!=null">,#{jdbs}</if>
		<if test="gpsqdzh!=null and gpsqdzh!=''">,#{gpsqdzh}</if>
		<if test="gpszdzh!=null and gpszdzh!=''">,#{gpszdzh}</if>
		<if test="jsfa!=null and jsfa!=''">,#{jsfa}</if>
		<if test="yilc!=null">,#{yilc}</if>
		<if test="erlc!=null">,#{erlc}</if>
		<if test="sanlc!=null">,#{sanlc}</if>
		<if test="silc!=null">,#{silc}</if>
		<if test="dwlc!=null">,#{dwlc}</if>
		<if test="wllc!=null">,#{wllc}</if>
		<if test="jhyilc!=null">,#{jhyilc}</if>
		<if test="jherlc!=null">,#{jherlc}</if>
		<if test="jhsanlc!=null">,#{jhsanlc}</if>
		<if test="jhsilc!=null">,#{jhsilc}</if>
		<if test="jhdwlc!=null">,#{jhdwlc}</if>
		<if test="jhwllc!=null">,#{jhwllc}</if>
		<if test="lqhntmchd != null">
	        ,#{lqhntmchd}
	      </if>
	      <if test="lqhntmc != null">
	        ,#{lqhntmc}
	      </if>
	      <if test="gxlqhntmchd != null">
	        ,#{gxlqhntmchd}
	      </if>
	      <if test="gxlqhntmc != null">
	        ,#{gxlqhntmc}
	      </if>
	      <if test="snhntmchd != null">
	        ,#{snhntmchd}
	      </if>
	      <if test="snhntmc != null">
	        ,#{snhntmc}
	      </if>
	      <if test="lqlmjdrzshd != null">
	        ,#{lqlmjdrzshd}
	      </if>
	      <if test="lqlmjdrzs != null">
	        ,#{lqlmjdrzs}
	      </if>
	      <if test="lqlmcbrzshd != null">
	        ,#{lqlmcbrzshd}
	      </if>
	      <if test="lqlmcbrzs != null">
	        ,#{lqlmcbrzs}
	      </if>
	      <if test="swjchd != null">
	        ,#{swjchd}
	      </if>
	      <if test="swjc != null">
	        ,#{swjc}
	      </if>
	      <if test="lqlmpmlqjdlzshd != null">
	        ,#{lqlmpmlqjdlzshd}
	      </if>
	      <if test="lqlmpmlqjdlzs != null">
	        ,#{lqlmpmlqjdlzs}
	      </if>
	      <if test="lqlmrhlqjdlzshd != null">
	        ,#{lqlmrhlqjdlzshd}
	      </if>
	      <if test="lqlmrhlqjdlzs != null">
	        ,#{lqlmrhlqjdlzs}
	      </if>
	      <if test="lqlmcblzshd != null">
	        ,#{lqlmcblzshd}
	      </if>
	      <if test="lqlmcblzs != null">
	        ,#{lqlmcblzs}
	      </if>
	      <if test="xzrxjchd != null">
	        ,#{xzrxjchd}
	      </if>
	      <if test="xzrxjc != null">
	        ,#{xzrxjc}
	      </if>
	      <if test="swjclzshd != null">
	        ,#{swjclzshd}
	      </if>
	      <if test="swjclzs != null">
	        ,#{swjclzs}
	      </if>
	      <if test="xfchd != null">
	        ,#{xfchd}
	      </if>
	      <if test="xfc != null">
	        ,#{xfc}
	      </if>
	      <if test="wcsnmbhd != null">
	        ,#{wcsnmbhd}
	      </if>
	      <if test="wcsnmb != null">
	        ,#{wcsnmb}
	      </if>
	      <if test="wcswjchd != null">
	        ,#{wcswjchd}
	      </if>
	      <if test="wcswjc != null">
	        ,#{wcswjc}
	      </if>
	      <if test="snhntmchbhd != null">
	        ,#{snhntmchbhd}
	      </if>
	      <if test="snhntmchb != null">
	        ,#{snhntmchb}
	      </if>
	      <if test="bxhd != null">
	        ,#{bxhd}
	      </if>
	      <if test="bx != null">
	        ,#{bx}
	      </if>
	      <if test="snhntmcsshhd != null">
	        ,#{snhntmcsshhd}
	      </if>
	      <if test="snhntmcssh != null">
	        ,#{snhntmcssh}
	      </if>
		  <if test="sbzj != null">
	        ,#{sbzj}
	      </if>
		  <if test="lmkd != null">
	        ,#{lmkd}
	      </if>
	      <if test="snhntmchbmj != null">
	        ,#{snhntmchbmj}
	      </if>
	      <if test="fcbc30 != null">
	        ,#{fcbc30}
	      </if>
	      <if test="bc6 != null">
	        ,#{bc6}
	      </if>
	      <if test="bc25 != null">
	        ,#{bc25}
	      </if>
	      <if test="bc30 != null">
	        ,#{bc30}
	      </if>
	      <if test="bmc25 != null">
	        ,#{bmc25}
	      </if>
	      <if test="wfc != null">
	        ,#{wfc}
	      </if>
	      <if test="xjfc != null">
	        ,#{xjfc}
	      </if>
	      <if test="fcbc30hd != null">
	        ,#{fcbc30hd}
	      </if>
	      <if test="bc6hd != null">
	        ,#{bc6hd}
	      </if>
	      <if test="bc25hd != null">
	        ,#{bc25hd}
	      </if>
	      <if test="bc30hd != null">
	        ,#{bc30hd}
	      </if>
	      <if test="bmc25hd != null">
	        ,#{bmc25hd}
	      </if>
	      <if test="wfchd != null">
	        ,#{wfchd}
	      </if>
	      <if test="xjfchd != null">
	        ,#{xjfchd}
	      </if>
	      <if test="wbchd != null">
	        ,#{wbchd}
	      </if>
	      <if test="wbc != null">
	         ,#{wbc}
	      </if>
	      <if test="ghlxbm != null">,#{ghlxbm}</if>
		<if test="ghlxmc != null">,#{ghlxmc}</if>
		<if test="ghqdzh != null">,#{ghqdzh}</if>
		<if test="ghzdzh != null">,#{ghzdzh}</if>
		<if test="gxlxbm != null">,#{gxlxbm}</if>
		<if test="gxqdzh != null">,#{gxqdzh}</if>
		<if test="gxzdzh != null">,#{gxzdzh}</if>
		)
	</insert>
	<delete id="deleteLx" parameterType="lx">
		delete from lxsh_lx where id=#{id}
	</delete>
	<select id="selectlxList" parameterType="lx" resultType="lx">
		select id,xmid,lxbm,lxmc,xzqh,xzqhdm ,gydw,gydwdm ,qdzh,zdzh,jsjsdj, 
		decode(substr(xmid,11,1),1,(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)),(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)))  lc,
		xjsdj  ,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh,jsfa,yilc,erlc,sanlc  ,silc,dwlc,wllc,jhyilc ,jherlc ,jhsanlc,jhsilc ,jhdwlc ,jhwllc ,xjlxbm ,xjqdzh ,xjzdzh ,xjlc,jhlc,ghlxbm ,ghlxmc ,lqhntmchd  ,lqhntmc,gxlqhntmchd,gxlqhntmc  ,snhntmchd  ,snhntmc,lqlmjdrzshd,lqlmjdrzs  ,lqlmcbrzshd,lqlmcbrzs  ,swjchd ,swjc,lqlmpmlqjdlzshd ,lqlmpmlqjdlzs,lqlmrhlqjdlzshd ,lqlmrhlqjdlzs,lqlmcblzshd,lqlmcblzs  ,xzrxjchd,xzrxjc ,swjclzshd  ,swjclzs,xfchd  ,xfc ,wcsnmbhd,wcsnmb ,wcswjchd,wcswjc ,snhntmchbhd,snhntmchb  ,bxhd,bx,snhntmcsshhd ,snhntmcssh ,sbzj,lxlmkd ,xzqhdm2,xzqhmc2,gxlxbm ,gxqdzh ,gxzdzh ,ghqdzh ,ghzdzh ,snhntmchbmj,fcbc30,bc6 ,bc25 ,bc30 ,bmc25 , wfc ,xjfc ,fcbc30hd ,bc6hd ,bc25hd ,bc30hd ,bmc25hd , wfchd ,xjfchd,wbchd,wbc   
		from lxsh_lx
		 where xmid=#{xmid} 
		<if test="jdbs!=null"> and jdbs=#{jdbs}</if>
		<if test="sffirst==1">and sffirst!='1'</if>
		order by to_number(ghqdzh) asc
	</select>
	<select id="selectlxbgList" parameterType="lx" resultType="lx">
		select * from lxsh_lx_tz where xmid=#{xmid} 
		<if test="jdbs!=null"> and jdbs=#{jdbs}</if>
		<if test="sffirst==1">and sffirst!='1'</if>
	</select>
	<insert id="insertLxJdbs" parameterType="lx">
		insert into lxsh_lx (xmid, lxbm, lxmc, xzqh, xzqhdm, gydw, gydwdm, qdzh, zdzh, jsjsdj, lc, xjsdj, jsxz, qdmc, zdmc, bzcs, sffirst, jdbs,gpsqdzh,gpszdzh,jsfa,yilc,erlc,sanlc,silc,dwlc,wllc,
		jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,xjlxbm,xjqdzh,xjzdzh,xjlc,jhlc,ghlxbm,ghlxmc,lqhntmchd,lqhntmc,gxlqhntmchd,gxlqhntmc,snhntmchd,snhntmc,lqlmjdrzshd,lqlmjdrzs,lqlmcbrzshd,lqlmcbrzs,swjchd,swjc,lqlmpmlqjdlzshd,lqlmpmlqjdlzs,lqlmrhlqjdlzshd,lqlmrhlqjdlzs,lqlmcblzshd,lqlmcblzs,xzrxjchd,xzrxjc,swjclzshd,swjclzs,xfchd,xfc,wcsnmbhd,wcsnmb,wcswjchd,wcswjc,snhntmchbhd,snhntmchb,bxhd,bx,snhntmcsshhd,snhntmcssh,sbzj,lxlmkd,xzqhdm2,xzqhmc2,gxlxbm,gxqdzh,gxzdzh,ghqdzh,ghzdzh,snhntmchbmj)
		select xmid, lxbm, lxmc, xzqh, xzqhdm, gydw, gydwdm, qdzh, zdzh, jsjsdj, lc, xjsdj, jsxz, qdmc, zdmc, bzcs, sffirst,decode(substr(xmid,11,1),'5',to_char(to_number(#{jdbs})+2),to_char(to_number(#{jdbs})+1)),gpsqdzh,gpszdzh,jsfa,yilc,erlc,sanlc,silc,dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,xjlxbm,xjqdzh,xjzdzh,xjlc,jhlc,ghlxbm,ghlxmc,lqhntmchd,lqhntmc,gxlqhntmchd,gxlqhntmc,snhntmchd,snhntmc,lqlmjdrzshd,lqlmjdrzs,lqlmcbrzshd,lqlmcbrzs,swjchd,swjc,lqlmpmlqjdlzshd,lqlmpmlqjdlzs,lqlmrhlqjdlzshd,lqlmrhlqjdlzs,lqlmcblzshd,lqlmcblzs,xzrxjchd,xzrxjc,swjclzshd,swjclzs,xfchd,xfc,wcsnmbhd,wcsnmb,wcswjchd,wcswjc,snhntmchbhd,snhntmchb,bxhd,bx,snhntmcsshhd,snhntmcssh,sbzj,lxlmkd,xzqhdm2,xzqhmc2,gxlxbm,gxqdzh,gxzdzh,ghqdzh,ghzdzh,snhntmchbmj from lxsh_lx where xmid in (${xmid}) and jdbs=#{jdbs}
	</insert>
	
	<!-- 以上方法，to_char(to_number(#{jdbs})+2),to_char(to_number(#{jdbs})+1))  这个如果是三流程，就替换成 to_char(to_number(#{jdbs})+1)-->
	
	    
	
	
	<!-- 历史记录查询部分 -->
	<select id="queryHaveLx" parameterType="lx" resultType="lx">
		select distinct xmid,xmmc from zgb_zxlwzhtx_lxsh z,LXSH_LX l,(
	    select xmbm,xmmc from lxsh_lmgz union all select xmbm,xmmc from lxsh_sjgz
	    union all select xmbm,xmmc from lxsh_xj
	    union all select xmbm,xmmc from xmsq_sh
	    union all select xmbm,xmmc from xmsq_yhdzx) x 
	    where l.xmid=x.xmbm and z.zxlwlxbm like '%'||#{ghlxbm}||'%' and z.id=l.id 
	    and l.jdbs=fun_zdjdbs(l.xmid)
	    and GREATEST(to_number(z.zxlwzdzh),to_number(z.zxlwqdzh))>LEAST(${ghzdzh},${ghqdzh}) 
	    and GREATEST(${ghzdzh},${ghqdzh})>LEAST(to_number(z.zxlwzdzh),to_number(z.zxlwqdzh))
	    and l.xmid !=#{xmid}
	    and l.xmid like substr(#{xmid},0,4)||'%'
	    and (select count(*) from plan_zjxd p where p.xmid=l.xmid)=0
	</select>
	<select id="queryLxMaxJdbs" parameterType="lx" resultType="lx">
		select * from lxsh_lx where xmid=#{xmid} and 
		jdbs= (select max(jdbs) from lxsh_lx x where x.xmid = #{xmid})
	</select>
	<select id="queryLxMaxJdbs1" parameterType="lx" resultType="lx">
		select * from wnjh_lx where xmid=#{xmid}
	</select>
	<select id="queryYLx" parameterType="lx" resultType="lx">
		<![CDATA[select ylxbm ylxbm,(case when Xqdzh<${qdzh} then YQDZH+${qdzh}-XQDZH else yqdzh end) yqdzh,
		(case when ${zdzh}<Xzdzh then YZDZH-XZDZH+${zdzh} else yzdzh end ) yzdzh ,
		xlxbm as lxbm,(case when Xqdzh<${qdzh} then ${qdzh} else xqdzh end ) qdzh,
		(case when ${zdzh}<Xzdzh then ${zdzh} else xzdzh end) zdzh 
		from XTGL_LXSJ t where  t.xlxbm like #{lxbm} || '%' and 
		t.Xqdzh<${zdzh} and t.Xzdzh>${qdzh}]]>
	</select>
	<select id="queryYlx" parameterType="lx" resultType="lx">
		<![CDATA[select ylxbm ylxbm,(case when to_number(yqdzh)<to_number(yzdzh) and to_number(Xqdzh)<${qdzh} then to_number(YQDZH)+${qdzh}-to_number(XQDZH)
	  when to_number(yqdzh)<to_number(yzdzh) and to_number(Xqdzh)>${qdzh} then yqdzh
	  when to_number(yqdzh)>to_number(yzdzh) and to_number(Xqdzh)<${qdzh} then ${qdzh}-to_number(xqdzh)+to_number(yzdzh)
	  when to_number(yqdzh)>to_number(yzdzh) and to_number(Xqdzh)>${qdzh} then yzdzh end) yqdzh,
      (case when to_number(yqdzh)<to_number(yzdzh) and ${zdzh}<to_number(Xzdzh) then to_number(YZDZH)-to_number(XZDZH)+${zdzh}
      when to_number(yqdzh)<to_number(yzdzh) and ${zdzh}>to_number(Xzdzh) then  yzdzh
      when to_number(yqdzh)>to_number(yzdzh) and ${zdzh}<to_number(Xzdzh) then ${zdzh}-to_number(xzdzh)+to_number(yqdzh)
      when to_number(yqdzh)>to_number(yzdzh) and ${zdzh}>to_number(Xzdzh) then yqdzh
      end ) yzdzh ,
		xlxbm as lxbm,
     (case when Xqdzh<${qdzh} then ${qdzh} else xqdzh end ) qdzh,
		(case when ${zdzh}<Xzdzh then ${zdzh} else xzdzh end) zdzh 
		from ghlx t where  t.xlxbm like #{lxbm} || '%' and 
		t.Xqdzh<${zdzh} and t.Xzdzh>${qdzh}]]>
	</select>
	<select id="queryYlxnew" parameterType="lx" resultType="lx">
		<![CDATA[select ylxbm ylxbm,nvl((case when to_number(yqdzh)<to_number(yzdzh) and to_number(Xqdzh)<${ghqdzh} then to_number(YQDZH)+${ghqdzh}-to_number(XQDZH)
				when to_number(yqdzh)<to_number(yzdzh) and to_number(Xqdzh)>${ghqdzh} then yqdzh
				when to_number(yqdzh)>to_number(yzdzh) and to_number(Xqdzh)<${ghqdzh} then ${ghqdzh}-to_number(xqdzh)+to_number(yzdzh)
				when to_number(yqdzh)>to_number(yzdzh) and to_number(Xqdzh)>${ghqdzh} then yzdzh end),0) qdzh,
				nvl((case when to_number(yqdzh)<to_number(yzdzh) and ${ghzdzh}<to_number(Xzdzh) then to_number(YZDZH)-to_number(XZDZH)+${ghzdzh}
				when to_number(yqdzh)<to_number(yzdzh) and ${ghzdzh}>to_number(Xzdzh) then  yzdzh
				when to_number(yqdzh)>to_number(yzdzh) and ${ghzdzh}<to_number(Xzdzh) then ${ghzdzh}-to_number(xzdzh)+to_number(yqdzh)
				when to_number(yqdzh)>to_number(yzdzh) and ${ghzdzh}>to_number(Xzdzh) then yqdzh
				end ),0) zdzh ,
				substr(ylxbm,0,4) as lxbm,
				nvl((case when Xqdzh<${ghqdzh} then ${ghqdzh} else xqdzh end ),0) xqdzh,
				nvl((case when ${ghzdzh}<Xzdzh then ${ghzdzh} else xzdzh end),0) xzdzh 
				from ghlx t where  t.xlxbm like #{ghlxbm} || '%' and 
				t.Xqdzh<${ghzdzh} and t.Xzdzh>${ghqdzh}]]>
    <if test="xzqhdm!=null and xzqhdm !=''">
    	and ${xzqhdm}
    </if>
    and ylxbm is not null and yqdzh is not null and yzdzh is not null
	</select>
	
	<select id="queryLsjlListnew" parameterType="java.util.Map" resultType="lx">
		select distinct l.xmid,decode(substr(l.xmid,11,1),'1',(select xmmc from jhsh_sjgz where xmbm=l.xmid),
		'2',(select xmmc from jhsh_lmgz where xmbm=l.xmid),
		'3',(select xmmc from jhsh_xj where xmbm=l.xmid),
		'4',(select xmmc from jhsh_yhdzx where xmbm=l.xmid),
		'5',(select xmmc from jhsh_sh where xmbm=l.xmid)
		) xmmc,
		l.ghlxbm lxbm,l.ghlxmc lxmc,l.qcqd qdzh,l.qczd zdzh,decode(l.lxbm, null, lx.lxbm, l.lxbm) ylxbm,decode(l.qdzh, null, lx.qdzh, l.qdzh) yqdzh,decode(l.zdzh, null, lx.zdzh, l.zdzh) yzdzh,lx.jsxz  xjsdj,lx.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',lx.jsjsdj,lx.xjsdj) jsjsdj from lx_clsd l left join lxsh_lx lx on l.xmid=lx.xmid
		where 1=1 and lx.jdbs='2'
		and l.ghlxbm like '%'||#{lx.lxbm}||'%'
		and to_number(l.qczd) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qcqd)
	</select>
	
	<select id="queryLsjlListqwh" parameterType="java.util.Map" resultType="lx">
		select distinct * from (
			<foreach collection="lx" item="item" separator="union all">
		<trim suffixOverrides="union all">
		<if test="item.xmlx!=null and item.xmlx.indexOf('养护大中修')!=-1 ">
		select distinct l.xmid,j.xmmc,decode(cl.ghlxbm,null,l.ghlxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.ghlxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.ghqdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,j.gcfl xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_yhdzx j on l.xmid=j.xmbm right join cbsj_yhdzx c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{item.lxbm}||'%' and f_str_or_num(l.ghqdzh)=0 and f_str_or_num(l.ghzdzh)=0 and 
		(
			(to_number(l.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(cl.qdzh)) 
	    )
	    <if test="item.xzqh != null and item.xzqh != ''">and ${item.xzqh}</if>
		<if test="item.xmid!=null and item.xmid!=''">and j.xmbm!=#{item.xmid}</if>
		union all
		</if>
		<if test="item.xmlx!=null and item.xmlx.indexOf('灾毁重建')!=-1 ">
		select distinct l.xmid,j.xmmc,decode(cl.ghlxbm,null,l.ghlxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.ghlxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.ghqdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.ghzdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_sh j on l.xmid=j.xmbm right join cbsj_sh c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{item.lxbm}||'%' and f_str_or_num(l.ghqdzh)=0 and f_str_or_num(l.ghzdzh)=0 and 
		(
			(to_number(l.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(cl.qdzh)) 
	    )
	    <if test="item.xzqh != null and item.xzqh != ''">and ${item.xzqh}</if>
		<if test="item.xmid!=null and item.xmid!=''">and j.xmbm!=#{item.xmid}</if>
		union all
		</if>
		<if test="item.xmlx!=null and item.xmlx.indexOf('路面改造')!=-1 ">
		select distinct l.xmid,j.xmmc,decode(cl.ghlxbm,null,l.ghlxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.ghlxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.ghqdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.ghzdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_lmgz j on l.xmid=j.xmbm right join cbsj_lmgz c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{item.lxbm}||'%' and f_str_or_num(l.ghqdzh)=0 and f_str_or_num(l.ghzdzh)=0 and 
		(
			(to_number(l.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(cl.qdzh)) 
	    )
	    <if test="item.xzqh != null and item.xzqh != ''">and ${item.xzqh}</if>
		<if test="item.xmid!=null and item.xmid!=''">and j.xmbm!=#{item.xmid}</if>
		union all
		</if>
		<if test="item.xmlx!=null and item.xmlx.indexOf('改建')!=-1 ">
		select distinct l.xmid,j.xmmc,decode(cl.ghlxbm,null,l.ghlxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.ghlxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.ghqdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.ghzdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_sjgz j on l.xmid=j.xmbm right join cbsj_sjgz c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{item.lxbm}||'%' and f_str_or_num(l.ghqdzh)=0 and f_str_or_num(l.ghzdzh)=0 and 
		(
			(to_number(l.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(l.qdzh))
			or
			(to_number(cl.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(cl.qdzh)) 
	    )
	    <if test="item.xzqh != null and item.xzqh != ''">and ${item.xzqh}</if>
		<if test="item.xmid!=null and item.xmid!=''">and j.xmbm!=#{item.xmid}</if>
		union all
		</if>
		<if test="item.xmlx!=null and item.xmlx.indexOf('新建')!=-1 ">
		select distinct l.xmid,j.xmmc,decode(cl.ghlxbm,null,l.xjlxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.xjqdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.xjzdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_xj j on l.xmid=j.xmbm right join cbsj_xj c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{item.lxbm}||'%' and f_str_or_num(l.ghqdzh)=0 and f_str_or_num(l.ghzdzh)=0  and 
		(
			(to_number(l.xjzdzh) > ${item.qdzh} and ${item.zdzh} > to_number(l.xjqdzh)) 
			or
			(to_number(cl.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(cl.qdzh)) 
	    )
	    <if test="item.xzqh != null and item.xzqh != ''">and ${item.xzqh}</if>
		<if test="item.xmid!=null and item.xmid!=''">and j.xmbm!=#{item.xmid}</if>
		union all
		</if>
		<if test="item.xmlx!=null and item.xmlx.indexOf('路网结构工程')!=-1 ">
		 select p.SBNF||P.ID xmid,s.sck_qlbh||L.QLMC||'('||s.sck_qlzxzh||')' xmmc,l.xlxbm lxbm,l.xlxmc lxmc,l.xzxzh qdzh,''zdzh,l.lxbm ylxbm,s.sck_qlzxzh yqdzh,'' yzdzh, '危桥改造' xjsdj,l.jsdj yjsdj,'' jsjsdj  from plan_wqgz p left join sck_wqgz s on p.sckid=s.sckid left join xmk_wqgz l on s.xmkid=l.id
    	where 
    	l.lxbm like '%'||#{item.lxbm}||'%' and 
    	(to_number(s.sck_qlzxzh) > ${item.qdzh} and ${item.zdzh} > to_number(s.sck_qlzxzh))
      	 <if test="item.xzqh != null and item.xzqh != ''">and ${item.xzqh}</if>
        union all      
	    select p.JHNF||P.ID xmid,L.LXBM||l.lxmc||'('||l.qdzh||','||l.zdzh||')' xmmc,''lxbm,''lxmc,''qdzh,''zdzh,l.lxbm ylxbm,l.qdzh yqdzh,l.zdzh yzdzh,'安防工程' xjsdj,l.lxjsdj jsdj,''jsjsdj  from plan_abgc p left join sck_abgc s on p.sckid=s.sckid left join xmk_abgc l on s.xmkid=l.id
	    where 
	    l.lxbm like '%'||#{item.lxbm}||'%' and 
	    (to_number(l.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(l.qdzh))
	     <if test="item.xzqh != null and item.xzqh != ''">and ${item.xzqh}</if>
	    union all
	    select p.SBNF||P.ID xmid,L.LXBM||l.lxmc||'('||l.qdzh||','||l.zdzh||')' xmmc,''lxbm,''lxmc,''qdzh,''zdzh,l.lxbm ylxbm,l.qdzh yqdzh,l.zdzh yzdzh,'灾害防治' xjsdj,l.lxjsdj jsdj,''jsjsdj  from plan_zhfz p left join sck_zhfz s on p.sckid=s.sckid left join xmk_zhfz l on s.xmkid=l.id
	    where 
	    l.lxbm like '%'||#{item.lxbm}||'%' and 
	    (to_number(l.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(l.qdzh))
	     <if test="item.xzqh != null and item.xzqh != ''">and ${item.xzqh}</if>
		union all
		</if>
		
		</trim>
		</foreach>
		
		) order by lxbm,to_number(qdzh),ylxbm,to_number(yqdzh),substr(xmid,4) 
		
	</select>
	
	
	<select id="queryLsjlList" parameterType="java.util.Map" resultType="lx">
	select distinct tab.* from(
	select distinct l.xmid,decode(substr(l.xmid,11,1),'1',(select xmmc from jhsh_sjgz where xmbm=l.xmid),
		'2',(select xmmc from jhsh_lmgz where xmbm=l.xmid),
		'3',(select xmmc from jhsh_xj where xmbm=l.xmid),
		'4',(select xmmc from jhsh_yhdzx where xmbm=l.xmid),
		'5',(select xmmc from jhsh_sh where xmbm=l.xmid)
		) xmmc,
		l.ghlxbm lxbm,l.ghlxmc lxmc,l.qcqd qdzh,l.qczd zdzh,decode(l.lxbm, null, lx.lxbm, l.lxbm) ylxbm,decode(l.qdzh, null, lx.qdzh, l.qdzh) yqdzh,decode(l.zdzh, null, lx.zdzh, l.zdzh) yzdzh,lx.jsxz  xjsdj,lx.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',lx.jsjsdj,lx.xjsdj) jsjsdj from lx_clsd l left join lxsh_lx lx on l.id=lx.id
		where 1=1 and lx.jdbs='2'
		and l.ghlxbm like '%'||#{lx.lxbm}||'%'
		and to_number(l.qczd) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qcqd)
		<if test="lx.xmid!=null and lx.xmid!=''">and lx.xmid!=#{lx.xmid}</if>
	union all
	select distinct l.xmid,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,j.gcfl xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_yhdzx j on l.xmid=j.xmbm right join cbsj_yhdzx c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(cl.qdzh)) 
	    )
	    
<!-- 	    to_number(l.qdzh)&lt;${lx.zdzh} and to_number(l.zdzh)>${lx.qdzh} -->
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		
		union all
		select distinct l.xmid,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_sh j on l.xmid=j.xmbm right join cbsj_sh c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(cl.qdzh)) 
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		union all
		select distinct l.xmid,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_lmgz j on l.xmid=j.xmbm right join cbsj_lmgz c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(cl.qdzh)) 
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		union all
		select distinct l.xmid,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_sjgz j on l.xmid=j.xmbm right join cbsj_sjgz c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qdzh))
			or
			(to_number(cl.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(cl.qdzh)) 
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		union all
		select distinct l.xmid,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_xj j on l.xmid=j.xmbm right join cbsj_xj c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(cl.qdzh)) 
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{lx.xmid}</if>
		
		<foreach collection="ylx" item="item">
			union all
	select distinct l.xmid,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,j.gcfl xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_yhdzx j on l.xmid=j.xmbm right join cbsj_yhdzx c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{item.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(cl.qdzh)) 
	    )
	    
<!-- 	    to_number(l.qdzh)&lt;${lx.zdzh} and to_number(l.zdzh)>${lx.qdzh} -->
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{item.xmid}</if>
		
		union all
		select distinct l.xmid,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_sh j on l.xmid=j.xmbm right join cbsj_sh c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{item.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(cl.qdzh)) 
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{item.xmid}</if>
		union all
		select distinct l.xmid,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_lmgz j on l.xmid=j.xmbm right join cbsj_lmgz c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{item.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(cl.qdzh)) 
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{item.xmid}</if>
		union all
		select distinct l.xmid,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_sjgz j on l.xmid=j.xmbm right join cbsj_sjgz c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{item.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(l.qdzh))
			or
			(to_number(cl.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(cl.qdzh)) 
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{item.xmid}</if>
		union all
		select distinct l.xmid,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,l.jsxz xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd cl right join lxsh_lx l on cl.id=l.id right join jhsh_xj j on l.xmid=j.xmbm right join cbsj_xj c on j.xmbm=c.xmbm
		where l.jdbs='2' and l.lxbm like '%'||#{item.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(l.qdzh)) 
			or
			(to_number(cl.zdzh) > ${item.qdzh} and ${item.zdzh} > to_number(cl.qdzh)) 
	    )
	    
		<if test="lx.xmid!=null and lx.xmid!=''">and j.xmbm!=#{item.xmid}</if>
		
		</foreach>
		
	) tab
	 order by xmid desc
	
	</select>
	<select id="queryJsdjAndLcByStartAndEnd" parameterType="lx" resultType="lx">
		<![CDATA[
		select to_char(sum(yilc), 'FM99990.099') yilc,to_char(sum(erlc), 'FM99990.099') erlc,to_char(sum(sanlc), 'FM99990.099') sanlc,to_char(sum(silc), 'FM99990.099') silc,to_char(sum(dwlc), 'FM99990.099') dwlc,to_char(sum(wllc), 'FM99990.099') wllc,replace(WMSYS.WM_CONCAT(f114),',','、') xjsdj
		from (select nvl(case when f114 = '一级公路' then sum(roadends - roadstart) end,0) yilc,
		nvl(case when f114 = '二级公路' then sum(roadends - roadstart) end,0) erlc,
		nvl(case when f114 = '三级公路' then sum(roadends - roadstart) end,0) sanlc,
		nvl(case when f114 = '四级公路' then sum(roadends - roadstart) end,0) silc,
		nvl(case when f114 = '等外公路' then sum(roadends - roadstart) end,0) dwlc,
		nvl(case when f114 is null then sum(roadends - roadstart) end,0) wllc,substr(f114,1,2) f114,f014
		from (select g.roadcode,to_char(decode(g.f114,null,'无路',g.f114)) f114,f014,
		case when g.roadstart < ${qdzh} then ${qdzh} when g.roadstart > ${qdzh} then g.roadstart when g.roadstart = ${qdzh} then g.roadstart end roadstart,
		case when g.roadends < ${zdzh} then g.roadends when g.roadends > ${zdzh} then ${zdzh} when g.roadends = ${zdzh} then g.roadends end roadends from gpsroad g
		where substr(g.roadcode, 1, 1) in ('G', 'S', 'X', 'Y', 'C', 'Z') and g.roadcode like substr(#{lxbm},0,8) || '%'  and f114 not like '%高速%'
		and ((g.roadstart <= ${qdzh} and ${qdzh} < g.roadends) or (g.roadstart > ${qdzh} and g.roadends < ${zdzh}) or (g.roadstart < ${zdzh} and g.roadends >= ${zdzh})))
		group by f114,f014 order by f014)
		]]>
	</select>
	<select id="queryylmlx" parameterType="lx" resultType="String">
		<![CDATA[
		select replace(WMSYS.WM_CONCAT(distinct F116),',',',') lmlx
	    from (select to_char(f116) f116 from gpsroad g
	    where substr(g.roadcode, 1, 1) in ('G', 'S', 'X', 'Y', 'C', 'Z') and g.roadcode like #{lxbm} || '%'
	    and ((g.roadstart <= ${qdzh} and ${qdzh} < g.roadends) or (g.roadstart > ${qdzh} and g.roadends < ${zdzh}) or (g.roadstart < ${zdzh} and g.roadends >= ${zdzh})))
	 
		]]>
	</select>
	<select id="zdyQueryLmsj" parameterType="java.util.List" resultType="java.util.Map">
		select * from (
			select rownum num,${filed} from lxsh_sjgz l left join 
			(select k1.*,l1.lc from kxxyj_sjgz k1 left join lxsh_lx l1 on xmbm=xmid and jdbs='1' and sffirst='1') k on l.xmbm=k.xmbm left join 
			(select c1.*,l1.lc from cbsj_sjgz c1 left join lxsh_lx l1 on xmbm=xmid and jdbs='2' and sffirst='1') c on k.xmbm=c.xmbm
			left join jhsh_sjgz j on c.xmbm=j.xmbm
			where 1=1  and l.shzt='1' and k.shzt='1'
			<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and l.xmbm like #{jhsh.xmbm}||'%'</if>
			<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and l.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
			<if test="jhsh.gydw!=null">and l.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
			<if test="jhsh.xzqh!=null">and l.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
			<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and l.lxmc like #{jhsh.lxmc}||'%'</if>
			<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and l.ghlxbh like #{jhsh.lxbm}||'%'</if>
			<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt = #{jhsh.kgzt}</if>
			<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
			<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
			<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>)
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="zdyQueryLmsjTotal" parameterType="java.util.List" resultType="int">
		select count(*) from lxsh_sjgz l left join 
		(select k1.*,l1.lc from kxxyj_sjgz k1 left join lxsh_lx l1 on xmbm=xmid and jdbs='1' and sffirst='1') k on l.xmbm=k.xmbm left join 
		(select c1.*,l1.lc from cbsj_sjgz c1 left join lxsh_lx l1 on xmbm=xmid and jdbs='2' and sffirst='1') c on k.xmbm=c.xmbm
		left join jhsh_sjgz j on c.xmbm=j.xmbm
		where 1=1  and l.shzt='1' and k.shzt='1'
		<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and l.xmbm like #{jhsh.xmbm}||'%'</if>
		<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and l.xmmc like #{jhsh.xmmc}||'%'</if>
		<if test="jhsh.gydw!=null">and l.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
		<if test="jhsh.xzqh!=null">and l.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
		<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and l.lxmc like #{jhsh.lxmc}||'%'</if>
		<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and l.ghlxbh like #{jhsh.lxbm}||'%'</if>
		<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt = #{jhsh.kgzt}</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
	</select>
	<select id="zdyQueryLmgz" parameterType="java.util.List" resultType="java.util.Map">
		select * from (
			select rownum num,${filed} from lxsh_lmgz l left join 
		    (select k1.*,l1.lc from kxxyj_lmgz k1 left join lxsh_lx l1 on xmbm=xmid and jdbs='1' and sffirst='1') k on l.xmbm=k.xmbm left join 
		    (select c1.*,l1.lc from cbsj_lmgz c1 left join lxsh_lx l1 on xmbm=xmid and jdbs='2' and sffirst='1') c on k.xmbm=c.xmbm
		    left join jhsh_lmgz j on c.xmbm=j.xmbm
		    where 1=1 and l.shzt='1' and k.shzt='1'
			<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and l.xmbm like #{jhsh.xmbm}||'%'</if>
			<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and l.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
			<if test="jhsh.gydw!=null">and l.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
			<if test="jhsh.xzqh!=null">and l.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
			<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and l.lxmc like #{jhsh.lxmc}||'%'</if>
			<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and l.ghlxbh like #{jhsh.lxbm}||'%'</if>
			<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt = #{jhsh.kgzt}</if>
			<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
			<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
			<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>)
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="zdyQueryLmgzTotal" parameterType="java.util.List" resultType="int">
		select count(*) from lxsh_lmgz l left join 
		(select k1.*,l1.lc from kxxyj_lmgz k1 left join lxsh_lx l1 on xmbm=xmid and jdbs='1' and sffirst='1') k on l.xmbm=k.xmbm left join 
		(select c1.*,l1.lc from cbsj_lmgz c1 left join lxsh_lx l1 on xmbm=xmid and jdbs='2' and sffirst='1') c on k.xmbm=c.xmbm
		left join jhsh_lmgz j on c.xmbm=j.xmbm
		where 1=1 and l.shzt='1' and k.shzt='1'
		<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and l.xmbm like #{jhsh.xmbm}||'%'</if>
		<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and l.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
		<if test="jhsh.gydw!=null">and l.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
		<if test="jhsh.xzqh!=null">and l.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
		<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and l.lxmc like #{jhsh.lxmc}||'%'</if>
		<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and l.ghlxbh like #{jhsh.lxbm}||'%'</if>
		<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt = #{jhsh.kgzt}</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
	</select>
	<select id="zdyQueryXj" parameterType="java.util.List" resultType="java.util.Map">
		select * from (
			select rownum num,${filed} from lxsh_xj l left join 
		    (select k1.*,l1.lc from kxxyj_xj k1 left join lxsh_lx l1 on xmbm=xmid and jdbs='1' and sffirst='1') k on l.xmbm=k.xmbm left join 
		    (select c1.*,l1.lc from cbsj_xj c1 left join lxsh_lx l1 on xmbm=xmid and jdbs='2' and sffirst='1') c on k.xmbm=c.xmbm
		    left join jhsh_xj j on c.xmbm=j.xmbm
	      	where 1=1  and l.shzt='1' and k.shzt='1'
	      	<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and l.xmbm like #{jhsh.xmbm}||'%'</if>
	      	<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and l.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
			<if test="jhsh.gydw!=null">and l.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
			<if test="jhsh.xzqh!=null">and l.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
			<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and l.lxmc like #{jhsh.lxmc}||'%'</if>
			<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and l.ghlxbh like #{jhsh.lxbm}||'%'</if>
			<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt = #{jhsh.kgzt}</if>
			<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
			<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
			<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>)
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="zdyQueryXjTotal" parameterType="java.util.List" resultType="int">
		select count(*) from lxsh_xj l left join 
		(select k1.*,l1.lc from kxxyj_xj k1 left join lxsh_lx l1 on xmbm=xmid and jdbs='1' and sffirst='1') k on l.xmbm=k.xmbm left join 
		(select c1.*,l1.lc from cbsj_xj c1 left join lxsh_lx l1 on xmbm=xmid and jdbs='2' and sffirst='1') c on k.xmbm=c.xmbm
		left join jhsh_xj j on c.xmbm=j.xmbm
	    where 1=1  and l.shzt='1' and k.shzt='1'
	    <if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and l.xmbm like #{jhsh.xmbm}||'%'</if>
	    <if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and l.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
		<if test="jhsh.gydw!=null">and l.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
		<if test="jhsh.xzqh!=null">and l.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
		<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and l.lxmc like #{jhsh.lxmc}||'%'</if>
		<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and l.ghlxbh like #{jhsh.lxbm}||'%'</if>
		<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt = #{jhsh.kgzt}</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and l.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
	</select>
	<select id="zdyQueryYhdzx" parameterType="java.util.List" resultType="java.util.Map">
		select * from (
			select rownum num,${filed} from xmsq_yhdzx x left join cbsj_yhdzx c on x.xmbm=c.xmbm left join jhsh_yhdzx j on c.xmbm=j.xmbm
			where x.sqzt='7'
			<if test="jhsh.xzqh!=null and jhsh.xzqh!=''">and x.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
			<if test="jhsh.gydw!=null and jhsh.gydw!=''">and x.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
			<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and x.xmbm like #{jhsh.xmbm}||'%'</if>
			<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
			<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and x.lxmc like '%'||#{jhsh.lxmc}||'%'</if>
			<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and x.ylxbh like '%'#{jhsh.lxbm}||'%'</if>
			<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt=#{jhsh.kgzt}</if>
			<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
			<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
			<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and x.tsdq like '%'||#{jhsh.tsdq}||'%'</if>)
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="zdyQueryYhdzxTotal" parameterType="java.util.List" resultType="int">
		select count(*) from xmsq_yhdzx x left join cbsj_yhdzx c on x.xmbm=c.xmbm left join jhsh_yhdzx j on c.xmbm=j.xmbm
		where x.sqzt='7'
		<if test="jhsh.xzqh!=null and jhsh.xzqh!=''">and x.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
		<if test="jhsh.gydw!=null and jhsh.gydw!=''">and x.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
		<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and x.xmbm like #{jhsh.xmbm}||'%'</if>
		<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
		<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and x.lxmc like '%'||#{jhsh.lxmc}||'%'</if>
		<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and x.ylxbh like '%'#{jhsh.lxbm}||'%'</if>
		<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt=#{jhsh.kgzt}</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and x.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
	</select>
	<select id="zdyQuerySh" parameterType="java.util.List" resultType="java.util.Map">
		select * from (
			select rownum num,${filed} from xmsq_sh x left join cbsj_sh c on x.xmbm=c.xmbm left join jhsh_sh j on c.xmbm=j.xmbm
			where x.sqzt='7'
			<if test="jhsh.xzqh!=null and jhsh.xzqh!=''">and x.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
			<if test="jhsh.gydw!=null and jhsh.gydw!=''">and x.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
			<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and x.xmbm like #{jhsh.xmbm}||'%'</if>
			<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
			<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and x.lxmc like '%'||#{jhsh.lxmc}||'%'</if>
			<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and x.ylxbh like '%'#{jhsh.lxbm}||'%'</if>
			<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt=#{jhsh.kgzt}</if>
			<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
			<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
			<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and x.tsdq like '%'||#{jhsh.tsdq}||'%'</if>)
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="zdyQueryShTotal" parameterType="java.util.List" resultType="int">
		select count(*) from xmsq_sh x left join cbsj_sh c on x.xmbm=c.xmbm left join jhsh_sh j on c.xmbm=j.xmbm
		where x.sqzt='7'
		<if test="jhsh.xzqh!=null and jhsh.xzqh!=''">and x.xzqhdm like '%'||#{jhsh.xzqh}||'%'</if>
		<if test="jhsh.gydw!=null and jhsh.gydw!=''">and x.gydwdm like '%'||#{jhsh.gydw}||'%'</if>
		<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and x.xmbm like #{jhsh.xmbm}||'%'</if>
		<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
		<if test="jhsh.lxmc!=null and jhsh.lxmc!=''">and x.lxmc like '%'||#{jhsh.lxmc}||'%'</if>
		<if test="jhsh.lxbm!=null and jhsh.lxbm!=''">and x.ylxbh like '%'#{jhsh.lxbm}||'%'</if>
		<if test="jhsh.kgzt!=null and jhsh.kgzt!=''">and j.kgzt=#{jhsh.kgzt}</if>
		<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.jsdj})</if>
		<if test="jhsh.ylxbh!=null and jhsh.ylxbh!=''">and j.xmbm in (select xmid from lxsh_lx l where ${jhsh.ylxbh})</if>
		<if test="jhsh.tsdq!=null and jhsh.tsdq!=''">and x.tsdq like '%'||#{jhsh.tsdq}||'%'</if>
	</select>
	<select id="queryJhshLjLmsj" parameterType="jhsh" resultType="java.util.Map">
		select sum(j.bbzzj) bbzzj,sum(j.sbzzj) sbzzj,sum(l1.lc) lc from jhsh_sjgz j left join lxsh_sjgz l on j.xmbm=l.xmbm 
		left join (select xmid,(sum(nvl(jhyilc,0))+sum(nvl(jherlc,0))+sum(nvl(jhsanlc,0))+sum(nvl(jhsilc,0))+sum(nvl(jhdwlc,0))+sum(nvl(jhwllc,0))) lc from lxsh_lx where xmid like '%1___' and jdbs='2' group by xmid) l1 on j.xmbm = l1.xmid
		where 1=1
		<if test="xzqhdm!=null and xzqhdm!=''">
			and ${xzqhdm}
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%1___' and jdbs='2')
		</if>
		<if test="lsjl!=null and lsjl!=''">
			and l.lsjl=#{jhsh.lsjl}
		</if>
		<if test="tsdq!=null and tsdq!=''">
			and l.tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="xmbm!=null and xmbm!=''">
			and ${xmbm}
		</if>
		<if test="xmmc!=null and xmmc!=''">
			and j.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xdzt>=0">
			and j.xdzt=${xdzt}
		</if>
		<if test="jsdj!=null and jsdj!=''">
			and ${jsdj}
		</if>
		<if test="lsjl!=null and lsjl!=''">
			and l.lsjl=#{lsjl}
		</if>
	</select>
	<select id="queryJhshLjLmsj1" parameterType="jhsh" resultType="java.util.Map">
		select sum(j.bbzzj) bbzzj,sum(j.sbzzj) sbzzj,sum(l1.lc) lc from jhsh_sjgz_qx j left join lxsh_sjgz l on j.xmbm=l.xmbm 
		left join (select xmid,(sum(nvl(jhyilc,0))+sum(nvl(jherlc,0))+sum(nvl(jhsanlc,0))+sum(nvl(jhsilc,0))+sum(nvl(jhdwlc,0))+sum(nvl(jhwllc,0))) lc from lxsh_lx where xmid like '%1___' and jdbs='2' group by xmid) l1 on j.xmbm = l1.xmid
		where 1=1
		<if test="xzqhdm!=null and xzqhdm!=''">
			and ${xzqhdm}
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%1___' and jdbs='2')
		</if>
		<if test="lsjl!=null and lsjl!=''">
			and l.lsjl=#{jhsh.lsjl}
		</if>
		<if test="tsdq!=null and tsdq!=''">
			and l.tsdq like '%'||#{tsdq}||'%'
		</if>
		<if test="xmbm!=null and xmbm!=''">
			and ${xmbm}
		</if>
		<if test="xmmc!=null and xmmc!=''">
			and j.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xdzt>=0">
			and j.xdzt=${xdzt}
		</if>
		<if test="jsdj!=null and jsdj!=''">
			and ${jsdj}
		</if>
		<if test="lsjl!=null and lsjl!=''">
			and l.lsjl=#{lsjl}
		</if>
	</select>
	<select id="queryJhshLjLmgz1" parameterType="jhsh" resultType="java.util.Map">
		select sum(j.bbzzj) bbzzj,sum(j.sbzzj) sbzzj,sum(l1.lc) lc from jhsh_lmgz_qx j left join lxsh_lmgz l on j.xmbm=l.xmbm 
		left join (select xmid,(sum(nvl(yilc,0))+sum(nvl(erlc,0))+sum(nvl(sanlc,0))+sum(nvl(silc,0))+sum(nvl(dwlc,0))+sum(nvl(wllc,0))) lc from lxsh_lx where xmid like '%2___' and jdbs='2' group by xmid) l1 on j.xmbm = l1.xmid
		where 1=1
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%2___' and jdbs='2')
		</if>
		<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{jhsh.lsjl}</if>
		<if test="tsdq!=null and tsdq!=''">and l.tsdq like '%'||#{tsdq}||'%'</if>
		<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
		<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
		<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
		<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{lsjl}</if>
	</select>
	<select id="queryJhshLjLmgz" parameterType="jhsh" resultType="java.util.Map">
		select sum(j.bbzzj) bbzzj,sum(j.sbzzj) sbzzj,sum(l1.lc) lc from jhsh_lmgz j left join lxsh_lmgz l on j.xmbm=l.xmbm 
		left join (select xmid,(sum(nvl(yilc,0))+sum(nvl(erlc,0))+sum(nvl(sanlc,0))+sum(nvl(silc,0))+sum(nvl(dwlc,0))+sum(nvl(wllc,0))) lc from lxsh_lx where xmid like '%2___' and jdbs='2' group by xmid) l1 on j.xmbm = l1.xmid
		where 1=1
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%2___' and jdbs='2')
		</if>
		<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{jhsh.lsjl}</if>
		<if test="tsdq!=null and tsdq!=''">and l.tsdq like '%'||#{tsdq}||'%'</if>
		<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
		<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
		<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
		<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{lsjl}</if>
	</select>
	<select id="queryJhshLjXj" parameterType="jhsh" resultType="java.util.Map">
		select sum(j.bbzzj) bbzzj,sum(j.sbzzj) sbzzj,sum(l1.lc) lc from jhsh_xj j left join lxsh_xj l on j.xmbm=l.xmbm 
		left join (select xmid,(sum(nvl(yilc,0))+sum(nvl(erlc,0))+sum(nvl(sanlc,0))+sum(nvl(silc,0))+sum(nvl(dwlc,0))+sum(nvl(wllc,0))) lc from lxsh_lx where xmid like '%3___' and jdbs='2' group by xmid) l1 on j.xmbm = l1.xmid
		where 1=1
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%3___' and jdbs='2')
		</if>
		<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{jhsh.lsjl}</if>
		<if test="tsdq!=null and tsdq!=''">and l.tsdq like '%'||#{tsdq}||'%'</if>
		<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
		<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
		<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
		<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{lsjl}</if>
	</select>
	<select id="queryJhshLjXj1" parameterType="jhsh" resultType="java.util.Map">
		select sum(j.bbzzj) bbzzj,sum(j.sbzzj) sbzzj,sum(l1.lc) lc from jhsh_xj_qx j left join lxsh_xj l on j.xmbm=l.xmbm 
		left join (select xmid,(sum(nvl(yilc,0))+sum(nvl(erlc,0))+sum(nvl(sanlc,0))+sum(nvl(silc,0))+sum(nvl(dwlc,0))+sum(nvl(wllc,0))) lc from lxsh_lx where xmid like '%3___' and jdbs='2' group by xmid) l1 on j.xmbm = l1.xmid
		where 1=1
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%3___' and jdbs='2')
		</if>
		<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{jhsh.lsjl}</if>
		<if test="tsdq!=null and tsdq!=''">and l.tsdq like '%'||#{tsdq}||'%'</if>
		<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
		<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
		<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
		<if test="lsjl!=null and lsjl!=''">and l.lsjl=#{lsjl}</if>
	</select>
	
	<select id="queryJhshLjYhdzx" parameterType="jhsh" resultType="java.util.Map">
		select 
		count(*) sl,nvl(sum(bccgs),0) cgs,nvl(sum(bcrys),0) rys,nvl(sum(bcdk),0) dk,nvl(sum(jhlc),0) lc,nvl(sum(bcqt),0) qt,nvl(sum(bcztz),0) tz,
		nvl(sum(bcjl),0) sjl,nvl(sum(bcdftz),0) dftz,
		nvl(sum(t.ztz), 0) ztz,
		nvl(sum(t.rys), 0) zrys,
		nvl(sum(t.yqdbcgs), 0) zcgs,
		nvl(sum(t.dk), 0) zdk,
		nvl(sum(t.qt), 0) zqt		
		 from (
				select j.*,lx2.zjhlc jhlc,sl.zlc,sl.xmsl xmsl,lxg.ntz tz,lxg.jsdj,cb.sjpfwh
					,bcztz,bccgs,bcrys,bcdk,bcjl,bcdftz,bcqt
				 from jhxdyh j  left join (select xmbm,sjpfwh from cbsj_yhdzx) cb on j.xmbm=cb.xmbm  left join xmsq_yhdzx lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx  
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	           
	            	left join (select j.xmid,
	            	sum(j.jl) bcjl,
	            	sum(j.rys) bcrys,
	            	sum(j.dk) bcdk,
	            	sum(j.qt) bcqt,
	                sum(j.btzzj) bcxd,
	              	replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
	              	replace(WMSYS.WM_CONCAT(j.xdnf),',',',') bcxdsj,
	             	nvl(sum(j.ztz), 0)   bcztz,
	             	nvl(sum(j.rys),0) + nvl(sum(j.dk),0) + nvl(sum(j.gz),0)+ nvl(sum(j.sz),0)+ nvl(sum(j.zq),0) bcstz,
	             	sum(j.gz) + sum(j.sz) + sum(j.zq) + sum(j.yhdk) bcdftz,
	            	sum(j.btzzj) bccgs
	          		from jhxdyh g
	          		left join plan_zjxd j
	          		on g.xmbm = j.xmid
	         		where 1 = 1
	         		<if test="jhxdwh !=null and jhxdwh !=''">
	         		 ${jhxdwh}  
	         		</if>
	         		 group by j.xmid) wh on j.xmbm=wh.xmid
		        
	              where 1=1 and j.jhxdwh  like '%'
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				<!-- <if test="ghxlxbm!=null and ghxlxbm!=''">
					and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
				</if> -->
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<!-- <if test="ghxlxmc !=null and ghxlxmc !=''">
					and ghxlxmctj like '%'||#{ghxlxmc}||'%'
				</if> -->
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and ${scxdnf} in (${xmnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
				order by j.xdzt,j.xmbm desc
			) t 
		
	</select>
	<select id="queryJhshLjYhdzx_qx" parameterType="jhsh" resultType="java.util.Map">
		select 
		<if test="jhxdwh ==null or jhxdwh ==''">
		count(*) sl,nvl(sum(yqdbcgs),0) cgs,nvl(sum(bcrys),0) rys,nvl(sum(dk),0) dk,nvl(sum(jhlc),0) lc,nvl(sum(ztz),0) tz,'0' sjl,'0' dftz,nvl(sum(hszj),0) hszj
		</if>
		<if test="jhxdwh !=null and jhxdwh !=''">
		count(*) sl,nvl(sum(bccgs),0) cgs,nvl(sum(bcrys),0) rys,nvl(sum(bcdk),0) dk,nvl(sum(jhlc),0) lc,nvl(sum(bcztz),0) tz,nvl(sum(bcjl),0) sjl,nvl(sum(bcdftz),0) dftz,nvl(sum(hszj),0) hszj
		</if>
		 from (
				select j.*,lx2.zjhlc jhlc,sl.zlc,sl.xmsl xmsl,lxg.ntz tz,lxg.jsdj,cb.sjpfwh
				<if test="jhxdwh !=null and jhxdwh !=''">
					,bcztz,bccgs,bcrys,bcdk,bcjl,bcdftz
				</if>
				 from jhxdyh_qx j  left join (select xmbm,sjpfwh from cbsj_yhdzx) cb on j.xmbm=cb.xmbm  left join xmsq_yhdzx lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx  
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	            <if test="jhxdwh !=null and jhxdwh !=''">
	            	left join (select j.xmid,
	            	sum(j.jl) bcjl,
	            	sum(j.rys) bcrys,
	            	sum(j.dk) bcdk,
	                sum(j.btzzj) bcxd,
	              	replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
	              	replace(WMSYS.WM_CONCAT(j.xdnf),',',',') bcxdsj,
	             	sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  bcztz,
	             	nvl(sum(j.rys),0) + nvl(sum(j.dk),0) + nvl(sum(j.gz),0)+ nvl(sum(j.sz),0)+ nvl(sum(j.zq),0) bcstz,
	             	sum(j.gz) + sum(j.sz) + sum(j.zq) + sum(j.yhdk) bcdftz,
	            	sum(j.btzzj) bccgs
	          		from jhxdyh g
	          		left join plan_zjxd j
	          		on g.xmbm = j.xmid
	         		where 1 = 1 ${jhxdwh}  group by j.xmid) wh on j.xmbm=wh.xmid
		        </if>
	              where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				<!-- <if test="ghxlxbm!=null and ghxlxbm!=''">
					and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
				</if> -->
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<!-- <if test="ghxlxmc !=null and ghxlxmc !=''">
					and ghxlxmctj like '%'||#{ghxlxmc}||'%'
				</if> -->
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(j.xmbm,0,4) in (${xmnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				order by j.xdzt,j.xmbm desc
			) t 
		
	</select>
	
	<select id="queryJhshLjYhdzx1" parameterType="jhsh" resultType="java.util.Map">
		select sum(j.sysbbzj) sysbb,sum(j.yqdbcgs) yqdbcgs,sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  ztz,sum(l1.lc) lc from jhsh_yhdzx_qx j left join xmsq_yhdzx l on j.xmbm=l.xmbm left join 
		(select xmid,(sum(nvl(yilc,0))+sum(nvl(erlc,0))+sum(nvl(sanlc,0))+sum(nvl(silc,0))+sum(nvl(dwlc,0))+sum(nvl(wllc,0))) lc from lxsh_lx where xmid like '%4___' and jdbs='2' group by xmid) l1 on j.xmbm = l1.xmid
		where 1=1
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%4___' and jdbs='2')
		</if>
		<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
		<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="tsdq!=null and tsdq!=''">and l.tsdq like '%'||#{tsdq}||'%'</if>
		<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
		<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
	</select>
	<select id="queryJhshLjSh" parameterType="jhsh" resultType="java.util.Map">
		select 
		count(*) sl,nvl(sum(bccgs),0) cgs,nvl(sum(bcdk),0) sbz,nvl(sum(jhlc),0) lc,nvl(sum(bcztz),0) tz,nvl(sum(bcjl),0) sjl,nvl(sum(bcdftz),0) dftz,nvl(sum(bcqt),0) qt,
		nvl(sum(pfztz),0) ztz,nvl(sum(dk),0) zsbz,nvl(sum(jhlc),0) lc,nvl(sum(bbzzj),0) zcgs,nvl(sum(qt),0) zqt
		 from (
				select j.*,lx2.zjhlc jhlc,sl.zlc,sl.xmsl xmsl,lxg.ntz tz,lxg.jsdj,cb.sjpfwh
				,bcztz,bccgs,bcstz,bcjl,bcdftz,bcdk,bcqt
				from jhxdsh j left join (select xmbm,sjpfwh from cbsj_sh) cb on j.xmbm=cb.xmbm  
				left join xmsq_sh lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx where jdbs='2' group by lx.xmid) l on j.xmbm=l.xmbm 
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx  
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	            left join (select j.xmid,
	            	sum(j.jl) bcjl,
	            	sum(j.rys) bcrys,
	            	sum(j.dk) bcdk,
	                sum(j.btzzj) bcxd,
	                sum(j.qt) bcqt,
	              	replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
	              	replace(WMSYS.WM_CONCAT(j.xdnf),',',',') bcxdsj,
	             	nvl(sum(j.ztz), 0)   bcztz,
	             	nvl(sum(j.rys),0) + nvl(sum(j.dk),0) + nvl(sum(j.gz),0)+ nvl(sum(j.sz),0)+ nvl(sum(j.zq),0) bcstz,
	             	sum(j.gz) + sum(j.sz) + sum(j.zq) + sum(j.yhdk) bcdftz,
	            	sum(j.btzzj) bccgs
	          		from jhxdsh g
	          		left join plan_zjxd j
	          		on g.xmbm = j.xmid
	         		where 1 = 1 
	         		<if test="jhxdwh !=null and jhxdwh !=''">
	         		${jhxdwh}  
	         		</if>
	         		group by j.xmid) wh on j.xmbm=wh.xmid
		        
	              where 1=1  and  j.jhxdwh  like '%'
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xmnf !=null and xmnf !=''">
					and ${scxdnf} in (${xmnf})
				</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>

				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>

				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%'))
			</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
				order by j.xdzt,j.xmbm desc
			) t 
		
	</select>
	<select id="queryJhshLjSh_qx" parameterType="jhsh" resultType="java.util.Map">
		select 
		<if test="jhxdwh ==null or jhxdwh ==''">
		count(*) sl,nvl(sum(bbzzj),0) cgs,nvl((sum(jl)+sum(dk)),0) sbz,nvl(sum(jhlc),0) lc,nvl(sum(pfztz),0) tz,'0' sjl,'0' dftz,nvl(sum(hszj),0) hszj
		</if>
		<if test="jhxdwh !=null and jhxdwh !=''">
		count(*) sl,nvl(sum(bccgs),0) cgs,nvl(sum(bcstz),0) sbz,nvl(sum(jhlc),0) lc,nvl(sum(bcztz),0) tz,nvl(sum(bcjl),0) sjl,nvl(sum(bcdftz),0) dftz,nvl(sum(hszj),0) hszj
		</if>
		 from (
				select j.*,lx2.zjhlc jhlc,sl.zlc,sl.xmsl xmsl,lxg.ntz tz,lxg.jsdj,cb.sjpfwh
				<if test="jhxdwh !=null and jhxdwh !=''">
					,bcztz,bccgs,bcstz,bcjl,bcdftz
				</if>
				from jhxdsh_qx j left join (select xmbm,sjpfwh from cbsj_sh) cb on j.xmbm=cb.xmbm  left join xmsq_sh lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx where jdbs='2' group by lx.xmid) l on j.xmbm=l.xmbm 
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx  
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	            <if test="jhxdwh !=null and jhxdwh !=''">
	            	left join (select j.xmid,
	            	sum(j.jl) bcjl,
	            	sum(j.rys) bcrys,
	            	sum(j.dk) bcdk,
	                sum(j.btzzj) bcxd,
	              	replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
	              	replace(WMSYS.WM_CONCAT(j.xdnf),',',',') bcxdsj,
	             	sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  bcztz,
	             	nvl(sum(j.rys),0) + nvl(sum(j.dk),0) + nvl(sum(j.gz),0)+ nvl(sum(j.sz),0)+ nvl(sum(j.zq),0) bcstz,
	             	sum(j.gz) + sum(j.sz) + sum(j.zq) + sum(j.yhdk) bcdftz,
	            	sum(j.btzzj) bccgs
	          		from jhxdsh g
	          		left join plan_zjxd j
	          		on g.xmbm = j.xmid
	         		where 1 = 1 ${jhxdwh}  group by j.xmid) wh on j.xmbm=wh.xmid
		        </if>
	              where 1=1 
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(j.xmbm,0,4) in (${xmnf})
				</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>

				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>

			<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				order by j.xdzt,j.xmbm desc
			) t 
		
	</select>
	
	<select id="queryJhshLjSh1" parameterType="jhsh" resultType="java.util.Map">
		select sum(j.sbzzj) sbzzj,sum(j.bbzzj) bbzzj,sum(l1.lc) lc from jhsh_sh_qx j left join xmsq_sh l on j.xmbm=l.xmbm left join 
		(select xmid,(sum(nvl(yilc,0))+sum(nvl(erlc,0))+sum(nvl(sanlc,0))+sum(nvl(silc,0))+sum(nvl(dwlc,0))+sum(nvl(wllc,0))) lc from lxsh_lx where xmid like '%5___' and jdbs='2' group by xmid) l1 on j.xmbm = l1.xmid
		where 1=1 
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="ylxbh!=null and ylxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where ${ylxbh} and xmid like '%5___' and jdbs='2')
		</if>
		<if test="xmbm!=null and xmbm!=''">and ${xmbm}</if>
		<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
		<if test="tsdq!=null and tsdq!=''">and l.tsdq like '%'||#{tsdq}||'%'</if>
		<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
	</select>
	<select id="queryJhshYhzx" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.xmbm,j.ztz,j.zbzzj,j.sbzzj,j.zddzjl,j.dfzc,j.jhkgsj,j.jhwgsj,j.xdzt,j.xdsj,
			        l.xzqh,l.gydw,l.xzqhdm,l.gydwdm,l.jb,l.jsxz,l.ydbmc,l.xmmc,l.lxmc,l.bz,l.lxzh,l.sqzt
			        from jhsh_yhzx j  left join xmsq_yhzx l on j.xmbm = l.xmbm
			        where 1=1
				<if test="jhsh2.xzqhdm!=null and jhsh2.xzqhdm!=''">
					and ${jhsh2.xzqhdm}
				</if>
				<if test="jhsh2.xmmc!=null and jhsh2.xmmc!=''">
					and l.xmmc like '%'||'${jhsh2.xmmc}'||'%'
				</if>
				<if test="jhsh2.jb!=null and jhsh2.jb!=''">
					and l.jb like '%'||${jhsh2.jb}||'%'
				</if>
				<if test="jhsh2.xmbm!=null and jhsh2.xmbm!=''">
					and ${jhsh2.xmbm}
				</if>
				<if test="jhsh2.jsxz!=null and jhsh2.jsxz!=''">
					and l.jsxz like '%'||${jhsh2.jsxz}||'%'
				</if>
				<if test="jhsh2.ydbmc!=null and jhsh2.ydbmc!=''">
					and l.ydbmc like '%'||'${jhsh2.ydbmc}'||'%'
				</if>
				<if test="jhsh2.lxmc !='' and jhsh2.lxmc != null ">
					and l.lxmc like '%'||'${jhsh2.lxmc}'||'%'
				</if>
				<if test="jhsh2.xdzt>=0">
					and j.xdzt=${jhsh2.xdzt}
				</if>
				order by j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	
	<select id="queryJhshYhzxCount" parameterType="java.util.Map" resultType="int">
				select count(*)
			        from jhsh_yhzx j  left join xmsq_yhzx l on j.xmbm = l.xmbm
			        where 1=1
				<if test="jhsh2.xzqhdm!=null and jhsh2.xzqhdm!=''">
					and ${jhsh2.xzqhdm}
				</if>
				<if test="jhsh2.xmmc!=null and jhsh2.xmmc!=''">
					and l.xmmc like '%'||'${jhsh2.xmmc}'||'%'
				</if>
				<if test="jhsh2.jb!=null and jhsh2.jb!=''">
					and l.jb like '%'||${jhsh2.jb}||'%'
				</if>
				<if test="jhsh2.xmbm!=null and jhsh2.xmbm!=''">
					and ${jhsh2.xmbm}
				</if>
				<if test="jhsh2.jsxz!=null and jhsh2.jsxz!=''">
					and l.jsxz like '%'||${jhsh2.jsxz}||'%'
				</if>
				<if test="jhsh2.ydbmc!=null and jhsh2.ydbmc!=''">
					and l.ydbmc like '%'||'${jhsh2.ydbmc}'||'%'
				</if>
				<if test="jhsh2.lxmc !='' and jhsh2.lxmc != null ">
					and l.lxmc like '%'||'${jhsh2.lxmc}'||'%'
				</if>
				<if test="jhsh2.xdzt>=0">
					and j.xdzt=${jhsh2.xdzt}
				</if>
	</select>
	
	<select id="queryJhshLjYhzx" parameterType="jhsh" resultType="java.util.Map">
		select sum(j.sbzzj) sysbb,sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  ztz 
		from jhsh_yhzx j left join xmsq_yhzx l on j.xmbm=l.xmbm 
		where 1=1
		<if test="xzqhdm!=null and xzqhdm!=''">
			and ${xzqhdm}
		</if>
		<if test="xmmc!=null and xmmc!=''">
			and l.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="jb!=null and jb!=''">
			and l.jb like '%'||#{jb}||'%'
		</if>
		<if test="xmbm!=null and xmbm!=''">
			and ${xmbm}
		</if>
		<if test="jsxz!=null and jsxz!=''">
			and l.jsxz like '%'||#{jsxz}||'%'
		</if>
		<if test="ydbmc!=null and ydbmc!=''">
			and l.ydbmc like '%'||#{ydbmc}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and l.lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xdzt>=0">
			and j.xdzt=#{xdzt}
		</if>
	</select>
	
	<select id="queryJhshxxYhzxByXmbm" parameterType="jhsh" resultType="jhsh">
		select j.*  from jhsh_yhzx j where  j.xmbm=#{xmbm}
	</select>
	
	<update id="updateJhshYhzx" parameterType="jhsh">
		update jhsh_yhzx set 
		<if test="xmbm!=null">xmbm=#{xmbm}</if>
		<if test="ztz!=null">,ztz=#{ztz}</if>
		<if test="zbzzj!=null">,zbzzj=#{zbzzj}</if>
		<if test="sbzzj!=null">,sbzzj=#{sbzzj}</if>
		<if test="zddzjl!=null">,zddzjl=#{zddzjl}</if>
		<if test="dfzc!=null">,dfzc=#{dfzc}</if>
		<if test="jhkgsj!=null">,jhkgsj=#{jhkgsj}</if>
		<if test="jhwgsj!=null">,jhwgsj=#{jhwgsj}</if>
		<if test="xdsj!=null">,xdsj=#{xdsj}</if>
		<if test="xdwh!=null">,xdwh=#{xdwh}</if>
		<if test="xdzt!=null">,xdzt=#{xdzt}</if>
		where xmbm=#{xmbm}
	</update>
	
	
	<select id="queryGsdgz" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,lxbm,qdzh1,zdzh1,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,to_char(lx.lc,'fm9999999990.000') lc,
				sl.zlc,sl.xmsl xmsl,lxg.tz,lxg.jsjsdj,lxg.xjsdj,lxg.lxmc
				,wh.bcxd bcxd,wh.bcstz,wh.bccgs,wh.bcjl
				from gsdgz j  left join lxgsdgz lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
		        left join (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc,decode(substr(xmid,11,1),'3',xjlxbm,ghlxbm) ghlxbm,ghlxmc,decode(substr(xmid,11,1),'3',xjqdzh,ghqdzh) ghqdzh,decode(substr(xmid,11,1),'3',xjzdzh,ghzdzh) ghzdzh,gxlxbm,gxqdzh,gxzdzh,lxbm,lxmc,qdzh qdzh1,zdzh zdzh1
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
		        on j.xmbm=lx.xmid
		        left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
		        left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
		        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
		        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
		        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
		        from (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
		        end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
		        else ''
		        end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
		        from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
		        	left join (select j.xmid,
	            	sum(j.jl) bcjl,
	            	sum(j.rys) bcrys,
	            	sum(j.dk) bcdk,
	                sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  bcxd,
	              	replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
	              	replace(WMSYS.WM_CONCAT(j.xdnf),',',',') bcxdsj,
	             	sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  bcztz,
	             	nvl(sum(j.rys),0) + nvl(sum(j.dk),0)  bcstz,
	             	sum(j.gz) + sum(j.sz) + sum(j.zq) + sum(j.yhdk) bcdftz,
	            	sum(j.btzzj) bccgs
	          		from gsdgz g
	          		left join plan_zjxd j
	          		on g.xmbm = j.xmid
	         		where 1 = 1 
	         		<if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">
	         		${jhsh.jhxdwh}  
	         		</if>
	         		group by j.xmid) wh on j.xmbm=wh.xmid
		        
	            where 1=1 and j.jhxdwh  like '%'
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xmnf !=null and jhsh.xmnf !=''">
					and ${jhsh.scxdnf} in (${jhsh.xmnf})
				</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.jsjsdj!=null and jhsh.jsjsdj!=''">and ${jhsh.jsjsdj}</if>
				
				<if test="jhsh.lxmc !=null and jhsh.lxmc !=''">
					and ghlxmctj like '%'||#{jhsh.lxmc}||'%'
				</if>
				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghlxbh})
				</if>
				<if test="jhsh.ghxlxbm != null and jhsh.ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghxlxbm})
				</if>
			<if test="jhsh.ghxlxmc != '' and jhsh.ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{jhsh.ghxlxmc}||'%')
				)
			</if>
				<if test="jhsh.tsdq !=null and jhsh.tsdq !=''">
					${jhsh.tsdq}
				</if>
				<if test="jhsh.xzdj !=null and jhsh.xzdj !=''">
					and ${jhsh.xzdj}
				</if>
				
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and j.lsjl=#{jhsh.lsjl}</if>
				<if test="jhsh.xmlx1 !=null and jhsh.xmlx1 !=''">${jhsh.xmlx1}</if>
				<if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">${jhsh.jhxdwh}</if>
				<if test="jhsh.sbzt !=null and jhsh.sbzt !=''">and j.sbzt=#{jhsh.sbzt}</if>
				<if test="jhsh.shzt !=null and jhsh.shzt !=''">and j.xdzt=#{jhsh.shzt}</if>
				<if test="jhsh.zjly !=null and jhsh.zjly !=''">
					${jhsh.zjly}
				</if>
				<if test="jhsh.xdzttj !=null and jhsh.xdzttj !=''">
					${jhsh.xdzttj}
				</if>
				<if test="jhsh.gyfl !=null and jhsh.gyfl !=''">
					
				</if>
				<if test="jhsh.xmklx !=null and jhsh.xmklx !=''">
					and xmklx like '%'||#{jhsh.xmklx}||'%'
				</if>
				<if test="jhsh.xmbm !=null and jhsh.xmbm !=''">
					and j.xmbm like '%'||#{jhsh.xmbm}||'%'
				</if>
				order by <if test="jhsh.zydpx =='升序'">to_number(j.zydpx),</if><if test="jhsh.zydpx =='降序'">to_number(j.zydpx) desc,</if>j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryGsdgz_qx" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,lxbm,qdzh1,zdzh1,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,to_char(lx.lc,'fm9999999990.000') lc,sl.zlc,sl.xmsl xmsl,lxg.tz,lxg.jsjsdj,lxg.xjsdj,lxg.lxmc<if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">,wh.bccgs bcxd</if> from gsdgz_qx j  left join lxgsdgz lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
		        left join (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc,decode(substr(xmid,11,1),'3',xjlxbm,ghlxbm) ghlxbm,ghlxmc,decode(substr(xmid,11,1),'3',xjqdzh,ghqdzh) ghqdzh,decode(substr(xmid,11,1),'3',xjzdzh,ghzdzh) ghzdzh,gxlxbm,gxqdzh,gxzdzh,lxbm,lxmc,qdzh qdzh1,zdzh zdzh1
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
		        on j.xmbm=lx.xmid
		        left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
		        left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
		        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
		        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
		        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
		        from (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
		        end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
		        else ''
		        end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
		        from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
		        <if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">
		        	left join (select j.xmid,
	            	sum(j.jl) bcjl,
	            	sum(j.rys) bcrys,
	            	sum(j.dk) bcdk,
	                sum(j.btzzj) bcxd,
	              	replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
	              	replace(WMSYS.WM_CONCAT(j.xdnf),',',',') bcxdsj,
	             	sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  bcztz,
	             	nvl(sum(j.rys),0) + nvl(sum(j.dk),0) + nvl(sum(j.gz),0)+ nvl(sum(j.sz),0)+ nvl(sum(j.zq),0) bcstz,
	             	sum(j.gz) + sum(j.sz) + sum(j.zq) + sum(j.yhdk) bcdftz,
	            	sum(j.btzzj) bccgs
	          		from gsdgz g
	          		left join plan_zjxd j
	          		on g.xmbm = j.xmid
	         		where 1 = 1 ${jhsh.jhxdwh}  group by j.xmid) wh on j.xmbm=wh.xmid
		        
		        </if>
		        
	            where 1=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and j.xmbm like '%'||#{jhsh.xmbm}||'%'</if>
				<if test="jhsh.xmnf !=null and jhsh.xmnf !=''">
					and substr(xmbm,0,4) in (${jhsh.xmnf})
				</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.jsjsdj!=null and jhsh.jsjsdj!=''">and ${jhsh.jsjsdj}</if>
				
				<if test="jhsh.lxmc !=null and jhsh.lxmc !=''">
					and ghlxmctj like '%'||#{jhsh.lxmc}||'%'
				</if>
				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghlxbh})
				</if>
				<if test="jhsh.ghxlxbm != null and jhsh.ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghxlxbm})
				</if>
			<if test="jhsh.ghxlxmc != '' and jhsh.ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{jhsh.ghxlxmc}||'%')
				)
			</if>
				<if test="jhsh.tsdq !=null and jhsh.tsdq !=''">
					${jhsh.tsdq}
				</if>
				<if test="jhsh.xzdj !=null and jhsh.xzdj !=''">
					and ${jhsh.xzdj}
				</if>
				
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and j.lsjl=#{jhsh.lsjl}</if>
				<if test="jhsh.xmlx1 !=null and jhsh.xmlx1 !=''">${jhsh.xmlx1}</if>
				<if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">${jhsh.jhxdwh}</if>
				<if test="jhsh.sbzt !=null and jhsh.sbzt !=''">and j.sbzt=#{jhsh.sbzt}</if>
				<if test="jhsh.shzt !=null and jhsh.shzt !=''">and j.xdzt=#{jhsh.shzt}</if>
				<if test="jhsh.zjly !=null and jhsh.zjly !=''">
					${jhsh.zjly}
				</if>
				<if test="jhsh.xdzttj !=null and jhsh.xdzttj !=''">
					${jhsh.xdzttj}
				</if>
				<if test="jhsh.gyfl !=null and jhsh.gyfl !=''">
					
				</if>
				<if test="jhsh.xmklx !=null and jhsh.xmklx !=''">
					and xmklx like '%'||#{jhsh.xmklx}||'%'
				</if>
				order by <if test="jhsh.zydpx =='升序'">j.zydpx,</if><if test="jhsh.zydpx =='降序'">j.zydpx desc,</if>j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	
	<select id="queryGsdgz_dc" parameterType="java.util.Map" resultType="jhsh">
				 select decode(l_.sffirst,'1',j.xmmc,'') xmmc,decode(l_.sffirst,'1',j.xmbm,'') xmbm,j.lsjl,j.gydw,j.xmlx1,j.xmlxs,j.kgsj,j.wgsj ,j.gq,decode(l_.sffirst,'1',j.gkpfwh,'') gkpfwh ,decode(l_.sffirst,'1',j.sjpfwh,'') 
				 sjpfwh,decode(l_.sffirst,'1',j.jhxdwh,'') jhxdwh,decode(l_.sffirst,'1',j.xdsj,'') xdsj,decode(l_.sffirst,'1',j.pfztz,'') pfztz,decode(l_.sffirst,'1',j.bbzzj,'') bbzzj,
				 decode(l_.sffirst,'1',j.sbzzj,'') sbzzj,l_.lxbm,l_.lc,decode(l_.sffirst,'1',j.qdzh,l_.qdzh) qdzh,decode(l_.sffirst,'1',j.zdzh,l_.zdzh) zdzh,l_.qdmc,l_.zdmc,l_.xzqh,lxg.tz,lxg.jsjsdj,lxg.xjsdj,
				 l_.lxmc,l_.ghlxbm,l_.ghlxmc,l_.ghqdzh,l_.ghzdzh,l_.gxlxbm,l_.gxqdzh,l_.gxzdzh
				 from gsdgz j 
				 left join lxgsdgz lxg on j.xmbm=lxg.xmbm 
				 left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx where jdbs='2' group by lx.xmid) l on j.xmbm=l.xmbm 
				 left join (select xmid,jsxz, (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)) when substr(xmid,11,1)=3
				 then xjlc else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc from lxsh_lx where jdbs='2' and sffirst='1' ) lx on j.xmbm=lx.xmid 
				 left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') 
				 
				 ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj, replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj, replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj, replace(WMSYS.WM_CONCAT(lxmc),',',',') 
				 ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj from (select xmid,jsxz, (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+
				 nvl(jhwllc,0))  else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm else '' end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj from LXSH_LX where jdbs='2' ) group by xmid) lx2 
				 on j.xmbm=lx2.xmid 
				 right join (select * from LXSH_LX where jdbs='2' ) l_ on j.xmbm=l_.xmid 
	             where 1=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xmnf !=null and jhsh.xmnf !=''">
					and substr(j.xmbm,0,4) in (${jhsh.xmnf})
				</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.jsjsdj!=null and jhsh.jsjsdj!=''">and ${jhsh.jsjsdj}</if>
				
				
				<if test="jhsh.lxmc !=null and jhsh.lxmc !=''">
					and l.lxmc like '%'||#{jhsh.lxmc}||'%'
				</if>
 				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghlxbh})
				</if>
				<if test="jhsh.ghxlxbm != null and jhsh.ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghxlxbm})
				</if>
			<if test="jhsh.ghxlxmc != '' and jhsh.ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{jhsh.ghxlxmc}||'%')
				)
			</if>
				<if test="jhsh.tsdq !=null and jhsh.tsdq !=''">
					${jhsh.tsdq}
				</if>
				<if test="jhsh.xzdj !=null and jhsh.xzdj !=''">
					and ${jhsh.xzdj}
				</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and j.lsjl=#{jhsh.lsjl}</if>
				<if test="jhsh.xmlx1 !=null and jhsh.xmlx1 !=''">${jhsh.xmlx1}</if>
				<if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">${jhsh.jhxdwh}</if>
				<if test="jhsh.sbzt !=null and jhsh.sbzt !=''">and j.sbzt=#{jhsh.sbzt}</if>
				<if test="jhsh.shzt !=null and jhsh.shzt !=''">and j.xdzt=#{jhsh.shzt}</if>
				<if test="jhsh.zjly !=null and jhsh.zjly !=''">
					${jhsh.zjly}
				</if>
				<if test="jhsh.xdzttj !=null and jhsh.xdzttj !=''">
					${jhsh.xdzttj}
				</if>
				<if test="jhsh.gyfl !=null and jhsh.gyfl !=''">
					
				</if>
				<if test="jhsh.xmklx !=null and jhsh.xmklx !=''">
					and xmklx like '%'||#{jhsh.xmklx}||'%'
				</if>
				order by <if test="jhsh.zydpx =='升序'">j.zydpx,</if><if test="jhsh.zydpx =='降序'">j.zydpx desc,</if>j.xdzt,j.xmbm desc,l_.sffirst desc
			 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryGsdgz_qx_dc" parameterType="java.util.Map" resultType="jhsh">
				 select decode(l_.sffirst,'1',j.xmmc,'') xmmc,decode(l_.sffirst,'1',j.xmbm,'') xmbm,j.lsjl,j.gydw,j.xmlx1,j.xmlxs,j.kgsj,j.wgsj ,j.gq,decode(l_.sffirst,'1',j.gkpfwh,'') gkpfwh ,decode(l_.sffirst,'1',j.sjpfwh,'') 
				 sjpfwh,decode(l_.sffirst,'1',j.jhxdwh,'') jhxdwh,decode(l_.sffirst,'1',j.xdsj,'') xdsj,decode(l_.sffirst,'1',j.pfztz,'') pfztz,decode(l_.sffirst,'1',j.bbzzj,'') bbzzj,
				 decode(l_.sffirst,'1',j.sbzzj,'') sbzzj,l_.lxbm,l_.lc,decode(l_.sffirst,'1',j.qdzh,l_.qdzh) qdzh,decode(l_.sffirst,'1',j.zdzh,l_.zdzh) zdzh,l_.qdmc,l_.zdmc,l_.xzqh,lxg.tz,lxg.jsjsdj,lxg.xjsdj,
				 l_.lxmc,l_.ghlxbm,l_.ghlxmc,l_.ghqdzh,l_.ghzdzh,l_.gxlxbm,l_.gxqdzh,l_.gxzdzh
				 from gsdgz_qx j 
				 left join lxgsdgz lxg on j.xmbm=lxg.xmbm 
				 left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx where jdbs='2' group by lx.xmid) l on j.xmbm=l.xmbm 
				 left join (select xmid,jsxz, (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)) when substr(xmid,11,1)=3
				 then xjlc else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc from lxsh_lx where jdbs='2' and sffirst='1' ) lx on j.xmbm=lx.xmid 
				 left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') 
				 
				 ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj, replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj, replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj, replace(WMSYS.WM_CONCAT(lxmc),',',',') 
				 ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj from (select xmid,jsxz, (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+
				 nvl(jhwllc,0))  else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm else '' end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj from LXSH_LX where jdbs='2' ) group by xmid) lx2 
				 on j.xmbm=lx2.xmid 
				 right join (select * from LXSH_LX where jdbs='2' ) l_ on j.xmbm=l_.xmid 
	             where 1=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xmnf !=null and jhsh.xmnf !=''">
					and substr(j.xmbm,0,4) in (${jhsh.xmnf})
				</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.jsjsdj!=null and jhsh.jsjsdj!=''">and ${jhsh.jsjsdj}</if>
				
				<if test="jhsh.lxmc !=null and jhsh.lxmc !=''">
					and l.lxmc like '%'||#{jhsh.lxmc}||'%'
				</if>
 				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghlxbh})
				</if>
				<if test="jhsh.ghxlxbm != null and jhsh.ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghxlxbm})
				</if>
			<if test="jhsh.ghxlxmc != '' and jhsh.ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{jhsh.ghxlxmc}||'%')
				)
			</if>
				<if test="jhsh.tsdq !=null and jhsh.tsdq !=''">
					${jhsh.tsdq}
				</if>
				<if test="jhsh.xzdj !=null and jhsh.xzdj !=''">
					and ${jhsh.xzdj}
				</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and j.lsjl=#{jhsh.lsjl}</if>
				<if test="jhsh.xmlx1 !=null and jhsh.xmlx1 !=''">${jhsh.xmlx1}</if>
				<if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">${jhsh.jhxdwh}</if>
				<if test="jhsh.sbzt !=null and jhsh.sbzt !=''">and j.sbzt=#{jhsh.sbzt}</if>
				<if test="jhsh.shzt !=null and jhsh.shzt !=''">and j.xdzt=#{jhsh.shzt}</if>
				<if test="jhsh.zjly !=null and jhsh.zjly !=''">
					${jhsh.zjly}
				</if>
				<if test="jhsh.xdzttj !=null and jhsh.xdzttj !=''">
					${jhsh.xdzttj}
				</if>
				<if test="jhsh.gyfl !=null and jhsh.gyfl !=''">
					
				</if>
				<if test="jhsh.xmklx !=null and jhsh.xmklx !=''">
					and xmklx like '%'||#{jhsh.xmklx}||'%'
				</if>
				order by <if test="jhsh.zydpx =='升序'">j.zydpx,</if><if test="jhsh.zydpx =='降序'">j.zydpx desc,</if>j.xdzt,j.xmbm desc,l_.sffirst desc
			 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryGsdgzCount" parameterType="java.util.Map" resultType="int">
		select count(*) from (
				select j.*,lx.lc,sl.zlc,sl.xmsl xmsl,lxg.tz,lxg.jsjsdj,lxg.xjsdj from gsdgz j  left join lxgsdgz lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
		        left join (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
		        on j.xmbm=lx.xmid
		        left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
		        left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
		        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
		        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
		        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
		        from (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
		        end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
		        else ''
		        end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
		        from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
		        
		         left join (select j.xmid,
	            	sum(j.jl) bcjl,
	            	sum(j.rys) bcrys,
	            	sum(j.dk) bcdk,
	                sum(j.btzzj) bcxd,
	              	replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
	              	replace(WMSYS.WM_CONCAT(j.xdnf),',',',') bcxdsj,
	             	sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  bcztz,
	             	nvl(sum(j.rys),0) + nvl(sum(j.dk),0) + nvl(sum(j.gz),0)+ nvl(sum(j.sz),0)+ nvl(sum(j.zq),0) bcstz,
	             	sum(j.gz) + sum(j.sz) + sum(j.zq) + sum(j.yhdk) bcdftz,
	            	sum(j.btzzj) bccgs
	          		from gsdgz g
	          		left join plan_zjxd j
	          		on g.xmbm = j.xmid
	         		where 1 = 1
	         		 <if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">
	         		 ${jhsh.jhxdwh}  
	         		 </if>
	         		  group by j.xmid) wh on j.xmbm=wh.xmid
	            where 1=1 and j.jhxdwh  like '%'
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xmnf !=null and jhsh.xmnf !=''">
					and ${jhsh.scxdnf} in (${jhsh.xmnf})
				</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.jsjsdj!=null and jhsh.jsjsdj!=''">and ${jhsh.jsjsdj}</if>
				
				
				<if test="jhsh.lxmc !=null and jhsh.lxmc !=''">
					and ghlxmctj like '%'||#{jhsh.lxmc}||'%'
				</if>
 				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghlxbh})
				</if>
				<if test="jhsh.ghxlxbm != null and jhsh.ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghxlxbm})
				</if>
			<if test="jhsh.ghxlxmc != '' and jhsh.ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{jhsh.ghxlxmc}||'%')
				)
			</if>
				<if test="jhsh.tsdq !=null and jhsh.tsdq !=''">
					${jhsh.tsdq}
				</if>
				<if test="jhsh.xzdj !=null and jhsh.xzdj !=''">
					and ${jhsh.xzdj}
				</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and j.lsjl=#{jhsh.lsjl}</if>
				<if test="jhsh.xmlx1 !=null and jhsh.xmlx1 !=''">${jhsh.xmlx1}</if>
				<if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">${jhsh.jhxdwh}</if>
				<if test="jhsh.sbzt !=null and jhsh.sbzt !=''">and j.sbzt=#{jhsh.sbzt}</if>
				<if test="jhsh.shzt !=null and jhsh.shzt !=''">and j.xdzt=#{jhsh.shzt}</if>
				<if test="jhsh.zjly !=null and jhsh.zjly !=''">
					${jhsh.zjly}
				</if>
				<if test="jhsh.xdzttj !=null and jhsh.xdzttj !=''">
					${jhsh.xdzttj}
				</if>
				<if test="jhsh.gyfl !=null and jhsh.gyfl !=''">
					
				</if>
				<if test="jhsh.xmklx !=null and jhsh.xmklx !=''">
					and xmklx like '%'||#{jhsh.xmklx}||'%'
				</if>
				<if test="jhsh.xmbm !=null and jhsh.xmbm !=''">
					and j.xmbm like '%'||#{jhsh.xmbm}||'%'
				</if>
				order by <if test="jhsh.zydpx =='升序'">j.zydpx,</if><if test="jhsh.zydpx =='降序'">j.zydpx desc,</if>j.xdzt,j.xmbm desc
			) t 

	</select>
	<select id="queryGsdgz_qxCount" parameterType="java.util.Map" resultType="int">
		select count(*) from (
				select j.*,lx.lc,sl.zlc,sl.xmsl xmsl,lxg.tz,lxg.jsjsdj,lxg.xjsdj from gsdgz_qx j  left join lxgsdgz lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
		        left join (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
		        on j.xmbm=lx.xmid
		        left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
		        left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
		        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
		        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
		        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
		        from (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
		        end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
		        else ''
		        end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
		        from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
		         <if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">
		         left join (select j.xmid,
	            	sum(j.jl) bcjl,
	            	sum(j.rys) bcrys,
	            	sum(j.dk) bcdk,
	                sum(j.btzzj) bcxd,
	              	replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
	              	replace(WMSYS.WM_CONCAT(j.xdnf),',',',') bcxdsj,
	             	sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  bcztz,
	             	nvl(sum(j.rys),0) + nvl(sum(j.dk),0) + nvl(sum(j.gz),0)+ nvl(sum(j.sz),0)+ nvl(sum(j.zq),0) bcstz,
	             	sum(j.gz) + sum(j.sz) + sum(j.zq) + sum(j.yhdk) bcdftz,
	            	sum(j.btzzj) bccgs
	          		from gsdgz g
	          		left join plan_zjxd j
	          		on g.xmbm = j.xmid
	         		where 1 = 1 ${jhsh.jhxdwh}  group by j.xmid) wh on j.xmbm=wh.xmid
		        
		        </if>
	            where 1=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xmbm!=null and jhsh.xmbm!=''">and j.xmbm like '%'||#{jhsh.xmbm}||'%'</if>
				<if test="jhsh.xmnf !=null and jhsh.xmnf !=''">
					and substr(xmbm,0,4) in (${jhsh.xmnf})
				</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.jsjsdj!=null and jhsh.jsjsdj!=''">and ${jhsh.jsjsdj}</if>
				
				
				<if test="jhsh.lxmc !=null and jhsh.lxmc !=''">
					and ghlxmctj like '%'||#{jhsh.lxmc}||'%'
				</if>
 				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghlxbh})
				</if>
				<if test="jhsh.ghxlxbm != null and jhsh.ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghxlxbm})
				</if>
			<if test="jhsh.ghxlxmc != '' and jhsh.ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{jhsh.ghxlxmc}||'%')
				)
			</if>
				<if test="jhsh.tsdq !=null and jhsh.tsdq !=''">
					${jhsh.tsdq}
				</if>
				<if test="jhsh.xzdj !=null and jhsh.xzdj !=''">
					and ${jhsh.xzdj}
				</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and j.lsjl=#{jhsh.lsjl}</if>
				<if test="jhsh.xmlx1 !=null and jhsh.xmlx1 !=''">${jhsh.xmlx1}</if>
				<if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">${jhsh.jhxdwh}</if>
				<if test="jhsh.sbzt !=null and jhsh.sbzt !=''">and j.sbzt=#{jhsh.sbzt}</if>
				<if test="jhsh.shzt !=null and jhsh.shzt !=''">and j.xdzt=#{jhsh.shzt}</if>
				<if test="jhsh.zjly !=null and jhsh.zjly !=''">
					${jhsh.zjly}
				</if>
				<if test="jhsh.xdzttj !=null and jhsh.xdzttj !=''">
					${jhsh.xdzttj}
				</if>
				<if test="jhsh.gyfl !=null and jhsh.gyfl !=''">
					
				</if>
				<if test="jhsh.xmklx !=null and jhsh.xmklx !=''">
					and xmklx like '%'||#{jhsh.xmklx}||'%'
				</if>
				order by <if test="jhsh.zydpx =='升序'">j.zydpx,</if><if test="jhsh.zydpx =='降序'">j.zydpx desc,</if>j.xdzt,j.xmbm desc
			) t 

	</select>
	
	<select id="queryJhshLjgsdgz" parameterType="jhsh" resultType="java.util.Map">
		select 
		count(*) sl,nvl(sum(bbzzj),0) cgs,nvl(sum(gz+sz+zq+dk+qt), 0) zsbz,
       nvl(sum(jl), 0) zjl,
       nvl(sum(dfzc), 0) zdfzc,
       nvl(sum(yhdk), 0) zyhdk,nvl(sum(bcztz),0) bcxd,nvl(sum(bcstz),0) sbz,nvl(sum(jhlc),0) lc,nvl(sum(pfztz),0) tz,nvl(sum(bcjl),0) sjl,nvl(sum(bcdftz),0) dftz,nvl(sum(bcyhdk),0) yhdk,nvl(sum(bccgs), 0) btz
		 from (
				select j.*,lx2.zjhlc jhlc,sl.zlc,sl.xmsl xmsl,lxg.tz,lxg.jsjsdj,lxg.xjsdj
					,bcztz,bccgs,bcstz,bcjl,bcdftz,bcyhdk,jhxd.btz btz
				from gsdgz j  
				left join (select p.xmid,sum(p.ztz) ztz,sum(p.btzzj) btz,sum(p.dfzc) dfzc,sum(p.yhdk) yhdk,sum(dk) dk,sum(jl) jl from plan_zjxd p group by p.xmid) jhxd on j.xmbm = jhxd.xmid	
				left join lxgsdgz lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
		        left join (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
		        on j.xmbm=lx.xmid
		        left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
		        left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
		        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
		        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
		        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
		        from (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
		        end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
		        else ''
		        end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
		        from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
		         left join (select j.xmid,
	            	sum(j.jl) bcjl,
	            	sum(j.rys) bcrys,
	            	sum(j.dk) bcdk,
	                sum(j.btzzj) bcxd,
	              	replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
	              	replace(WMSYS.WM_CONCAT(j.xdnf),',',',') bcxdsj,
	             	sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  bcztz,
	             	nvl(sum(j.rys),0) + nvl(sum(j.dk),0) + nvl(sum(j.gz),0)+ nvl(sum(j.sz),0)+ nvl(sum(j.zq),0) bcstz,
<!-- 	             	sum(j.gz) + sum(j.sz) + sum(j.zq) +  -->
<!-- 	             	sum(j.yhdk) bcdftz, -->
						sum(j.dfzc) bcdftz,
						sum(j.yhdk) bcyhdk,
	            	sum(j.btzzj) bccgs
	          		from gsdgz g
	          		left join plan_zjxd j
	          		on g.xmbm = j.xmid
	         		where 1 = 1
	         		<if test="jhxdwh !=null and jhxdwh !=''">
	         		 ${jhxdwh} 
	         		 </if>
	         		  group by j.xmid) wh on j.xmbm=wh.xmid
	            where 1=1 and j.jhxdwh  like '%'
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xmnf !=null and xmnf !=''">
					and ${scxdnf} in (${xmnf})
				</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsjsdj}</if>
				
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="sbzt !=null and sbzt !=''">and j.sbzt=#{sbzt}</if>
				<if test="shzt !=null and shzt !=''">and j.xdzt=#{shzt}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="xmklx !=null and xmklx !=''">
					and xmklx like '%'||#{xmklx}||'%'
				</if>
				<if test="xmbm !=null and xmbm !=''">
					and j.xmbm like '%'||#{xmbm}||'%'
				</if>
				order <if test="zydpx=='升序'">j.zydpx,</if><if test="zydpx=='降序'">j.zydpx desc,</if>by j.xdzt,j.xmbm desc
			) t 
	</select>
	<select id="queryJhshLjgsdgz_qx" parameterType="jhsh" resultType="java.util.Map">
		select 
		<if test="jhxdwh ==null or jhxdwh ==''">
		count(*) sl,nvl(sum(bbzzj),0) cgs,nvl((sum(jl)+sum(dk)),0) sbz,nvl(sum(jhlc),0) lc,nvl(sum(pfztz),0) tz,'0' sjl,
<!-- 				nvl(sum(gz),0)+nvl(sum(sz),0)+nvl(sum(zq),0)+nvl(sum(yhdk),0) dftz -->
		nvl(sum(dfzc),0) dftz,nvl(sum(yhdk),0) yhdk,nvl(sum(hszj),0) hszj
		</if>
		<if test="jhxdwh !=null and jhxdwh !=''">
		count(*) sl,nvl(sum(bccgs),0) cgs,nvl(sum(bccgs),0) bcxd,nvl(sum(bcstz),0) sbz,nvl(sum(jhlc),0) lc,nvl(sum(bcztz),0) tz,nvl(sum(bcjl),0) sjl,nvl(sum(bcdftz),0) dftz,nvl(sum(bcyhdk),0) yhdk,nvl(sum(hszj),0) hszj
		</if>
		 from (
				select j.*,lx2.zjhlc jhlc,sl.zlc,sl.xmsl xmsl,lxg.tz,lxg.jsjsdj,lxg.xjsdj
				<if test="jhxdwh !=null and jhxdwh !=''">
					,bcztz,bccgs,bcstz,bcjl,bcdftz,bcyhdk
				</if>
				from gsdgz_qx j  left join lxgsdgz lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
		        left join (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
		        on j.xmbm=lx.xmid
		        left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
		        left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
		        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
		        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
		        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
		        from (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
		        end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
		        else ''
		        end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
		        from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
		         <if test="jhxdwh !=null and jhxdwh !=''">
		         left join (select j.xmid,
	            	sum(j.jl) bcjl,
	            	sum(j.rys) bcrys,
	            	sum(j.dk) bcdk,
	                sum(j.btzzj) bcxd,
	              	replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
	              	replace(WMSYS.WM_CONCAT(j.xdnf),',',',') bcxdsj,
	             	sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  bcztz,
	             	nvl(sum(j.rys),0) + nvl(sum(j.dk),0) + nvl(sum(j.gz),0)+ nvl(sum(j.sz),0)+ nvl(sum(j.zq),0) bcstz,
<!-- 	             	sum(j.gz) + sum(j.sz) + sum(j.zq) +  -->
<!-- 	             	sum(j.yhdk) bcdftz, -->
						sum(j.dfzc) bcdftz,
						sum(j.yhdk) bcyhdk,
	            	sum(j.btzzj) bccgs
	          		from gsdgz g
	          		left join plan_zjxd j
	          		on g.xmbm = j.xmid
	         		where 1 = 1 ${jhxdwh}  group by j.xmid) wh on j.xmbm=wh.xmid
		        
		        </if>
	            where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(xmbm,0,4) in (${xmnf})
				</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsdj}</if>
				


				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>

			<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="sbzt !=null and sbzt !=''">and j.sbzt=#{sbzt}</if>
				<if test="shzt !=null and shzt !=''">and j.xdzt=#{shzt}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="xmklx !=null and xmklx !=''">
					and xmklx like '%'||#{xmklx}||'%'
				</if>
				order <if test="zydpx=='升序'">j.zydpx,</if><if test="zydpx=='降序'">j.zydpx desc,</if>by j.xdzt,j.xmbm desc
			) t 
	</select>
	
	<select id="queryGsdgzxd" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,lxbm,qdzh1,zdzh1,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,lx.lc lc,sl.zlc,sl.xmsl xmsl,lxg.tz,lxg.jsjsdj,lxg.xjsdj from gsdgz j  left join lxgsdgz lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
		        left join (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc,decode(substr(xmid,11,1),'3',xjlxbm,ghlxbm) ghlxbm,ghlxmc,decode(substr(xmid,11,1),'3',xjqdzh,ghqdzh) ghqdzh,decode(substr(xmid,11,1),'3',xjzdzh,ghzdzh) ghzdzh,gxlxbm,gxqdzh,gxzdzh,lxbm,lxmc,qdzh qdzh1,zdzh zdzh1
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
		        on j.xmbm=lx.xmid
		        left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
		        left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
		        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
		        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
		        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
		        from (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
		        end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
		        else ''
		        end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
		        from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	            where 1=1 and xdzt=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				
				<if test="jhsh.lxmc !=null and jhsh.lxmc !=''">
					and ghlxmctj like '%'||#{jhsh.lxmc}||'%'
				</if>
 				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghlxbh})
				</if>
				<if test="jhsh.ghxlxbm != null and jhsh.ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghxlxbm})
				</if>
			<if test="jhsh.ghxlxmc != '' and jhsh.ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{jhsh.ghxlxmc}||'%')
				)
			</if>
				<if test="jhsh.xmnf !=null and jhsh.xmnf !=''">
					and substr(xmbm,0,4) in (${jhsh.xmnf})
				</if>
				<if test="jhsh.scxdnf !=null and jhsh.scxdnf !=''">
					and scxdnf in (${jhsh.scxdnf})
				</if>
				<if test="jhsh.tsdq !=null and jhsh.tsdq !=''">
					${jhsh.tsdq}
				</if>
				<if test="jhsh.xzdj !=null and jhsh.xzdj !=''">
					and ${jhsh.xzdj}
				</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xdzt>=0">and j.xdzt=${jhsh.xdzt}</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.jsjsdj!=null and jhsh.jsjsdj!=''">and ${jhsh.jsjsdj}</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and j.lsjl=#{jhsh.lsjl}</if>
				<if test="jhsh.xmlx1 !=null and jhsh.xmlx1 !=''">${jhsh.xmlx1}</if>
				<if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">${jhsh.jhxdwh}</if>
				<if test="jhsh.zjly !=null and jhsh.zjly !=''">
					${jhsh.zjly}
				</if>
				<if test="jhsh.xdzttj !=null and jhsh.xdzttj !=''">
					${jhsh.xdzttj}
				</if>
				<if test="jhsh.gyfl !=null and jhsh.gyfl !=''">
					
				</if>
				<if test="jhsh.xmklx !=null and jhsh.xmklx !=''">
					and xmklx like '%'||#{jhsh.xmklx}||'%'
				</if>
				<if test="jhsh.xdsj !=null and jhsh.xdsj !=''">
					and to_date(j.xdsj,'yyyy-mm-dd')&lt;=to_date(#{jhsh.xdsj},'yyyy-mm-dd')
				</if>
				order <if test="jhsh.zydpx =='升序'">j.zydpx,</if><if test="jhsh.zydpx =='降序'">j.zydpx desc,</if>by j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryGsdgzxdCount" parameterType="java.util.Map" resultType="int">
		select count(*) from (
				select j.*,lx.lc,sl.zlc,sl.xmsl xmsl,lxg.tz,lxg.jsjsdj,lxg.xjsdj from gsdgz j  left join lxgsdgz lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
		        left join (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
		        on j.xmbm=lx.xmid
		        left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
		        left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
		        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
		        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
		        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
		        from (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
		        end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
		        else ''
		        end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
		        from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	            where 1=1 and xdzt=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				
				<if test="jhsh.lxmc !=null and jhsh.lxmc !=''">
					and ghlxmctj like '%'||#{jhsh.lxmc}||'%'
				</if>
 				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghlxbh})
				</if>
				<if test="jhsh.ghxlxbm != null and jhsh.ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghxlxbm})
				</if>
			<if test="jhsh.ghxlxmc != '' and jhsh.ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{jhsh.ghxlxmc}||'%')
				)
			</if>
				<if test="jhsh.xmnf !=null and jhsh.xmnf !=''">
					and substr(xmbm,0,4) in (${jhsh.xmnf})
				</if>
				<if test="jhsh.scxdnf !=null and jhsh.scxdnf !=''">
					and scxdnf in (${jhsh.scxdnf})
				</if>
				<if test="jhsh.tsdq !=null and jhsh.tsdq !=''">
					${jhsh.tsdq}
				</if>
				<if test="jhsh.xzdj !=null and jhsh.xzdj !=''">
					and ${jhsh.xzdj}
				</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xdzt>=0">and j.xdzt=${jhsh.xdzt}</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.jsjsdj!=null and jhsh.jsjsdj!=''">and ${jhsh.jsjsdj}</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and j.lsjl=#{jhsh.lsjl}</if>
				<if test="jhsh.xmlx1 !=null and jhsh.xmlx1 !=''">${jhsh.xmlx1}</if>
				<if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">${jhsh.jhxdwh}</if>
				<if test="jhsh.zjly !=null and jhsh.zjly !=''">
					${jhsh.zjly}
				</if>
				<if test="jhsh.xdzttj !=null and jhsh.xdzttj !=''">
					${jhsh.xdzttj}
				</if>
				<if test="jhsh.gyfl !=null and jhsh.gyfl !=''">
					
				</if>
				<if test="jhsh.xmklx !=null and jhsh.xmklx !=''">
					and xmklx like '%'||#{jhsh.xmklx}||'%'
				</if>
				<if test="jhsh.xdsj !=null and jhsh.xdsj !=''">
					and to_date(j.xdsj,'yyyy-mm-dd')&lt;=to_date(#{jhsh.xdsj},'yyyy-mm-dd')
				</if>
				order <if test="jhsh.zydpx =='升序'">j.zydpx,</if><if test="jhsh.zydpx =='降序'">j.zydpx desc,</if>by j.xdzt,j.xmbm desc
			) t 
	</select>
	<select id="queryJhshLjgsdxd" parameterType="jhsh" resultType="java.util.Map">
		select count(*) sl,nvl(sum(zcgs), 0) cgs,
       nvl(nvl(sum(zrys), 0) + nvl(sum(zdk), 0) + nvl(sum(zgz), 0) +
           nvl(sum(zsz), 0) + nvl(sum(zzq), 0) + nvl(sum(zqt), 0),
           0) sbz,
       nvl(sum(zjhlc), 0) lc,
       nvl(nvl(sum(zrys), 0) + nvl(sum(zdk), 0) + nvl(sum(zgz), 0) +
           nvl(sum(zsz), 0) + nvl(sum(zzq), 0) + nvl(sum(zqt), 0)+ 
           nvl(sum(zcgs), 0)+ nvl(sum(zjl), 0)+ nvl(sum(zyhdk), 0)+ nvl(sum(zdfzc), 0),
           0) tz,
       nvl(sum(zjl), 0) sjl,
       nvl(sum(zyhdk), 0) yhdk,
       nvl(sum(zdfzc), 0) dftz
		from (
				select j.*,zxd.ztz zztz,zxd.cgs zcgs,zxd.gz zgz,zxd.sz zsz,zxd.zq zzq,zxd.dk zdk,zxd.jl zjl,zxd.rys zrys,zxd.yhdk zyhdk,zxd.dfzc zdfzc,zxd.qt zqt,lx.lc,sl.zlc,sl.xmsl xmsl,lxg.tz,lxg.jsjsdj,lxg.xjsdj,lx2.zjhlc from gsdgz j  left join lxgsdgz lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
		        left join (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
		        on j.xmbm=lx.xmid
		        left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
		        left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
		        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
		        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
		        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
		        from (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
		        end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
		        else ''
		        end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
		        from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
		        left join 
	            (select xmid,nvl(sum(ztz),0) ztz,nvl(sum(btzzj),0) cgs,nvl(sum(gz),0) gz,nvl(sum(sz),0) sz,nvl(sum(dk),0) dk,nvl(sum(zq),0) zq,nvl(sum(jl),0) jl,nvl(sum(qt),0) qt,nvl(sum(rys),0) rys,nvl(sum(yhdk),0) yhdk,nvl(sum(dfzc),0) dfzc    
	            from plan_zjxd j
	            where 1=1
	            <if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
	            group by j.xmid) zxd
	            on j.xmbm=zxd.xmid
	            where 1=1 and xdzt=1
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>

				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
			<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(xmbm,0,4) in (${xmnf})
				</if>
				<if test="scxdnf !=null and scxdnf !=''">
					and scxdnf in (${scxdnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="xmklx !=null and xmklx !=''">
					and xmklx like '%'||#{xmklx}||'%'
				</if>
				<if test="xdsj !=null and xdsj !=''">
					and to_date(j.xdsj,'yyyy-mm-dd')&lt;=to_date(#{xdsj},'yyyy-mm-dd')
				</if>
				order by <if test="zydpx=='升序'">j.zydpx,</if><if test="zydpx=='降序'">j.zydpx desc,</if>j.xdzt,j.xmbm desc
			) t 
	</select>
	<select id="queryGsdgzxdbz" parameterType="jhsh" resultType="jhsh">
		select * from (	
				select j.*,lx.lc lc,sl.zlc,sl.xmsl xmsl,lxg.tz,lxg.jsjsdj,lxg.xjsdj from gsdgz j  left join lxgsdgz lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
		        left join (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
		        on j.xmbm=lx.xmid
		        left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
		        left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
		        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
		        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
		        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
		        from (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
		        end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
		        else ''
		        end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
		        from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	            where 1=1 and xdzt=1
	            and (xdzttj='未下达' or xdzttj='未完成')
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>

				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
			<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(xmbm,0,4) in (${xmnf})
				</if>
				<if test="scxdnf !=null and scxdnf !=''">
					and scxdnf in (${scxdnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<!-- <if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if> -->
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="xmklx !=null and xmklx !=''">
					and xmklx like '%'||#{xmklx}||'%'
				</if>
				<if test="xdsj !=null and xdsj !=''">
					and to_date(j.xdsj,'yyyy-mm-dd')&lt;=to_date(#{xdsj},'yyyy-mm-dd')
				</if>
				order by <if test="zydpx=='升序'">j.zydpx,</if><if test="zydpx=='降序'">j.zydpx desc,</if>j.xdzt,j.xmbm desc
			) t 
		
		
	</select>
	<select id="queryGsdgzxd_qxbz" parameterType="jhsh" resultType="jhsh">
		select * from (	
				select j.*,lx.lc lc,sl.zlc,sl.xmsl xmsl,lxg.tz,lxg.jsjsdj,lxg.xjsdj from gsdgz_qx j  left join lxgsdgz lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
		        left join (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
		        on j.xmbm=lx.xmid
		        left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
		        left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
		        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
		        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
		        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
		        from (select  xmid,jsxz,
		        (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
		        end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
		        else ''
		        end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
		        from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	            where 1=1 
	            and (xdzttj='未下达' or xdzttj='未完成')
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and ghlxbmtj like '%'||#{ghlxbh}||'%'
				</if>
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>

				
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="xmklx !=null and xmklx !=''">
					and xmklx like '%'||#{xmklx}||'%'
				</if>
				<if test="xdsj !=null and xdsj !=''">
					and to_date(j.xdsj,'yyyy-mm-dd')&lt;=to_date(#{xdsj},'yyyy-mm-dd')
				</if>
				order by <if test="zydpx=='升序'">j.zydpx,</if><if test="zydpx=='降序'">j.zydpx desc,</if>j.xdzt,j.xmbm desc
			) t 
	</select>
	
	<insert id="planxdAll" parameterType="java.util.List">
		insert into plan_zjxd(id<if test="xmbm != null">,xmid</if><if test="bzxdnf != null">,xdnf</if><if test="tbdw != null">,tbdw</if><if test="bztbsj != null">,tbtime</if><if test="bzcgs != null">,btzzj</if><if test="jhxdwh != null">,jhxdwh</if><if test="bzgz != null">,gz</if><if test="bzsz != null">,sz</if><if test="bzpfztz != null">,ztz</if><if test="bzdk != null">,dk</if><if test="bzzq != null">,zq</if><if test="bzqt != null">,qt</if><if test="bzjl != null">,jl</if><if test="bzrys != null">,rys</if><if test="bzyhdk != null">,yhdk</if><if test="bzdfzc != null">,dfzc</if><if test="zyjsnr != null">,zyjsnr</if><if test="xzscnl != null">,xzscnl</if>
		<if test="sfqx != null and sfqx !=''">,sfqx</if>
		)
		values(sys_guid()<if test="xmbm != null">,#{xmbm}</if><if test="bzxdnf != null">,#{bzxdnf}</if><if test="tbdw != null">,#{tbdw}</if><if test="bztbsj != null">,#{bztbsj}</if><if test="bzcgs != null">,#{bzcgs}</if><if test="jhxdwh != null">,#{jhxdwh}</if><if test="bzgz != null">,#{bzgz}</if><if test="bzsz != null">,#{bzsz}</if><if test="bzpfztz != null">,#{bzpfztz}</if><if test="bzdk != null">,#{bzdk}</if><if test="bzzq != null">,#{bzzq}</if><if test="bzqt != null">,#{bzqt}</if><if test="bzjl != null">,#{bzjl}</if><if test="bzrys != null">,#{bzrys}</if><if test="bzyhdk != null">,#{bzyhdk}</if><if test="bzdfzc != null">,to_number(#{bzdfzc})</if><if test="zyjsnr != null">,#{zyjsnr}</if><if test="xzscnl != null">,#{xzscnl}</if>
		<if test="sfqx != null and sfqx !=''">,#{sfqx}</if>
		)
	</insert>
	<insert id="planxdAllSzxm" parameterType="java.util.List">
		insert into plan_zjxd(id
		<if test="XMBM != null">,XMID</if>
		<if test="BZXDNF != null">,XDNF</if>
		<if test="TBDW != null">,TBDW</if>
		<if test="BZTBSJ != null">,TBTIME</if>
		<if test="BZCGS != null">,BTZZJ</if>
		<if test="JHXDWH != null">,jhxdwh</if>
		<if test="BZGZ != null">,gz</if>
		<if test="BZSZ != null">,sz</if>
		<if test="BZZTZ != null">,ztz</if>
		<if test="BZDK != null">,dk</if>
		<if test="BZZQ != null">,zq</if>
		<if test="BZQT != null">,qt</if>
		<if test="BZJL != null">,jl</if>
		<if test="BZRYS != null">,rys</if>
		<if test="BZYHDK != null">,yhdk</if>
		<if test="BZDFZC != null">,dfzc</if>
		<if test="ZYJSNR != null">,zyjsnr</if>
		<if test="XZSCNL != null">,xzscnl</if>
		<if test="SFQX != null and SFQX !=''">,sfqx</if>
		<if test="BZSTZ != null and BZSTZ !=''">,STZ</if>
		<if test="BZZDDZJL != null and BZZDDZJL !=''">,ZDDZJL</if>
		)
		values(sys_guid()
		<if test="XMBM != null">,#{XMBM}</if>
		<if test="BZXDNF != null">,#{BZXDNF}</if>
		<if test="TBDW != null">,#{TBDW}</if>
		<if test="BZTBSJ != null">,#{BZTBSJ}</if>
		<if test="BZCGS != null">,#{BZCGS}</if>
		<if test="JHXDWH != null">,#{JHXDWH}</if>
		<if test="BZGZ != null">,#{BZGZ}</if>
		<if test="BZSZ != null">,#{BZSZ}</if>
		<if test="BZZTZ != null">,#{BZZTZ}</if>
		<if test="BZDK != null">,#{BZDK}</if>
		<if test="BZZQ != null">,#{BZZQ}</if>
		<if test="BZQT != null">,#{BZQT}</if>
		<if test="BZJL != null">,#{BZJL}</if>
		<if test="BZRYS != null">,#{BZRYS}</if>
		<if test="BZYHDK != null">,#{BZYHDK}</if>
		<if test="BZDFZC != null">,to_number(#{BZDFZC})</if>
		<if test="ZYJSNR != null">,#{ZYJSNR}</if>
		<if test="XZSCNL != null">,#{XZSCNL}</if>
		<if test="SFQX != null and SFQX !=''">,#{SFQX}</if>
		<if test="BZSTZ != null and BZSTZ !=''">,#{BZSTZ}</if>
		<if test="BZZDDZJL != null and BZZDDZJL !=''">,#{ZDDZJL}</if>
		)
	</insert>
	<update id="planxdAllSzxmmc" parameterType="java.util.List">
		update 	${XMLX}
				set xmmc=#{XMMC} where xmbm=#{XMBM}
	</update>
	<insert id="planxdAllmc" parameterType="java.util.List">
		update 	<if test="xmlx == 1">jhsh_sjgz</if>
				<if test="xmlx == 2">jhsh_lmgz</if>
				<if test="xmlx == 3">jhsh_xj</if>
				<if test="xmlx == 4">jhsh_yhdzx</if>
				<if test="xmlx == 5">jhsh_sh</if>
				set xmmc=#{xmmc} where xmbm=#{xmbm}
		<!-- 
		insert into plan_zjxd(id<if test="xmbm != null">,xmid</if><if test="bzxdnf != null">,xdnf</if><if test="tbdw != null">,tbdw</if><if test="bztbsj != null">,tbtime</if><if test="bzcgs != null">,btzzj</if><if test="jhxdwh != null">,jhxdwh</if><if test="bzgz != null">,gz</if><if test="bzsz != null">,sz</if><if test="bzpfztz != null">,ztz</if><if test="bzdk != null">,dk</if><if test="bzzq != null">,zq</if><if test="bzqt != null">,qt</if><if test="bzjl != null">,jl</if><if test="bzrys != null">,rys</if><if test="bzyhdk != null">,yhdk</if><if test="bzdfzc != null">,dfzc</if><if test="zyjsnr != null">,zyjsnr</if><if test="xzscnl != null">,xzscnl</if>)
		values(sys_guid()<if test="xmbm != null">,#{xmbm}</if><if test="bzxdnf != null">,#{bzxdnf}</if><if test="tbdw != null">,#{tbdw}</if><if test="bztbsj != null">,#{bztbsj}</if><if test="bzcgs != null">,#{bzcgs}</if><if test="jhxdwh != null">,#{jhxdwh}</if><if test="bzgz != null">,#{bzgz}</if><if test="bzsz != null">,#{bzsz}</if><if test="bzpfztz != null">,#{bzpfztz}</if><if test="bzdk != null">,#{bzdk}</if><if test="bzzq != null">,#{bzzq}</if><if test="bzqt != null">,#{bzqt}</if><if test="bzjl != null">,#{bzjl}</if><if test="bzrys != null">,#{bzrys}</if><if test="bzyhdk != null">,#{bzyhdk}</if><if test="bzdfzc != null">,to_number(#{bzdfzc})</if><if test="zyjsnr != null">,#{zyjsnr}</if><if test="xzscnl != null">,#{xzscnl}</if>)
		 -->
	</insert>
	<insert id="planxdAllmc_qx" parameterType="java.util.List">
		update 	<if test="xmlx == 1">jhsh_sjgz_qx</if>
				<if test="xmlx == 2">jhsh_lmgz_qx</if>
				<if test="xmlx == 3">jhsh_xj_qx</if>
				<if test="xmlx == 4">jhsh_yhdzx_qx</if>
				<if test="xmlx == 5">jhsh_sh_qx</if>
				set xmmc=#{xmmc} where xmbm=#{xmbm}
		<!-- 
		insert into plan_zjxd(id<if test="xmbm != null">,xmid</if><if test="bzxdnf != null">,xdnf</if><if test="tbdw != null">,tbdw</if><if test="bztbsj != null">,tbtime</if><if test="bzcgs != null">,btzzj</if><if test="jhxdwh != null">,jhxdwh</if><if test="bzgz != null">,gz</if><if test="bzsz != null">,sz</if><if test="bzpfztz != null">,ztz</if><if test="bzdk != null">,dk</if><if test="bzzq != null">,zq</if><if test="bzqt != null">,qt</if><if test="bzjl != null">,jl</if><if test="bzrys != null">,rys</if><if test="bzyhdk != null">,yhdk</if><if test="bzdfzc != null">,dfzc</if><if test="zyjsnr != null">,zyjsnr</if><if test="xzscnl != null">,xzscnl</if>)
		values(sys_guid()<if test="xmbm != null">,#{xmbm}</if><if test="bzxdnf != null">,#{bzxdnf}</if><if test="tbdw != null">,#{tbdw}</if><if test="bztbsj != null">,#{bztbsj}</if><if test="bzcgs != null">,#{bzcgs}</if><if test="jhxdwh != null">,#{jhxdwh}</if><if test="bzgz != null">,#{bzgz}</if><if test="bzsz != null">,#{bzsz}</if><if test="bzpfztz != null">,#{bzpfztz}</if><if test="bzdk != null">,#{bzdk}</if><if test="bzzq != null">,#{bzzq}</if><if test="bzqt != null">,#{bzqt}</if><if test="bzjl != null">,#{bzjl}</if><if test="bzrys != null">,#{bzrys}</if><if test="bzyhdk != null">,#{bzyhdk}</if><if test="bzdfzc != null">,to_number(#{bzdfzc})</if><if test="zyjsnr != null">,#{zyjsnr}</if><if test="xzscnl != null">,#{xzscnl}</if>)
		 -->
	</insert>
	<insert id="planxdAllcbwh_qx" parameterType="java.util.List">
		update 	<if test="xmlx == 1">cbsj_sjgz_qx</if>
				<if test="xmlx == 2">cbsj_lmgz_qx</if>
				<if test="xmlx == 3">cbsj_xj_qx</if>
				<if test="xmlx == 4">cbsj_yhdzx_qx</if>
				<if test="xmlx == 5">cbsj_sh_qx</if>
				set bz=#{sgtsjwh} where xmbm=#{xmbm}
		<!-- 
		insert into plan_zjxd(id<if test="xmbm != null">,xmid</if><if test="bzxdnf != null">,xdnf</if><if test="tbdw != null">,tbdw</if><if test="bztbsj != null">,tbtime</if><if test="bzcgs != null">,btzzj</if><if test="jhxdwh != null">,jhxdwh</if><if test="bzgz != null">,gz</if><if test="bzsz != null">,sz</if><if test="bzpfztz != null">,ztz</if><if test="bzdk != null">,dk</if><if test="bzzq != null">,zq</if><if test="bzqt != null">,qt</if><if test="bzjl != null">,jl</if><if test="bzrys != null">,rys</if><if test="bzyhdk != null">,yhdk</if><if test="bzdfzc != null">,dfzc</if><if test="zyjsnr != null">,zyjsnr</if><if test="xzscnl != null">,xzscnl</if>)
		values(sys_guid()<if test="xmbm != null">,#{xmbm}</if><if test="bzxdnf != null">,#{bzxdnf}</if><if test="tbdw != null">,#{tbdw}</if><if test="bztbsj != null">,#{bztbsj}</if><if test="bzcgs != null">,#{bzcgs}</if><if test="jhxdwh != null">,#{jhxdwh}</if><if test="bzgz != null">,#{bzgz}</if><if test="bzsz != null">,#{bzsz}</if><if test="bzpfztz != null">,#{bzpfztz}</if><if test="bzdk != null">,#{bzdk}</if><if test="bzzq != null">,#{bzzq}</if><if test="bzqt != null">,#{bzqt}</if><if test="bzjl != null">,#{bzjl}</if><if test="bzrys != null">,#{bzrys}</if><if test="bzyhdk != null">,#{bzyhdk}</if><if test="bzdfzc != null">,to_number(#{bzdfzc})</if><if test="zyjsnr != null">,#{zyjsnr}</if><if test="xzscnl != null">,#{xzscnl}</if>)
		 -->
	</insert>
	
	<select id="queryshxd" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,lxbm,qdzh1,zdzh1,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,lx.lc jhlc,sl.zlc,sl.xmsl xmsl,lxg.jsdj,lxg.tsdq,lxg.xzqh xzqhmc,cb.sjpfwh from jhxdsh j left join (select xmbm,sjpfwh from cbsj_sh) cb on j.xmbm=cb.xmbm  left join xmsq_sh lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx where jdbs='2' group by lx.xmid) l on j.xmbm=l.xmbm 
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,lxbm,lxmc,qdzh qdzh1,zdzh zdzh1
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	              where 1=1 and xdzt=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				
				<if test="jhsh.lxmc !=null and jhsh.lxmc !=''">
					and ghlxmctj like '%'||#{jhsh.lxmc}||'%'
				</if>
 				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghlxbh})
				</if>
				<if test="jhsh.ghxlxbm != null and jhsh.ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghxlxbm})
				</if>
			<if test="jhsh.ghxlxmc != '' and jhsh.ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{jhsh.ghxlxmc}||'%')
				)
			</if>
				<if test="jhsh.xmnf !=null and jhsh.xmnf !=''">
					and substr(j.xmbm,0,4) in (${jhsh.xmnf})
				</if>
				<if test="jhsh.scxdnf !=null and jhsh.scxdnf !=''">
					and scxdnf in (${jhsh.scxdnf})
				</if>
				<if test="jhsh.tsdq !=null and jhsh.tsdq !=''">
					${jhsh.tsdq}
				</if>
				<if test="jhsh.xzdj !=null and jhsh.xzdj !=''">
					and ${jhsh.xzdj}
				</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xdzt>=0">and j.xdzt=${jhsh.xdzt}</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and j.lsjl=#{jhsh.lsjl}</if>
				<if test="jhsh.xmlx1 !=null and jhsh.xmlx1 !=''">and xmlx1 like '%'||#{jhsh.xmlx1}||'%'</if>
				<if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">${jhsh.jhxdwh}</if>
				<if test="jhsh.xdzttj !=null and jhsh.xdzttj !=''">
					${jhsh.xdzttj}
				</if>
				<if test="jhsh.xdsj !=null and jhsh.xdsj !=''">
					and to_date(j.xdsj,'yyyy-mm-dd')&lt;=to_date(#{jhsh.xdsj},'yyyy-mm-dd')
				</if>
				order by <if test="jhsh.zydpx =='升序'">j.zydpx,</if><if test="jhsh.zydpx =='降序'">j.zydpx desc,</if>j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryshxdCount" parameterType="java.util.Map" resultType="int">
		select count(*) from (
				select j.*,lx.lc jhlc,sl.xmsl xmsl,lxg.jsdj from jhxdsh j  left join xmsq_sh lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	              where 1=1 and xdzt=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				
				<if test="jhsh.lxmc !=null and jhsh.lxmc !=''">
					and ghlxmctj like '%'||#{jhsh.lxmc}||'%'
				</if>
				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghlxbh})
				</if>
				<if test="jhsh.ghxlxbm != null and jhsh.ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghxlxbm})
				</if>
			<if test="jhsh.ghxlxmc != '' and jhsh.ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{jhsh.ghxlxmc}||'%')
				)
			</if>
				<if test="jhsh.xmnf !=null and jhsh.xmnf !=''">
					and substr(xmbm,0,4) in (${jhsh.xmnf})
				</if>
				<if test="jhsh.scxdnf !=null and jhsh.scxdnf !=''">
					and scxdnf in (${jhsh.scxdnf})
				</if>
				<if test="jhsh.tsdq !=null and jhsh.tsdq !=''">
					${jhsh.tsdq}
				</if>
				<if test="jhsh.xzdj !=null and jhsh.xzdj !=''">
					and ${jhsh.xzdj}
				</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xdzt>=0">and j.xdzt=${jhsh.xdzt}</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and j.lsjl=#{jhsh.lsjl}</if>
				<if test="jhsh.xmlx1 !=null and jhsh.xmlx1 !=''">and xmlx1 like '%'||#{jhsh.xmlx1}||'%'</if>
				<if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">${jhsh.jhxdwh}</if>
				<if test="jhsh.xdzttj !=null and jhsh.xdzttj !=''">
					${xdzttj}
				</if>
				<if test="jhsh.xdsj !=null and jhsh.xdsj !=''">
					and to_date(j.xdsj,'yyyy-mm-dd')&lt;=to_date(#{jhsh.xdsj},'yyyy-mm-dd')
				</if>
				order by j.xdzt,j.xmbm desc
			) t 
	</select>
	<select id="queryJhbzshLj" parameterType="jhsh" resultType="java.util.Map">
		select count(*) sl,nvl(sum(zcgs),0) cgs,nvl(nvl(sum(zrys),0)+nvl(sum(zdk),0)+nvl(sum(zjl),0),0) sbz,nvl(sum(jhlc),0) lc,nvl(sum(zztz),0) tz,nvl(sum(zjl),0) sjl,nvl((nvl(sum(zgz),0)+nvl(sum(zsz),0)+nvl(sum(zzq),0)),0) dftz from (
				select j.*,zxd.ztz zztz,zxd.cgs zcgs,zxd.gz zgz,zxd.sz zsz,zxd.zq zzq,zxd.dk zdk,zxd.jl zjl,zxd.rys zrys,zxd.qt zqt,lx2.zjhlc jhlc,sl.zlc,sl.xmsl xmsl,lxg.jsdj,lxg.xzqh xzqhmc,cb.sjpfwh
				from jhxdsh j left join (select xmbm,sjpfwh from cbsj_sh) cb on j.xmbm=cb.xmbm  left join xmsq_sh lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx where jdbs='2' group by lx.xmid) l on j.xmbm=l.xmbm 
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	            left join 
	            (select xmid,nvl(sum(ztz),0) ztz,nvl(sum(btzzj),0) cgs,nvl(sum(gz),0) gz,nvl(sum(sz),0) sz,nvl(sum(dk),0) dk,nvl(sum(zq),0) zq,nvl(sum(jl),0) jl,nvl(sum(qt),0) qt,nvl(sum(rys),0) rys,nvl(sum(yhdk),0) yhdk  
	            from plan_zjxd j
	            where 1=1
	            <if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
	            group by j.xmid) zxd
	            on j.xmbm=zxd.xmid
	              where 1=1 and xdzt=1
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(j.xmbm,0,4) in (${xmnf})
				</if>
				<if test="scxdnf !=null and scxdnf !=''">
					and scxdnf in (${scxdnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">and xmlx1 like '%'||#{xmlx1}||'%'</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="xdsj !=null and xdsj !=''">
					and to_date(j.xdsj,'yyyy-mm-dd')&lt;=to_date(#{xdsj},'yyyy-mm-dd')
				</if>
				order by j.xdzt,j.xmbm desc
			) t 
	</select>
	<select id="queryshxdbz" parameterType="jhsh" resultType="jhsh">
		select rownum num,t.* from (
				select j.*,lx.lc jhlc,sl.zlc,sl.xmsl xmsl,lxg.jsdj,lxg.xzqh xzqhmc,cb.sjpfwh from jhxdsh j left join (select xmbm,sjpfwh from cbsj_sh) cb on j.xmbm=cb.xmbm  left join xmsq_sh lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx where jdbs='2' group by lx.xmid) l on j.xmbm=l.xmbm 
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	              where 1=1 and xdzt=1 and (xdzttj='未下达' or xdzttj='未完成')
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
				<if test="ghxlxmc != '' and ghxlxmc != null ">
					and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
					
					)
				</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(j.xmbm,0,4) in (${xmnf})
				</if>
				<if test="scxdnf !=null and scxdnf !=''">
					and scxdnf in (${scxdnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">and xmlx1 like '%'||#{xmlx1}||'%'</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="xdsj !=null and xdsj !=''">
					and to_date(j.xdsj,'yyyy-mm-dd')&lt;=to_date(#{xdsj},'yyyy-mm-dd')
				</if>
				order by j.xdzt,j.xmbm desc
			) t 
	          
	</select>
	
	<select id="queryshxd_qxbz" parameterType="jhsh" resultType="jhsh">
		select rownum num,t.* from (
				select j.*,lx.lc jhlc,sl.zlc,sl.xmsl xmsl,lxg.jsdj,lxg.xzqh xzqhmc,cb.sjpfwh from jhxdsh_qx j left join (select xmbm,sjpfwh from cbsj_sh) cb on j.xmbm=cb.xmbm  left join xmsq_sh lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx where jdbs='2' group by lx.xmid) l on j.xmbm=l.xmbm 
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	              where 1=1 and (xdzttj='未下达' or xdzttj='未完成')
				
				order by j.xdzt,j.xmbm desc
			) t 
	          
	</select>
	
	<select id="queryjhxdyh" parameterType="java.util.Map" resultType="jhsh">
		select * from (	
			select rownum num,t.* from (
				select j.*,lxbm,qdzh1,zdzh1,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,lx.lc jhlc,sl.zlc,sl.xmsl xmsl,lxg.ntz tz,lxg.jsdj,lxg.tsdq,cb.sjpfwh from jhxdyh j  left join (select xmbm,sjpfwh from cbsj_yhdzx) cb on j.xmbm=cb.xmbm  left join xmsq_yhdzx lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,lxbm,lxmc,qdzh qdzh1,zdzh zdzh1
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	              where 1=1 and xdzt=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				<if test="jhsh.lxmc !=null and jhsh.lxmc !=''">
					and ghlxmctj like '%'||#{jhsh.lxmc}||'%'
				</if>

				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghlxbh})
				</if>
				<if test="jhsh.ghxlxbm != null and jhsh.ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghxlxbm})
				</if>
			<if test="jhsh.ghxlxmc != '' and jhsh.ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{jhsh.ghxlxmc}||'%')
				)
			</if>
				<if test="jhsh.xmnf !=null and jhsh.xmnf !=''">
					and substr(j.xmbm,0,4) in (${jhsh.xmnf})
				</if>
				<if test="jhsh.scxdnf !=null and jhsh.scxdnf !=''">
					and scxdnf in (${jhsh.scxdnf})
				</if>
				<if test="jhsh.tsdq !=null and jhsh.tsdq !=''">
					${jhsh.tsdq}
				</if>
				<if test="jhsh.xzdj !=null and jhsh.xzdj !=''">
					and ${jhsh.xzdj}
				</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xdzt>=0">and j.xdzt=${jhsh.xdzt}</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and j.lsjl=#{jhsh.lsjl}</if>
				<if test="jhsh.xmlx1 !=null and jhsh.xmlx1 !=''">${xmlx1}</if>
				<if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">${jhsh.jhxdwh}</if>
				<if test="jhsh.zjly !=null and jhsh.zjly !=''">
					${jhsh.zjly}
				</if>
				<if test="jhsh.xdzttj !=null and jhsh.xdzttj !=''">
					${jhsh.xdzttj}
				</if>
				<if test="jhsh.gyfl !=null and jhsh.gyfl !=''">
					
				</if>
				<if test="jhsh.sfsycgs !=null and jhsh.sfsycgs !=''">
					and sfsycgs = #{jhsh.sfsycgs}
				</if>
				<if test="jhsh.xdsj !=null and jhsh.xdsj !=''">
					and to_date(j.xdsj,'yyyy-mm-dd')&lt;=to_date(#{jhsh.xdsj},'yyyy-mm-dd')
				</if>
				order by j.xdzt,j.xmbm desc
			) t 
		) 
		<if test="page!=null and page!='' and page!=0">
			where <![CDATA[ num>(${page}-1)*${rows} and num<=${page}*${rows}]]>
		</if>
	</select>
	<select id="queryjhxdyhCount" parameterType="java.util.Map" resultType="int">
		select count(*) from (
				select j.*,lx.lc jhlc,sl.xmsl xmsl,lxg.ntz tz,lxg.jsdj from jhxdyh j  left join (select xmbm,sjpfwh from cbsj_yhdzx) cb on j.xmbm=cb.xmbm  left join xmsq_yhdzx lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	              where 1=1 and xdzt=1
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>

				<if test="jhsh.lxmc !=null and jhsh.lxmc !=''">
					and ghlxmctj like '%'||#{jhsh.lxmc}||'%'
				</if>
				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghlxbh})
				</if>
				<if test="jhsh.ghxlxbm != null and jhsh.ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghxlxbm})
				</if>
			<if test="jhsh.ghxlxmc != '' and jhsh.ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{jhsh.ghxlxmc}||'%')
				
				)
			</if>
				<if test="jhsh.xmnf !=null and jhsh.xmnf !=''">
					and substr(j.xmbm,0,4) in (${jhsh.xmnf})
				</if>
				<if test="jhsh.scxdnf !=null and jhsh.scxdnf !=''">
					and scxdnf in (${jhsh.scxdnf})
				</if>
				<if test="jhsh.tsdq !=null and jhsh.tsdq !=''">
					${jhsh.tsdq}
				</if>
				<if test="jhsh.xzdj !=null and jhsh.xzdj !=''">
					and ${jhsh.xzdj}
				</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xdzt>=0">and j.xdzt=${jhsh.xdzt}</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and j.lsjl=#{jhsh.lsjl}</if>
				<if test="jhsh.xmlx1 !=null and jhsh.xmlx1 !=''">${xmlx1}</if>
				<if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">${jhsh.jhxdwh}</if>
				<if test="jhsh.zjly !=null and jhsh.zjly !=''">
					${jhsh.zjly}
				</if>
				<if test="jhsh.xdzttj !=null and jhsh.xdzttj !=''">
					${jhsh.xdzttj}
				</if>
				<if test="jhsh.gyfl !=null and jhsh.gyfl !=''">
					
				</if>
				<if test="jhsh.sfsycgs !=null and jhsh.sfsycgs !=''">
					and sfsycgs = #{jhsh.sfsycgs}
				</if>
				<if test="jhsh.xdsj !=null and jhsh.xdsj !=''">
					and to_date(j.xdsj,'yyyy-mm-dd')&lt;=to_date(#{jhsh.xdsj},'yyyy-mm-dd')
				</if>
				order by j.xdzt,j.xmbm desc
			) t 
	</select>
	<select id="queryJhbzyhLj" parameterType="jhsh" resultType="java.util.Map">
		select count(*) sl,nvl(sum(zcgs),0) cgs,nvl(sum(zrys),0) rys,nvl(sum(zdk),0) dk,nvl(sum(jhlc),0) lc,nvl(sum(zztz),0) tz,nvl(sum(zqt),0) qt,nvl(sum(zjl),0) sjl,nvl((nvl(sum(zgz),0)+nvl(sum(zsz),0)+nvl(sum(zzq),0)),0) dftz 
		from (
				select j.*,zxd.ztz zztz,zxd.cgs zcgs,zxd.gz zgz,zxd.sz zsz,zxd.zq zzq,zxd.dk zdk,zxd.jl zjl,zxd.rys zrys,zxd.qt zqt,lx2.zjhlc jhlc,sl.zlc,sl.xmsl xmsl,lxg.ntz tz,lxg.jsdj,cb.sjpfwh 
				
				from jhxdyh j  left join (select xmbm,sjpfwh from cbsj_yhdzx) cb on j.xmbm=cb.xmbm  left join xmsq_yhdzx lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	            left join 
	            (select xmid,nvl(sum(ztz),0) ztz,nvl(sum(btzzj),0) cgs,nvl(sum(gz),0) gz,nvl(sum(sz),0) sz,nvl(sum(dk),0) dk,nvl(sum(zq),0) zq,nvl(sum(jl),0) jl,nvl(sum(qt),0) qt,nvl(sum(rys),0) rys  
	            from plan_zjxd j
	            where 1=1
	            <if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
	            group by j.xmid) zxd
	            on j.xmbm=zxd.xmid
	              where 1=1 and xdzt=1
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(j.xmbm,0,4) in (${xmnf})
				</if>
				<if test="scxdnf !=null and scxdnf !=''">
					and scxdnf in (${scxdnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdsj !=null and xdsj !=''">
					and to_date(j.xdsj,'yyyy-mm-dd')&lt;=to_date(#{xdsj},'yyyy-mm-dd')
				</if>
				order by j.xdzt,j.xmbm desc
			) t 
	</select>
	<select id="queryyhxdbz" parameterType="jhsh" resultType="jhsh">
		select rownum num,t.* from (
				select j.*,lx.lc jhlc,sl.xmsl xmsl,sl.zlc,lxg.ntz tz,lxg.jsdj,cb.sjpfwh from jhxdyh j  left join (select xmbm,sjpfwh from cbsj_yhdzx) cb on j.xmbm=cb.xmbm  left join xmsq_yhdzx lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	              where 1=1 and xdzt=1  and (xdzttj='未下达' or xdzttj='未完成')
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>

			<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(j.xmbm,0,4) in (${xmnf})
				</if>
				<if test="scxdnf !=null and scxdnf !=''">
					and scxdnf in (${scxdnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdsj !=null and xdsj !=''">
					and to_date(j.xdsj,'yyyy-mm-dd')&lt;=to_date(#{xdsj},'yyyy-mm-dd')
				</if>
				order by j.xdzt,j.xmbm desc
			) t 
	</select>
	<select id="queryyhxd_qxbz" parameterType="jhsh" resultType="jhsh">
		select rownum num,t.* from (
				select j.*,lx.lc jhlc,sl.xmsl xmsl,sl.zlc,lxg.ntz tz,lxg.jsdj,cb.sjpfwh from jhxdyh_qx j  left join (select xmbm,sjpfwh from cbsj_yhdzx) cb on j.xmbm=cb.xmbm  left join xmsq_yhdzx lxg on j.xmbm=lxg.xmbm left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw from lxsh_lx lx group by lx.xmid) l on j.xmbm=l.xmbm
	            left join (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='2' and sffirst='1' ) lx 
	            on j.xmbm=lx.xmid
	            left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='2' group by xmid) sl on j.xmbm=sl.xmid
	            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
	              where 1=1 and (xdzttj='未下达' or xdzttj='未完成')
				
				order by j.xdzt,j.xmbm desc
			) t 
	</select>
	
	<insert id="planxdhzadd" parameterType="java.util.List">
		insert into jhxd_bzhz(id
		<if test="ztz != null">,xdzj</if>
		<if test="jsxz != null">,jsxz</if>
		<if test="ylxbh != null">,xzdj</if>
		<if test="xzqh != null">,xzqh</if>
		<if test="zlc != null">,lc</if>
		)
		values(
		sys_guid()
		<if test="ztz != null">,#{ztz}</if>
		<if test="jsxz != null">,#{jsxz}</if>
		<if test="ylxbh != null">,substr(#{ylxbh},0,1)</if>
		<if test="xzqh != null">,#{xzqh}</if>
		<if test="zlc != null">,#{zlc}</if>)
	</insert>
	
	<delete id="planxdhzdelete">
		delete from JHXD_BZHZ 
	</delete>
	
	<select id="getbzyhhzb" resultType="hashmap">
		select 1 xh,'全省合计' xzqh,sum(lc) lc,sum(dxlc) dxlc,sum(zxlc) zxlc,sum(yflc) yflc,(sum(gdxlc)+sum(gzxlc)+sum(gyflc)) glc,
		 sum(gdxlc) gdxlc,sum(gzxlc) gzxlc,sum(gyflc) gyflc,(sum(sdxlc)+sum(szxlc)+sum(syflc)) slc,
		 sum(sdxlc) sdxlc,sum(szxlc) szxlc,sum(syflc) syflc,sum(xdzj) xdzj,sum(dxxdzj) dxxdzj,
		 sum(zxxdzj) zxxdzj,sum(yfxdzj) yfxdzj,sum(qtxdzj) qtxdzj,(sum(gdxxdzj)+sum(gzxxdzj)+sum(gyfxdzj)) gxdzj,sum(gdxxdzj) gdxxdzj,
		 sum(gzxxdzj) gzxxdzj,sum(gyfxdzj) gyfxdzj,(sum(sdxxdzj)+sum(szxxdzj)+sum(syfxdzj)) sxdzj,sum(sdxxdzj) sdxxdzj,sum(szxxdzj) szxxdzj,sum(syfxdzj) syfxdzj
		from(
		select 
		t.xzqh,t.lc,(case when jsxz like '%大修%' then t.lc else'0' end) dxlc,(case when jsxz like '%中修%' then t.lc else'0' end) zxlc,
		 (case when jsxz like '%预防性%' then t.lc else'0' end) yflc,decode(t.xzdj,'G',(case when jsxz like '%大修%' then t.lc else'0' end),'0') gdxlc,
		 decode(t.xzdj,'G',(case when jsxz like '%中修%' then t.lc else'0' end),'0') gzxlc,decode(t.xzdj,'G',(case when jsxz like '%预防性%' then t.lc else'0' end),'0') gyflc,
		decode(t.xzdj,'S',(case when jsxz like '%大修%' then t.lc else'0' end),'0') sdxlc,decode(t.xzdj,'S',(case when jsxz like '%中修%' then t.lc else'0' end),'0') szxlc,
		decode(t.xzdj,'S',(case when jsxz like '%预防性%' then t.lc else'0' end),'0') syflc,
		t.xdzj,(case when jsxz like '%大修%' then t.xdzj else'0' end) dxxdzj,(case when jsxz like '%中修%' then t.xdzj else'0' end) zxxdzj,
		 (case when jsxz like '%预防性%' then t.xdzj else'0' end) yfxdzj,(case when jsxz not like '%大修%' and jsxz not like '%中修%' and jsxz not like '%预防性%' then t.xdzj else'0' end) qtxdzj,decode(t.xzdj,'G',(case when jsxz like '%大修%' then t.xdzj else'0' end),'0') gdxxdzj,
		 decode(t.xzdj,'G',(case when jsxz like '%中修%' then t.xdzj else'0' end),'0') gzxxdzj,decode(t.xzdj,'G',(case when jsxz like '%预防性%' then t.xdzj else'0' end),'0') gyfxdzj,
		decode(t.xzdj,'S',(case when jsxz like '%大修%' then t.xdzj else'0' end),'0') sdxxdzj,decode(t.xzdj,'S',(case when jsxz like '%中修%' then t.xdzj else'0' end),'0') szxxdzj,
		decode(t.xzdj,'S',(case when jsxz like '%预防性%' then t.xdzj else'0' end),'0') syfxdzj
		from jhxd_bzhz t
		)
		
		union all
		
		select  decode(xzqh,'赣州市',2,'吉安市',3,'宜春市',4,'上饶市',5,'抚州市',6,'九江市',7,'南昌市',8,'萍乡市',9,'景德镇市',10,'新余市',11,'鹰潭市',12，13) xh,
		xzqh,sum(lc) lc,sum(dxlc) dxlc,sum(zxlc) zxlc,sum(yflc) yflc,(sum(gdxlc)+sum(gzxlc)+sum(gyflc)) glc,
		 sum(gdxlc) gdxlc,sum(gzxlc) gzxlc,sum(gyflc) gyflc,(sum(sdxlc)+sum(szxlc)+sum(syflc)) slc,
		 sum(sdxlc) sdxlc,sum(szxlc) szxlc,sum(syflc) syflc,sum(xdzj) xdzj,sum(dxxdzj) dxxdzj,
		 sum(zxxdzj) zxxdzj,sum(yfxdzj) yfxdzj,sum(qtxdzj) qtxdzj,(sum(gdxxdzj)+sum(gzxxdzj)+sum(gyfxdzj)) gxdzj,sum(gdxxdzj) gdxxdzj,
		 sum(gzxxdzj) gzxxdzj,sum(gyfxdzj) gyfxdzj,(sum(sdxxdzj)+sum(szxxdzj)+sum(syfxdzj)) sxdzj,sum(sdxxdzj) sdxxdzj,sum(szxxdzj) szxxdzj,sum(syfxdzj) syfxdzj
		from(
		select 
		t.xzqh,t.lc,(case when jsxz like '%大修%' then t.lc else'0' end) dxlc,(case when jsxz like '%中修%' then t.lc else'0' end) zxlc,
		 (case when jsxz like '%预防性%' then t.lc else'0' end) yflc,decode(t.xzdj,'G',(case when jsxz like '%大修%' then t.lc else'0' end),'0') gdxlc,
		 decode(t.xzdj,'G',(case when jsxz like '%中修%' then t.lc else'0' end),'0') gzxlc,decode(t.xzdj,'G',(case when jsxz like '%预防性%' then t.lc else'0' end),'0') gyflc,
		decode(t.xzdj,'S',(case when jsxz like '%大修%' then t.lc else'0' end),'0') sdxlc,decode(t.xzdj,'S',(case when jsxz like '%中修%' then t.lc else'0' end),'0') szxlc,
		decode(t.xzdj,'S',(case when jsxz like '%预防性%' then t.lc else'0' end),'0') syflc,
		t.xdzj,(case when jsxz like '%大修%' then t.xdzj else'0' end) dxxdzj,(case when jsxz like '%中修%' then t.xdzj else'0' end) zxxdzj,
		 (case when jsxz like '%预防性%' then t.xdzj else'0' end) yfxdzj,(case when jsxz not like '%大修%' and jsxz not like '%中修%' and jsxz not like '%预防性%' then t.xdzj else'0' end) qtxdzj,decode(t.xzdj,'G',(case when jsxz like '%大修%' then t.xdzj else'0' end),'0') gdxxdzj,
		 decode(t.xzdj,'G',(case when jsxz like '%中修%' then t.xdzj else'0' end),'0') gzxxdzj,decode(t.xzdj,'G',(case when jsxz like '%预防性%' then t.xdzj else'0' end),'0') gyfxdzj,
		decode(t.xzdj,'S',(case when jsxz like '%大修%' then t.xdzj else'0' end),'0') sdxxdzj,decode(t.xzdj,'S',(case when jsxz like '%中修%' then t.xdzj else'0' end),'0') szxxdzj,
		decode(t.xzdj,'S',(case when jsxz like '%预防性%' then t.xdzj else'0' end),'0') syfxdzj
		from jhxd_bzhz t
		) group by xzqh
		
		order by xh
				
	</select>
	<!-- 更新示范路工程申报状态 -->
	<update id="plansflgc" parameterType="jhsh">
		update jhsh_sfl set jhsh_sfl.sbzt='1' where jhsh_sfl.xmbm=#{xmbm}
	</update>
	<!-- 更新示范路工程审核状态（为什么不是更新shzt？） -->
	<update id="planshSflgc" parameterType="jhsh">
		update jhsh_sfl set xdzt='1',xdsj=to_char(sysdate,'yyyy-mm-dd') where xmbm in (${xmbm})
	</update>
	<update id="plansbgj" parameterType="jhsh">
		update jhsh_sjgz set sbzt='1' where xmbm in (${xmbm})
	</update>
	<update id="plansblm" parameterType="jhsh">
		update jhsh_lmgz set sbzt='1'  where xmbm in (${xmbm})
	</update>
	<update id="plansbxj" parameterType="jhsh">
		update jhsh_xj set sbzt='1'  where xmbm in (${xmbm})
	</update>
	<update id="plansbyh" parameterType="jhsh">
		update jhsh_yhdzx set sbzt='1'  where xmbm in (${xmbm})
	</update>
	<update id="plansbsh" parameterType="jhsh">
		update jhsh_sh set sbzt='1'  where xmbm in (${xmbm})
	</update>
	<update id="thwshjh" parameterType="jhsh">
		update ${zq} set sbzt='1',xdzt='0',xdsj=''  where xmbm in (${xmbm})
	</update>
	<update id="planshgj" parameterType="jhsh">
		update jhsh_sjgz set xdzt='1',xdsj=to_char(sysdate,'yyyy-mm-dd') where xmbm in (${xmbm})
	</update>
	<update id="planshlm" parameterType="jhsh">
		update jhsh_lmgz set xdzt='1',xdsj=to_char(sysdate,'yyyy-mm-dd') where xmbm in (${xmbm})
	</update>
	<update id="planshxj" parameterType="jhsh">
		update jhsh_xj set xdzt='1',xdsj=to_char(sysdate,'yyyy-mm-dd') where xmbm in (${xmbm})
	</update>
	<update id="planshyh" parameterType="jhsh">
		update jhsh_yhdzx set xdzt='1',xdsj=to_char(sysdate,'yyyy-mm-dd') where xmbm in (${xmbm})
	</update>
	<update id="planshsh" parameterType="jhsh">
		update jhsh_sh set xdzt='1',xdsj=to_char(sysdate,'yyyy-mm-dd') where xmbm in (${xmbm})
	</update>
	
	<select id="queryLsjlListwnxmk" parameterType="java.util.Map" resultType="lx">
	<!-- select distinct tab.* from (
		select  l.xmid,xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,'改建' xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd1 cl right join wnjh_lx l on cl.id=l.id right join wnjh_sjgz j on l.xmid=j.id 
		where l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qdzh)) 
			
	    )
	   
	   and (to_number(l.qdzh)!=${lx.zdzh}) and (to_number(l.zdzh)!=${lx.qdzh})
		
	    
	    union all 
	    
		select l.xmid,xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,'路面改造' xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd1 cl right join wnjh_lx l on cl.id=l.id right join wnjh_lmgz j on l.xmid=j.id 
		where l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qdzh)) 
	    )
	    
	   and (to_number(l.qdzh)!=${lx.zdzh}) and (to_number(l.zdzh)!=${lx.qdzh})
		
	    union all 
	    
		select l.xmid,xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,'新建' xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd1 cl right join wnjh_lx l on cl.id=l.id right join wnjh_xj j on l.xmid=j.id 
		where l.lxbm like '%'||#{lx.lxbm}||'%' and 
		(
			(to_number(l.zdzh) > ${lx.qdzh} and ${lx.zdzh} > to_number(l.qdzh)) 
	    )
	   
	   and (to_number(l.qdzh)!=${lx.zdzh}) and (to_number(l.zdzh)!=${lx.qdzh})
	)tab
	
		
	    order by xmnf desc -->
	    
	    
	    select distinct tab.* from (
		select  l.xmid,xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,'改建' xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd1 cl right join wnjh_lx l on cl.id=l.id right join wnjh_sjgz j on l.xmid=j.id 
		where l.lxbm like '%'||#{lx.lxbm}||'%' 
		and (${lx.zdzh} > ((case when (select f_str_or_num(l.qdzh) from dual)=1 then 9999 else to_number(l.qdzh) end))  
		 and ((case when (select f_str_or_num(l.zdzh) from dual)=1 then 0 else to_number(l.zdzh) end)) > ${lx.qdzh} )  
	     and (((case when (select f_str_or_num(l.qdzh) from dual)=1 then 9999 else to_number(l.qdzh) end))!=${lx.zdzh}) and (((case when (select f_str_or_num(l.zdzh) from dual)=1 then 0 else to_number(l.zdzh) end))!=${lx.qdzh})
		
	    
	    union all 
	    
		select l.xmid,xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,'路面改造' xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd1 cl right join wnjh_lx l on cl.id=l.id right join wnjh_lmgz j on l.xmid=j.id 
		where l.lxbm like '%'||#{lx.lxbm}||'%' 
		and (${lx.zdzh} > ((case when (select f_str_or_num(l.qdzh) from dual)=1 then 9999 else to_number(l.qdzh) end))  
		 and ((case when (select f_str_or_num(l.zdzh) from dual)=1 then 0 else to_number(l.zdzh) end)) > ${lx.qdzh} )  
	     and (((case when (select f_str_or_num(l.qdzh) from dual)=1 then 9999 else to_number(l.qdzh) end))!=${lx.zdzh}) and (((case when (select f_str_or_num(l.zdzh) from dual)=1 then 0 else to_number(l.zdzh) end))!=${lx.qdzh})
		
	    union all 
	    
		select l.xmid,xmnf,l.jsxz,j.xmmc,decode(cl.ghlxbm,null,l.lxbm,cl.ghlxbm) lxbm,decode(cl.ghlxmc,null,l.lxmc,cl.ghlxmc) lxmc,decode(cl.qcqd,null,l.qdzh,cl.qcqd) qdzh,decode(cl.qczd,null,l.zdzh,cl.qczd) zdzh,decode(cl.lxbm, null, l.lxbm, cl.lxbm) ylxbm,decode(cl.qdzh, null, l.qdzh, cl.qdzh) yqdzh,decode(cl.zdzh, null, l.zdzh, cl.zdzh) yzdzh,'新建' xjsdj,l.xjsdj yjsdj,decode(substr(l.xmid,11,1),'1',l.jsjsdj,l.xjsdj) jsjsdj from lx_clsd1 cl right join wnjh_lx l on cl.id=l.id right join wnjh_xj j on l.xmid=j.id 
		where l.lxbm like '%'||#{lx.lxbm}||'%' 
		and (${lx.zdzh} > ((case when (select f_str_or_num(l.qdzh) from dual)=1 then 9999 else to_number(l.qdzh) end))  
		 and ((case when (select f_str_or_num(l.zdzh) from dual)=1 then 0 else to_number(l.zdzh) end)) > ${lx.qdzh} )  
	     and (((case when (select f_str_or_num(l.qdzh) from dual)=1 then 9999 else to_number(l.qdzh) end))!=${lx.zdzh}) and (((case when (select f_str_or_num(l.zdzh) from dual)=1 then 0 else to_number(l.zdzh) end))!=${lx.qdzh})
		
	)tab
	
		
	    order by xmnf desc
	</select>
	<select id="queryGsdgz_dcexcelljsb" parameterType="jhsh" resultType="elist">
	select *
  from (select  t.*
          from (
          select '合计' v_0,''v_1,'' v_2,'' v_3,'' v_4,to_char(count(j.xmmc)) v_5,
          '' v_6,'' v_7,'' v_8, '' v_9,
          '' v_10,'' v_11,'' v_12,
          to_char(sum(sl.zlc),'fm9999999990.000') v_13,to_char(sum(j.ql_ym),'fm9999999990.000') v_14,
          to_char(sum( j.sd_ym),'fm9999999990.000') v_15,'' v_16,
          '' v_17, to_char(sum( j.pfztz),'fm9999999990.000') v_18,
         nvl(sum(wh.bcztz),0) v_19,nvl(sum(wh.bccgs),0) v_20,nvl(sum(j.gz),0) v_21,
         nvl(sum(j.sz),0) v_22,
           nvl(sum(j.zq),0) v_23,
           nvl(sum(j.dk),0) v_24,
           nvl(sum(j.jl),0) v_25,
           nvl(sum(j.qt),0) v_26,
            nvl(sum(j.dfzc),0) v_27,
            nvl(sum(j.yhdk),0) v_28,
            '' v_29,
            '' v_30,
            '' v_31,
            '' v_32,
            '' v_33,
            '' v_34,
            '' v_35,
            '' v_36,
            '' v_37     
                  from (select a.*,b.ql_ym,b.sd_ym from gsdgz a left join (select  xmbm,ql_ym,sd_ym from cbsj_xj union all 
                  select  xmbm,ql_ym,sd_ym from cbsj_sjgz union all select  xmbm,ql_ym,sd_ym from cbsj_lmgz) b on a.xmbm=b.xmbm ) j
                  left join lxgsdgz lxg on j.xmbm = lxg.xmbm
                  left join (select xmid xmbm,
                                   min(lx.xzqhdm) xzqhdm,
                                   min(lx.gydw) gydw
                              from lxsh_lx lx
                             group by lx.xmid) l on j.xmbm = l.xmbm
                  left join (select xmid,
                                   jsxz,
                                   (case
                                     when substr(xmid, 11, 1) = 1 then
                                      to_char(nvl(jhyilc, 0) + nvl(jherlc, 0) +
                                              nvl(jhsanlc, 0) + nvl(jhsilc, 0) +
                                              nvl(jhdwlc, 0) + nvl(jhwllc, 0))
                                     else
                                      to_char(nvl(yilc, 0) + nvl(erlc, 0) +
                                              nvl(sanlc, 0) + nvl(silc, 0) +
                                              nvl(dwlc, 0) + nvl(wllc, 0))
                                   end) lc,
                                   decode(substr(xmid, 11, 1),
                                          '3',
                                          xjlxbm,
                                          ghlxbm) ghlxbm,
                                   ghlxmc,
                                   decode(substr(xmid, 11, 1),
                                          '3',
                                          xjqdzh,
                                          ghqdzh) ghqdzh,
                                   decode(substr(xmid, 11, 1),
                                          '3',
                                          xjzdzh,
                                          ghzdzh) ghzdzh,
                                   gxlxbm,
                                   gxqdzh,
                                   gxzdzh,
                                   lxbm,
                                   lxmc,
                                   qdzh qdzh1,
                                   zdzh zdzh1
                              from lxsh_lx
                             where jdbs = '2'
                               and sffirst = '1') lx on j.xmbm = lx.xmid
                  left join (select xmid,
                                   count(xmid) xmsl,
                                   decode(substr(xmid, 11, 1),
                                          1,
                                          (nvl(sum(jhyilc), 0) +
                                          nvl(sum(jherlc), 0) +
                                          nvl(sum(jhsanlc), 0) +
                                          nvl(sum(jhsilc), 0) +
                                          nvl(sum(jhdwlc), 0) +
                                          nvl(sum(jhwllc), 0)),
                                          (nvl(sum(yilc), 0) +
                                          nvl(sum(erlc), 0) +
                                          nvl(sum(sanlc), 0) +
                                          nvl(sum(silc), 0) +
                                          nvl(sum(dwlc), 0) +
                                          nvl(sum(wllc), 0))) zlc
                              from lxsh_lx
                             where jdbs = '2'
                             group by xmid) sl on j.xmbm = sl.xmid
                  left join (select xmid,
                                   sum(jhlc) zjhlc,
                                   replace(WMSYS.WM_CONCAT(lxbm), ',', ',') ghlxbmtj,
                                   replace(WMSYS.WM_CONCAT(ghxlxbm), ',', ',') ghxlxbmtj,
                                   replace(WMSYS.WM_CONCAT(jsjsdj), ',', ',') jsjsdjtj,
                                   replace(WMSYS.WM_CONCAT(xjsdj), ',', ',') xjsdjtj,
                                   replace(WMSYS.WM_CONCAT(lxmc), ',', ',') ghlxmctj,
                                   replace(WMSYS.WM_CONCAT(ghxlxmc), ',', ',') ghxlxmctj
                              from (select xmid,
                                           jsxz,
                                           (case
                                             when substr(xmid, 11, 1) = 1 then
                                              to_char(nvl(jhyilc, 0) +
                                                      nvl(jherlc, 0) +
                                                      nvl(jhsanlc, 0) +
                                                      nvl(jhsilc, 0) +
                                                      nvl(jhdwlc, 0) +
                                                      nvl(jhwllc, 0))
                                             else
                                              to_char(nvl(yilc, 0) +
                                                      nvl(erlc, 0) +
                                                      nvl(sanlc, 0) +
                                                      nvl(silc, 0) +
                                                      nvl(dwlc, 0) +
                                                      nvl(wllc, 0))
                                           end) jhlc,
                                           lxbm,
                                           lxmc,
                                           (case
                                             when substr(xmid, 11, 1) = 3 then
                                              xjlxbm
                                             else
                                              ''
                                           end) ghxlxbm,
                                           '' ghxlxmc,
                                           jsjsdj,
                                           xjsdj
                                      from LXSH_LX
                                     where jdbs = '2')
                             group by xmid) lx2 on j.xmbm = lx2.xmid
                  left join (select j.xmid,
                                   sum(j.jl) bcjl,
                                   sum(j.rys) bcrys,
                                   sum(j.dk) bcdk,
                                   sum(j.btzzj) + nvl(sum(j.rys), 0) +
                                   nvl(sum(j.dk), 0) + nvl(sum(j.gz), 0) +
                                   nvl(sum(j.sz), 0) + nvl(sum(j.zq), 0) +
                                   sum(j.dfzc) bcxd,
                                   replace(WMSYS.WM_CONCAT(j.jhxdwh),
                                           ',',
                                           ',') bcxdwh,
                                   replace(WMSYS.WM_CONCAT(j.xdnf), ',', ',') bcxdsj,
                                   sum(j.btzzj) + nvl(sum(j.rys), 0) +
                                   nvl(sum(j.dk), 0) + nvl(sum(j.gz), 0) +
                                   nvl(sum(j.sz), 0) + nvl(sum(j.zq), 0) +
                                   sum(j.dfzc) bcztz,
                                   nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) bcstz,
                                   sum(j.gz) + sum(j.sz) + sum(j.zq) +
                                   sum(j.yhdk) bcdftz,
                                   sum(j.btzzj) bccgs
                              from gsdgz g
                              left join plan_zjxd j on g.xmbm = j.xmid
                             where 1 = 1
                            <if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">
	         		${jhsh.jhxdwh}  
	         		</if>
	         		group by j.xmid) wh on j.xmbm=wh.xmid
		        
	            where 1=1 and j.jhxdwh  like '%'
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xmnf !=null and jhsh.xmnf !=''">
					and ${jhsh.scxdnf} in (${jhsh.xmnf})
				</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.jsjsdj!=null and jhsh.jsjsdj!=''">and ${jhsh.jsjsdj}</if>
				
				<if test="jhsh.lxmc !=null and jhsh.lxmc !=''">
					and ghlxmctj like '%'||#{jhsh.lxmc}||'%'
				</if>
				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghlxbh})
				</if>
				<if test="jhsh.ghxlxbm != null and jhsh.ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghxlxbm})
				</if>
			<if test="jhsh.ghxlxmc != '' and jhsh.ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{jhsh.ghxlxmc}||'%')
				)
			</if>
				<if test="jhsh.tsdq !=null and jhsh.tsdq !=''">
					${jhsh.tsdq}
				</if>
				<if test="jhsh.xzdj !=null and jhsh.xzdj !=''">
					and ${jhsh.xzdj}
				</if>
				
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and j.lsjl=#{jhsh.lsjl}</if>
				<if test="jhsh.xmlx1 !=null and jhsh.xmlx1 !=''">${jhsh.xmlx1}</if>
				<if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">${jhsh.jhxdwh}</if>
				<if test="jhsh.sbzt !=null and jhsh.sbzt !=''">and j.sbzt=#{jhsh.sbzt}</if>
				<if test="jhsh.shzt !=null and jhsh.shzt !=''">and j.xdzt=#{jhsh.shzt}</if>
				<if test="jhsh.zjly !=null and jhsh.zjly !=''">
					${jhsh.zjly}
				</if>
				<if test="jhsh.xdzttj !=null and jhsh.xdzttj !=''">
					${jhsh.xdzttj}
				</if>
				<if test="jhsh.gyfl !=null and jhsh.gyfl !=''">
					
				</if>
				<if test="jhsh.xmklx !=null and jhsh.xmklx !=''">
					and xmklx like '%'||#{jhsh.xmklx}||'%'
				</if>
				<if test="jhsh.xmbm !=null and jhsh.xmbm !=''">
					and j.xmbm like '%'||#{jhsh.xmbm}||'%'
				</if>
				order by <if test="jhsh.zydpx =='升序'">j.zydpx,</if><if test="jhsh.zydpx =='降序'">j.zydpx desc,</if>j.xdzt,j.xmbm desc
			) t 
		) 
		
	</select>
	<select id="queryGsdgz_dcexcelsb" parameterType="jhsh" resultType="elist">
	select *
  from (select to_char(rownum) v_0, t.*
          from (select j.zydpx v_1,
                       to_char('江西省') v_2,
                       to_char(j.ds) v_3,
                       to_char(j.xzqh) v_4,
                       j.xmmc v_5,
       decode(instr(RemoveSameStr(lx2.ghlxbm, ','), ','),
              0,
              RemoveSameStr(lx2.ghlxbm, ','),
              lx2.ghlxbm) v_6,
                       lx2.ghqdzh v_7,
                       lx2.ghzdzh v_8,
                       decode(instr(RemoveSameStr(lx2.ylxbm, ','), ','),
              0,
              RemoveSameStr(lx2.ylxbm, ','),
              lx2.ylxbm) v_9,
                       lx2.qdzh v_10,
                       lx2.zdzh v_11,
                       to_char(j.xmlx1) v_12,
                       lx2.lc v_13,
                       j.ql_ym v_14,
                       j.sd_ym v_15,
                       lxg.jsjsdj v_16,
                       lxg.xjsdj v_17,
                       j.pfztz v_18,
                       nvl(wh.bcztz, 0) v_19,
                       nvl(wh.bccgs, 0) v_20,
                       nvl(j.gz, 0) v_21,
                       nvl(j.sz, 0) v_22,
                       nvl(j.zq, 0) v_23,
                       nvl(j.dk, 0) v_24,
                       nvl(j.jl, 0) v_25,
                       nvl(j.qt, 0) v_26,
                       nvl(j.dfzc, 0) v_27,
                       nvl(j.yhdk, 0) v_28,
                       j.zyjsnr v_29,
                       j.xzscnl v_30,
                       j.gkpfwh v_31,
                       j.sjpfwh v_32,
                       lxg.xmklx v_33,
                       j.xmbm v_34,
                       j.scxdnf v_35,
                       j.bz v_36,
                       j.tsdq v_37
                  from (select a.*, b.ql_ym, b.sd_ym
                          from gsdgz a
                          left join (select xmbm, ql_ym, sd_ym
                                      from cbsj_xj
                                    union all
                                    select xmbm, ql_ym, sd_ym
                                      from cbsj_sjgz
                                    union all
                                    select xmbm, ql_ym, sd_ym from cbsj_lmgz) b on a.xmbm =
                                                                                   b.xmbm) j
                  left join lxgsdgz lxg on j.xmbm = lxg.xmbm
                  left join (select xmid xmbm,
                                   min(lx.xzqhdm) xzqhdm,
                                   min(lx.gydw) gydw
                              from lxsh_lx lx
                             group by lx.xmid) l on j.xmbm = l.xmbm
                  left join (select xmid,
                    replace(WMSYS.WM_CONCAT(lxbm), ',', ',') ghlxbmtj,
                    replace(WMSYS.WM_CONCAT(ghxlxbm), ',', ',') ghxlxbmtj,
                    replace(WMSYS.WM_CONCAT(jsjsdj), '、', ',') jsjsdjtj,
                    replace(WMSYS.WM_CONCAT(xjsdj), '、', ',') xjsdjtj,
                    replace(max(qdzh), ',.', ',0.') qdzh,
                    replace(max(zdzh), ',.', ',0.') zdzh,
                    replace(max(ghqdzh), ',.', ',0.') ghqdzh,
                    replace(max(ghzdzh), ',.', ',0.') ghzdzh,
                    max(ghlxbm) ghlxbm,
                    max(ylxbm) ylxbm,
                    sum(lc) lc
               from (select xmid,
                            lxbm,
                            lxmc,
                          
                            (case
                              when substr(xmid, 11, 1) = 3 then
                               xjlxbm
                              else
                               ''
                            end) ghxlxbm,
                            '' ghxlxmc,
                            jsjsdj,
                            xjsdj,
                            WMSYS.WM_CONCAT(ghlxbm) over(PARTITION BY xmid ORDER BY id, ghlxbm) ghlxbm,
                            WMSYS.WM_CONCAT(lxbm) over(PARTITION BY xmid ORDER BY id, lxbm) ylxbm,
                            WMSYS.WM_CONCAT((case
                                              when qdzh like '.%' then
                                               0 || qdzh
                                              when qdzh like '%,.%' then
                                               replace(qdzh, ',.', ',0.')
                                              else
                                               qdzh
                                            end)) over(PARTITION BY xmid ORDER BY id, qdzh) qdzh,
                            WMSYS.WM_CONCAT((case
                                              when zdzh like '.%' then
                                               0 || zdzh
                                              when zdzh like '%,.%' then
                                               replace(zdzh, ',.', ',0.')
                                              else
                                               zdzh
                                            end)) over(PARTITION BY xmid ORDER BY id, zdzh) zdzh,
                            WMSYS.WM_CONCAT((case
                                              when ghqdzh like '.%' then
                                               0 || ghqdzh
                                              when ghqdzh like '%,.%' then
                                               replace(ghqdzh, ',.', ',0.')
                                              else
                                               ghqdzh
                                            end)) over(PARTITION BY xmid ORDER BY id, ghqdzh) ghqdzh,
                            WMSYS.WM_CONCAT((case
                                              when ghzdzh like '.%' then
                                               0 || ghzdzh
                                              when ghzdzh like '%,.%' then
                                               replace(ghzdzh, ',.', ',0.')
                                              else
                                               ghzdzh
                                            end)) over(PARTITION BY xmid ORDER BY id, ghzdzh) ghzdzh,
                                             (case
                              when substr(xmid, 11, 1) = 1 then
                               to_char(nvl(jhyilc, 0) + nvl(jherlc, 0) +
                                       nvl(jhsanlc, 0) + nvl(jhsilc, 0) +
                                       nvl(jhdwlc, 0) + nvl(jhwllc, 0))
                              else
                               to_char(nvl(yilc, 0) + nvl(erlc, 0) +
                                       nvl(sanlc, 0) + nvl(silc, 0) +
                                       nvl(dwlc, 0) + nvl(wllc, 0))
                            end) lc
                       from LXSH_LX 
                      where jdbs = '2')
                             group by xmid) lx2 on j.xmbm = lx2.xmid
                  left join (select j.xmid,
                                   sum(j.jl) bcjl,
                                   sum(j.rys) bcrys,
                                   sum(j.dk) bcdk,
                                   sum(j.btzzj) + nvl(sum(j.rys), 0) +
                                   nvl(sum(j.dk), 0) + nvl(sum(j.gz), 0) +
                                   nvl(sum(j.sz), 0) + nvl(sum(j.zq), 0) +
                                   sum(j.dfzc) bcxd,
                                   replace(WMSYS.WM_CONCAT(j.jhxdwh),
                                           ',',
                                           ',') bcxdwh,
                                   replace(WMSYS.WM_CONCAT(j.xdnf), ',', ',') bcxdsj,
                                   sum(j.btzzj) + nvl(sum(j.rys), 0) +
                                   nvl(sum(j.dk), 0) + nvl(sum(j.gz), 0) +
                                   nvl(sum(j.sz), 0) + nvl(sum(j.zq), 0) +
                                   sum(j.dfzc) bcztz,
                                   nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) bcstz,
                                   sum(j.gz) + sum(j.sz) + sum(j.zq) +
                                   sum(j.yhdk) bcdftz,
                                   sum(j.btzzj) bccgs
                              from gsdgz g
                              left join plan_zjxd j on g.xmbm = j.xmid
                             where 1 = 1
                             <if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">
	         		${jhsh.jhxdwh}  
	         		</if>
	         		group by j.xmid) wh on j.xmbm=wh.xmid
		        
	            where 1=1 and j.jhxdwh  like '%'
				<if test="jhsh.xzqhdm!=null and jhsh.xzqhdm!=''">and ${jhsh.xzqhdm}</if>
				<if test="jhsh.xmmc!=null and jhsh.xmmc!=''">and j.xmmc like '%'||#{jhsh.xmmc}||'%'</if>
				<if test="jhsh.xmnf !=null and jhsh.xmnf !=''">
					and ${jhsh.scxdnf} in (${jhsh.xmnf})
				</if>
				<if test="jhsh.jsdj!=null and jhsh.jsdj!=''">and ${jhsh.jsdj}</if>
				<if test="jhsh.jsjsdj!=null and jhsh.jsjsdj!=''">and ${jhsh.jsjsdj}</if>
				
				<if test="jhsh.lxmc !=null and jhsh.lxmc !=''">
					and ghlxmctj like '%'||#{jhsh.lxmc}||'%'
				</if>
				<if test="jhsh.ghlxbh!=null and jhsh.ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghlxbh})
				</if>
				<if test="jhsh.ghxlxbm != null and jhsh.ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${jhsh.ghxlxbm})
				</if>
			<if test="jhsh.ghxlxmc != '' and jhsh.ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{jhsh.ghxlxmc}||'%')
				)
			</if>
				<if test="jhsh.tsdq !=null and jhsh.tsdq !=''">
					${jhsh.tsdq}
				</if>
				<if test="jhsh.xzdj !=null and jhsh.xzdj !=''">
					and ${jhsh.xzdj}
				</if>
				
				<if test="jhsh.lsjl!=null and jhsh.lsjl!=''">and j.lsjl=#{jhsh.lsjl}</if>
				<if test="jhsh.xmlx1 !=null and jhsh.xmlx1 !=''">${jhsh.xmlx1}</if>
				<if test="jhsh.jhxdwh !=null and jhsh.jhxdwh !=''">${jhsh.jhxdwh}</if>
				<if test="jhsh.sbzt !=null and jhsh.sbzt !=''">and j.sbzt=#{jhsh.sbzt}</if>
				<if test="jhsh.shzt !=null and jhsh.shzt !=''">and j.xdzt=#{jhsh.shzt}</if>
				<if test="jhsh.zjly !=null and jhsh.zjly !=''">
					${jhsh.zjly}
				</if>
				<if test="jhsh.xdzttj !=null and jhsh.xdzttj !=''">
					${jhsh.xdzttj}
				</if>
				<if test="jhsh.gyfl !=null and jhsh.gyfl !=''">
					
				</if>
				<if test="jhsh.xmklx !=null and jhsh.xmklx !=''">
					and xmklx like '%'||#{jhsh.xmklx}||'%'
				</if>
				<if test="jhsh.xmbm !=null and jhsh.xmbm !=''">
					and j.xmbm like '%'||#{jhsh.xmbm}||'%'
				</if>
				order by <if test="jhsh.zydpx =='升序'">j.zydpx,</if><if test="jhsh.zydpx =='降序'">j.zydpx desc,</if>j.xdzt,j.xmbm desc
			) t 
		) 
		
	</select>
                   
                 
	
	<select id="queryGsdgz_dcexcel1" parameterType="jhsh" resultType="elist">
	
	 select 
           '合计' v_0,'' v_1,'' v_2,'' v_3,to_char(count(j.xmbm)) v_4,
          '' v_5,'' v_6,'' v_7, '' v_8,
          '' v_9,'' v_10,'' v_11,
          to_char(sum(l.zjhlc),'fm9999999990.000') v_12,to_char(sum(yilc),'fm9999999990.000') v_13,
          to_char(sum(erlc),'fm9999999990.000') v_14,to_char(sum(sanlc),'fm9999999990.000') v_15,
          to_char(sum(silc),'fm9999999990.000') v_16,
          nvl('',0)  v_17,nvl('',0) v_18, 
          '' v_19,'' v_20,to_char(nvl(sum(j.pfztz),0)) v_21,to_char(nvl(sum(j.bbzzj),0)) v_22,
          nvl(sum(jhxd.btz),0) v_23,nvl(sum(jhxd.dk),0) v_24,nvl(sum(jhxd.jl),0) v_25,
          nvl(sum(jhlj.ztz),0) v_26,nvl(sum(jhlj.btz),0) v_27,nvl(sum(jhlj.dk),0) v_28,nvl(sum(jhlj.jl),0) v_29,
          nvl(sum(jh15.ztz),0) v_30,nvl(sum(jh15.btz),0) v_31,nvl(sum(jh15.dk),0) v_32,nvl(sum(jh15.jl),0) v_33,
          nvl(sum(jh15.dfzc),0) v_34,nvl(sum(jh15.yhdk),0) v_35,'' v_36,'' v_37,'' v_38,
          '' v_39,'' v_40,'' v_41,'' v_42,'' v_43,'' v_44
          from gsdgz j
          left join cbgsdgz cb
          on j.xmbm=cb.xmbm
          left join kxgsdgz kx
          on j.xmbm=kx.xmbm
           left join         
         (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
              replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
              replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
              replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,
             replace(max(qdzh), ',.', ',0.') qdzh,replace(max(zdzh), ',.', ',0.') zdzh,replace(max(ghqdzh), ',.', ',0.') ghqdzh,replace(max(ghzdzh), ',.', ',0.') ghzdzh
             ,max(ghlxbm) ghlxbm,max(ylxbm) ylxbm,
              decode(substr(xmid,11,1),'1',(sum(nvl(jhyilc,0))),(sum(nvl(yilc,0)))) yilc,decode(substr(xmid,11,1),'1',(sum(nvl(jherlc,0))),(sum(nvl(erlc,0)))) erlc,
             decode(substr(xmid,11,1),'1',(sum(nvl(jhsanlc,0))),(sum(nvl(sanlc,0)))) sanlc,decode(substr(xmid,11,1),'1',(sum(nvl(jhsilc,0))),(sum(nvl(silc,0)))) silc
              from (select  xmid,
              (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0))
              else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0))
              end) jhlc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,yilc,erlc,sanlc,silc,dwlc,wllc,
               lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm  else '' end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj,
               WMSYS.WM_CONCAT(ghlxbm)over( PARTITION BY xmid ORDER BY id,ghlxbm) ghlxbm,
               WMSYS.WM_CONCAT(lxbm)over( PARTITION BY xmid ORDER BY id,lxbm) ylxbm,
               WMSYS.WM_CONCAT((case when qdzh like '.%' then 0||qdzh when qdzh like '%,.%' then replace(qdzh, ',.', ',0.') else qdzh end ))over( PARTITION BY xmid ORDER BY id,qdzh) qdzh,
               WMSYS.WM_CONCAT((case when zdzh like '.%' then 0||zdzh when zdzh like '%,.%' then replace(zdzh, ',.', ',0.') else zdzh end ))over( PARTITION BY xmid ORDER BY id,zdzh) zdzh,
               WMSYS.WM_CONCAT((case when ghqdzh like '.%' then 0||ghqdzh when ghqdzh like '%,.%' then replace(ghqdzh, ',.', ',0.') else ghqdzh end ))over( PARTITION BY xmid ORDER BY id,ghqdzh) ghqdzh,
               WMSYS.WM_CONCAT((case when ghzdzh like '.%' then 0||ghzdzh when ghzdzh like '%,.%' then replace(ghzdzh, ',.', ',0.') else ghzdzh end ))over( PARTITION BY xmid ORDER BY id,ghzdzh) ghzdzh
              from LXSH_LX  where jdbs='2') group by xmid) l on j.xmbm=l.xmid 
          left join(
          select p.xmid,sum(p.ztz) ztz,sum(p.btzzj) btz,sum(p.dfzc) dfzc,sum(p.yhdk) yhdk,sum(dk) dk,sum(jl) jl from plan_zjxd p 
           group by p.xmid 
          ) jhxd on j.xmbm=jhxd.xmid
          left join(
          select p.xmid,sum(p.ztz) ztz,sum(p.btzzj) btz,sum(p.dfzc) dfzc,sum(p.yhdk) yhdk,sum(p.dk) dk,sum(p.jl) jl from plan_zjxd p
          where 1=1 
          <if test="jhxdwh !=null and jhxdwh !=''">
           and p.xdnf&lt; (select min(j.xdnf) from plan_zjxd j where 1=1 ${jhxdwh})
          </if>
          group by p.xmid 
          ) jhlj on j.xmbm=jhlj.xmid
          left join(
          select j.xmid,sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  ztz,sum(j.btzzj) btz,sum(j.dfzc) dfzc,sum(j.yhdk) yhdk,sum(j.dk) dk,sum(j.jl) jl,
          replace(WMSYS.WM_CONCAT(j.zyjsnr),',',',') zyjsnr, replace(WMSYS.WM_CONCAT(j.xzscnl),',',',') xzscnl
          from plan_zjxd j 
          where 1=1
          <if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if> 
          group by j.xmid 
          ) jh15 on j.xmbm=jh15.xmid
               where 1=1 and j.jhxdwh  like '%'
                <if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			    <if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%'))
			    </if>
				<if test="xmnf !=null and xmnf !=''">
					and fun_scxdnf(xmbm) in (${xmnf})
				</if>
<!-- 				<if test="scxdnf !=null and scxdnf !=''"> -->
<!-- 					and scxdnf in (${scxdnf}) -->
<!-- 				</if> -->
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if> 
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
				
  union all
               
	select 
           to_char(rownum) v_0,to_char('江西省') v_1,to_char(j.ds) v_2,to_char(j.xzqh) v_3,j.xmmc v_4,
          decode(instr(RemoveSameStr(l.ghlxbm,','),','),0,RemoveSameStr(l.ghlxbm,','),l.ghlxbm) v_5,
          to_char(l.ghqdzh) v_6,to_char(l.ghzdzh) v_7,
          decode(instr(RemoveSameStr(l.ylxbm,','),','),0,RemoveSameStr(l.ylxbm,','),l.ylxbm) v_8,
          to_char(l.qdzh) v_9,to_char(l.zdzh) v_10,to_char(j.xmlx1) v_11,
          to_char(l.zjhlc,'fm9999999990.000') v_12,to_char(yilc,'fm9999999990.000') v_13,
          to_char(erlc,'fm9999999990.000') v_14,to_char(sanlc,'fm9999999990.000') v_15,
          to_char(silc,'fm9999999990.000') v_16,
<!--           nvl(decode(cb.ql_ym,'无','0',cb.ql_ym),0)  v_17,nvl(decode(cb.sd_ym,'无','0',cb.sd_ym),0) v_18, -->
         nvl('',0)  v_17,nvl('',0) v_18, 
          substr(j.kgsj,0,4) v_19,substr(j.wgsj,0,4) v_20,nvl(j.pfztz,0) v_21,nvl(j.bbzzj,0) v_22,
          nvl(jhxd.btz,0) v_23,nvl(jhxd.dk,0) v_24,nvl(jhxd.jl,0) v_25,
          nvl(jhlj.ztz,0) v_26,nvl(jhlj.btz,0) v_27,nvl(jhlj.dk,0) v_28,nvl(jhlj.jl,0) v_29,
          nvl(jh15.ztz,0) v_30,nvl(jh15.btz,0) v_31,nvl(jh15.dk,0) v_32,nvl(jh15.jl,0) v_33,
          nvl(jh15.dfzc,0) v_34,nvl(jh15.yhdk,0) v_35,j.zyjsnr v_36,j.xzscnl v_37,j.jhxdwh v_38,
          kx.gkpfwh v_39,cb.sjpfwh v_40,j.xmbm v_41,sbnf.scxdnf v_42,j.bz v_43,j.tsdq v_44
          from gsdgz j
          left join (select xmid,min(xdnf) scxdnf from plan_zjxd group by xmid) sbnf on j.xmbm = sbnf.xmid
          left join cbgsdgz cb
          on j.xmbm=cb.xmbm
          left join kxgsdgz kx
          on j.xmbm=kx.xmbm
          
           left join
          
         (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
              replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
              replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
              replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,
             replace(max(qdzh), ',.', ',0.') qdzh,replace(max(zdzh), ',.', ',0.') zdzh,replace(max(ghqdzh), ',.', ',0.') ghqdzh,replace(max(ghzdzh), ',.', ',0.') ghzdzh
             ,max(ghlxbm) ghlxbm,max(ylxbm) ylxbm,
              decode(substr(xmid,11,1),'1',(sum(nvl(jhyilc,0))),(sum(nvl(yilc,0)))) yilc,decode(substr(xmid,11,1),'1',(sum(nvl(jherlc,0))),(sum(nvl(erlc,0)))) erlc,
             decode(substr(xmid,11,1),'1',(sum(nvl(jhsanlc,0))),(sum(nvl(sanlc,0)))) sanlc,decode(substr(xmid,11,1),'1',(sum(nvl(jhsilc,0))),(sum(nvl(silc,0)))) silc
              from (select  xmid,
              (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0))
              else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0))
              end) jhlc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,yilc,erlc,sanlc,silc,dwlc,wllc,
               lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm  else '' end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj,
               WMSYS.WM_CONCAT(ghlxbm)over( PARTITION BY xmid ORDER BY id,ghlxbm) ghlxbm,
               WMSYS.WM_CONCAT(lxbm)over( PARTITION BY xmid ORDER BY id,lxbm) ylxbm,
               WMSYS.WM_CONCAT((case when qdzh like '.%' then 0||qdzh when qdzh like '%,.%' then replace(qdzh, ',.', ',0.') else qdzh end ))over( PARTITION BY xmid ORDER BY id,qdzh) qdzh,
               WMSYS.WM_CONCAT((case when zdzh like '.%' then 0||zdzh when zdzh like '%,.%' then replace(zdzh, ',.', ',0.') else zdzh end ))over( PARTITION BY xmid ORDER BY id,zdzh) zdzh,
               WMSYS.WM_CONCAT((case when ghqdzh like '.%' then 0||ghqdzh when ghqdzh like '%,.%' then replace(ghqdzh, ',.', ',0.') else ghqdzh end ))over( PARTITION BY xmid ORDER BY id,ghqdzh) ghqdzh,
               WMSYS.WM_CONCAT((case when ghzdzh like '.%' then 0||ghzdzh when ghzdzh like '%,.%' then replace(ghzdzh, ',.', ',0.') else ghzdzh end ))over( PARTITION BY xmid ORDER BY id,ghzdzh) ghzdzh
              from LXSH_LX  where jdbs='2') group by xmid) l on j.xmbm=l.xmid 
          left join(
          select p.xmid,sum(p.ztz) ztz,sum(p.btzzj) btz,sum(p.dfzc) dfzc,sum(p.yhdk) yhdk,sum(dk) dk,sum(jl) jl from plan_zjxd p 
           group by p.xmid 
          ) jhxd on j.xmbm=jhxd.xmid
          left join(
          select p.xmid,sum(p.ztz) ztz,sum(p.btzzj) btz,sum(p.dfzc) dfzc,sum(p.yhdk) yhdk,sum(p.dk) dk,sum(p.jl) jl from plan_zjxd p
          where 1=1
          <if test="jhxdwh !=null and jhxdwh !=''">
           and p.xdnf&lt; (select min(j.xdnf) from plan_zjxd j where 1=1 ${jhxdwh})
          </if>
          group by p.xmid 
          ) jhlj on j.xmbm=jhlj.xmid
          left join(
          select j.xmid,sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc)  ztz,sum(j.btzzj) btz,sum(j.dfzc) dfzc,sum(j.yhdk) yhdk,sum(j.dk) dk,sum(j.jl) jl,
          replace(WMSYS.WM_CONCAT(j.zyjsnr),',',',') zyjsnr, replace(WMSYS.WM_CONCAT(j.xzscnl),',',',') xzscnl
          from plan_zjxd j 
          where 1=1
          <if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if> 
          group by j.xmid 
          ) jh15 on j.xmbm=jh15.xmid
               where 1=1 and j.jhxdwh  like '%'
                <if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			    <if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%'))
			    </if>
				<if test="xmnf !=null and xmnf !=''">
					and fun_scxdnf(xmbm) in (${xmnf})
				</if>
<!-- 				<if test="scxdnf !=null and scxdnf !=''"> -->
<!-- 					and scxdnf in (${scxdnf}) -->
<!-- 				</if> -->
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if> 
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
	</select> 
	
	<select id="queryGsdgz_dcexcel" parameterType="jhsh" resultType="elist">
					select 
					null v_0,null v_1,count(*)||'' v_2,null v_3,sum(v_4)||'' v_4,sum(v_5)||'' v_5,
					sum(v_6)||'' v_6,sum(v_7)||'' v_7,sum(v_8)||'' v_8,null v_9,
					null v_10,null v_11,null v_12,sum(v_13)||'' v_13,sum(v_14)||'' v_14,sum(v_15) v_15,
					sum(v_16) v_16,sum(v_17) v_17,sum(v_18) v_18,sum(v_19) v_19,
					sum(v_20) v_20,null v_21,null v_22,null v_23,null v_24,null v_50
					from (
					select 
					rownum v_0,j.xzqh v_1,j.xmmc v_2,l.jsxz v_3,
<!-- 					nvl(decode(cb.sd_ym,'无','0',cb.sd_ym),0)+nvl(decode(cb.dq_cd,'无','0',cb.dq_cd),0)+ -->
					to_char(zlc,'fm9999999990.000') v_4,to_char(yilc,'fm9999999990.000') v_5,to_char(erlc,'fm9999999990.000') v_6,to_char(sanlc,'fm9999999990.000') v_7,to_char(silc,'fm9999999990.000') v_8,
<!-- 					nvl(decode(cb.dq_cd,'无','0',cb.dq_cd),0)  -->
					'' v_9,
<!-- 					nvl(decode(cb.sd_ym,'无','0',cb.sd_ym),0)  -->
					'' v_10,j.kgsj v_11,j.wgsj v_12,j.pfztz v_13,j.bbzzj v_14,
					wc14.ztz14 v_15,wc14.btz14 v_16,jh15.ztz v_17,jh15.btz v_18,
					jh15.dfzc v_19,jh15.yhdk v_20,j.zyjsnr v_21,j.xzscnl v_22,
					kx.gkpfwh v_23,cb.sjpfwh v_24
					from gsdgz j
					left join cbgsdgz cb
					on j.xmbm=cb.xmbm
					left join kxgsdgz kx
					on j.xmbm=kx.xmbm
					
					 left join
					
					(select xmid,decode(substr(xmid,11,1),'1',(sum(nvl(jhyilc,0))+sum(nvl(jherlc,0))+sum(nvl(jhsanlc,0))+sum(nvl(jhsilc,0))+sum(nvl(jhdwlc,0))+sum(nvl(jhwllc,0))),(sum(nvl(yilc,0))+sum(nvl(erlc,0))+sum(nvl(sanlc,0))+sum(nvl(silc,0))+sum(nvl(dwlc,0))+sum(nvl(wllc,0)))) zlc, 
					decode(substr(xmid,11,1),'1',(sum(nvl(jhyilc,0))),(sum(nvl(yilc,0)))) yilc,decode(substr(xmid,11,1),'1',(sum(nvl(jherlc,0))),(sum(nvl(erlc,0)))) erlc,
					(sum(nvl(jhsanlc,0))),(sum(nvl(sanlc,0))) sanlc,(sum(nvl(jhsilc,0))),(sum(nvl(silc,0))) silc,min(jsxz) jsxz,min(xzqhdm) xzqhdm,min(gydw) gydw
					from lxsh_lx where jdbs='2' group by xmid) l on j.xmbm=l.xmid 
					left join (
					select jhid,sum(nvl(lm.wc_btz,0))+sum(nvl(lm.wc_stz,0))+sum(nvl(lm.wc_qttz,0)) ztz14,sum(nvl(lm.wc_btz,0)) btz14 from gcgl_gcgzgj lm where substr(lm.sbyf,0,4)&lt;=to_char(to_number(substr(#{xmnf},0,4))-1) group by lm.jhid
					union all
					select jhid,sum(nvl(lm.wc_btz,0))+sum(nvl(lm.wc_stz,0))+sum(nvl(lm.wc_qttz,0)) ztz14,sum(nvl(lm.wc_btz,0)) btz14 from gcgl_xj lm where substr(lm.sbyf,0,4)&lt;=to_char(to_number(substr(#{xmnf},0,4))-1) group by lm.jhid
					union all
					select jhid,sum(nvl(sj.bywctze,0))+sum(nvl(sj.zycgs,0)) ztz14,sum(nvl(sj.zycgs,0)) btz14 from gcgl_gcgzsj sj where substr(sj.sbyf,0,4)&lt;=to_char(to_number(substr(#{xmnf},0,4))-1) group by sj.jhid
					) wc14 on j.xmbm=wc14.jhid
					left join(
					select p.xmid,sum(p.ztz) ztz,sum(p.btzzj) btz,sum(p.dfzc) dfzc,sum(p.yhdk) yhdk from plan_zjxd p where p.xdnf=#{xmnf} group by p.xmid 
					) jh15 on j.xmbm=jh15.xmid
	             where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and fun_scxdnf(xmbm) in (${xmnf})
				</if>
				<if test="scxdnf !=null and scxdnf !=''">
					and scxdnf in (${scxdnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
					)
					union all
					select 
					'' v_0,j.xzqh v_1,j.xmmc v_2,l.jsxz v_3,
<!-- 					nvl(decode(cb.sd_ym,'无','0',cb.sd_ym),0)+nvl(decode(cb.dq_cd,'无','0',cb.dq_cd),0)+ -->
					to_char(zlc,'fm9999999990.000') v_4,to_char(yilc,'fm9999999990.000') v_5,to_char(erlc,'fm9999999990.000') v_6,to_char(sanlc,'fm9999999990.000') v_7,to_char(silc,'fm9999999990.000') v_8,
<!-- 					nvl(decode(cb.dq_cd,'无','0',cb.dq_cd),0)  -->
					'' v_9,
<!-- 					nvl(decode(cb.sd_ym,'无','0',cb.sd_ym),0)  -->
					'' v_10,j.kgsj v_11,j.wgsj v_12,decode(l.sffirst,'1',j.pfztz,'') v_13,decode(l.sffirst,'1',j.bbzzj,'') v_14,
					decode(l.sffirst,'1',wc14.ztz14,'') v_15,decode(l.sffirst,'1',wc14.btz14,'') v_16,decode(l.sffirst,'1',jh15.ztz,'') v_17,decode(l.sffirst,'1',jh15.btz,'') v_18,
					decode(l.sffirst,'1',jh15.dfzc,'') v_19,decode(l.sffirst,'1',jh15.yhdk,'') v_20,j.zyjsnr v_21,j.xzscnl v_22,
					kx.gkpfwh v_23,cb.sjpfwh v_24,l.sffirst v_50
					from gsdgz j
					left join cbgsdgz cb
					on j.xmbm=cb.xmbm
					left join kxgsdgz kx
					on j.xmbm=kx.xmbm
					
					 left join
					
					(select xmid,decode(substr(xmid, 11, 1),
                         '1',
                         (nvl(jhyilc, 0) + nvl(jherlc, 0) +
                         nvl(jhsanlc, 0) + nvl(jhsilc, 0) +
                         nvl(jhdwlc, 0) + nvl(jhwllc, 0)),
                         (nvl(yilc, 0) + nvl(erlc, 0) +
                         nvl(sanlc, 0) + nvl(silc, 0) +
                         nvl(dwlc, 0) + nvl(wllc, 0))) zlc,
                  decode(substr(xmid, 11, 1),
                         '1',
                         (nvl(jhyilc, 0)),
                         (nvl(yilc, 0))) yilc,
                  decode(substr(xmid, 11, 1),
                         '1',
                         (nvl(jherlc, 0)),
                         (nvl(erlc, 0))) erlc,
                  (nvl(jhsanlc, 0)),
                  (nvl(sanlc, 0)) sanlc,
                  (nvl(jhsilc, 0)),
                  (nvl(silc, 0)) silc,
                  jsxz jsxz,
                  xzqhdm xzqhdm,
                  gydw gydw,
                  lxbm lxbm,
                  ghlxmc lxmc,
                  jsjsdj jsjsdj,
                  sffirst,
                  ghlxbm,
                  ghqdzh,
                  ghzdzh,
                  lxlmkd,
                  jsfa
             from lxsh_lx
            where jdbs = '2' order by xmid,sffirst desc) l on j.xmbm=l.xmid 
					left join (
					select jhid,sum(nvl(lm.wc_btz,0))+sum(nvl(lm.wc_stz,0))+sum(nvl(lm.wc_qttz,0)) ztz14,sum(nvl(lm.wc_btz,0)) btz14 from gcgl_gcgzgj lm where substr(lm.sbyf,0,4)&lt;=to_char(to_number(substr(#{xmnf},0,4))-1) group by lm.jhid
					union all
					select jhid,sum(nvl(lm.wc_btz,0))+sum(nvl(lm.wc_stz,0))+sum(nvl(lm.wc_qttz,0)) ztz14,sum(nvl(lm.wc_btz,0)) btz14 from gcgl_xj lm where substr(lm.sbyf,0,4)&lt;=to_char(to_number(substr(#{xmnf},0,4))-1) group by lm.jhid
					union all
					select jhid,sum(nvl(sj.bywctze,0))+sum(nvl(sj.zycgs,0)) ztz14,sum(nvl(sj.zycgs,0)) btz14 from gcgl_gcgzsj sj where substr(sj.sbyf,0,4)&lt;=to_char(to_number(substr(#{xmnf},0,4))-1) group by sj.jhid
					) wc14 on j.xmbm=wc14.jhid
					left join(
					select p.xmid,sum(p.ztz) ztz,sum(p.btzzj) btz,sum(p.dfzc) dfzc,sum(p.yhdk) yhdk from plan_zjxd p where p.xdnf=#{xmnf} group by p.xmid 
					) jh15 on j.xmbm=jh15.xmid
	             where 1=1
				<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and fun_scxdnf(xmbm) in (${xmnf})
				</if>
				<if test="scxdnf !=null and scxdnf !=''">
					and scxdnf in (${scxdnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="jsjsdj!=null and jsjsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
		
	</select>
<!-- 下面是导出灾毁恢复的sql -->	
<select id="queryZhhf_dcexcel1" parameterType="jhsh" resultType="elist">
 select 
  '合计' v_0, '' v_1,'' v_2, to_char(count(j.xmbm)) v_3,
  '' v_4,'' v_5,'' v_6,'' v_7,'' v_8,'' v_9,'' v_10, 
  to_char(sum(l.zjhlc) ,'fm9999999990.000') v_11,to_char(sum(l.yilc) ,'fm9999999990.000') v_12,
  to_char(sum(l.erlc) ,'fm9999999990.000') v_13,to_char(sum(l.sanlc),'fm9999999990.000') v_14,
  to_char(sum(l.silc),'fm9999999990.000') v_15,nvl('',0) v_16,nvl('',0) v_17,'' v_18,
  '' v_19,'' v_20,to_char(nvl(sum(j.pfztz),0)) v_21,
  to_char(sum(decode(xd.stz,0,j.pfztz,xd.btz+xd.stz+xd.dfzc))) v_22,nvl(sum(xd.btz),0) v_23,
  nvl(sum(xd.stz),0) v_24,nvl(sum(decode(xd.stz,0,(j.pfztz-xd.btz),xd.dfzc)),0) v_25,'' v_26,'' v_27,'' v_28,'' v_29,'' v_30,'' v_31
  from   Jhxdsh   j
  left join cbsj_sh c
  on j.xmbm=c.xmbm
  left join xmsq_sh x
  on j.xmbm=x.xmbm
   left join
  (select j.xmid,nvl(sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc) ,0) ztz,nvl(sum(j.btzzj),0) btz,nvl(sum(j.dk),0) stz,nvl(sum(j.dfzc),0) dfzc
   ,nvl(sum(j.yhdk),0) yhdk,nvl(sum(gz)+sum(sz)+sum(zq),0) dftz,
   replace(WMSYS.WM_CONCAT(j.zyjsnr),',',',') zyjsnr
  from plan_zjxd j where 1=1 
  <if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if> 
  group by j.xmid) xd on j.xmbm=xd.xmid
  left join (
 select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
              replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
              replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
              replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,
             replace(max(qdzh), ',.', ',0.') qdzh,replace(max(zdzh), ',.', ',0.') zdzh,replace(max(ghqdzh), ',.', ',0.') ghqdzh,replace(max(ghzdzh), ',.', ',0.') ghzdzh
             ,max(ghlxbm) ghlxbm,max(ylxbm) ylxbm,
              decode(substr(xmid,11,1),'1',(sum(nvl(jhyilc,0))),(sum(nvl(yilc,0)))) yilc,decode(substr(xmid,11,1),'1',(sum(nvl(jherlc,0))),(sum(nvl(erlc,0)))) erlc,
             decode(substr(xmid,11,1),'1',(sum(nvl(jhsanlc,0))),(sum(nvl(sanlc,0)))) sanlc,decode(substr(xmid,11,1),'1',(sum(nvl(jhsilc,0))),(sum(nvl(silc,0)))) silc
              from (select  xmid,
              (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0))
              else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0))
              end) jhlc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,yilc,erlc,sanlc,silc,dwlc,wllc,
               lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm  else '' end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj,
               WMSYS.WM_CONCAT(ghlxbm)over( PARTITION BY xmid ORDER BY id,ghlxbm) ghlxbm,
               WMSYS.WM_CONCAT(lxbm)over( PARTITION BY xmid ORDER BY id,lxbm) ylxbm,
               WMSYS.WM_CONCAT((case when qdzh like '.%' then 0||qdzh when qdzh like '%,.%' then replace(qdzh, ',.', ',0.') else qdzh end ))over( PARTITION BY xmid ORDER BY id,qdzh) qdzh,
               WMSYS.WM_CONCAT((case when zdzh like '.%' then 0||zdzh when zdzh like '%,.%' then replace(zdzh, ',.', ',0.') else zdzh end ))over( PARTITION BY xmid ORDER BY id,zdzh) zdzh,
               WMSYS.WM_CONCAT((case when ghqdzh like '.%' then 0||ghqdzh when ghqdzh like '%,.%' then replace(ghqdzh, ',.', ',0.') else ghqdzh end ))over( PARTITION BY xmid ORDER BY id,ghqdzh) ghqdzh,
               WMSYS.WM_CONCAT((case when ghzdzh like '.%' then 0||ghzdzh when ghzdzh like '%,.%' then replace(ghzdzh, ',.', ',0.') else ghzdzh end ))over( PARTITION BY xmid ORDER BY id,ghzdzh) ghzdzh
              from LXSH_LX  where jdbs='2') group by xmid) l on j.xmbm=l.xmid 
   where 1=1 and j.jhxdwh  like '%'
      <if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="lxmc !=null and lxmc !=''">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghxlxbm != null and ghxlxbm != ''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
		</if>
		<if test="ghxlxmc != '' and ghxlxmc != null ">
			and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%'))
		</if>
		<if test="xmnf !=null and xmnf !=''">
			and fun_scxdnf(j.xmbm) in (${xmnf})
		</if>
		<if test="tsdq !=null and tsdq !=''">
			${tsdq}
		</if>
		<if test="xzdj !=null and xzdj !=''">
			and ${xzdj}
		</if>
		<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
		<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
		<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
		<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
		<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
		<if test="xdzttj !=null and xdzttj !=''">
			${xdzttj}
		</if>
		<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
		
   union all 
   
  select 
   to_char(rownum) v_0, to_char(j.ds) v_1,to_char(j.xzqh) v_2, j.xmmc v_3,
  decode(instr(RemoveSameStr(l.ghlxbm,','),','),0,RemoveSameStr(l.ghlxbm,','),l.ghlxbm) v_4,
  l.ghqdzh v_5,l.ghzdzh v_6,
  decode(instr(RemoveSameStr(l.ylxbm,','),','),0,RemoveSameStr(l.ylxbm,','),l.ylxbm) v_7,
  l.qdzh v_8,l.zdzh v_9,
  j.jsxz v_10, to_char(l.zjhlc ,'fm9999999990.000') v_11,to_char(l.yilc ,'fm9999999990.000') v_12,
  to_char(l.erlc ,'fm9999999990.000') v_13,to_char(l.sanlc,'fm9999999990.000') v_14,
  to_char(l.silc,'fm9999999990.000') v_15,nvl('',0) v_16,nvl('',0) v_17,c.jsfa v_18,
  substr(c.kgsj,0,4) v_19,substr(c.wgsj,0,4) v_20,nvl(j.pfztz,0) v_21,
  decode(xd.stz,0,j.pfztz,xd.btz+xd.stz+xd.dfzc) v_22,nvl(xd.btz,0) v_23,
  nvl(xd.stz,0) v_24,decode(xd.stz,0,(j.pfztz-xd.btz),xd.dfzc) v_25,xd.zyjsnr v_26,c.sjpfwh v_27,j.jhxdwh v_28,j.xmbm v_29,sbnf.scxdnf v_30,j.tsdqzcg v_31
  from   Jhxdsh   j
  left join (select xmid,min(xdnf) scxdnf from plan_zjxd group by xmid) sbnf on j.XMBM = sbnf.xmid 
  left join cbsj_sh c
  on j.xmbm=c.xmbm
  left join xmsq_sh x
  on j.xmbm=x.xmbm
   left join
  (select j.xmid,nvl(sum(j.btzzj)+nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                           nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                           nvl(sum(j.zq), 0)+sum(j.dfzc) ,0) ztz,nvl(sum(j.btzzj),0) btz,nvl(sum(j.dk),0) stz,nvl(sum(j.dfzc),0) dfzc
   ,nvl(sum(j.yhdk),0) yhdk,nvl(sum(gz)+sum(sz)+sum(zq),0) dftz,
   replace(WMSYS.WM_CONCAT(j.zyjsnr),',',',') zyjsnr
  from plan_zjxd j where 1=1
   <if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if> 
  group by j.xmid) xd on j.xmbm=xd.xmid
  left join (
 select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
              replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
              replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
              replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,
             replace(max(qdzh), ',.', ',0.') qdzh,replace(max(zdzh), ',.', ',0.') zdzh,replace(max(ghqdzh), ',.', ',0.') ghqdzh,replace(max(ghzdzh), ',.', ',0.') ghzdzh
             ,max(ghlxbm) ghlxbm,max(ylxbm) ylxbm,
              decode(substr(xmid,11,1),'1',(sum(nvl(jhyilc,0))),(sum(nvl(yilc,0)))) yilc,decode(substr(xmid,11,1),'1',(sum(nvl(jherlc,0))),(sum(nvl(erlc,0)))) erlc,
             decode(substr(xmid,11,1),'1',(sum(nvl(jhsanlc,0))),(sum(nvl(sanlc,0)))) sanlc,decode(substr(xmid,11,1),'1',(sum(nvl(jhsilc,0))),(sum(nvl(silc,0)))) silc
              from (select  xmid,
              (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0))
              else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0))
              end) jhlc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,yilc,erlc,sanlc,silc,dwlc,wllc,
               lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm  else '' end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj,
               WMSYS.WM_CONCAT(ghlxbm)over( PARTITION BY xmid ORDER BY id,ghlxbm) ghlxbm,
               WMSYS.WM_CONCAT(lxbm)over( PARTITION BY xmid ORDER BY id,lxbm) ylxbm,
               WMSYS.WM_CONCAT((case when qdzh like '.%' then 0||qdzh when qdzh like '%,.%' then replace(qdzh, ',.', ',0.') else qdzh end ))over( PARTITION BY xmid ORDER BY id,qdzh) qdzh,
               WMSYS.WM_CONCAT((case when zdzh like '.%' then 0||zdzh when zdzh like '%,.%' then replace(zdzh, ',.', ',0.') else zdzh end ))over( PARTITION BY xmid ORDER BY id,zdzh) zdzh,
               WMSYS.WM_CONCAT((case when ghqdzh like '.%' then 0||ghqdzh when ghqdzh like '%,.%' then replace(ghqdzh, ',.', ',0.') else ghqdzh end ))over( PARTITION BY xmid ORDER BY id,ghqdzh) ghqdzh,
               WMSYS.WM_CONCAT((case when ghzdzh like '.%' then 0||ghzdzh when ghzdzh like '%,.%' then replace(ghzdzh, ',.', ',0.') else ghzdzh end ))over( PARTITION BY xmid ORDER BY id,ghzdzh) ghzdzh
              from LXSH_LX  where jdbs='2') group by xmid) l on j.xmbm=l.xmid 
   where 1=1 and j.jhxdwh  like '%'
        <if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="lxmc !=null and lxmc !=''">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghxlxbm != null and ghxlxbm != ''">
			and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
		</if>
		<if test="ghxlxmc != '' and ghxlxmc != null ">
			and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%'))
		</if>
		<if test="xmnf !=null and xmnf !=''">
			and fun_scxdnf(j.xmbm) in (${xmnf})
		</if>
		<if test="tsdq !=null and tsdq !=''">
			${tsdq}
		</if>
		<if test="xzdj !=null and xzdj !=''">
			and ${xzdj}
		</if>
		<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
		<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
		<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
		<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
		<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
		<if test="xdzttj !=null and xdzttj !=''">
			${xdzttj}
		</if>
		<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
</select>

	<select id="queryZhhf_dcexcel" parameterType="jhsh" resultType="elist">
	select 
		null v_0,null v_1,'全省汇总' v_2,count(*)||'' v_3,sum(v_4) v_4,sum(v_5) v_5,
		sum(v_6) v_6,sum(v_7) v_7,null v_8,null v_9,
		null v_10,sum(v_11)||'' v_11,sum(v_12)||'' v_12,sum(v_13) v_13,
		sum(v_14) v_14,sum(v_15) v_15,null v_16,null v_17,null v_50
	from(
	
	select 
	rownum v_0, j.xzqh v_1, j.xmmc v_2,l.jsxz v_3,
	l.zlc v_4,
	l.yilc v_5,l.erlc v_6,l.sanlc v_7,x.jsfa v_8,
	j.jhkgsj v_9,
	j.jhwgsj v_10,j.pfztz v_11,j.bbzzj v_12,xd.ztz v_13,xd.btz v_14,
	xd.dftz v_15,'' v_16,c.sjpfwh v_17
	from 	Jhxdsh   j
	left join cbsj_sh c
	on j.xmbm=c.xmbm
	left join xmsq_sh x
	on j.xmbm=x.xmbm
	 left join
	(select p.xmid,sum(p.ztz) ztz,sum(p.btzzj) btz,sum(p.dfzc) dfzc,sum(p.yhdk) yhdk,sum(gz)+sum(sz)+sum(zq) dftz 
	from plan_zjxd p where p.xdnf=#{xmnf} group by p.xmid) xd on j.xmbm=xd.xmid
	left join (
	select xmid,decode(substr(xmid,11,1),'1',(sum(nvl(jhyilc,0))+sum(nvl(jherlc,0))+sum(nvl(jhsanlc,0))+sum(nvl(jhsilc,0))+sum(nvl(jhdwlc,0))+sum(nvl(jhwllc,0))),(sum(nvl(yilc,0))+sum(nvl(erlc,0))+sum(nvl(sanlc,0))+sum(nvl(silc,0))+sum(nvl(dwlc,0))+sum(nvl(wllc,0)))) zlc, 
	decode(substr(xmid,11,1),'1',(sum(nvl(jhyilc,0))),(sum(nvl(yilc,0)))) yilc,decode(substr(xmid,11,1),'1',(sum(nvl(jherlc,0))),(sum(nvl(erlc,0)))) erlc,
	(sum(nvl(jhsanlc,0))),(sum(nvl(sanlc,0))) sanlc,(sum(nvl(jhsilc,0))),(sum(nvl(silc,0))) silc,min(jsxz) jsxz,min(xzqhdm) xzqhdm,min(gydw) gydw
	 from lxsh_lx where jdbs='2' group by xmid) l on j.xmbm=l.xmid left join xmsq_sh lxg on j.xmbm=lxg.xmbm
	 where 1=1
	 	<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		

		<if test="lxmc !=null and lxmc !=''">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>

		<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
		<if test="ghxlxmc != '' and ghxlxmc != null ">
			and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
			
			)
		</if>
		<if test="xmnf !=null and xmnf !=''">
			and fun_scxdnf(j.xmbm) in (${xmnf})
		</if>
		
		<if test="tsdq !=null and tsdq !=''">
			${tsdq}
		</if>
		<if test="xzdj !=null and xzdj !=''">
			and ${xzdj}
		</if>
		<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
		<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
		<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
		<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
		<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
		<if test="xdzttj !=null and xdzttj !=''">
			${xdzttj}
		</if>
	)
	union all
	
		select 
		'' v_0, j.xzqh v_1, j.xmmc v_2,l.jsxz v_3,
		to_number(l.zlc) v_4,
		to_number(l.yilc) v_5,to_number(l.erlc) v_6,to_number(l.sanlc) v_7,x.jsfa v_8,
		j.jhkgsj v_9,
		j.jhwgsj v_10,decode(l.sffirst,'1',j.pfztz,'') v_11,decode(l.sffirst,'1',j.bbzzj,'') v_12,decode(l.sffirst,'1',xd.ztz,'') v_13,decode(l.sffirst,'1',xd.btz,'') v_14,
		decode(l.sffirst,'1',xd.dftz,'') v_15,'' v_16,c.sjpfwh v_17,l.sffirst v_50
		from 	Jhxdsh   j
		left join cbsj_sh c
		on j.xmbm=c.xmbm
		left join xmsq_sh x
		on j.xmbm=x.xmbm
		 left join
		(select p.xmid,sum(p.ztz) ztz,sum(p.btzzj) btz,sum(p.dfzc) dfzc,sum(p.yhdk) yhdk,sum(gz)+sum(sz)+sum(zq) dftz 
		from plan_zjxd p where p.xdnf=#{xmnf} group by p.xmid) xd on j.xmbm=xd.xmid
		left join (
		select xmid,decode(substr(xmid, 11, 1),
                         '1',
                         (nvl(jhyilc, 0) + nvl(jherlc, 0) +
                         nvl(jhsanlc, 0) + nvl(jhsilc, 0) +
                         nvl(jhdwlc, 0) + nvl(jhwllc, 0)),
                         (nvl(yilc, 0) + nvl(erlc, 0) +
                         nvl(sanlc, 0) + nvl(silc, 0) +
                         nvl(dwlc, 0) + nvl(wllc, 0))) zlc,
                  decode(substr(xmid, 11, 1),
                         '1',
                         (nvl(jhyilc, 0)),
                         (nvl(yilc, 0))) yilc,
                  decode(substr(xmid, 11, 1),
                         '1',
                         (nvl(jherlc, 0)),
                         (nvl(erlc, 0))) erlc,
                  (nvl(jhsanlc, 0)),
                  (nvl(sanlc, 0)) sanlc,
                  (nvl(jhsilc, 0)),
                  (nvl(silc, 0)) silc,
                  jsxz jsxz,
                  xzqhdm xzqhdm,
                  gydw gydw,
                  lxbm lxbm,
                  ghlxmc lxmc,
                  jsjsdj jsjsdj,
                  sffirst,
                  ghlxbm,
                  ghqdzh,
                  ghzdzh,
                  lxlmkd,
                  jsfa
             from lxsh_lx
            where jdbs = '2' order by xmid,sffirst desc) l on j.xmbm=l.xmid  left join xmsq_sh lxg on j.xmbm=lxg.xmbm
		 where 1=1
		 <if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		
		<if test="lxmc !=null and lxmc !=''">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
	
		<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
		<if test="ghxlxmc != '' and ghxlxmc != null ">
			and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
			
			)
		</if>
		<if test="xmnf !=null and xmnf !=''">
			and fun_scxdnf(j.xmbm) in (${xmnf})
		</if>
		
		<if test="tsdq !=null and tsdq !=''">
			${tsdq}
		</if>
		<if test="xzdj !=null and xzdj !=''">
			and ${xzdj}
		</if>
		<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
		<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
		<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
		<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
		<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
		<if test="xdzttj !=null and xdzttj !=''">
			${xdzttj}
		</if>
	</select>
<!-- 下面是导出养护大中修汇总的sql -->
	<select id="queryYhdzx_dcexcel" parameterType="jhsh" resultType="elist">
	select 
	'全省汇总' v_1,sum(cj)+sum(gz)+sum(yfx) v_2,sum(cj) v_3,sum(gz) v_4,sum(yfx) v_5,
	sum(gdcj)+sum(gdgz)+sum(gdyfx) v_6,sum(gdcj) v_7,sum(gdgz) v_8,sum(gdyfx) v_9,
	sum(sdcj)+sum(sdgz)+sum(sdyfx) v_10,sum(sdcj) v_11,sum(sdgz) v_12,sum(sdyfx) v_13,
	sum(cjtz)+sum(gztz)+sum(yfxtz) v_14,sum(cjtz) v_15,sum(gztz) v_16,sum(yfxtz) v_17,
	sum(gdcjtz)+sum(gdgztz)+sum(gdyfxtz) v_18,sum(gdcjtz) v_19,sum(gdgztz) v_20,sum(gdyfxtz) v_21,
	sum(sdcjtz)+sum(sdgztz)+sum(sdyfxtz) v_22,sum(sdcjtz) v_23,sum(sdgztz) v_24,sum(sdyfxtz) v_25,'36' xzqh
	from(
	select 
	(case when l.jsxz = '大修' or l.jsxz = '重修' or l.jsxz = '重建' then l.zlc else 0 end) cj,
	(case when l.jsxz = '中修' or l.jsxz = '改造' then l.zlc else 0 end) gz,
	(case when l.jsxz like '%预防性%' then l.zlc else 0 end) yfx,
	decode(substr(lxbm,0,1),'G',(case when l.jsxz = '大修' or l.jsxz = '重修' or l.jsxz = '重建' then l.zlc else 0 end),0) gdcj,
	decode(substr(lxbm,0,1),'G',(case when l.jsxz = '中修' or l.jsxz = '改造' then l.zlc else 0 end),0) gdgz,
	decode(substr(lxbm,0,1),'G',(case when l.jsxz like '%预防性%' then l.zlc else 0 end),0) gdyfx,
	decode(substr(lxbm,0,1),'S',(case when l.jsxz = '大修' or l.jsxz = '重修' or l.jsxz = '重建' then l.zlc else 0 end),0) sdcj,
	decode(substr(lxbm,0,1),'S',(case when l.jsxz = '中修' or l.jsxz = '改造' then l.zlc else 0 end),0) sdgz,
	decode(substr(lxbm,0,1),'S',(case when l.jsxz like '%预防性%' then l.zlc else 0 end),0) sdyfx,
	(case when l.jsxz = '大修' or l.jsxz = '重修' or l.jsxz = '重建' then xd.ztz else 0 end) cjtz,
	(case when l.jsxz = '中修' or l.jsxz = '改造' then xd.ztz else 0 end) gztz,
	(case when l.jsxz like '%预防性%' then xd.ztz else 0 end) yfxtz,
	decode(substr(lxbm,0,1),'G',(case when l.jsxz = '大修' or l.jsxz = '重修' or l.jsxz = '重建' then xd.ztz else 0 end),0) gdcjtz,
	decode(substr(lxbm,0,1),'G',(case when l.jsxz = '中修' or l.jsxz = '改造' then xd.ztz else 0 end),0) gdgztz,
	decode(substr(lxbm,0,1),'G',(case when l.jsxz like '%预防性%' then xd.ztz else 0 end),0) gdyfxtz,
	decode(substr(lxbm,0,1),'S',(case when l.jsxz = '大修' or l.jsxz = '重修' or l.jsxz = '重建' then xd.ztz else 0 end),0) sdcjtz,
	decode(substr(lxbm,0,1),'S',(case when l.jsxz = '中修' or l.jsxz = '改造' then xd.ztz else 0 end),0) sdgztz,
	decode(substr(lxbm,0,1),'S',(case when l.jsxz like '%预防性%' then xd.ztz else 0 end),0) sdyfxtz,l.xzqhdm xzqh
	from jhxdyh j
	left join ( select p.xmid,
       sum(p.ztz) ztz,
       sum(p.rys) rys,
       sum(p.dk) dk,
       sum(p.btzzj) btz,
       sum(p.dfzc) dfzc,
       sum(p.yhdk) yhdk,
       sum(gz) + sum(sz) + sum(zq) dftz
  	from plan_zjxd p
 	where p.xdnf = #{xmnf}
 	group by p.xmid )  xd  on  j.xmbm=xd.xmid
	left  join(
           select xmid,decode(substr(xmid, 11, 1),
                         '1',
                         (sum(nvl(jhyilc, 0)) + sum(nvl(jherlc, 0)) +
                         sum(nvl(jhsanlc, 0)) + sum(nvl(jhsilc, 0)) +
                         sum(nvl(jhdwlc, 0)) + sum(nvl(jhwllc, 0))),
                         (sum(nvl(yilc, 0)) + sum(nvl(erlc, 0)) +
                         sum(nvl(sanlc, 0)) + sum(nvl(silc, 0)) +
                         sum(nvl(dwlc, 0)) + sum(nvl(wllc, 0)))) zlc,
                  decode(substr(xmid, 11, 1),
                         '1',
                         (sum(nvl(jhyilc, 0))),
                         (sum(nvl(yilc, 0)))) yilc,
                  decode(substr(xmid, 11, 1),
                         '1',
                         (sum(nvl(jherlc, 0))),
                         (sum(nvl(erlc, 0)))) erlc,
                  (sum(nvl(jhsanlc, 0))),
                  (sum(nvl(sanlc, 0))) sanlc,
                  (sum(nvl(jhsilc, 0))),
                  (sum(nvl(silc, 0))) silc,
                  min(jsxz) jsxz,
                  substr(min(xzqhdm),0,4) xzqhdm,
                  min(gydw) gydw,
                  min(lxbm) lxbm
             from lxsh_lx
            where jdbs = '2'
            group by xmid)  l
            on j.XMBM=l.xmid
   where 1=1
   <if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>

				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(j.xmbm,0,4) in (${xmnf})
				</if>
				<if test="scxdnf !=null and scxdnf !=''">
					and scxdnf in (${scxdnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdsj !=null and xdsj !=''">
					and to_date(j.xdsj,'yyyy-mm-dd')&lt;=to_date(#{xdsj},'yyyy-mm-dd')
				</if>
   
) t 
	union all
	
	select to_char((select name from xtgl_xzqh where id = xzqh||'00')) v_1,sum(cj)+sum(gz)+sum(yfx) v_2,sum(cj) v_3,sum(gz) v_4,sum(yfx) v_5,
	sum(gdcj)+sum(gdgz)+sum(gdyfx) v_6,sum(gdcj) v_7,sum(gdgz) v_8,sum(gdyfx) v_9,
	sum(sdcj)+sum(sdgz)+sum(sdyfx) v_10,sum(sdcj) v_11,sum(sdgz) v_12,sum(sdyfx) v_13,
	sum(cjtz)+sum(gztz)+sum(yfxtz) v_14,sum(cjtz) v_15,sum(gztz) v_16,sum(yfxtz) v_17,
	sum(gdcjtz)+sum(gdgztz)+sum(gdyfxtz) v_18,sum(gdcjtz) v_19,sum(gdgztz) v_20,sum(gdyfxtz) v_21,
	sum(sdcjtz)+sum(sdgztz)+sum(sdyfxtz) v_22,sum(sdcjtz) v_23,sum(sdgztz) v_24,sum(sdyfxtz) v_25,xzqh
	from(
	select 
	(case when l.jsxz = '大修' or l.jsxz = '重修' or l.jsxz = '重建' then l.zlc else 0 end) cj,
	(case when l.jsxz = '中修' or l.jsxz = '改造' then l.zlc else 0 end) gz,
	(case when l.jsxz like '%预防性%' then l.zlc else 0 end) yfx,
	decode(substr(lxbm,0,1),'G',(case when l.jsxz = '大修' or l.jsxz = '重修' or l.jsxz = '重建' then l.zlc else 0 end),0) gdcj,
	decode(substr(lxbm,0,1),'G',(case when l.jsxz = '中修' or l.jsxz = '改造' then l.zlc else 0 end),0) gdgz,
	decode(substr(lxbm,0,1),'G',(case when l.jsxz like '%预防性%' then l.zlc else 0 end),0) gdyfx,
	decode(substr(lxbm,0,1),'S',(case when l.jsxz = '大修' or l.jsxz = '重修' or l.jsxz = '重建' then l.zlc else 0 end),0) sdcj,
	decode(substr(lxbm,0,1),'S',(case when l.jsxz = '中修' or l.jsxz = '改造' then l.zlc else 0 end),0) sdgz,
	decode(substr(lxbm,0,1),'S',(case when l.jsxz like '%预防性%' then l.zlc else 0 end),0) sdyfx,
	(case when l.jsxz = '大修' or l.jsxz = '重修' or l.jsxz = '重建' then xd.ztz else 0 end) cjtz,
	(case when l.jsxz = '中修' or l.jsxz = '改造' then xd.ztz else 0 end) gztz,
	(case when l.jsxz like '%预防性%' then xd.ztz else 0 end) yfxtz,
	decode(substr(lxbm,0,1),'G',(case when l.jsxz = '大修' or l.jsxz = '重修' or l.jsxz = '重建' then xd.ztz else 0 end),0) gdcjtz,
	decode(substr(lxbm,0,1),'G',(case when l.jsxz = '中修' or l.jsxz = '改造' then xd.ztz else 0 end),0) gdgztz,
	decode(substr(lxbm,0,1),'G',(case when l.jsxz like '%预防性%' then xd.ztz else 0 end),0) gdyfxtz,
	decode(substr(lxbm,0,1),'S',(case when l.jsxz = '大修' or l.jsxz = '重修' or l.jsxz = '重建' then xd.ztz else 0 end),0) sdcjtz,
	decode(substr(lxbm,0,1),'S',(case when l.jsxz = '中修' or l.jsxz = '改造' then xd.ztz else 0 end),0) sdgztz,
	decode(substr(lxbm,0,1),'S',(case when l.jsxz like '%预防性%' then xd.ztz else 0 end),0) sdyfxtz,l.xzqhdm xzqh
	from jhxdyh j
	left join ( select p.xmid,
       sum(p.ztz) ztz,
       sum(p.rys) rys,
       sum(p.dk) dk,
       sum(p.btzzj) btz,
       sum(p.dfzc) dfzc,
       sum(p.yhdk) yhdk,
       sum(gz) + sum(sz) + sum(zq) dftz
  	from plan_zjxd p
 	where p.xdnf = #{xmnf}
 	group by p.xmid )  xd  on  j.xmbm=xd.xmid
	left  join(
           select xmid,decode(substr(xmid, 11, 1),
                         '1',
                         (sum(nvl(jhyilc, 0)) + sum(nvl(jherlc, 0)) +
                         sum(nvl(jhsanlc, 0)) + sum(nvl(jhsilc, 0)) +
                         sum(nvl(jhdwlc, 0)) + sum(nvl(jhwllc, 0))),
                         (sum(nvl(yilc, 0)) + sum(nvl(erlc, 0)) +
                         sum(nvl(sanlc, 0)) + sum(nvl(silc, 0)) +
                         sum(nvl(dwlc, 0)) + sum(nvl(wllc, 0)))) zlc,
                  decode(substr(xmid, 11, 1),
                         '1',
                         (sum(nvl(jhyilc, 0))),
                         (sum(nvl(yilc, 0)))) yilc,
                  decode(substr(xmid, 11, 1),
                         '1',
                         (sum(nvl(jherlc, 0))),
                         (sum(nvl(erlc, 0)))) erlc,
                  (sum(nvl(jhsanlc, 0))),
                  (sum(nvl(sanlc, 0))) sanlc,
                  (sum(nvl(jhsilc, 0))),
                  (sum(nvl(silc, 0))) silc,
                  min(jsxz) jsxz,
                  substr(min(xzqhdm),0,4) xzqhdm,
                  min(gydw) gydw,
                  min(lxbm) lxbm
             from lxsh_lx
            where jdbs = '2'
            group by xmid)  l
            on j.XMBM=l.xmid
   where 1=1
  <if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>

				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(j.xmbm,0,4) in (${xmnf})
				</if>
				<if test="scxdnf !=null and scxdnf !=''">
					and scxdnf in (${scxdnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdsj !=null and xdsj !=''">
					and to_date(j.xdsj,'yyyy-mm-dd')&lt;=to_date(#{xdsj},'yyyy-mm-dd')
				</if>
   
) t group by t.xzqh order by xzqh



	</select>
	<!-- 下面是导出养护大中修明细的sql -->
	<select id="queryYhdzxDetail_dcexcel" parameterType="jhsh" resultType="elist">
	select j.YLXBH v_1,j.GHLXBH v_2,l.lxmc v_3,j.QDZH v_4,j.ZDZH v_5,l.zlc v_6,l.jsjsdj v_7,x.lmkd v_8,l.jsxz v_9,c.jsfa v_10,
j.ZTZ v_11,j.RYS+j.DK v_12,null v_13,xd.ztz v_14,null v_15,xd.rys v_16,xd.dk v_17,c.sjpfwh v_18,x.gydw v_19,x.bz v_20

from jhxdyh j left join xmsq_yhdzx x on j.xmbm=x.xmbm left join cbsj_yhdzx c on j.xmbm=c.xmbm
	left join ( select p.xmid,
       sum(p.ztz) ztz,
       sum(p.rys) rys,
       sum(p.dk) dk,
       sum(p.btzzj) btz,
       sum(p.dfzc) dfzc,
       sum(p.yhdk) yhdk,
       sum(gz) + sum(sz) + sum(zq) dftz
  	from plan_zjxd p
 	where p.xdnf = #{xmnf}
 	group by p.xmid )  xd  on  j.xmbm=xd.xmid
	left  join(
           select xmid,decode(substr(xmid, 11, 1),
                         '1',
                         (sum(nvl(jhyilc, 0)) + sum(nvl(jherlc, 0)) +
                         sum(nvl(jhsanlc, 0)) + sum(nvl(jhsilc, 0)) +
                         sum(nvl(jhdwlc, 0)) + sum(nvl(jhwllc, 0))),
                         (sum(nvl(yilc, 0)) + sum(nvl(erlc, 0)) +
                         sum(nvl(sanlc, 0)) + sum(nvl(silc, 0)) +
                         sum(nvl(dwlc, 0)) + sum(nvl(wllc, 0)))) zlc,
                  decode(substr(xmid, 11, 1),
                         '1',
                         (sum(nvl(jhyilc, 0))),
                         (sum(nvl(yilc, 0)))) yilc,
                  decode(substr(xmid, 11, 1),
                         '1',
                         (sum(nvl(jherlc, 0))),
                         (sum(nvl(erlc, 0)))) erlc,
                  (sum(nvl(jhsanlc, 0))),
                  (sum(nvl(sanlc, 0))) sanlc,
                  (sum(nvl(jhsilc, 0))),
                  (sum(nvl(silc, 0))) silc,
                  min(jsxz) jsxz,
                  min(xzqhdm) xzqhdm,
                  min(gydw) gydw,
                  min(lxbm) lxbm,
                  min(lxmc) lxmc,
                  min(jsjsdj) jsjsdj
             from lxsh_lx
            where jdbs = '2'
            group by xmid)  l
            on j.XMBM=l.xmid
   where 1=1
   			<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				

				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>

				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and substr(j.xmbm,0,4) in (${xmnf})
				</if>
				<if test="scxdnf !=null and scxdnf !=''">
					and scxdnf in (${scxdnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="xdzt>=0">and j.xdzt=${xdzt}</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdsj !=null and xdsj !=''">
					and to_date(j.xdsj,'yyyy-mm-dd')&lt;=to_date(#{xdsj},'yyyy-mm-dd')
				</if>
   order by c.xzqhdm
	</select>
	
	
	<!--  -->
	<!-- 下面是导出计划查询养护大中修汇总的sql -->
	<select id="queryYhdzx_dcexcel1" parameterType="jhsh" resultType="elist">
	select 
	'全省汇总' v_1,sum(cj)+sum(gz)+sum(yfx) v_2,sum(cj) v_3,sum(gz) v_4,sum(yfx) v_5,
	sum(gdcj)+sum(gdgz)+sum(gdyfx) v_6,sum(gdcj) v_7,sum(gdgz) v_8,sum(gdyfx) v_9,
	sum(sdcj)+sum(sdgz)+sum(sdyfx) v_10,sum(sdcj) v_11,sum(sdgz) v_12,sum(sdyfx) v_13,
	sum(cjtz)+sum(gztz)+sum(yfxtz) v_14,sum(cjtz) v_15,sum(gztz) v_16,sum(yfxtz) v_17,
	sum(gdcjtz)+sum(gdgztz)+sum(gdyfxtz) v_18,sum(gdcjtz) v_19,sum(gdgztz) v_20,sum(gdyfxtz) v_21,
	sum(sdcjtz)+sum(sdgztz)+sum(sdyfxtz) v_22,sum(sdcjtz) v_23,sum(sdgztz) v_24,sum(sdyfxtz) v_25,'36' xzqh
	from(
	select 
	(case when j.jsxz = '大修' then l.zlc else 0 end) cj,
	(case when j.jsxz = '中修' then l.zlc else 0 end) gz,
	(case when j.jsxz ='预防性' then l.zlc else 0 end) yfx,
	decode(substr(lxbm,0,1),'G',(case when j.jsxz = '大修'  then l.zlc else 0 end),0) gdcj,
	decode(substr(lxbm,0,1),'G',(case when j.jsxz = '中修'  then l.zlc else 0 end),0) gdgz,
	decode(substr(lxbm,0,1),'G',(case when j.jsxz = '预防性' then l.zlc else 0 end),0) gdyfx,
	decode(substr(lxbm,0,1),'S',(case when j.jsxz = '大修'  then l.zlc else 0 end),0) sdcj,
  decode(substr(lxbm,0,1),'S',(case when j.jsxz = '中修'  then l.zlc else 0 end),0) sdgz,
  decode(substr(lxbm,0,1),'S',(case when j.jsxz = '预防性' then l.zlc else 0 end),0) sdyfx,
  (case when j.jsxz = '大修'  then to_number(xd.ztz) else 0 end) cjtz,
  (case when j.jsxz = '中修'  then to_number(xd.ztz) else 0 end) gztz,
  (case when j.jsxz = '预防性' then to_number(xd.ztz) else 0 end) yfxtz,
  decode(substr(lxbm,0,1),'G',(case when j.jsxz = '大修'  then to_number(xd.ztz) else 0 end),0) gdcjtz,
  decode(substr(lxbm,0,1),'G',(case when j.jsxz = '中修'  then to_number(xd.ztz) else 0 end),0) gdgztz,
  decode(substr(lxbm,0,1),'G',(case when j.jsxz = '预防性' then to_number(xd.ztz) else 0 end),0) gdyfxtz,
  decode(substr(lxbm,0,1),'S',(case when j.jsxz = '大修'  then to_number(xd.ztz) else 0 end),0) sdcjtz,
  decode(substr(lxbm,0,1),'S',(case when j.jsxz = '中修'  then to_number(xd.ztz) else 0 end),0) sdgztz,
  decode(substr(lxbm,0,1),'S',(case when j.jsxz = '预防性' then to_number(xd.ztz) else 0 end),0) sdyfxtz,l.xzqhdm xzqh
  from jhxdyh j
   left join ( select j.xmid,
       nvl(sum(j.btzzj),0)+nvl(sum(j.rys),0)+nvl(sum(j.dk),0)+nvl(sum(j.jl),0) ztz
    from plan_zjxd j
   where 1=1 <if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if> 
   group by j.xmid )  xd  on  j.xmbm=xd.xmid
  left  join(
           select xmid,decode(substr(xmid, 11, 1),
                         '1',
                         (sum(nvl(jhyilc, 0)) + sum(nvl(jherlc, 0)) +
                         sum(nvl(jhsanlc, 0)) + sum(nvl(jhsilc, 0)) +
                         sum(nvl(jhdwlc, 0)) + sum(nvl(jhwllc, 0))),
                         (sum(nvl(yilc, 0)) + sum(nvl(erlc, 0)) +
                         sum(nvl(sanlc, 0)) + sum(nvl(silc, 0)) +
                         sum(nvl(dwlc, 0)) + sum(nvl(wllc, 0)))) zlc,
                  decode(substr(xmid, 11, 1),
                         '1',
                         (sum(nvl(jhyilc, 0))),
                         (sum(nvl(yilc, 0)))) yilc,
                  decode(substr(xmid, 11, 1),
                         '1',
                         (sum(nvl(jherlc, 0))),
                         (sum(nvl(erlc, 0)))) erlc,
                  (sum(nvl(jhsanlc, 0))),
                  (sum(nvl(sanlc, 0))) sanlc,
                  (sum(nvl(jhsilc, 0))),
                  (sum(nvl(silc, 0))) silc,
                  min(jsxz) jsxz,
                  substr(min(xzqhdm),0,4) xzqhdm,
                  min(gydw) gydw,
                  min(ghlxbm) lxbm
             from lxsh_lx
            where jdbs = '2'
            group by xmid)  l
            on j.XMBM=l.xmid left join xmsq_yhdzx lxg on j.xmbm=lxg.xmbm
   where 1=1 and j.jhxdwh  like '%'
   <if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%'))
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and fun_scxdnf(j.xmbm) in (${xmnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
   
 ) t 
  union all
  
  select to_char((select name from xtgl_xzqh where id = xzqh||'00')) v_1,sum(cj)+sum(gz)+sum(yfx) v_2,sum(cj) v_3,sum(gz) v_4,sum(yfx) v_5,
	sum(gdcj)+sum(gdgz)+sum(gdyfx) v_6,sum(gdcj) v_7,sum(gdgz) v_8,sum(gdyfx) v_9,
	sum(sdcj)+sum(sdgz)+sum(sdyfx) v_10,sum(sdcj) v_11,sum(sdgz) v_12,sum(sdyfx) v_13,
	sum(cjtz)+sum(gztz)+sum(yfxtz) v_14,sum(cjtz) v_15,sum(gztz) v_16,sum(yfxtz) v_17,
	sum(gdcjtz)+sum(gdgztz)+sum(gdyfxtz) v_18,sum(gdcjtz) v_19,sum(gdgztz) v_20,sum(gdyfxtz) v_21,
	sum(sdcjtz)+sum(sdgztz)+sum(sdyfxtz) v_22,sum(sdcjtz) v_23,sum(sdgztz) v_24,sum(sdyfxtz) v_25,xzqh
	from(
	select 
	(case when j.jsxz = '大修'  then l.zlc else 0 end) cj,
	(case when j.jsxz = '中修'  then l.zlc else 0 end) gz,
	(case when j.jsxz = '预防性' then l.zlc else 0 end) yfx,
	decode(substr(lxbm,0,1),'G',(case when j.jsxz = '大修'  then l.zlc else 0 end),0) gdcj,
	decode(substr(lxbm,0,1),'G',(case when j.jsxz = '中修'  then l.zlc else 0 end),0) gdgz,
	decode(substr(lxbm,0,1),'G',(case when j.jsxz = '预防性' then l.zlc else 0 end),0) gdyfx,
	decode(substr(lxbm,0,1),'S',(case when j.jsxz = '大修'  then l.zlc else 0 end),0) sdcj,
	decode(substr(lxbm,0,1),'S',(case when j.jsxz = '中修'  then l.zlc else 0 end),0) sdgz,
	decode(substr(lxbm,0,1),'S',(case when j.jsxz = '预防性' then l.zlc else 0 end),0) sdyfx,
	(case when j.jsxz = '大修' then to_number(xd.ztz) else 0 end) cjtz,
	(case when j.jsxz = '中修' then to_number(xd.ztz) else 0 end) gztz,
	(case when j.jsxz = '预防性' then to_number(xd.ztz) else 0 end) yfxtz,
	decode(substr(lxbm,0,1),'G',(case when j.jsxz = '大修'  then to_number(xd.ztz) else 0 end),0) gdcjtz,
	decode(substr(lxbm,0,1),'G',(case when j.jsxz = '中修'  then to_number(xd.ztz) else 0 end),0) gdgztz,
	decode(substr(lxbm,0,1),'G',(case when j.jsxz = '预防性' then to_number(xd.ztz) else 0 end),0) gdyfxtz,
	decode(substr(lxbm,0,1),'S',(case when j.jsxz = '大修'  then to_number(xd.ztz) else 0 end),0) sdcjtz,
	decode(substr(lxbm,0,1),'S',(case when j.jsxz = '中修'  then to_number(xd.ztz) else 0 end),0) sdgztz,
	decode(substr(lxbm,0,1),'S',(case when j.jsxz = '预防性' then to_number(xd.ztz) else 0 end),0) sdyfxtz,l.xzqhdm xzqh
	from jhxdyh j
	 left join ( select j.xmid,
       nvl(sum(j.btzzj),0)+nvl(sum(j.rys),0)+nvl(sum(j.dk),0)+nvl(sum(j.jl),0) ztz
    from plan_zjxd j
   where 1=1 <if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if> 
   group by j.xmid )  xd  on  j.xmbm=xd.xmid
	left  join(
           select xmid,decode(substr(xmid, 11, 1),
                         '1',
                         (sum(nvl(jhyilc, 0)) + sum(nvl(jherlc, 0)) +
                         sum(nvl(jhsanlc, 0)) + sum(nvl(jhsilc, 0)) +
                         sum(nvl(jhdwlc, 0)) + sum(nvl(jhwllc, 0))),
                         (sum(nvl(yilc, 0)) + sum(nvl(erlc, 0)) +
                         sum(nvl(sanlc, 0)) + sum(nvl(silc, 0)) +
                         sum(nvl(dwlc, 0)) + sum(nvl(wllc, 0)))) zlc,
                  decode(substr(xmid, 11, 1),
                         '1',
                         (sum(nvl(jhyilc, 0))),
                         (sum(nvl(yilc, 0)))) yilc,
                  decode(substr(xmid, 11, 1),
                         '1',
                         (sum(nvl(jherlc, 0))),
                         (sum(nvl(erlc, 0)))) erlc,
                  (sum(nvl(jhsanlc, 0))),
                  (sum(nvl(sanlc, 0))) sanlc,
                  (sum(nvl(jhsilc, 0))),
                  (sum(nvl(silc, 0))) silc,
                  min(jsxz) jsxz,
                  substr(min(xzqhdm),0,4) xzqhdm,
                  min(gydw) gydw,
                  min(ghlxbm) lxbm
             from lxsh_lx
            where jdbs = '2'
            group by xmid)  l
            on j.XMBM=l.xmid  left join xmsq_yhdzx lxg on j.xmbm=lxg.xmbm
   where 1=1 and j.jhxdwh  like '%'
  <if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and fun_scxdnf(j.xmbm) in (${xmnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
   
) t group by t.xzqh order by xzqh



	</select>
	
	<select id="queryYhdzxDetail_dcexcel1" parameterType="jhsh" resultType="elist">
	select '' v_1,'' v_2,'' v_3,'合计' v_4, '' v_5,'' v_6,'' v_7,'' v_8,
       nvl(to_char(sum(lx2.zjhlc),'fm999990.09999'), 0) v_9,'' v_10, '' v_11,'' v_12,'' v_13,'' v_14,'' v_15,
      nvl(sum(j.ZTZ),0) v_16,nvl(sum(j.RYS),0) v_17,nvl(sum(j.DK),0) v_18,
      '' v_19,'' v_20,'' v_21,'' v_22,'' v_23,'' v_24,'' v_25,'' v_50
 from jhxdyh j left join xmsq_yhdzx x on j.xmbm=x.xmbm 
left join cbsj_yhdzx c on j.xmbm=c.xmbm 
            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
	            replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
	            replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
	            replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
	            from (select  xmid,jsxz,
	            (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
	            end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
	            else ''
	            end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
	            from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
   where 1=1 and j.jsxz in ('大修','中修','预防性') and j.jhxdwh  like '%'
   <if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%'))
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and fun_scxdnf(j.xmbm) in (${xmnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
   
   union all
   
   select '' v_1,'' v_2,'' v_3,'大修' v_4, '' v_5,'' v_6,'' v_7,'' v_8,
      nvl(to_char(sum(lx2.zjhlc),'fm999990.09999'), 0) v_9,'' v_10, '' v_11,'' v_12,'' v_13,'' v_14,'' v_15,
      nvl(sum(j.ZTZ),0) v_16,nvl(sum(j.RYS),0) v_17,nvl(sum(j.DK),0) v_18,
      '' v_19,'' v_20,'' v_21,'' v_22,'' v_23,'' v_24,'' v_25,'' v_50
 from jhxdyh j left join xmsq_yhdzx x on j.xmbm=x.xmbm 
left join cbsj_yhdzx c on j.xmbm=c.xmbm 
            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
              replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
              replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
              replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
              from (select  xmid,jsxz,
              (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
              
              else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
              end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
              else ''
              end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
              from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
   where 1=1 and j.jsxz in ('大修') and j.jhxdwh  like '%'
    <if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%'))
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and fun_scxdnf(j.xmbm) in (${xmnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
   union all
   
   select '' v_1,'' v_2,'' v_3,'中修' v_4, '' v_5,'' v_6,'' v_7,'' v_8,
      nvl(to_char(sum(lx2.zjhlc),'fm999990.09999'), 0) v_9,'' v_10, '' v_11,'' v_12,'' v_13,'' v_14,'' v_15,
      nvl(sum(j.ZTZ),0) v_16,nvl(sum(j.RYS),0) v_17,nvl(sum(j.DK),0) v_18,
      '' v_19,'' v_20,'' v_21,'' v_22,'' v_23,'' v_24,'' v_25,'' v_50
 from jhxdyh j left join xmsq_yhdzx x on j.xmbm=x.xmbm 
left join cbsj_yhdzx c on j.xmbm=c.xmbm 
            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
              replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
              replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
              replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
              from (select  xmid,jsxz,
              (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
              
              else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
              end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
              else ''
              end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
              from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
   where 1=1 and j.jsxz in ('中修') and j.jhxdwh  like '%'
    <if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%'))
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and fun_scxdnf(j.xmbm) in (${xmnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
   union all
   
select '' v_1,'' v_2,'' v_3,'预防性' v_4, '' v_5,'' v_6,'' v_7,'' v_8,
      nvl(to_char(sum(lx2.zjhlc),'fm999990.09999'), 0) v_9,'' v_10, '' v_11,'' v_12,'' v_13,'' v_14,'' v_15,
       nvl(sum(j.ZTZ),0) v_16,nvl(sum(j.RYS),0) v_17,nvl(sum(j.DK),0) v_18,
      '' v_19,'' v_20,'' v_21,'' v_22,'' v_23,'' v_24,'' v_25,'' v_50
 from jhxdyh j left join xmsq_yhdzx x on j.xmbm=x.xmbm 
left join cbsj_yhdzx c on j.xmbm=c.xmbm 
            left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
              replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
              replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
              replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
              from (select  xmid,jsxz,
              (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
              
              else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
              end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
              else ''
              end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
              from LXSH_LX  where jdbs='2' ) group by xmid) lx2 on j.xmbm=lx2.xmid
   where 1=1 and j.jsxz in ('预防性') and j.jhxdwh  like '%'
    <if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%'))
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and fun_scxdnf(j.xmbm) in (${xmnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
   
   union all
  select * from (
select 
to_char(max(j.ds)) v_1,
decode(instr(RemoveSameStr(max(lx2.ghlxbm),','),','),0,RemoveSameStr(max(lx2.ghlxbm),','),max(lx2.ghlxbm)) v_2,
decode(instr(RemoveSameStr(max(lx2.ylxbm),','),','),0,RemoveSameStr(max(lx2.ylxbm),','),max(lx2.ylxbm)) v_3,
max(c.xmmc) v_4,
max(lx2.qdzh) v_5,max(lx2.zdzh) v_6,max(lx2.ghqdzh)v_7,max(lx2.ghzdzh) v_8,
to_char(sum(l.zlc),'fm999990.09999') v_9,RemoveSameStr(replace(WMSYS.WM_CONCAT(distinct(l.xjsdj)),'、',','),',') v_10 ,
RemoveSameStr(decode(WMSYS.WM_CONCAT(distinct(l.lxlmkd)),null,max(x.lmkd),0,max(x.lmkd),WMSYS.WM_CONCAT(distinct(l.lxlmkd))),',') v_11,
WMSYS.WM_CONCAT(distinct(x.ylmlx)) v_12,WMSYS.WM_CONCAT(distinct(x.ylmjg)) v_13,max(j.jsxz) v_14,
max(c.jsfa) v_15,decode(max(j.ztz),null,0,max(j.ztz)) v_16,decode(max(j.rys),null,0,max(j.rys)) v_17,decode(max(j.dk),null,0,max(j.dk)) v_18,WMSYS.WM_CONCAT(distinct(c.sjpfwh)) v_19,WMSYS.WM_CONCAT(distinct(x.gydw)) v_20,
max(j.jhxdwh) v_21,j.xmbm v_22,max(sbnf.scxdnf) v_23,max(decode(substr(x.bz,0,3),'lxs','',x.bz)) v_24,max(x.tsdq) v_25,max(l.sffirst) v_50
from jhxdyh j 
left join (select xmid,min(xdnf) scxdnf from plan_zjxd group by xmid) sbnf on j.xmbm = sbnf.xmid
left join xmsq_yhdzx x on j.xmbm=x.xmbm 
left join cbsj_yhdzx c on j.xmbm=c.xmbm 
  left join ( select p.xmid,
       sum(p.ztz) ztz,
       sum(p.rys) rys,
       sum(p.dk) dk,
       sum(p.btzzj) btz,
       sum(p.dfzc) dfzc,
       sum(p.yhdk) yhdk,
       sum(gz) + sum(sz) + sum(zq) dftz
    from plan_zjxd p
   where p.xdnf ='2017' 
   group by p.xmid )  xd  on  j.xmbm=xd.xmid
  left  join(
           select xmid,decode(substr(xmid, 11, 1),
                         '1',
                         (nvl(jhyilc, 0) + nvl(jherlc, 0) +
                         nvl(jhsanlc, 0) + nvl(jhsilc, 0) +
                         nvl(jhdwlc, 0) + nvl(jhwllc, 0)),
                         (nvl(yilc, 0) + nvl(erlc, 0) +
                         nvl(sanlc, 0) + nvl(silc, 0) +
                         nvl(dwlc, 0) + nvl(wllc, 0))) zlc,
                  decode(substr(xmid, 11, 1),
                         '1',
                         (nvl(jhyilc, 0)),
                         (nvl(yilc, 0))) yilc,
                  decode(substr(xmid, 11, 1),
                         '1',
                         (nvl(jherlc, 0)),
                         (nvl(erlc, 0))) erlc,
                  (nvl(jhsanlc, 0)),
                  (nvl(sanlc, 0)) sanlc,
                  (nvl(jhsilc, 0)),
                  (nvl(silc, 0)) silc,
                  jsxz jsxz,
                  xzqhdm xzqhdm,
                  gydw gydw,
                  lxbm lxbm,
                  ghlxmc lxmc,
                  jsjsdj jsjsdj,
                  sffirst,
                  ghlxbm,
                  ghqdzh,
                  ghzdzh,
                  lxlmkd,
                  jsfa,qdzh,zdzh,xjsdj
             from lxsh_lx
            where jdbs = '2' 
            )  l
            on j.XMBM=l.xmid
             left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
              replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
              replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
              replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,
             replace(max(qdzh), ',.', ',0.') qdzh,replace(max(zdzh), ',.', ',0.') zdzh,replace(max(ghqdzh), ',.', ',0.') ghqdzh,replace(max(ghzdzh), ',.', ',0.') ghzdzh,max(ghlxbm) ghlxbm,max(ylxbm) ylxbm
              from (select  xmid,jsxz,
              (case when substr(xmid,11,1)=1 then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
              
              else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0))
              end) jhlc,lxbm,lxmc,(case when substr(xmid,11,1)=3 then xjlxbm 
              else ''
              end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj,
               WMSYS.WM_CONCAT(ghlxbm)over( PARTITION BY xmid ORDER BY id,ghlxbm) ghlxbm,
               WMSYS.WM_CONCAT(lxbm)over( PARTITION BY xmid ORDER BY id,lxbm) ylxbm,
               WMSYS.WM_CONCAT((case when qdzh like '.%' then 0||qdzh when qdzh like '%,.%' then replace(qdzh, ',.', ',0.') else qdzh end ))over( PARTITION BY xmid ORDER BY id,qdzh) qdzh,
               WMSYS.WM_CONCAT((case when zdzh like '.%' then 0||zdzh when zdzh like '%,.%' then replace(zdzh, ',.', ',0.') else zdzh end ))over( PARTITION BY xmid ORDER BY id,zdzh) zdzh,
               WMSYS.WM_CONCAT((case when ghqdzh like '.%' then 0||ghqdzh when ghqdzh like '%,.%' then replace(ghqdzh, ',.', ',0.') else ghqdzh end ))over( PARTITION BY xmid ORDER BY id,ghqdzh) ghqdzh,
               WMSYS.WM_CONCAT((case when ghzdzh like '.%' then 0||ghzdzh when ghzdzh like '%,.%' then replace(ghzdzh, ',.', ',0.') else ghzdzh end ))over( PARTITION BY xmid ORDER BY id,ghzdzh) ghzdzh
              from LXSH_LX  where jdbs='2') group by xmid) lx2 on j.xmbm=lx2.xmid
   where 1=1 and j.jhxdwh  like '%'
            <if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%'))
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and ${scxdnf} in (${xmnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
				<if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
   group by j.xmbm order by j.xmbm desc) a 
	
	</select>
	<!-- 下面是导出计划查询养护大中修明细的sql -->
	<!-- <select id="queryYhdzxDetail_dcexcel1" parameterType="jhsh" resultType="elist">
	select l.lxbm v_1,l.ghlxbm v_2,l.lxmc v_3,l.ghqdzh v_4,l.ghZDZH v_5,l.zlc v_6,l.jsjsdj v_7,l.lxlmkd v_8,l.jsxz v_9,l.jsfa v_10,
decode(l.sffirst,'1',j.ZTZ,'') v_11,decode(l.sffirst,'1',j.RYS+j.DK,'') v_12,null v_13,decode(l.sffirst,'1',xd.ztz,'') v_14,null v_15,decode(l.sffirst,'1',xd.rys,'') v_16,decode(l.sffirst,'1',xd.dk,'') v_17,c.sjpfwh v_18,x.gydw v_19,decode(substr(x.bz,0,3),'lxs','',x.bz) v_20,l.sffirst v_50

from jhxdyh j left join xmsq_yhdzx x on j.xmbm=x.xmbm left join cbsj_yhdzx c on j.xmbm=c.xmbm left join xmsq_yhdzx lxg on j.xmbm=lxg.xmbm
	left join ( select p.xmid,
       sum(p.ztz) ztz,
       sum(p.rys) rys,
       sum(p.dk) dk,
       sum(p.btzzj) btz,
       sum(p.dfzc) dfzc,
       sum(p.yhdk) yhdk,
       sum(gz) + sum(sz) + sum(zq) dftz
  	from plan_zjxd p
 	where p.xdnf = #{xmnf}
 	group by p.xmid )  xd  on  j.xmbm=xd.xmid
	left  join(
           select xmid,decode(substr(xmid, 11, 1),
                         '1',
                         (nvl(jhyilc, 0) + nvl(jherlc, 0) +
                         nvl(jhsanlc, 0) + nvl(jhsilc, 0) +
                         nvl(jhdwlc, 0) + nvl(jhwllc, 0)),
                         (nvl(yilc, 0) + nvl(erlc, 0) +
                         nvl(sanlc, 0) + nvl(silc, 0) +
                         nvl(dwlc, 0) + nvl(wllc, 0))) zlc,
                  decode(substr(xmid, 11, 1),
                         '1',
                         (nvl(jhyilc, 0)),
                         (nvl(yilc, 0))) yilc,
                  decode(substr(xmid, 11, 1),
                         '1',
                         (nvl(jherlc, 0)),
                         (nvl(erlc, 0))) erlc,
                  (nvl(jhsanlc, 0)),
                  (nvl(sanlc, 0)) sanlc,
                  (nvl(jhsilc, 0)),
                  (nvl(silc, 0)) silc,
                  jsxz jsxz,
                  xzqhdm xzqhdm,
                  gydw gydw,
                  lxbm lxbm,
                  ghlxmc lxmc,
                  jsjsdj jsjsdj,
                  sffirst,
                  ghlxbm,
                  ghqdzh,
                  ghzdzh,
                  lxlmkd,
                  jsfa
             from lxsh_lx
            where jdbs = '2'
            )  l
            on j.XMBM=l.xmid
   where 1=1
   			<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			<if test="ghxlxmc != '' and ghxlxmc != null ">
				and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%')
				
				)
			</if>
				<if test="xmnf !=null and xmnf !=''">
					and fun_scxdnf(j.xmbm) in (${xmnf})
				</if>
				<if test="tsdq !=null and tsdq !=''">
					${tsdq}
				</if>
				<if test="xzdj !=null and xzdj !=''">
					and ${xzdj}
				</if>
				<if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				<if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				<if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				<if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				<if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				<if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				<if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				<if test="zjly !=null and zjly !=''">
					${zjly}
				</if>
				<if test="gyfl !=null and gyfl !=''">
					
				</if>
				<if test="sfsycgs !=null and sfsycgs !=''">
					and sfsycgs = #{sfsycgs}
				</if>
				<if test="xdzttj !=null and xdzttj !=''">
					${xdzttj}
				</if>
   order by c.xzqhdm,j.xmbm,sffirst desc
	</select> -->
	
	<!--  -->
	<select id="queryQTLx" parameterType="lx" resultType="lx">
		select * from lxsh_lx where jdbs=(select max(jdbs) from lxsh_lx t where t.xmid=#{xmid}) and to_number(qdzh)!=to_number(#{qdzh}) and to_number(zdzh)!=to_number(#{zdzh}) and xmid=#{xmid}
	</select>
	<select id="querywnLsxxxmbm" parameterType="jhsh" resultType="string">
		select lsxmid from wngsdgz where xmbm=#{xmbm}
	</select>
	<select id="querywnLsxx" parameterType="String" resultType="lx">
		select * from jhsh_lsjl where id in(${value})
	</select>
	<select id="querylxLsxxxmbm" parameterType="jhsh" resultType="string">
		select lsxmid from lx_xmxx where xmbm=#{xmbm}
	</select>
	<select id="querylxLsxx" parameterType="jhsh" resultType="lx">
		select * from jhsh_lsjl where id in(${lsxmbm}) 
		<if test="lsxmnf != null and lsxmnf != ''">
		 ${lsxmnf}
		</if>
		<if test="lsxmlx != null and lsxmlx != ''">
		 ${lsxmlx}
		</if>
		order by xmbm
	</select>
	<select id="querywnxmxxxmbm" parameterType="jhsh" resultType="string">
		select wnxmid from lx_xmxx where xmbm=#{xmbm}
	</select>
	<select id="querywnxmxx" parameterType="String" resultType="lx">
		select * from wn_xmxx where id in(${value}) order by xmnf
	</select>
	<select id="queryylxbxmbm" parameterType="jhsh" resultType="lx">
		select distinct lxbm,qdzh,zdzh from lxsh_lx where xmid=#{xmbm}
	</select>
	
	<select id="queryLsxx2new" parameterType="lx" resultType="lx">
		select * from query_lsjl where 1=1
		<if test="xzqhdm != null and xzqhdm != ''">and ${xzqhdm}</if>
		<if test="jsxz != null and jsxz != ''">and ${jsxz}</if>
		<if test="lxbm != null and lxbm != ''">and lxbm like '%'||#{lxbm}||'%' </if>
		<if test="ghlxbm != null and ghlxbm != ''">and ghlxbm like '%'||#{ghlxbm}||'%' </if>
		<if test="tsdq != null and tsdq != ''">and ${tsdq}</if>
		<if test="xdnf != null and xdnf != ''">and ${xdnf}</if>
		<if test="qdzh != null and qdzh != ''">
		and to_number(fun_zdzxz(qdzh,zdzh,'max'))>to_number(#{qdzh})
		</if>
		<if test="zdzh != null and zdzh != ''">
		and to_number(fun_zdzxz(qdzh,zdzh,'min'))&lt;to_number(#{zdzh})
		</if>
		<if test="ghqdzh != null and ghqdzh != ''">
		and to_number(fun_zdzxz(ghqdzh,ghzdzh,'max'))>to_number(#{ghqdzh})
		</if>
		<if test="ghzdzh != null and ghzdzh != ''">
		and to_number(fun_zdzxz(ghqdzh,ghzdzh,'min'))&lt;to_number(#{ghzdzh})
		</if>
		<if test="xmknf != null and xmknf != ''">and ${xmknf}</if>
		<if test="sjlx != null and sjlx != ''">
		and ${sjlx}
		</if>
	</select>
	
	<select id="exportLsjlSearchExcel" parameterType="lx" resultType="elist">
      select to_char(rownum) v_0,ql.sjlx v_1,ql.xmlx v_2,ql.xmmc v_3,
        decode(ql.sjlx,'补助历史', substr(ql.xmid, 0, 4),ql.xmknf) v_4,
        ql.xdnf v_5, ql.ghlxbm v_6,ql.jsjsdj v_7,ql.ghqdzh v_8,ql.ghzdzh v_9,ql.lxbm v_10,
        ql.xjsdj v_11,ql.qdzh v_12,ql.zdzh v_13
      from query_lsjl ql where 1=1
	    <if test="xzqhdm != null and xzqhdm != ''">and ${xzqhdm}</if>
		<if test="jsxz != null and jsxz != ''">and ${jsxz}</if>
		<if test="lxbm != null and lxbm != ''">and lxbm like '%'||#{lxbm}||'%' </if>
		<if test="ghlxbm != null and ghlxbm != ''">and ghlxbm like '%'||#{ghlxbm}||'%' </if>
		<if test="tsdq != null and tsdq != ''">and ${tsdq}</if>
		<if test="xdnf != null and xdnf != ''">and ${xdnf}</if>
		<if test="qdzh != null and qdzh != ''">
		and to_number(fun_zdzxz(qdzh,zdzh,'max'))>to_number(#{qdzh})
		</if>
		<if test="zdzh != null and zdzh != ''">
		and to_number(fun_zdzxz(qdzh,zdzh,'min'))&lt;to_number(#{zdzh})
		</if>
		<if test="ghqdzh != null and ghqdzh != ''">
		and to_number(fun_zdzxz(ghqdzh,ghzdzh,'max'))>to_number(#{ghqdzh})
		</if>
		<if test="ghzdzh != null and ghzdzh != ''">
		and to_number(fun_zdzxz(ghqdzh,ghzdzh,'min'))&lt;to_number(#{ghzdzh})
		</if>
		<if test="xmknf != null and xmknf != ''">and ${xmknf}</if>
		<if test="sjlx != null and sjlx != ''">
		and ${sjlx}
		</if>
	</select>
	<select id="getgxlxbyzh" parameterType="lx" resultType="lx">
		select * from table(fun_cfld(#{ghlxbm},${ghqdzh},${ghzdzh}))
	</select>
	<select id="queryJhshxxLmsjqxByXmbm" parameterType="jhsh" resultType="jhsh">
		select j.*,l.lxbm as ylxbh,l.gpsqdzh,l.gpszdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from jhsh_sjgz_qx j left join lxsh_lx l on j.xmbm=l.xmid where jdbs='2' and l.sffirst='1' and j.xmbm=#{xmbm}
	</select>
	<select id="queryJhshxxLmgzqxByXmbm" parameterType="jhsh" resultType="jhsh">
		select j.*,l.lxbm as ylxbh,l.gpsqdzh,l.gpszdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from jhsh_lmgz_qx j left join lxsh_lx l on j.xmbm=l.xmid where jdbs='2' and l.sffirst='1' and j.xmbm=#{xmbm}
	</select>
	<select id="queryJhshxxXjqxByXmbm" parameterType="jhsh" resultType="jhsh">
		select j.*,l.lxbm as ylxbh,l.gpsqdzh,l.gpszdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from jhsh_xj_qx j left join lxsh_lx l on j.xmbm=l.xmid where jdbs='2' and l.sffirst='1' and j.xmbm=#{xmbm}
	</select>
	<select id="queryJhshxxYhdzxqxByXmbm" parameterType="jhsh" resultType="jhsh">
		select j.*,l.lxbm as ylxbh,l.gpsqdzh,l.gpszdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from jhsh_yhdzx_qx j left join lxsh_lx l on j.xmbm=l.xmid where jdbs='2' and l.sffirst='1' and j.xmbm=#{xmbm}
	</select>
	<select id="queryJhshxxShqxByXmbm" parameterType="jhsh" resultType="jhsh">
		select j.*,l.lxbm as ylxbh,l.gpsqdzh,l.gpszdzh,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc from jhsh_sh_qx j left join lxsh_lx l on j.xmbm=l.xmid where jdbs='2' and l.sffirst='1' and j.xmbm=#{xmbm}
	</select>
	
	<select id="queryLxbyGhlxbm" parameterType="string" resultType="lx">
	select DISTINCT LXBM,qdzh,zdzh from table(fun_cfld(#{value},0,9999))
	</select>
	
	<select id="queryChildGydw"  parameterType="jhsh" resultType="jhsh">
		select * from XTGL_DEPARTMENT t where t.parent=#{gydw} and (t.id not like '%000_' or t.id  like '%0000')  order by t.id
	</select>
	<select id="queryZjByGydwdm" parameterType="jhsh" resultType="jhsh">
		select * from plan_zjxd z where xdnf=#{xdnf} and z.parent=#{gydwdm} and z.jhxdwh=#{jhxdwh} order by gydwdm
	</select> 
	<select id="queryShqxByOne" parameterType="jhsh" resultType="jhsh">
		select * from plan_zjxd where 1=1 and gydwdm=#{gydwdm} and xdnf=#{xdnf} and jhxdwh=#{jhxdwh}
	</select>
	<insert id="insertShqx" parameterType="jhsh">
		insert into plan_zjxd
	    <trim prefix="(" suffix=")" suffixOverrides="," >
	    	<if test="ztz != null and ztz != ''" >ztz,</if>
	    	<if test="btzzj != null and btzzj != ''" >btzzj,</if>
	    	<if test="rys != null and rys != ''" >rys,</if>
	    	<if test="ttc != null and ttc != ''" >ttc,</if>
	    	<if test="dfzc != null and dfzc != ''" >dfzc,</if>
	    	<if test="xdnf != null and xdnf != ''" >xdnf,</if>
	    	<if test="jhxdwh != null and jhxdwh != ''" >jhxdwh,</if>
	    	<if test="parent != null and parent != ''" >parent,</if>
	    	<if test="gydwdm != null and gydwdm != ''" >gydwdm,</if>
	    	<if test="xdnf != null and xdnf != '' and gydwdm != null and gydwdm != '' and jhxdwh != null and jhxdwh != ''" >xmid,</if>
	  	</trim>
	    <trim prefix="values (" suffix=")" suffixOverrides="," >
	    	<if test="ztz != null and ztz != ''" >#{ztz},</if>
	    	<if test="btzzj != null and btzzj != ''" >#{btzzj},</if>
	    	<if test="rys != null and rys != ''" >#{rys},</if>
	    	<if test="ttc != null and ttc != ''" >#{ttc},</if>
	    	<if test="dfzc != null and dfzc != ''" >#{dfzc},</if>
	    	<if test="xdnf != null and xdnf != ''" >#{xdnf},</if>
	    	<if test="jhxdwh != null and jhxdwh != ''" >#{jhxdwh},</if>
	    	<if test="parent != null and parent != ''" >#{parent},</if>
	    	<if test="gydwdm != null and gydwdm != ''" >#{gydwdm},</if>
	    	<if test="xdnf != null and xdnf != '' and gydwdm != null and gydwdm != '' and jhxdwh != null and jhxdwh != ''" >#{xdnf}||#{gydwdm}||#{jhxdwh},</if>
		</trim>
	</insert>
	<update id="updateShqx" parameterType="jhsh">
	 update plan_zjxd
   	 <set>
      <if test="ztz != null" >ztz = #{ztz},</if>
      <if test="btzzj != null" >btzzj = #{btzzj},</if>
      <if test="rys != null" >rys = #{rys},</if>
      <if test="ttc != null" >ttc = #{ttc},</if>
      <if test="dfzc != null" >dfzc = #{dfzc},</if>
      <if test="xdnf != null" >xdnf = #{xdnf},</if>
      <if test="jhxdwh != null" >jhxdwh = #{jhxdwh},</if>
      <if test="parent != null" >parent = #{parent},</if>
      <if test="gydwdm != null" >gydwdm = #{gydwdm},</if>
	 </set>
      where 1=1 and gydwdm=#{gydwdm} and xdnf=#{xdnf} and jhxdwh = #{jhxdwh}
	</update>
	
	<select id="queryXmlistshqx" parameterType="jhsh" resultType="jhsh">
		select * from(select rownum num ,t1.* from (select t.*,(select name from xtgl_department where id=t.gydwdm) gydw   from plan_zjxd t
		where 1=1 and gydwdm is not null 
		<if test="gydw !='' and gydw != null">${gydw}</if>
		<if test="xdnf !='' and xdnf != null">and xdnf like '%'||#{xdnf}||'%'</if>
		order by xdnf,gydwdm
		) t1 
		)t2
		where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
	</select>
	<select id="queryXmlistshqxCount" parameterType="jhsh" resultType="int">
		select count(*) from plan_zjxd t
		where 1=1 and gydwdm is not null 
		<if test="gydw !='' and gydw != null">${gydw}</if>
		<if test="xdnf !='' and xdnf != null">and xdnf like '%'||#{xdnf}||'%'</if>	
	</select>
	
	<select id="queryLxidbyGhlxbm" resultType="lx" parameterType="string">
		select distinct id from zgb_zxlwzhtx_lxsh where 1=1 ${value}
		union all 
		select distinct id from zgb_zxlwzhtx_wnjh where 1=1 ${value}
	</select>
	<select id="updateJhshSflInfo" parameterType="jhsh">
		update JHSH_SFL
	    <set>
	      <if test="ztz != null" >ztz = #{ztz},</if>
	      <if test="tbz != null" >tbz = #{tbz},</if>
	      <if test="tbz_jaf != null" >tbz_jaf = #{tbz_jaf},</if>
	      <if test="tbz_gcjlf != null" >tbz_gcjlf = #{tbz_gcjlf},</if>
	      <if test="tbz_qqgzf != null" >tbz_qqgzf = #{tbz_qqgzf},</if>
	      <if test="dfzc != null" >dfzc = #{dfzc},</if>
	      <if test="zydpx != null" >zydpx = #{zydpx},</if>
	    </set>
	    where xmbm=#{xmbm} 
	</select>
	<select id="sbshSzxmsfl" parameterType="jhsh">
		update JHSH_SFL
	    <set>
	      <if test="sbzt != null and sbzt != ''" >sbzt = #{sbzt},</if>
	      <if test="shzt != null and shzt != ''" >shzt = #{shzt},qqwcsj=to_char(sysdate,'yyyy-mm-dd'),</if>
	      <if test="thyy != null and thyy != ''" >thyy = #{thyy},</if>
	    </set>
	    where xmbm in (${xmbm})
	</select>
	
	<select id="exportSflgcExcel" parameterType="jhsh" resultType="elist">
      select to_char(rownum) v_0, sg.szds v_1, jh.xmmc v_2,wn.xmlx v_3,
  wn.qhmc v_4, sg.gydw v_5, sz.xlxbm v_6, sz.xlxmc v_7, sz.GHQDZH v_8,
  sz.GHZDZH v_9, sz.ylxbm v_10,sz.ylxmc v_11, sz.YQDZH v_12,sz.YZDZH v_13,
  nvl(sg.yj,0)+nvl(sg.ej,0)+nvl(sg.sj,0)+nvl(sg.sij,0) v_14,nvl(sg.yj,0) v_15,
  nvl(sg.ej,0) v_16,nvl(sg.sj,0) v_17,nvl(sg.sij,0) v_18, sg.xmnf v_19,
  nvl(jh.ztz,0) v_20,
  nvl(jh.tbz_jaf,0)+nvl(jh.tbz_gcjlf,0)+nvl(jh.tbz_qqgzf,0) v_21,
  nvl(jh.tbz_jaf,0) v_22, nvl(jh.tbz_gcjlf,0) v_23, nvl(jh.tbz_qqgzf,0) v_24,nvl(jh.yxdtbz,0) v_25,   
  nvl(jh.bcxdtbz,0) v_26,sg.pfwh v_27, xs.scxdnf v_28, wn.bz v_29, jh.jhxdwh_xd v_30, jh.jhxdsj v_31
  FROM JHSH_SFL JH
  LEFT JOIN (select xmid,min(xdnf) scxdnf from plan_zjxd group by xmid) xs on jh.xmbm = xs.xmid
  LEFT JOIN SGT_SFL sg ON JH.XMBM = SG.XMBM
  LEFT JOIN WNJH_SFL WN ON SG.XMKID = WN.ID
  left join szxmzd sz on wn.id = sz.xmkid
 WHERE 1 = 1
   and jh.shzt = '1'
      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="gydw !='' and gydw != null">${gydw}</if>
      <!-- <if test="jhxdwh !='' and jhxdwh != null">${jhxdwh}</if> -->
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="scxdnf !='' and scxdnf != null">${scxdnf}</if>
      <if test="xmmc !='' and xmmc != null">and jh.xmmc like '%${xmmc}%'</if>
      <if test="ghlxbm !='' and ghlxbm != null">and sz.xlxbm like '%${ghlxbm}%'</if>
      <if test="ghlxmc !='' and ghlxmc != null">and sz.xlxmc like '%${ghlxmc}%'</if>
      <if test="ylxbm !='' and ylxbm != null">and sz.ylxbm like '%${ylxbm}%'</if>
      <if test="ylxmc !='' and ylxmc != null">and sz.ylxmc like '%${ylxmc}%'</if>
      <!--<if test="sbzt !='' and sbzt != null">and jh.sbzt = #{sbzt}</if>--> 
      <!--<if test="shzt !='' and shzt != null">and jh.shzt = #{shzt}</if>--> 
      <!-- <if test="xdzttj !='' and xdzttj != null">and jh.xdzt like '%${xdzttj}%'</if> -->  
	</select>
	<select id="exportYhzxjhExcel" parameterType="jhsh" resultType="elist">
      select dqxx.* from (select '' v_0, '' v_1, '' v_2, '' v_3, '全省合计' v_4, '' v_5, '' v_6,'' v_7, '' v_8, 
     '' v_9, '' v_10, '' v_11, '' v_12, '' v_13, '' v_14, nvl(sum(jh.ztz), 0) v_15,'' v_16, '' v_17, 
     sum(nvl(jh.bcsbz,0))+sum(nvl(jh.bcjl,0)) v_18, nvl(sum(jh.bcsbz), 0) v_19, nvl(sum(jh.bcjl), 0) v_20, 
     nvl(sum(jh.dfzc), 0) v_21, '' v_22, '' v_23, '' v_24, '' v_25
  FROM JHSH_YHZX JH
  left join (select xmid,min(xdnf) scxdnf from plan_zjxd group by xmid) pz on JH.xmbm=pz.xmid 
  LEFT JOIN SGT_YHZX sg ON JH.XMBM = SG.XMBM
  LEFT JOIN WNJH_YHZX WN ON SG.XMKID = WN.ID
  left join szxmzd sz on wn.id = sz.xmkid
  WHERE 1 = 1 and jh.shzt = '1' and fun_scxdnf(jh.xmbm) is not null        
  union all 
  select '' v_0, rs.v_1 v_1, '' v_2, '' v_3, '' v_4, '' v_5, '' v_6, '' v_7, '' v_8,'' v_9,'' v_10,'' v_11,
     '' v_12, '' v_13, '' v_14, sum(rs.v_15) v_15, '' v_16, '' v_17, sum(rs.v_18) v_18, sum(rs.v_19) v_19,
     sum(rs.v_20) v_20, sum(rs.v_21) v_21, '' v_22, '' v_23, '' v_24, '' v_25
  from (  
      select to_char(row_number() over(partition by sg.szds order by jh.ztz)) v_0, sg.szds v_1,wn.ssfj v_2,
         jh.xmmc v_3, wn.dwlx v_4, sg.gydw v_5, wn.lxbm v_6, wn.lxmc v_7, wn.zh v_8, wn.ylxbm v_9,wn.ylxmc v_10,
         wn.yzh v_11, wn.jsxz v_12,wn.jhshnf v_13,wn.ydbmc v_14,decode(jh.ztz, null, 0, jh.ztz) v_15,nvl(jh.jbzj, 0) v_16,
         nvl(jh.yxdbzzj, 0) v_17,decode(nvl(jh.bcsbz,0)+nvl(jh.bcjl,0), null, 0, nvl(jh.bcsbz,0)+nvl(jh.bcjl,0)) v_18,
         decode(jh.bcsbz, null, 0, jh.bcsbz) v_19,decode(jh.bcjl, null, 0, jh.bcjl) v_20,decode(jh.dfzc, null, 0, jh.dfzc) v_21, 
         pz.scxdnf v_22, wn.bz v_23,jh.jhxdwh v_24,jh.jhxdsj v_25
  FROM JHSH_YHZX JH
  left join (select xmid,min(xdnf) scxdnf from plan_zjxd group by xmid) pz on JH.xmbm=pz.xmid 
  LEFT JOIN SGT_YHZX sg ON JH.XMBM = SG.XMBM
  LEFT JOIN WNJH_YHZX WN ON SG.XMKID = WN.ID
  left join szxmzd sz on wn.id = sz.xmkid
  WHERE 1 = 1 and jh.shzt = '1' and fun_scxdnf(jh.xmbm) is not null order by sg.szds) rs group by rs.v_1 
  union all
  select to_char(row_number() over(partition by sg.szds order by jh.ztz)) v_0,sg.szds v_1,wn.ssfj v_2,jh.xmmc v_3,
         wn.dwlx v_4,sg.gydw v_5,wn.lxbm v_6,wn.lxmc v_7,wn.zh v_8,wn.ylxbm v_9,wn.ylxmc v_10, wn.yzh v_11,
         wn.jsxz v_12,wn.jhshnf v_13,wn.ydbmc v_14,decode(jh.ztz, null, 0, jh.ztz) v_15, nvl(jh.jbzj, 0) v_16,
         nvl(jh.yxdbzzj, 0) v_17,decode(nvl(jh.bcsbz,0)+nvl(jh.bcjl,0), null, 0, nvl(jh.bcsbz,0)+nvl(jh.bcjl,0)) v_18,
         decode(jh.bcsbz, null, 0, jh.bcsbz) v_19,decode(jh.bcjl, null, 0, jh.bcjl) v_20, decode(jh.dfzc, null, 0, jh.dfzc) v_21, 
         pz.scxdnf v_22,wn.bz v_23,jh.jhxdwh v_24,jh.jhxdsj v_25
  FROM JHSH_YHZX JH
  left join (select xmid,min(xdnf) scxdnf from plan_zjxd group by xmid) pz on JH.xmbm=pz.xmid 
  LEFT JOIN SGT_YHZX sg ON JH.XMBM = SG.XMBM
  LEFT JOIN WNJH_YHZX WN ON SG.XMKID = WN.ID
  left join szxmzd sz on wn.id = sz.xmkid
  WHERE 1 = 1 and jh.shzt = '1'and fun_scxdnf(jh.xmbm) is not null
	      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="gydw !='' and gydw != null">${gydw}</if>
      <!-- <if test="jhxdwh !='' and jhxdwh != null">${jhxdwh}</if> -->
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="scxdnf !='' and scxdnf != null">${scxdnf}</if>
      <if test="xmmc !='' and xmmc != null">and jh.xmmc like '%${xmmc}%'</if>
      <if test="ghlxbm !='' and ghlxbm != null">and sz.xlxbm like '%${ghlxbm}%'</if>
      <if test="ghlxmc !='' and ghlxmc != null">and sz.xlxmc like '%${ghlxmc}%'</if>
      <if test="ylxbm !='' and ylxbm != null">and sz.ylxbm like '%${ylxbm}%'</if>
      <if test="ylxmc !='' and ylxmc != null">and sz.ylxmc like '%${ylxmc}%'</if>
      <!--<if test="sbzt !='' and sbzt != null">and jh.sbzt = #{sbzt}</if>--> 
      <!--<if test="shzt !='' and shzt != null">and jh.shzt = #{shzt}</if>--> 
      <!-- <if test="xdzttj !='' and xdzttj != null">and jh.xdzt like '%${xdzttj}%'</if> --> 
	) dqxx order by dqxx.v_1 nulls first, dqxx.v_0 nulls first
	
	</select>
	
	<select id="exportFwqjhExcel" parameterType="jhsh" resultType="elist">
  select to_char(rownum) v_0, sg.szds v_1, wn.qhmc v_2, sg.gydw v_3, jh.xmmc v_4,
    sz.xlxbm v_5, sz.xlxmc v_6, sz.xlxzh v_7, sz.ylxbm v_8, sz.ylxmc v_9,
    sz.llxzh v_10, sz.JSDJ v_11, sz.xmlx v_12, sz.xysslx v_13, sz.jssslx v_14,
    sz.fwnr v_15, nvl(sz.zdmj,0) v_16, xs.scxdnf v_17, wn.bz v_18,
    nvl(jh.ztz,0) v_19, nvl(jh.cgs,0) v_20, nvl(jh.dfzc,0) v_21, jh.jhxdwh v_22, jh.jhxdsj v_23
  FROM JHSH_FWQ JH
  LEFT JOIN (select xmid,min(xdnf) scxdnf from plan_zjxd group by xmid) xs on jh.xmbm = xs.xmid
  LEFT JOIN SGT_FWQ sg ON JH.XMBM = SG.XMBM
  LEFT JOIN WNJH_FWQ WN ON SG.XMKID = WN.ID
  left join szxmzd sz on wn.id = sz.xmkid
  WHERE 1 = 1 and jh.shzt = '1' and fun_scxdnf(jh.xmbm) is not null
      <if test="xzqh !='' and xzqh != null">${xzqh}</if>
      <if test="gydw !='' and gydw != null">${gydw}</if>
      <!-- <if test="jhxdwh !='' and jhxdwh != null">${jhxdwh}</if> -->
      <if test="xmnf !='' and xmnf != null">${xmnf}</if>
      <if test="scxdnf !='' and scxdnf != null">${scxdnf}</if>
      <if test="xmmc !='' and xmmc != null">and jh.xmmc like '%${xmmc}%'</if>
      <if test="ghlxbm !='' and ghlxbm != null">and sz.xlxbm like '%${ghlxbm}%'</if>
      <if test="ghlxmc !='' and ghlxmc != null">and sz.xlxmc like '%${ghlxmc}%'</if>
      <if test="ylxbm !='' and ylxbm != null">and sz.ylxbm like '%${ylxbm}%'</if>
      <if test="ylxmc !='' and ylxmc != null">and sz.ylxmc like '%${ylxmc}%'</if>
      <!--<if test="sbzt !='' and sbzt != null">and jh.sbzt = #{sbzt}</if>--> 
      <!--<if test="shzt !='' and shzt != null">and jh.shzt = #{shzt}</if>--> 
      <!-- <if test="xdzttj !='' and xdzttj != null">and jh.xdzt like '%${xdzttj}%'</if> -->  
	</select>
	
	<select id="exportJhshShSbTotalExcel" parameterType="jhsh" resultType="elist">
     select '合计' v_0,'' v_1,'' v_2,'' v_3,'' v_4,'' v_5,'' v_6,'' v_7,'' v_8,'' v_9,'' v_10,'' v_11,'' v_12,sum(t.v_13) v_13,
       sum(t.v_14) v_14,sum(t.v_16)+sum(t.v_17)+sum(t.v_18)+sum(t.v_19) v_15,sum(t.v_16) v_16,sum(t.v_17) v_17,sum(t.v_18) v_18,sum(t.v_19) v_19,'' v_20,'' v_21,'' v_22,'' v_23,'' v_24      
       from (
       select j.ZYDPX v_0, to_char(j.ds) v_1, j.xzqh v_2,j.xmmc v_3,lx.ghlxbm v_4,lx.ghlxmc v_5,lx.ghqdzh v_6,lx.ghzdzh v_7,      
       lx.lxbm v_8,lx.lxmc v_9,lx.qdzh1 v_10,lx.zdzh1 v_11,j.jsxz v_12, lx2.zjhlc v_13,
       decode(j.PFZTZ, null, 0, j.PFZTZ) v_14,
       nvl(wh.bccgs,0)+nvl(wh.bcstz,0)+nvl(j.DFZC,0)+nvl(j.QT,0) v_15,nvl(wh.bccgs,0) v_16,nvl(wh.bcstz,0) v_17,
       decode(j.DFZC, null, 0, j.DFZC) v_18,decode(j.QT, null, 0, j.QT) v_19,cb.sjpfwh v_20,j.XMBM v_21,j.scxdnf v_22,cb.jsfa v_23,j.tsdqzcg v_24
from jhxdsh j
left join (select xmbm, sjpfwh ,jsfa from cbsj_sh) cb on j.xmbm = cb.xmbm
left join xmsq_sh lxg on j.xmbm = lxg.xmbm
left join (select xmid xmbm, min(lx.xzqhdm) xzqhdm, min(lx.gydw) gydw from lxsh_lx lx where jdbs = '2' group by lx.xmid) l on j.xmbm = l.xmbm
           left join (select xmid,jsxz,(case when substr(xmid, 11, 1) = 1 then to_char(nvl(jhyilc, 0) + nvl(jherlc, 0) + nvl(jhsanlc, 0) + nvl(jhsilc, 0) + nvl(jhdwlc, 0) + nvl(jhwllc, 0))
                      else to_char(nvl(yilc, 0) + nvl(erlc, 0) +nvl(sanlc, 0) + nvl(silc, 0) + nvl(dwlc, 0) + nvl(wllc, 0))end) lc,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,lxbm, lxmc, qdzh qdzh1, zdzh zdzh1
                      from lxsh_lx
                      where jdbs = '2' and sffirst = '1') lx on j.xmbm = lx.xmid
                      left join (select xmid,count(xmid) xmsl, decode(substr(xmid, 11, 1),1,(nvl(sum(jhyilc), 0) +
                             nvl(sum(jherlc), 0) +nvl(sum(jhsanlc), 0) +nvl(sum(jhsilc), 0) +nvl(sum(jhdwlc), 0) +
                             nvl(sum(jhwllc), 0)),(nvl(sum(yilc), 0) + nvl(sum(erlc), 0) + nvl(sum(sanlc), 0) + nvl(sum(silc), 0) +
                             nvl(sum(dwlc), 0) +nvl(sum(wllc), 0))) zlc
                             from lxsh_lx
                             where jdbs = '2'
                             group by xmid) sl on j.xmbm = sl.xmid
                      left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm), ',', ',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm), ',', ',') ghxlxbmtj,
                                   replace(WMSYS.WM_CONCAT(jsjsdj), ',', ',') jsjsdjtj,replace(WMSYS.WM_CONCAT(xjsdj), ',', ',') xjsdjtj,replace(WMSYS.WM_CONCAT(lxmc), ',', ',') ghlxmctj,
                                   replace(WMSYS.WM_CONCAT(ghxlxmc), ',', ',') ghxlxmctj
                              from (select xmid,jsxz,
                                           (case
                                             when substr(xmid, 11, 1) = 1 then
                                              to_char(nvl(jhyilc, 0) + nvl(jherlc, 0) + nvl(jhsanlc, 0) + nvl(jhsilc, 0) +nvl(jhdwlc, 0) +nvl(jhwllc, 0))
                                             else
                                              to_char(nvl(yilc, 0) + nvl(erlc, 0) + nvl(sanlc, 0) +nvl(silc, 0) +nvl(dwlc, 0) +nvl(wllc, 0))
                                           end) jhlc,lxbm,lxmc,
                                           (case
                                             when substr(xmid, 11, 1) = 3 then xjlxbm
                                             else '' end) ghxlxbm,'' ghxlxmc,jsjsdj,xjsdj
                                      from LXSH_LX
                                     where jdbs = '2')
                             group by xmid) lx2 on j.xmbm = lx2.xmid
                  left join (select j.xmid,sum(j.btzzj) bcxd,replace(WMSYS.WM_CONCAT(j.jhxdwh),',', ',') bcxdwh,
                                   replace(WMSYS.WM_CONCAT(j.xdnf), ',', ',') bcxdsj,sum(j.btzzj) + nvl(sum(j.rys), 0) +
                                   nvl(sum(j.dk), 0) + nvl(sum(j.gz), 0) +nvl(sum(j.sz), 0) + nvl(sum(j.zq), 0) +
                                   sum(j.dfzc) bcztz,nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                                   nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) + nvl(sum(j.zq), 0) bcstz,sum(j.btzzj) bccgs,sum(j.dk) stz
                              from jhxdsh g
                              left join plan_zjxd j on g.xmbm = j.xmid
                             where 1 = 1
                             group by j.xmid) wh on j.xmbm = wh.xmid
                 where 1 = 1
                <if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
                <if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				<if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				</if>
				<if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				</if>
				<if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				</if>
			    <if test="ghxlxmc != '' and ghxlxmc != null ">
				    and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%'))
			     </if>
				 <if test="xmnf !=null and xmnf !=''">and ${scxdnf} in (${xmnf})</if>
				 <if test="tsdq !=null and tsdq !=''">${tsdq}</if>
				 <if test="xzdj !=null and xzdj !=''">and ${xzdj}</if>
				 <if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				 <if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				 <if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				 <if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				 <if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				 <if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				 <if test="xdzttj !=null and xdzttj !=''">${xdzttj}</if>
				 <if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>                 
                 order by j.xdzt, j.xmbm desc)t
	</select>
	
	<select id="exportJhshShSbExcel" parameterType="jhsh" resultType="elist">                                                        
select j.ZYDPX v_0,
       to_char(j.ds) v_1,
       j.xzqh v_2,
       j.xmmc v_3,
       decode(instr(RemoveSameStr(lx2.ghlxbm, ','), ','),
              0,
              RemoveSameStr(lx2.ghlxbm, ','),
              lx2.ghlxbm) v_4,
     decode(instr(RemoveSameStr(lx2.ghlxmc, ','), ','),
              0,
              RemoveSameStr(lx2.ghlxmc, ','),
              lx2.ghlxmc) v_5,
       lx2.ghqdzh v_6,
       lx2.ghzdzh v_7,
     decode(instr(RemoveSameStr(lx2.ylxbm, ','), ','),
              0,
              RemoveSameStr(lx2.ylxbm, ','),
              lx2.ylxbm) v_8,
      decode(instr(RemoveSameStr(lx2.ylxmc, ','), ','),
              0,
              RemoveSameStr(lx2.ylxmc, ','),
              lx2.ylxmc) v_9,
       lx2.qdzh v_10,
       lx2.zdzh v_11,
       j.jsxz v_12,
       lx2.lc v_13,
       decode(j.PFZTZ, null, 0, j.PFZTZ) v_14,
       nvl(wh.bccgs, 0) + nvl(wh.bcstz, 0) + nvl(j.DFZC, 0) + nvl(j.QT, 0) v_15,
       nvl(wh.bccgs, 0) v_16,
       nvl(wh.bcstz, 0) v_17,
       decode(j.DFZC, null, 0, j.DFZC) v_18,
       decode(j.QT, null, 0, j.QT) v_19,
       cb.sjpfwh v_20,
       j.XMBM v_21,
       j.scxdnf v_22,
       cb.jsfa v_23,
       j.tsdqzcg v_24
  from jhxdsh j
  left join (select xmbm, sjpfwh, jsfa from cbsj_sh) cb on j.xmbm = cb.xmbm
  left join xmsq_sh lxg on j.xmbm = lxg.xmbm
  left join (select xmid xmbm, min(lx.xzqhdm) xzqhdm, min(lx.gydw) gydw
               from lxsh_lx lx
              where jdbs = '2'
              group by lx.xmid) l on j.xmbm = l.xmbm
  left join (select xmid,
                    replace(WMSYS.WM_CONCAT(lxbm), ',', ',') ghlxbmtj,
                    replace(WMSYS.WM_CONCAT(ghxlxbm), ',', ',') ghxlxbmtj,
                    replace(WMSYS.WM_CONCAT(jsjsdj), '、', ',') jsjsdjtj,
                    replace(WMSYS.WM_CONCAT(xjsdj), '、', ',') xjsdjtj,
                    replace(max(qdzh), ',.', ',0.') qdzh,
                    replace(max(zdzh), ',.', ',0.') zdzh,
                    replace(max(ghqdzh), ',.', ',0.') ghqdzh,
                    replace(max(ghzdzh), ',.', ',0.') ghzdzh,
                    max(ghlxmc) ghlxmc,
                    max(ylxmc) ylxmc,
                    max(ghlxbm) ghlxbm,
                    max(ylxbm) ylxbm,
                    sum(lc) lc 
               from (select xmid,
                            lxbm,
                            lxmc,
                          
                            (case
                              when substr(xmid, 11, 1) = 3 then
                               xjlxbm
                              else
                               ''
                            end) ghxlxbm,
                            '' ghxlxmc,
                            jsjsdj,
                            xjsdj,
                             WMSYS.WM_CONCAT(ghlxmc) over(PARTITION BY xmid ORDER BY id, ghlxmc) ghlxmc,
                            WMSYS.WM_CONCAT(lxmc) over(PARTITION BY xmid ORDER BY id, lxmc) ylxmc,
                            WMSYS.WM_CONCAT(ghlxbm) over(PARTITION BY xmid ORDER BY id, ghlxbm) ghlxbm,
                            WMSYS.WM_CONCAT(lxbm) over(PARTITION BY xmid ORDER BY id, lxbm) ylxbm,
                            WMSYS.WM_CONCAT((case
                                              when qdzh like '.%' then
                                               0 || qdzh
                                              when qdzh like '%,.%' then
                                               replace(qdzh, ',.', ',0.')
                                              else
                                               qdzh
                                            end)) over(PARTITION BY xmid ORDER BY id, qdzh) qdzh,
                            WMSYS.WM_CONCAT((case
                                              when zdzh like '.%' then
                                               0 || zdzh
                                              when zdzh like '%,.%' then
                                               replace(zdzh, ',.', ',0.')
                                              else
                                               zdzh
                                            end)) over(PARTITION BY xmid ORDER BY id, zdzh) zdzh,
                            WMSYS.WM_CONCAT((case
                                              when ghqdzh like '.%' then
                                               0 || ghqdzh
                                              when ghqdzh like '%,.%' then
                                               replace(ghqdzh, ',.', ',0.')
                                              else
                                               ghqdzh
                                            end)) over(PARTITION BY xmid ORDER BY id, ghqdzh) ghqdzh,
                            WMSYS.WM_CONCAT((case
                                              when ghzdzh like '.%' then
                                               0 || ghzdzh
                                              when ghzdzh like '%,.%' then
                                               replace(ghzdzh, ',.', ',0.')
                                              else
                                               ghzdzh
                                            end)) over(PARTITION BY xmid ORDER BY id, ghzdzh) ghzdzh,
                                             (case
                              when substr(xmid, 11, 1) = 1 then
                               to_char(nvl(jhyilc, 0) + nvl(jherlc, 0) +
                                       nvl(jhsanlc, 0) + nvl(jhsilc, 0) +
                                       nvl(jhdwlc, 0) + nvl(jhwllc, 0))
                              else
                               to_char(nvl(yilc, 0) + nvl(erlc, 0) +
                                       nvl(sanlc, 0) + nvl(silc, 0) +
                                       nvl(dwlc, 0) + nvl(wllc, 0))
                            end) lc
                       from LXSH_LX 
                      where jdbs = '2')
              group by xmid) lx2 on j.xmbm = lx2.xmid
  left join (select j.xmid,
                    sum(j.btzzj) bcxd,
                    replace(WMSYS.WM_CONCAT(j.jhxdwh), ',', ',') bcxdwh,
                    replace(WMSYS.WM_CONCAT(j.xdnf), ',', ',') bcxdsj,
                    sum(j.btzzj) + nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                    nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                    nvl(sum(j.zq), 0) + sum(j.dfzc) bcztz,
                    nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                    nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                    nvl(sum(j.zq), 0) bcstz,
                    sum(j.btzzj) bccgs,
                    sum(j.dk) stz
               from jhxdsh g
               left join plan_zjxd j on g.xmbm = j.xmid
                             where 1 = 1
                             group by j.xmid) wh on j.xmbm = wh.xmid
                 where 1 = 1                 
                 <if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
                 <if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				 <if test="lxmc !=null and lxmc !=''">
					and ghlxmctj like '%'||#{lxmc}||'%'
				 </if>
				 <if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				 </if>
				 <if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				 </if>
			     <if test="ghxlxmc != '' and ghxlxmc != null ">
				    and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%'))
			     </if>
				 <if test="xmnf !=null and xmnf !=''">and ${scxdnf} in (${xmnf})</if>
				 <if test="tsdq !=null and tsdq !=''">${tsdq}</if>
				 <if test="xzdj !=null and xzdj !=''">and ${xzdj}</if>
				 <if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				 <if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				 <if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				 <if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				 <if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				 <if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				 <if test="xdzttj !=null and xdzttj !=''">${xdzttj}</if>
				 <if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>
                 order by 
                 <if test="zydpx=='升序'">to_number(j.zydpx) asc,</if>
			     <if test="zydpx=='降序'">to_number(j.zydpx),</if>   
                 j.xmbm,j.xdzt asc
	</select>
	
	<select id="exportJhshYhdzxTotalExcel" parameterType="jhsh" resultType="elist">
	select '合计' v_0, '' v_1,'' v_2,'' v_3,'' v_4,'' v_5,'' v_6,'' v_7,'' v_8,'' v_9,'' v_10,'' v_11,'' v_12,sum(t.v_13) v_13,'' v_14,
'' v_15,sum(t.v_16) v_16,sum(t.v_17) v_17,sum(t.v_18) v_18,sum(t.v_19) v_19,'' v_20,'' v_21,'' v_22,'' v_23,'' v_24 ,''v_25,''v_26
from(
select to_char(rownum) v_0, j.ZYDPX v_1, j.ds v_2, j.XMBM v_3, j.xmmc v_4, lx.ghlxbm v_5, lx.ghlxmc v_6,
       lx.ghqdzh v_7, lx.ghzdzh v_8,lx.lxbm v_9, lx.lxmc v_10, lx.qdzh1 v_11, lx.zdzh1 v_12,to_char(lx2.zjhlc,'fm999990.09999') v_13,lxg.jsdj v_14,
       j.jsxz v_15, nvl(j.ZTZ,0) v_16, nvl(j.RYS,0) v_17, nvl(wh.bcstz,0) v_18,nvl(j.QT,0) v_19,nvl(wh.bccgs,0) v_20,
       cb.sjpfwh v_21,j.gydw v_22, j.scxdnf v_23,lxg.bz v_24,cb.jsfa v_25,j.tsdqzcg v_26
                  from jhxdyh j
                  left join (select xmbm, sjpfwh ,jsfa from cbsj_yhdzx) cb on j.xmbm = cb.xmbm
                  left join xmsq_yhdzx lxg on j.xmbm = lxg.xmbm
                  left join (select xmid xmbm,min(lx.xzqhdm) xzqhdm,min(lx.gydw) gydw
                              from lxsh_lx lx group by lx.xmid) l on j.xmbm = l.xmbm
                  left join (select xmid,jsxz,
                                    (case when substr(xmid, 11, 1) = 1 then
                                      to_char(nvl(jhyilc, 0) + nvl(jherlc, 0) +
                                              nvl(jhsanlc, 0) + nvl(jhsilc, 0) +
                                              nvl(jhdwlc, 0) + nvl(jhwllc, 0))
                                     else
                                      to_char(nvl(yilc, 0) + nvl(erlc, 0) +
                                              nvl(sanlc, 0) + nvl(silc, 0) +
                                              nvl(dwlc, 0) + nvl(wllc, 0))
                                   end) lc,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh,lxbm,lxmc,qdzh qdzh1,zdzh zdzh1
                              from lxsh_lx
                             where jdbs = '2' and sffirst = '1') lx on j.xmbm = lx.xmid
                  left join (select xmid,count(xmid) xmsl,decode(substr(xmid, 11, 1),1,(nvl(sum(jhyilc), 0) +
                                 nvl(sum(jherlc), 0) +nvl(sum(jhsanlc), 0) +nvl(sum(jhsilc), 0) +nvl(sum(jhdwlc), 0) +
                                 nvl(sum(jhwllc), 0)),(nvl(sum(yilc), 0) +nvl(sum(erlc), 0) +nvl(sum(sanlc), 0) +
                                 nvl(sum(silc), 0) +nvl(sum(dwlc), 0) +nvl(sum(wllc), 0))) zlc
                              from lxsh_lx
                             where jdbs = '2'
                             group by xmid) sl on j.xmbm = sl.xmid
                  left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm), ',', ',') ghlxbmtj,
                                   replace(WMSYS.WM_CONCAT(ghxlxbm), ',', ',') ghxlxbmtj,
                                   replace(WMSYS.WM_CONCAT(jsjsdj), ',', ',') jsjsdjtj,
                                   replace(WMSYS.WM_CONCAT(xjsdj), ',', ',') xjsdjtj,
                                   replace(WMSYS.WM_CONCAT(lxmc), ',', ',') ghlxmctj,
                                   replace(WMSYS.WM_CONCAT(ghxlxmc), ',', ',') ghxlxmctj
                              from (select xmid,jsxz,
                                           (case
                                             when substr(xmid, 11, 1) = 1 then
                                              to_char(nvl(jhyilc, 0) +nvl(jherlc, 0) + nvl(jhsanlc, 0) + nvl(jhsilc, 0) +
                                                      nvl(jhdwlc, 0) +nvl(jhwllc, 0))
                                             else
                                              to_char(nvl(yilc, 0) + nvl(erlc, 0) +  nvl(sanlc, 0) +  nvl(silc, 0) +
                                                      nvl(dwlc, 0) + nvl(wllc, 0))end) jhlc,
                                           lxbm, lxmc,
                                           (case when substr(xmid, 11, 1) = 3 then xjlxbm else '' end) ghxlxbm,
                                           '' ghxlxmc, jsjsdj, xjsdj
                                      from LXSH_LX
                                     where jdbs = '2')
                             group by xmid) lx2 on j.xmbm = lx2.xmid
                  left join (select j.xmid,sum(j.btzzj) bcxd,replace(WMSYS.WM_CONCAT(j.jhxdwh),',',',') bcxdwh,
                                   replace(WMSYS.WM_CONCAT(j.xdnf), ',', ',') bcxdsj,
                                   sum(j.btzzj) + nvl(sum(j.rys), 0) +
                                   nvl(sum(j.dk), 0) + nvl(sum(j.gz), 0) +
                                   nvl(sum(j.sz), 0) + nvl(sum(j.zq), 0) +
                                   sum(j.dfzc) bcztz,
                                   nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                                   nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                                   nvl(sum(j.zq), 0) bcstz,
                                   sum(j.btzzj) bccgs
                              from jhxdyh g
                              left join plan_zjxd j on g.xmbm = j.xmid
                             where 1 = 1
                             group by j.xmid) wh on j.xmbm = wh.xmid
                 where 1 = 1
                 <if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
                 <if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				 <if test="lxmc !=null and lxmc !=''">and ghlxmctj like '%'||#{lxmc}||'%'</if>
				 <if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				 </if>
				 <if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				 </if>
			     <if test="ghxlxmc != '' and ghxlxmc != null ">
				    and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%'))
			     </if>
				 <if test="xmnf !=null and xmnf !=''">and ${scxdnf} in (${xmnf})</if>
				 <if test="tsdq !=null and tsdq !=''">${tsdq}</if>
				 <if test="xzdj !=null and xzdj !=''">and ${xzdj}</if>
				 <if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				 <if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				 <if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				 <if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				 <if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				 <if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				 <if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				 <if test="zjly !=null and zjly !=''">${zjly}</if>
				 <if test="gyfl !=null and gyfl !=''"></if>
				 <if test="sfsycgs !=null and sfsycgs !=''">and sfsycgs = #{sfsycgs}</if>
				 <if test="xdzttj !=null and xdzttj !=''">${xdzttj}</if>
				 <if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>   
                     order by j.xmbm,j.xdzt asc)t
	</select>

	<select id="exportJhshYhdzxDetailExcel" parameterType="jhsh" resultType="elist">
	select to_char(rownum) v_0,
       j.ZYDPX v_1,
       j.ds v_2,
       j.XMBM v_3,
       j.xmmc v_4,
       decode(instr(RemoveSameStr(lx2.ghlxbm, ','), ','),
              0,
              RemoveSameStr(lx2.ghlxbm, ','),
              lx2.ghlxbm) v_5,
       decode(instr(RemoveSameStr(lx2.ghlxmc, ','), ','),
              0,
              RemoveSameStr(lx2.ghlxmc, ','),
              lx2.ghlxmc) v_6,
       lx2.ghqdzh v_7,
       lx2.ghzdzh v_8,
       decode(instr(RemoveSameStr(lx2.ylxbm, ','), ','),
              0,
              RemoveSameStr(lx2.ylxbm, ','),
              lx2.ylxbm) v_9,
       decode(instr(RemoveSameStr(lx2.ylxmc, ','), ','),
              0,
              RemoveSameStr(lx2.ylxmc, ','),
              lx2.ylxmc) v_10,
       lx2.qdzh v_11,
       lx2.zdzh v_12,
       to_char(lx2.lc, 'fm999990.09999') v_13,
       lxg.jsdj v_14,
       j.jsxz v_15,
       nvl(j.ZTZ, 0) v_16,
       nvl(j.RYS, 0) v_17,
       nvl(wh.bcstz, 0) v_18,
       nvl(j.QT, 0) v_19,
       nvl(wh.bccgs, 0) v_20,
       cb.sjpfwh v_21,
       j.gydw v_22,
       j.scxdnf v_23,
       lxg.bz v_24,
       cb.jsfa v_25,
       j.tsdqzcg v_26
  from jhxdyh j
  left join (select xmbm, sjpfwh,jsfa from cbsj_yhdzx) cb on j.xmbm = cb.xmbm
  left join xmsq_yhdzx lxg on j.xmbm = lxg.xmbm
  left join (select xmid xmbm, min(lx.xzqhdm) xzqhdm, min(lx.gydw) gydw
               from lxsh_lx lx
              group by lx.xmid) l on j.xmbm = l.xmbm
  left join (select xmid,
                    replace(WMSYS.WM_CONCAT(lxbm), ',', ',') ghlxbmtj,
                    replace(WMSYS.WM_CONCAT(ghxlxbm), ',', ',') ghxlxbmtj,
                    replace(WMSYS.WM_CONCAT(jsjsdj), '、', ',') jsjsdjtj,
                    replace(WMSYS.WM_CONCAT(xjsdj), '、', ',') xjsdjtj,
                    replace(max(qdzh), ',.', ',0.') qdzh,
                    replace(max(zdzh), ',.', ',0.') zdzh,
                    replace(max(ghqdzh), ',.', ',0.') ghqdzh,
                    replace(max(ghzdzh), ',.', ',0.') ghzdzh,
                    max(ghlxmc) ghlxmc,
                    max(ylxmc) ylxmc,
                    max(ghlxbm) ghlxbm,
                    max(ylxbm) ylxbm,
                    sum(lc) lc 
               from (select xmid,
                            lxbm,
                            lxmc,
                          
                            (case
                              when substr(xmid, 11, 1) = 3 then
                               xjlxbm
                              else
                               ''
                            end) ghxlxbm,
                            '' ghxlxmc,
                            jsjsdj,
                            xjsdj,
                             WMSYS.WM_CONCAT(ghlxmc) over(PARTITION BY xmid ORDER BY id, ghlxmc) ghlxmc,
                            WMSYS.WM_CONCAT(lxmc) over(PARTITION BY xmid ORDER BY id, lxmc) ylxmc,
                            WMSYS.WM_CONCAT(ghlxbm) over(PARTITION BY xmid ORDER BY id, ghlxbm) ghlxbm,
                            WMSYS.WM_CONCAT(lxbm) over(PARTITION BY xmid ORDER BY id, lxbm) ylxbm,
                            WMSYS.WM_CONCAT((case
                                              when qdzh like '.%' then
                                               0 || qdzh
                                              when qdzh like '%,.%' then
                                               replace(qdzh, ',.', ',0.')
                                              else
                                               qdzh
                                            end)) over(PARTITION BY xmid ORDER BY id, qdzh) qdzh,
                            WMSYS.WM_CONCAT((case
                                              when zdzh like '.%' then
                                               0 || zdzh
                                              when zdzh like '%,.%' then
                                               replace(zdzh, ',.', ',0.')
                                              else
                                               zdzh
                                            end)) over(PARTITION BY xmid ORDER BY id, zdzh) zdzh,
                            WMSYS.WM_CONCAT((case
                                              when ghqdzh like '.%' then
                                               0 || ghqdzh
                                              when ghqdzh like '%,.%' then
                                               replace(ghqdzh, ',.', ',0.')
                                              else
                                               ghqdzh
                                            end)) over(PARTITION BY xmid ORDER BY id, ghqdzh) ghqdzh,
                            WMSYS.WM_CONCAT((case
                                              when ghzdzh like '.%' then
                                               0 || ghzdzh
                                              when ghzdzh like '%,.%' then
                                               replace(ghzdzh, ',.', ',0.')
                                              else
                                               ghzdzh
                                            end)) over(PARTITION BY xmid ORDER BY id, ghzdzh) ghzdzh,
                                             (case
                              when substr(xmid, 11, 1) = 1 then
                               to_char(nvl(jhyilc, 0) + nvl(jherlc, 0) +
                                       nvl(jhsanlc, 0) + nvl(jhsilc, 0) +
                                       nvl(jhdwlc, 0) + nvl(jhwllc, 0))
                              else
                               to_char(nvl(yilc, 0) + nvl(erlc, 0) +
                                       nvl(sanlc, 0) + nvl(silc, 0) +
                                       nvl(dwlc, 0) + nvl(wllc, 0))
                            end) lc
                       from LXSH_LX 
                      where jdbs = '2')group by xmid) lx2 on j.xmbm = lx2.xmid
  left join (select j.xmid,
                    sum(j.btzzj) bcxd,
                    replace(WMSYS.WM_CONCAT(j.jhxdwh), ',', ',') bcxdwh,
                    replace(WMSYS.WM_CONCAT(j.xdnf), ',', ',') bcxdsj,
                    sum(j.btzzj) + nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                    nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                    nvl(sum(j.zq), 0) + sum(j.dfzc) bcztz,
                    nvl(sum(j.rys), 0) + nvl(sum(j.dk), 0) +
                    nvl(sum(j.gz), 0) + nvl(sum(j.sz), 0) +
                    nvl(sum(j.zq), 0) bcstz,
                    sum(j.btzzj) bccgs
               from jhxdyh g
               left join plan_zjxd j on g.xmbm = j.xmid
                             where 1 = 1
                             group by j.xmid) wh on j.xmbm = wh.xmid
                 where 1 = 1
                 <if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
                 <if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
				 <if test="lxmc !=null and lxmc !=''">and ghlxmctj like '%'||#{lxmc}||'%'</if>
				 <if test="ghlxbh!=null and ghlxbh!=''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
				 </if>
				 <if test="ghxlxbm != null and ghxlxbm != ''">
					and j.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghxlxbm})
				 </if>
			     <if test="ghxlxmc != '' and ghxlxmc != null ">
				    and (j.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghxlxmc}||'%'))
			     </if>
				 <if test="xmnf !=null and xmnf !=''">and ${scxdnf} in (${xmnf})</if>
				 <if test="tsdq !=null and tsdq !=''">${tsdq}</if>
				 <if test="xzdj !=null and xzdj !=''">and ${xzdj}</if>
				 <if test="shzt!=null and shzt!=''">and j.xdzt=${shzt}</if>
				 <if test="sbzt!=null and sbzt!=''">and j.sbzt=${sbzt}</if>
				 <if test="xmmc!=null and xmmc!=''">and j.xmmc like '%'||#{xmmc}||'%'</if>
				 <if test="jsdj!=null and jsdj!=''">and ${jsdj}</if>
				 <if test="lsjl!=null and lsjl!=''">and j.lsjl=#{lsjl}</if>
				 <if test="xmlx1 !=null and xmlx1 !=''">${xmlx1}</if>
				 <if test="jhxdwh !=null and jhxdwh !=''">${jhxdwh}</if>
				 <if test="zjly !=null and zjly !=''">${zjly}</if>
				 <if test="gyfl !=null and gyfl !=''"></if>
				 <if test="sfsycgs !=null and sfsycgs !=''">and sfsycgs = #{sfsycgs}</if>
				 <if test="xdzttj !=null and xdzttj !=''">${xdzttj}</if>
				 <if test="xmbm!=null and xmbm!=''">and j.xmbm like '%'||#{xmbm}||'%'</if>   
                    order by 
                    <if test="zydpx=='升序'">to_number(j.zydpx) asc,</if>
			        <if test="zydpx=='降序'">to_number(j.zydpx),</if>   
                    j.xmbm,j.xdzt asc                                                         
	</select>
	<update id="insertOrUpdateJhshDj" parameterType="java.util.List">
      begin
      UPDATE jhsh_dj j 
      <set>
       <if test="yjgdql!=null and yjgdql!=''">j.yjgdql=#{yjgdql,jdbcType=VARCHAR},</if>
       <if test="ejgdql!=null and ejgdql!=''">j.ejgdql=#{ejgdql,jdbcType=VARCHAR},</if>
       <if test="yjsdql!=null and yjsdql!=''">j.yjsdql=#{yjsdql,jdbcType=VARCHAR},</if>
       <if test="ejsdql!=null and ejsdql!=''">j.ejsdql=#{ejsdql,jdbcType=VARCHAR},</if>
       <if test="sjsdql!=null and sjsdql!=''">j.sjsdql=#{sjsdql,jdbcType=VARCHAR},</if>
       <if test="yjgdsd!=null and yjgdsd!=''">j.yjgdsd=#{yjgdsd,jdbcType=VARCHAR},</if>      
       <if test="ejgdsd!=null and ejgdsd!=''">j.ejgdsd=#{ejgdsd,jdbcType=VARCHAR},</if>
       <if test="yjsdsd!=null and yjsdsd!=''">j.yjsdsd=#{yjsdsd,jdbcType=VARCHAR},</if>
       <if test="ejsdsd!=null and ejsdsd!=''">j.ejsdsd=#{ejsdsd,jdbcType=VARCHAR},</if>
       <if test="sjsdsd!=null and sjsdsd!=''">j.sjsdsd=#{sjsdsd,jdbcType=VARCHAR},</if>
       <if test="yjgd!=null and yjgd!=''">j.yjgd=#{yjgd,jdbcType=VARCHAR},</if>
       <if test="ejgd!=null and ejgd!=''">j.ejgd=#{ejgd,jdbcType=VARCHAR},</if>
       <if test="yjsd!=null and yjsd!=''">j.yjsd=#{yjsd,jdbcType=VARCHAR},</if>
       <if test="ejsd!=null and ejsd!=''">j.ejsd=#{ejsd,jdbcType=VARCHAR},</if>  
       <if test="sjsd!=null and sjsd!=''">j.sjsd=#{sjsd,jdbcType=VARCHAR}</if>
      </set>
      WHERE j.xmbm = #{xmbm}; 
      if sql%notfound then
      INSERT INTO jhsh_dj(xmbm,yjgdql,ejgdql,yjsdql,ejsdql,sjsdql,yjgdsd,ejgdsd,yjsdsd,ejsdsd,sjsdsd,yjgd,ejgd,yjsd,ejsd,sjsd) 
              VALUES (#{xmbm,jdbcType=VARCHAR},#{yjgdql,jdbcType=VARCHAR},#{ejgdql,jdbcType=VARCHAR},#{yjsdql,jdbcType=VARCHAR},#{ejsdql,jdbcType=VARCHAR},
              #{sjsdql,jdbcType=VARCHAR},#{yjgdsd,jdbcType=VARCHAR},#{ejgdsd,jdbcType=VARCHAR},#{yjsdsd,jdbcType=VARCHAR},#{ejsdsd,jdbcType=VARCHAR},
              #{sjsdsd,jdbcType=VARCHAR},#{yjgd,jdbcType=VARCHAR},#{ejgd,jdbcType=VARCHAR},#{yjsd,jdbcType=VARCHAR},#{ejsd,jdbcType=VARCHAR},#{sjsd,jdbcType=VARCHAR});
      end if;
      end;   
	</update>
</mapper>
