<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.lxsh">
	<insert id="insertqqgllx" parameterType="lxsh">
		insert into lxsh_lx (id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh,jsfa ,yilc,erlc,sanlc,silc,dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,xjlxbm,xjqdzh,xjzdzh,xjlc,jhlc,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh)
		select id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,'0',jdbs,gpsqdzh,gpszdzh,jsfa ,yilc,erlc,sanlc,silc,dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,xjlxbm,xjqdzh,xjzdzh,xjlc,jhlc,ghlxbm,ghlxmc,ghqdzh,ghzdzh,gxlxbm,gxqdzh,gxzdzh 
		from wnjh_lx  where  xmid in (${wnid})
<!-- 		xmid=#{wnid} -->
	</insert>
	<insert id="updateqqgllx" parameterType="lxsh">
		update lxsh_lx set xmid=#{xmbm},jdbs='0',gpsqdzh=qdzh,gpszdzh=zdzh where xmid in (${wnid})
<!-- 		xmid=#{wnid} -->
	</insert>
	
	<update id="updatesffirst" parameterType="lxsh">
	update lxsh_lx set sffirst='1' where id=#{lxid}
	</update>
	
	<insert id="updateqqglls" parameterType="lxsh">
		update ${bz} l set lsjl=(select lsjl from ${bzcs} w where id=#{wnid} ),
		lsxmbm=(select lsxmbm from ${bzcs} w where id=#{wnid} ),
		lsxmid=(select lsxmid from ${bzcs} w where id=#{wnid} )
		where xmbm=#{xmbm}
	</insert>
	
	<select id="querywnlsjl" parameterType="lxsh" resultType="lxsh">
		select lsjl,lsxmbm,lsxmid from wnjh_sjgz w  where id in (${wnid})
	</select>
	
	<update id="updatesjgzls" parameterType="lxsh">
		update lxsh_sjgz l set lsjl=#{lsjl},lsxmbm=#{lsxmbm},lsxmid=#{lsxmid} where xmbm=#{xmbm}
	</update>
	
	<update id="updateqqglsj" parameterType="lxsh">
		
		update wnjh_sjgz set qqkzzt=#{sfbflx} where  id in (${wnid})
<!-- 		id=#{wnid} -->
		
	</update>
	<update id="updateqqgllm" parameterType="lxsh">
		update wnjh_lmgz set qqkzzt=#{sfbflx} where id=#{wnid}
	
	</update>
	<update id="updateqqglxj" parameterType="lxsh">
	
		update wnjh_xj set qqkzzt=#{sfbflx} where id=#{wnid}
	
	</update>
	
	<select id="loadjsdjcd" parameterType="lxsh" resultType="lxsh">
		select sum(t.yilc) yilc,sum(t.erlc) erlc,sum(t.sanlc) sanlc,sum(t.silc) silc,sum(t.dwlc) dwlc,sum(t.wllc) wllc,
       sum(t.jhyilc) jhyilc,sum(t.jherlc) jherlc,sum(t.jhsanlc) jhsanlc,sum(t.jhsilc) jhsilc,sum(t.jhdwlc) jhdwlc,sum(t.jhwllc) jhwllc,
        max(xjlxbm) xjlxbm,max(xjqdzh) xjqdzh,max(xjzdzh) xjzdzh     
       from wnjh_lx t where t.xmid=#{id} group by t.xmid
     </select>
     
     <select id="loadjsdj" parameterType="lxsh" resultType="lxsh">
		select sum(t.yilc) yilc,sum(t.erlc) erlc,sum(t.sanlc) sanlc,sum(t.silc) silc,sum(t.dwlc) dwlc,sum(t.wllc) wllc,
       sum(t.jhyilc) jhyilc,sum(t.jherlc) jherlc,sum(t.jhsanlc) jhsanlc,sum(t.jhsilc) jhsilc,sum(t.jhdwlc) jhdwlc,sum(t.jhwllc) jhwllc     
       from wnjh_lx t where t.xmid in (${xmbm})
     </select>
     
	<select id="selectimportXmbm" parameterType="String" resultType="String">
		${value}
	</select>
	<select id="selectXmbm" parameterType="String" resultType="String">
		select max(substr(xmbm,-3)) from lxsh_sjgz where xmbm like ${value}||'%'
	</select>
	<select id="selectlmgzXmbm" parameterType="String" resultType="String">
		select max(substr(xmbm,-3)) from lxsh_lmgz where xmbm like ${value}||'%'
	</select>
	<select id="selectxjXmbm" parameterType="String" resultType="String">
		select max(substr(xmbm,-3)) from lxsh_xj where xmbm like ${value}||'%'
	</select>
	<select id="selectbzcs" parameterType="lxsh" resultType="lxsh">
		select bzzj bzys from PLAN_FLWBZBZ where xmlx=#{xmlx} and gldj=#{gldj} and jsdj like #{jsdj}||'%'
	</select>
	<select id="selectSFCF" parameterType="lxsh" resultType="lxsh">
		select * from LXSH_LX where lxbm=#{ghlxbh} and ((qdzh&lt;=#{qdzh} and zdzh>#{qdzh}) or (qdzh&lt;#{zdzh} and zdzh>=#{zdzh})) and substr(xmid,0,4)=#{xmnf}
	</select>
	<select id="selectSFCFLX" parameterType="lxsh" resultType="lxsh">
		select * from LXSH_LX where lxbm=#{ghlxbh} and ((qdzh&lt;=#{qdzh} and zdzh>#{qdzh}) or (qdzh&lt;#{zdzh} and zdzh>=#{zdzh})) and substr(xmid,0,4)=substr(#{xmbm},0,4) and jdbs=#{jdbs}
	</select>
	<select id="selectSFCF1" parameterType="lxsh" resultType="lxsh">
		select * from LXSH_LMGZ where ghlxbh =#{ghlxbh} and ((qdzh&lt;=#{qdzh} and zdzh>#{qdzh}) or (qdzh&lt;#{zdzh} and zdzh>=#{zdzh})) and xmnf=#{xmnf}
	</select>
	<select id="selectSFCF2" parameterType="lxsh" resultType="lxsh">
		select * from LXSH_XJ where ghlxbh =#{ghlxbh} and ((qdzh&lt;=#{qdzh} and zdzh>#{qdzh}) or (qdzh&lt;#{zdzh} and zdzh>=#{zdzh})) and xmnf=#{xmnf}
	</select>
	<insert id="insertSjgz" parameterType="lxsh">
		insert into LXSH_SJGZ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,tsdq,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,bz,yhdk,jszlc<if test="xzqhdm2 != null">,xzqhdm2</if><if test="sfbflx != null">,sfbflx</if><if test="wnid != null">,wnid</if><if test="xmklx != null">,xmklx</if>)
		values(sys_guid(),#{lxmc},#{xmmc},#{ghlxbh},#{lc},#{jsxz},#{qdzh},#{zdzh},#{qdmc},#{zdmc},#{jhkgn},#{jhwgn},#{jsjsdj},#{xjsdj},#{xmbm},#{tz},#{bzys},#{dfzc},#{tsdq},#{xzqh},#{gydw},#{xzqhdm},#{gydwdm},#{xmnf},#{sbthcd},#{tbbmbm},#{bz},#{yhdk},#{jszlc}<if test="xzqhdm2 != null">,#{xzqhdm2}</if><if test="sfbflx != null">,#{sfbflx}</if><if test="wnid != null">,#{wnid}</if><if test="xmklx != null">,#{xmklx}</if>)
	</insert>
	<insert id="insertLmgz" parameterType="lxsh">
		insert into LXSH_LMGZ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,tsdq,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,lsjl,bz,yhdk<if test="xzqhdm2 != null">,xzqhdm2</if><if test="sfbflx != null">,sfbflx</if><if test="wnid != null">,wnid</if><if test="xmklx != null">,xmklx</if>)
		values(sys_guid(),#{lxmc},#{xmmc},#{ghlxbh},#{lc},#{jsxz},#{qdzh},#{zdzh},#{qdmc},#{zdmc},#{jhkgn},#{jhwgn},#{jsjsdj},#{xjsdj},#{xmbm},#{tz},#{bzys},#{dfzc},#{tsdq},#{xzqh},#{gydw},#{xzqhdm},#{gydwdm},#{xmnf},#{sbthcd},#{tbbmbm},#{lsjl},#{bz},#{yhdk}<if test="xzqhdm2 != null">,#{xzqhdm2}</if><if test="sfbflx != null">,#{sfbflx}</if><if test="wnid != null">,#{wnid}</if><if test="xmklx != null">,#{xmklx}</if>)
	</insert>
	<insert id="insertXj" parameterType="lxsh">
		insert into LXSH_XJ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,tsdq,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,lsjl,bz,yhdk<if test="xzqhdm2 != null">,xzqhdm2</if><if test="sfbflx != null">,sfbflx</if><if test="wnid != null">,wnid</if><if test="xmklx != null">,xmklx</if>)
		values(sys_guid(),#{lxmc},#{xmmc},#{ghlxbh},#{lc},#{jsxz},#{qdzh},#{zdzh},#{qdmc},#{zdmc},#{jhkgn},#{jhwgn},#{jsjsdj},#{xjsdj},#{xmbm},#{tz},#{bzys},#{dfzc},#{tsdq},#{xzqh},#{gydw},#{xzqhdm},#{gydwdm},#{xmnf},#{sbthcd},#{tbbmbm},#{lsjl},#{bz},#{yhdk}<if test="xzqhdm2 != null">,#{xzqhdm2}</if><if test="sfbflx != null">,#{sfbflx}</if><if test="wnid != null">,#{wnid}</if><if test="xmklx != null">,#{xmklx}</if>)
	</insert>
	<insert id="insertlx" parameterType="lxsh">
		insert into LXSH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh
		<if test="xjlxbm!='' and xjlxbm!=null">,xjlxbm</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,xjqdzh</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,xjzdzh</if>
		<if test="xjlc!='' and xjlc!=null">,xjlc</if>
		,yilc,erlc,sanlc,silc,dwlc,wllc
		<if test="jhyilc!=null">,jhyilc</if>
		<if test="jherlc!=null">,jherlc</if>
		<if test="jhsanlc!=null">,jhsanlc</if>
		<if test="jhsilc!=null">,jhsilc</if>
		<if test="jhdwlc!=null">,jhdwlc</if>
		<if test="jhwllc!=null">,jhwllc</if>)
		values(sys_guid(),#{xmbm},#{ghlxbh},#{lxmc},#{xzqh},#{xzqhdm},#{gydw},#{gydwdm},#{qdzh},#{zdzh},#{jsjsdj},#{lc},#{xjsdj},#{jsxz},#{qdmc},#{zdmc},#{bzys},'1',#{jdbs},#{gpsqdzh},#{gpszdzh}
		<if test="xjlxbm!='' and xjlxbm!=null">,#{xjlxbm}</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,#{xjqdzh}</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,#{xjzdzh}</if>
		<if test="xjlc!='' and xjlc!=null">,#{xjlc}</if>
		,#{yilc},#{erlc},#{sanlc},#{silc},#{dwlc},#{wllc}
		<if test="jhyilc!=null">,#{jhyilc}</if>
		<if test="jherlc!=null">,#{jherlc}</if>
		<if test="jhsanlc!=null">,#{jhsanlc}</if>
		<if test="jhsilc!=null">,#{jhsilc}</if>
		<if test="jhdwlc!=null">,#{jhdwlc}</if>
		<if test="jhwllc!=null">,#{jhwllc}</if>)
	</insert>
	<insert id="insertLx" parameterType="lxsh">
		<!-- insert into LXSH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh
		<if test="xjlxbm!=null">,xjlxbm</if> <if test="xjqdzh!=null">,xjqdzh</if> <if test="xjzdzh!=null">,xjzdzh</if>
		<if test="yilc!=null">,yilc</if> <if test="erlc!=null">,erlc</if> <if test="sanlc!=null">,sanlc</if> <if test="silc!=null">,silc</if> <if test="dwlc!=null">,dwlc</if> <if test="wllc!=null">,wllc</if>
		<if test="jhyilc!=null">,jhyilc</if> <if test="jherlc!=null">,jherlc</if> <if test="jhsanlc!=null">,jhsanlc</if> <if test="jhsilc!=null">,jhsilc</if> <if test="jhdwlc!=null">,jhdwlc</if> <if test="jhwllc!=null">,jhwllc</if>
		)
		values(sys_guid(),#{xmbm},#{ghlxbh},#{lxmc},#{xzqh},#{xzqhdm},#{gydw},#{gydwdm},#{qdzh},#{zdzh},#{jsjsdj},#{lc},#{xjsdj},#{jsxz},#{qdmc},#{zdmc},#{bzys},'0',#{jdbs},#{gpsqdzh},#{gpszdzh}
		<if test="xjlxbm!=null">,#{xjlxbm}</if> <if test="xjqdzh!=null">,#{xjqdzh}</if> <if test="xjzdzh!=null">,#{xjzdzh}</if>
		<if test="yilc!=null">,#{yilc}</if> <if test="erlc!=null">,#{erlc}</if> <if test="sanlc!=null">,#{sanlc}</if> <if test="silc!=null">,#{silc}</if> <if test="dwlc!=null">,#{dwlc}</if> <if test="wllc!=null">,#{wllc}</if>
		<if test="jhyilc!=null">,#{jhyilc}</if> <if test="jherlc!=null">,#{jherlc}</if> <if test="jhsanlc!=null">,#{jhsanlc}</if> <if test="jhsilc!=null">,#{jhsilc}</if> <if test="jhdwlc!=null">,#{jhdwlc}</if> <if test="jhwllc!=null">,#{jhwllc}</if>)
	 -->
	insert into LXSH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,sffirst,jdbs,gpsqdzh,gpszdzh
		<if test="xjlxbm!='' and xjlxbm!=null">,xjlxbm</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,xjqdzh</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,xjzdzh</if>
		<if test="xjlc!='' and xjlc!=null">,xjlc</if>
		<if test="yilc!=null">,yilc</if>
		<if test="erlc!=null">,erlc</if>
		<if test="sanlc!=null">,sanlc</if>
		<if test="silc!=null">,silc</if>
		<if test="dwlc!=null">,dwlc</if>
		<if test="wllc!=null">,wllc</if>
		<if test="jhyilc!=null">,jhyilc</if>
		<if test="jherlc!=null">,jherlc</if>
		<if test="jhsanlc!=null">,jhsanlc</if>
		<if test="jhsilc!=null">,jhsilc</if>
		<if test="jhdwlc!=null">,jhdwlc</if>
		<if test="jhwllc!=null">,jhwllc</if>
		<if test="ghlxbm !=null">,ghlxbm</if>
		<if test="ghlxmc !=null">,ghlxmc</if>
		<if test="ghqdzh !=null">,ghqdzh</if>
		<if test="ghzdzh !=null">,ghzdzh</if>
		<if test="gxlxbm !=null">,gxlxbm</if>
		<if test="gxqdzh !=null">,gxqdzh</if>
		<if test="gxzdzh !=null">,gxzdzh</if>)
		values(#{id},#{xmbm},#{ghlxbh},#{lxmc},#{xzqh},#{xzqhdm},#{gydw},#{gydwdm},#{qdzh},#{zdzh},#{jsjsdj},#{lc},#{xjsdj},#{jsxz},#{qdmc},#{zdmc},#{sffirst},#{jdbs},#{gpsqdzh},#{gpszdzh}
		<if test="xjlxbm!='' and xjlxbm!=null">,#{xjlxbm}</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,#{xjqdzh}</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,#{xjzdzh}</if>
		<if test="xjlc!='' and xjlc!=null">,#{xjlc}</if>
		<if test="yilc!=null">,#{yilc}</if>
		<if test="erlc!=null">,#{erlc}</if>
		<if test="sanlc!=null">,#{sanlc}</if>
		<if test="silc!=null">,#{silc}</if>
		<if test="dwlc!=null">,#{dwlc}</if>
		<if test="wllc!=null">,#{wllc}</if>
		<if test="jhyilc!=null">,#{jhyilc}</if>
		<if test="jherlc!=null">,#{jherlc}</if>
		<if test="jhsanlc!=null">,#{jhsanlc}</if>
		<if test="jhsilc!=null">,#{jhsilc}</if>
		<if test="jhdwlc!=null">,#{jhdwlc}</if>
		<if test="jhwllc!=null">,#{jhwllc}</if>
		<if test="ghlxbm !=null">,#{ghlxbm}</if>
		<if test="ghlxmc !=null">,#{ghlxmc}</if>
		<if test="ghqdzh !=null">,#{ghqdzh}</if>
		<if test="ghzdzh !=null">,#{ghzdzh}</if>
		<if test="gxlxbm !=null">,#{gxlxbm}</if>
		<if test="gxqdzh !=null">,#{gxqdzh}</if>
		<if test="gxzdzh !=null">,#{gxzdzh}</if>) 
	
	
	</insert>
	<insert id="insertLx1" parameterType="lxsh">
		insert into lxsh_lx (xmid, lxbm, lxmc, xzqh, xzqhdm, gydw, gydwdm, qdzh, zdzh, jsjsdj, lc, xjsdj, jsxz, qdmc, zdmc, bzcs, sffirst, jdbs,gpsqdzh,gpszdzh,jsfa,yilc,erlc,sanlc,silc,dwlc,wllc ,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,xjlxbm,xjqdzh,xjzdzh,xjlc,jhlc,ghlxbm,ghlxmc,lqhntmchd,lqhntmc,gxlqhntmchd,gxlqhntmc,snhntmchd,snhntmc,lqlmjdrzshd,lqlmjdrzs,lqlmcbrzshd,lqlmcbrzs,swjchd,swjc,lqlmpmlqjdlzshd,lqlmpmlqjdlzs,lqlmrhlqjdlzshd,lqlmrhlqjdlzs,lqlmcblzshd,lqlmcblzs,xzrxjchd,xzrxjc,swjclzshd,swjclzs,xfchd,xfc,wcsnmbhd,wcsnmb,wcswjchd,wcswjc,snhntmchbhd,snhntmchb,bxhd,bx,snhntmcsshhd,snhntmcssh,sbzj,lxlmkd,xzqhdm2,xzqhmc2,gxlxbm,gxqdzh,gxzdzh,ghqdzh,ghzdzh,snhntmchbmj)
		select xmid, lxbm, lxmc, xzqh, xzqhdm, gydw, gydwdm, qdzh, zdzh, jsjsdj, lc, xjsdj, jsxz, qdmc, zdmc, bzcs, sffirst, to_char(to_number(#{jdbs})),qdzh,zdzh,jsfa,yilc,erlc,sanlc,silc,dwlc,wllc   ,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,xjlxbm,xjqdzh,xjzdzh,xjlc,jhlc,ghlxbm,ghlxmc,lqhntmchd,lqhntmc,gxlqhntmchd,gxlqhntmc,snhntmchd,snhntmc,lqlmjdrzshd,lqlmjdrzs,lqlmcbrzshd,lqlmcbrzs,swjchd,swjc,lqlmpmlqjdlzshd,lqlmpmlqjdlzs,lqlmrhlqjdlzshd,lqlmrhlqjdlzs,lqlmcblzshd,lqlmcblzs,xzrxjchd,xzrxjc,swjclzshd,swjclzs,xfchd,xfc,wcsnmbhd,wcsnmb,wcswjchd,wcswjc,snhntmchbhd,snhntmchb,bxhd,bx,snhntmcsshhd,snhntmcssh,sbzj,lxlmkd,xzqhdm2,xzqhmc2,gxlxbm,gxqdzh,gxzdzh,ghqdzh,ghzdzh,snhntmchbmj from lxsh_lx where xmid = #{xmbm} and jdbs=to_char(to_number(#{jdbs})-1)
		<!-- insert into LXSH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh)
		values(sys_guid(),#{xmbm},#{ghlxbh},#{lxmc},#{xzqh},#{xzqhdm},#{gydw},#{gydwdm},#{qdzh},#{zdzh},#{jsjsdj},#{lc},#{xjsdj},#{jsxz},#{qdmc},#{zdmc},#{bzys},#{sffirst},#{jdbs},#{gpsqdzh},#{gpszdzh}) -->
	</insert>
	<select id="querylxlist" parameterType="lxsh" resultType="lxsh">
		select t.*,bzcs bzys,xmid xmbm,lxbm ghlxbh from lxsh_lx t where xmid=#{xmbm} and jdbs=#{jdbs}
	</select>
	<select id="selectSjgzList" parameterType="lxsh" resultType="lxsh">
		select * from (select rownum num ,t.id,t.xmbm,to_char(sbzt),t.wnid,t.sfbflx,
		t.gydwdm,t.sbthcd,t.lsjl,t.ghlxbh,t.gydw,t.xzqh,t.tz,t.bzys,t.dfzc,t.tsdq ,lx.*,sl.xmsl,sl.zlc jszlc  from LXSH_SJGZ t left join
		(select xmid,lxbm,qdzh minqdzh,zdzh maxzdzh,qdmc,zdmc,lc,xjsdj,jsjsdj,yilc,erlc,sanlc,silc,dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,decode(substr(xmid,11,1),'3',xjlxbm,ghlxbm) ghlxbm,ghlxmc,decode(substr(xmid,11,1),'3',xjqdzh,ghqdzh) ghqdzh,decode(substr(xmid,11,1),'3',xjzdzh,ghzdzh) ghzdzh,gxlxbm,gxqdzh,gxzdzh 
		from lxsh_lx where jdbs='0' and sffirst='1') lx on t.xmbm=lx.xmidz
		left join ( select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='0' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1 and  sbthcd &lt;=#{sbthcd}
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%1___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
		order by xmbm desc,sbzt1 
	</select>
	<select id="selectSjgzListCount" parameterType="lxsh" resultType="int">
		select count(t.xmbm) from LXSH_SJGZ t left join (select xmid,lxbm,lc,xjsdj,jsjsdj
		from lxsh_lx where jdbs='0' and sffirst='1') lx on t.xmbm=lx.xmid where 1=1 and sbthcd &lt;=#{sbthcd}
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%1___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
	</select>
	<select id="selectSjgzlxList" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.id,xmid xmbm,lxbm ghlxbh,lxmc,xzqh,zdzh,qdzh,gydw,xzqhdm,gydwdm,jsjsdj,xjsdj,lc,jsxz,qdmc,zdmc,t.bzcs bzys  from LXSH_LX t where 1=1 and sffirst!='1'
		<if test="xmbm!='' and xmbm!= null ">
			and xmid like '%'||#{xmbm}||'%'
		</if>
		<if test="jdbs!='' and jdbs!= null ">
			and jdbs like '%'||#{jdbs}||'%'
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
	</select>
	<select id="selectSjgzlxListCount" parameterType="lxsh" resultType="int">
		select count(*) from LXSH_LX where 1=1 and sffirst!='1'
		<if test="xmbm!='' and xmbm!= null ">
			and xmid like '%'||#{xmbm}||'%'
		</if>
		<if test="jdbs!='' and jdbs!= null ">
			and jdbs like '%'||#{jdbs}||'%'
		</if>
	</select>
	<update id="sbsjgzSbzt" parameterType="hashmap">
		update LXSH_SJGZ set sbzt=1,sbthcd=#{sbthcd},thyy='' where id=#{id}
	</update>
	<update id="sblmgzSbzt" parameterType="hashmap">
		update LXSH_LMGZ set sbzt=1,sbthcd=#{sbthcd},thyy='' where id=#{id}
	</update>
	<update id="sbxjSbzt" parameterType="hashmap">
		update LXSH_XJ set sbzt=1,sbthcd=#{sbthcd},thyy='' where id=#{id}
	</update>
	<update id="thSjgzSbzt" parameterType="hashmap">
		update LXSH_SJGZ set sbthcd=#{sbthcd} where id=#{id}
	</update>
	<update id="thSjgzSbzt1" parameterType="hashmap">
		update LXSH_SJGZ set shzt=0 where xmbm=#{xmbm}
	</update>
	<update id="thLmgzSbzt" parameterType="hashmap">
		update LXSH_LMGZ set sbthcd=#{sbthcd} where id=#{id}
	</update>
	<update id="thLmgzSbzt1" parameterType="hashmap">
		update LXSH_LMGZ set shzt=0 where xmbm=#{xmbm}
	</update>
	<delete id="deletelmgzkxx" parameterType="hashmap">
		delete from kxxyj_lmgz where xmbm=#{xmbm}
	</delete>
	<delete id="deletesjgzkxx" parameterType="hashmap">
		delete from kxxyj_sjgz where xmbm=#{xmbm}
	</delete>
	<delete id="deletexjkxx" parameterType="hashmap">
		delete from kxxyj_xj where xmbm=#{xmbm}
	</delete>
	<update id="thXjSbzt" parameterType="hashmap">
		update LXSH_XJ set sbthcd=#{sbthcd} where id=#{id}
	</update>
	<update id="thXjSbzt1" parameterType="hashmap">
		update LXSH_XJ set shzt=0 where xmbm=#{xmbm}
	</update>
	<update id="updateSjgz" parameterType="lxsh">
		update LXSH_SJGZ set xmmc=#{xmmc},xmbm=#{xmbm},qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},xjsdj=#{xjsdj},jhkgn=#{jhkgn},jhwgn=#{jhwgn},tz=#{tz},dfzc=(to_number(#{tz})-to_number(#{bzys})),gydw=#{gydw},gydwdm=#{gydwdm},xzqhdm=#{xzqhdm},xzqh=#{xzqh},tsdq=#{tsdq},yhdk=#{yhdk},bz=#{bz},jszlc=#{jszlc}
		<if test="xzqhdm2 != null">,xzqhdm2=#{xzqhdm2}</if>
		<if test="sfbflx != null">,sfbflx=#{sfbflx}</if>   
		<if test="xmnf != null">,xmnf=#{xmnf}</if> 
		<if test="lsjl != null">,lsjl=#{lsjl}</if> 
		<if test="lsxmbm !=null">,lsxmbm=#{lsxmbm}</if>
		<if test="lsxmid !=null">,lsxmid=#{lsxmid}</if> 
		where xmbm=#{xmbm1}
	</update>
	<update id="updateLmgz" parameterType="lxsh">
		update LXSH_LMGZ set xmmc=#{xmmc},xmbm=#{xmbm},qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},xjsdj=#{xjsdj},jhkgn=#{jhkgn},jhwgn=#{jhwgn},tz=#{tz}<!-- ,bzys=#{bzys} -->,dfzc=(to_number(#{tz})-to_number(#{bzys})),gydw=#{gydw},gydwdm=#{gydwdm},xzqhdm=#{xzqhdm},xzqh=#{xzqh},tsdq=#{tsdq},yhdk=#{yhdk},bz=#{bz}<if test="xzqhdm2 != null">,xzqhdm2=#{xzqhdm2}</if>  
		<if test="sfbflx != null">,sfbflx=#{sfbflx}</if>  
		<if test="xmnf != null">,xmnf=#{xmnf}</if>  
		<if test="lsjl != null">,lsjl=#{lsjl}</if> 
		<if test="lsxmbm !=null">,lsxmbm=#{lsxmbm}</if>
		<if test="lsxmid !=null">,lsxmid=#{lsxmid}</if> 
		where xmbm=#{xmbm1}
	</update>
	<update id="updateXj" parameterType="lxsh">
		update LXSH_XJ set ghlxbh=#{ghlxbh},xmbm=#{xmbm},lxmc=#{lxmc},xjsdj=#{xjsdj},xmmc=#{xmmc},qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},jhkgn=#{jhkgn},jhwgn=#{jhwgn},tz=#{tz}<!-- ,bzys=#{bzys} -->,dfzc=(to_number(#{tz})-to_number(#{bzys})),gydw=#{gydw},gydwdm=#{gydwdm},xzqhdm=#{xzqhdm},xzqh=#{xzqh},tsdq=#{tsdq},bz=#{bz},yhdk=#{yhdk}<if test="xzqhdm2 != null">,xzqhdm2=#{xzqhdm2}</if>  
		<if test="sfbflx != null">,sfbflx=#{sfbflx}</if>  
		<if test="xmnf != null">,xmnf=#{xmnf}</if>  
		<if test="lsjl != null">,lsjl=#{lsjl}</if> 
		<if test="lsxmbm !=null">,lsxmbm=#{lsxmbm}</if>
		<if test="lsxmid !=null">,lsxmid=#{lsxmid}</if> 
		where xmbm=#{xmbm1}
	</update>
	<update id="updateSjgzlx" parameterType="lxsh">
		update LXSH_LX set qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj}<!-- ,bzcs=#{bzys} -->
		where xmid=#{xmbm1} and sffirst='1' and jdbs=#{jdbs}
	</update>
	<select id="querylxshlxid" parameterType="lxsh" resultType="string">
	select id from lxsh_lx where xmid=#{xmbm1} and sffirst='1' and jdbs=#{jdbs}
	</select>
	<select id="queryMaxbzcs" parameterType="lxsh" resultType="double">
		select sum(to_number(bzcs)) from LXSH_LX where xmid=#{xmbm} and jdbs=#{jdbs}
	</select>
	<select id="queryMaxlc" parameterType="lxsh" resultType="double">
		select sum(to_number(lc)) from LXSH_LX where xmid=#{xmbm} and jdbs=#{jdbs}
	</select>
	<select id="selectSjgzshList" parameterType="lxsh" resultType="lxsh">
		select * from (select rownum num ,xmklx,t.id,t.xmbm,to_char(sbzt) sbzt1,t.shzt,t.xmnf,t.xzqhdm,t.xmmc,t.thyy,
		t.gydwdm,t.sbthcd,t.lsjl,t.ghlxbh,t.gydw,t.xzqh,t.tz,t.bzys,t.dfzc,t.tsdq ,lx.*,sl.xmsl,sl.zlc jszlc,t.jhkgn,t.jhwgn,t.yhdk,t.bz,t.jsxz,t.lxmc,t.wnid,t.sfbflx  from LXSH_SJGZ t left join
		(select xmid,lxbm,qdzh minqdzh,zdzh maxzdzh,qdmc,zdmc,lc,xjsdj,jsjsdj,yilc,erlc,sanlc,silc,dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,decode(substr(xmid,11,1),'3',xjlxbm,ghlxbm) ghlxbm,ghlxmc,decode(substr(xmid,11,1),'3',xjqdzh,ghqdzh) ghqdzh,decode(substr(xmid,11,1),'3',xjzdzh,ghzdzh) ghzdzh,gxlxbm,gxqdzh,gxzdzh 
		from lxsh_lx where jdbs='0' and sffirst='1'
			<if test="ghlxmc!='' and ghlxmc!= null ">and ghlxmc=#{ghlxmc}</if>
			) lx on t.xmbm=lx.xmid
			
		left join (select  xmid,jsxz,
		        (case when jsxz like '%改建%' then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            when jsxz like '%新建%' then xjlc
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='0' and sffirst='1' ) lxs 
		        on t.xmbm=lxs.xmid
		left join ( select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='0' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1 <if test="sbzt!='' and sbzt!= null ">and sbzt=#{sbzt}</if>
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">and sbzt=#{sbzt1}</if>
		<if test="shzt!='' and shzt!= null ">and shzt=#{shzt}</if>
		
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="jsjsdj!='' and jsjsdj!= null ">and ${jsjsdj}</if>
		<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%1___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
	</select>
	<select id="selectSjgzshListCount" parameterType="lxsh" resultType="int">
		select count(t.xmbm) from LXSH_SJGZ t left join (select xmid,lxbm,lc,xjsdj,jsjsdj
		from lxsh_lx where jdbs='0' and sffirst='1'
		
			<if test="ghlxmc!='' and ghlxmc!= null ">and ghlxmc=#{ghlxmc}</if>
			) lx on t.xmbm=lx.xmid where 1=1 <if test="sbzt!='' and sbzt!= null ">and sbzt=#{sbzt}</if>
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">and sbzt=#{sbzt1}</if>
		<if test="shzt!='' and shzt!= null ">
			and shzt=#{shzt}
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="jsjsdj!='' and jsjsdj!= null ">and ${jsjsdj}</if>
		<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%1___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
	</select>
	<select id="selectLmgzshList" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,xmklx,t.id,t.xmmc,t.xmbm,to_char(sbzt) sbzt1,t.shzt,t.xmnf,t.xzqhdm,t.gydwdm,t.sbthcd,t.thyy,
		t.lsjl,t.ghlxbh,t.gydw,t.xzqh,t.tz,t.bzys,t.dfzc,t.tsdq ,lx.*,lxs.lc,sl.xmsl,t.jhkgn,t.jhwgn,t.yhdk,t.bz,t.jsxz,t.lxmc,t.wnid,t.sfbflx,sl.zlc jszlc from LXSH_LMGZ t left join 
		(select xmid,qdzh minqdzh,zdzh maxzdzh,qdmc,zdmc,xjsdj,jsjsdj,yilc,erlc,sanlc,silc,dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,
		jhdwlc,jhwllc,decode(substr(xmid,11,1),'3',xjlxbm,ghlxbm) ghlxbm,ghlxmc,decode(substr(xmid,11,1),'3',xjqdzh,ghqdzh) ghqdzh,decode(substr(xmid,11,1),'3',xjzdzh,ghzdzh) ghzdzh,gxlxbm,gxqdzh,gxzdzh from lxsh_lx where jdbs='0' and sffirst='1'
		<if test="ghlxmc!='' and ghlxmc!= null ">and ghlxmc=#{ghlxmc}</if>
		) lx on t.xmbm=lx.xmid 
		left join (select  xmid,jsxz,
		        (case when jsxz like '%改建%' then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
	            when jsxz like '%新建%' then xjlc
	            else to_char(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) end) lc
	            from lxsh_lx where jdbs='0' and sffirst='1' ) lxs 
		        on t.xmbm=lxs.xmid
		
		left join ( select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='0' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1 <if test="sbzt!='' and sbzt!= null ">and sbzt=#{sbzt}</if>
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">and sbzt=#{sbzt1}</if>
		<if test="shzt!='' and shzt!= null ">
			and shzt=#{shzt}
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="jsjsdj!='' and jsjsdj!= null ">and ${jsjsdj}</if>
		<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%2___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
		
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
	</select>
	<select id="selectLmgzshListCount" parameterType="lxsh" resultType="int">
		select count(t.xmbm) from LXSH_LMGZ t left join (select xmid,lxbm,lc,xjsdj,jsjsdj
		from lxsh_lx where jdbs='0' and sffirst='1'
		<if test="ghlxmc!='' and ghlxmc!= null ">and ghlxmc=#{ghlxmc}</if>
		) lx on t.xmbm=lx.xmid where 1=1 <if test="sbzt!='' and sbzt!= null ">and sbzt=#{sbzt}</if>
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">and sbzt=#{sbzt1}</if>
		<if test="shzt!='' and shzt!= null ">
			and shzt=#{shzt}
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="jsjsdj!='' and jsjsdj!= null ">and ${jsjsdj}</if>
		<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%2___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
		
	</select>
	
	<select id="selectXjshList" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,xmklx,t.id,t.xmmc,t.xmbm,to_char(sbzt) sbzt1,t.shzt,t.xmnf,t.xzqhdm,t.gydwdm,t.sbthcd,sl.xmsl sl,sl.zlc jszlc,(nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) xjlc,t.thyy,
		t.lsjl,t.ghlxbh,t.gydw,t.xzqh,t.tz,t.bzys,t.dfzc,t.tsdq ,lx.*,t.jhkgn,t.jhwgn,t.yhdk,t.bz,t.jsxz,t.lxmc,t.wnid,t.sfbflx from LXSH_XJ t left join 
		(select xmid,lxbm,qdzh minqdzh,zdzh maxzdzh,qdmc,zdmc,lc,xjsdj,jsjsdj,yilc,erlc,sanlc,silc,dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,decode(substr(xmid,11,1),'3',xjlxbm,ghlxbm) ghlxbm,ghlxmc,decode(substr(xmid,11,1),'3',xjqdzh,ghqdzh) ghqdzh,decode(substr(xmid,11,1),'3',xjzdzh,ghzdzh) ghzdzh,gxlxbm,gxqdzh,gxzdzh  from lxsh_lx where jdbs='0' and sffirst='1'
		) lx on t.xmbm=lx.xmid
		left join ( select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='0' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1 <if test="sbzt!='' and sbzt!= null ">and sbzt=#{sbzt}</if>
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">and sbzt=#{sbzt1}</if>
		<if test="shzt!='' and shzt!= null ">
			and shzt=#{shzt}
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="jsjsdj!='' and jsjsdj!= null ">and ${jsjsdj}</if>
		<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%3___' and ${gldj})</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
		
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
	</select>
	<select id="selectXjshListCount" parameterType="lxsh" resultType="int">
		select count(t.xmbm) from LXSH_XJ t left join (select xmid,lxbm,lc,xjsdj,jsjsdj
		from lxsh_lx where jdbs='0' and sffirst='1'
		<if test="ghlxmc!='' and ghlxmc!= null ">and ghlxmc=#{ghlxmc}</if>
		) lx on t.xmbm=lx.xmid 
		where 1=1 <if test="sbzt!='' and sbzt!= null ">and sbzt=#{sbzt}</if>
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">and sbzt=#{sbzt1}</if>
		<if test="shzt!='' and shzt!= null ">
			and shzt=#{shzt}
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="jsjsdj!='' and jsjsdj!= null ">and ${jsjsdj}</if>
		<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%3___' and ${gldj})</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
		
	</select>
	<delete id="delSjgz" parameterType="hashmap">
		delete from LXSH_SJGZ where xmbm=#{xmbm}
	</delete>
	<update id="delwnsjgz" parameterType="lxsh">
		update wnjh_sjgz set QQKZZT = '未开展' where id in (${wnid})
<!-- 		id=(select wnid from LXSH_SJGZ where xmbm=#{xmbm}) -->
	</update>
	<delete id="delLmgz" parameterType="hashmap">
		delete from LXSH_LMGZ where xmbm=#{xmbm}
	</delete>
	<update id="delwnlm" parameterType="String">
		update wnjh_lmgz set QQKZZT = '未开展' where id=(select wnid from LXSH_LMGZ where xmbm=#{xmbm})
	</update>
	<delete id="delXj" parameterType="hashmap">
		delete from LXSH_XJ where xmbm=#{xmbm}
	</delete>
	<update id="delwnxj" parameterType="String">
		update wnjh_xj set QQKZZT = '未开展' where id=(select wnid from LXSH_xj where xmbm=#{xmbm})
	</update>
	<delete id="delSjgzlx" parameterType="hashmap">
		delete from LXSH_LX where xmid=#{xmbm}
	</delete>
	<update id="shsjgzSbzt" parameterType="hashmap">
		update LXSH_SJGZ set shzt=1 where id=#{id}
	</update>
	<update id="shlmgzSbzt" parameterType="hashmap">
		update LXSH_LMGZ set shzt=1 where id=#{id}
	</update>
	<update id="shxjSbzt" parameterType="hashmap">
		update LXSH_XJ set shzt=1 where id=#{id}
	</update>
	<select id="queryshsjgz" parameterType="string" resultType="lxsh">
		select * from LXSH_SJGZ where ${value}
	</select>
	<select id="queryshlmgz" parameterType="string" resultType="lxsh">
		select * from LXSH_LMGZ where ${value}
	</select>
	<select id="queryshxj" parameterType="string" resultType="lxsh">
		select * from LXSH_XJ where ${value}
	</select>
	<insert id="insertsjgzkxx" parameterType="lxsh">
		insert into kxxyj_sjgz(id,xmmc,xmbm,xzqh,xzqhdm,qdzh,zdzh,jsjsdj,jsxz,yhdk,dfzc,jszlc,gydw1,gydwdm1,tzgs)
		select sys_guid(),xmmc,xmbm,xzqh,xzqhdm2,qdzh,zdzh,jsjsdj,jsxz,yhdk,dfzc,jszlc,gydw,gydwdm,tz from lxsh_sjgz where xmbm=#{xmbm}
	</insert>
	<insert id="insertlmgzkxx" parameterType="lxsh">
		insert into kxxyj_lmgz(id,xmmc,xmbm,xzqh,xzqhdm,qdzh,zdzh,jsjsdj,jsxz,yhdk,dfzc,gydw1,gydwdm1,tzgs)
		select sys_guid(),xmmc,xmbm,xzqh,xzqhdm2,qdzh,zdzh,jsjsdj,jsxz,yhdk,dfzc,gydw,gydwdm,tz from lxsh_lmgz where xmbm=#{xmbm}
	</insert>
	<insert id="insertxjkxx" parameterType="lxsh">
		insert into kxxyj_xj(id,xmmc,xmbm,xzqh,xzqhdm,qdzh,zdzh,jsjsdj,jsxz,yhdk,dfzc,gydw1,gydwdm1,tzgs)
		select sys_guid(),xmmc,xmbm,xzqh,xzqhdm2,qdzh,zdzh,jsjsdj,jsxz,yhdk,dfzc,gydw,gydwdm,tz from lxsh_xj where xmbm=#{xmbm}
	</insert>
	<select id="selectLmgzList" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.id,t.xmmc,t.xmbm,to_char(sbzt) sbzt1,t.xmnf,t.xzqhdm,t.gydwdm,t.sbthcd,
		t.lsjl,t.ghlxbh,t.gydw,t.xzqh,t.tz,t.bzys,t.dfzc,t.tsdq ,lx.*,sl.xmsl,sl.zlc jszlc from LXSH_LMGZ t left join 
		(select xmid,qdzh minqdzh,zdzh maxzdzh,qdmc,zdmc,lc,xjsdj,jsjsdj,yilc,erlc,sanlc,silc,dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,
		jhdwlc,jhwllc,decode(substr(xmid,11,1),'3',xjlxbm,ghlxbm) ghlxbm,ghlxmc,decode(substr(xmid,11,1),'3',xjqdzh,ghqdzh) ghqdzh,decode(substr(xmid,11,1),'3',xjzdzh,ghzdzh) ghzdzh,gxlxbm,gxqdzh,gxzdzh from lxsh_lx where jdbs='0' and sffirst='1') lx on t.xmbm=lx.xmid 
		left join ( select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='0' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1 and sbthcd &lt;=#{sbthcd}
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%2___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
	</select>
	<select id="selectLmgzListCount" parameterType="lxsh" resultType="int">
		select count(t.xmbm) from LXSH_LMGZ t left join (select xmid,lxbm,lc,xjsdj,jsjsdj
		from lxsh_lx where jdbs='0' and sffirst='1') lx on t.xmbm=lx.xmid where 1=1 and  sbthcd &lt;=#{sbthcd}
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%2___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
	</select>
	
	<select id="selectXjList" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.id,t.xmmc,t.xmbm,to_char(sbzt) sbzt1,t.xmnf,t.xzqhdm,t.gydwdm,t.sbthcd,
		t.lsjl,t.ghlxbh,t.gydw,t.xzqh,t.tz,t.bzys,t.dfzc,t.tsdq ,lx.*,sl.xmsl,sl.zlc jszlc from LXSH_XJ t left join 
		(select xmid,qdzh minqdzh,zdzh maxzdzh,qdmc,zdmc,lc,xjsdj,jsjsdj,yilc,erlc,sanlc,silc,dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,
		jhdwlc,jhwllc,decode(substr(xmid,11,1),'3',xjlxbm,ghlxbm) ghlxbm,ghlxmc,decode(substr(xmid,11,1),'3',xjqdzh,ghqdzh) ghqdzh,decode(substr(xmid,11,1),'3',xjzdzh,ghzdzh) ghzdzh,gxlxbm,gxqdzh,gxzdzh from lxsh_lx where jdbs='0' and sffirst='1') lx on t.xmbm=lx.xmid
		left join ( select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='0' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1 and  sbthcd &lt;=#{sbthcd}
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%3___' and ${gldj})</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
	</select>
	<select id="selectXjListCount" parameterType="lxsh" resultType="int">
		select count(t.xmbm) from LXSH_XJ t left join (select xmid,lxbm,lc,xjsdj,jsjsdj
		from lxsh_lx where jdbs='0' and sffirst='1') lx on t.xmbm=lx.xmid 
		where 1=1 and  sbthcd &lt;=#{sbthcd}
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%3___' and ${gldj})</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
	</select>
	<select id="Lmgzsfkxx" parameterType="string" resultType="lxsh">
		select * from kxxyj_lmgz where 1=1 and ${value} and sbthcd is not null
	</select>
	<select id="sjgzsfkxx" parameterType="string" resultType="lxsh">
		select * from kxxyj_sjgz where 1=1 and ${value} and sbthcd is not null
	</select>
	<select id="Xjsfkxx" parameterType="string" resultType="lxsh">
		select * from kxxyj_xj where 1=1 and ${value} and sbthcd is not null
	</select>
	<select id="qqglGpsroad" parameterType="hashmap" resultType="lxsh">
		select t.*,ll.gpsqdzh,ll.gpszdzh,ll.ghlxbm,ll.ghlxmc,ll.ghqdzh,ll.ghzdzh,ll.gxlxbm,ll.gxqdzh,ll.gxzdzh,ll.lc JSZLC,ll.xjlc,ll.id lxid 
		from ${xmlx} t left join (select * from wnjh_lx l where sffirst=1) ll on t.id=ll.xmid 
		where  qqkzzt !='已开展' and znsjck is null
		<if test="xmmc!=null and xmmc!=''">
		and xmmc like '%'||#{xmmc}||'%' 
		</if>
		<if test="xzqh!=null and xzqh!=''">
		and xzqhdm2 like '%'||#{xzqh}||'%' 
		</if>
		<if test="xmbm!=null and xmbm!=''">
		  and xmbm in (${xmbm})
		</if>
	</select>
	<update id="updatesjgz" parameterType="lxsh">
		update lxsh_sjgz set <!-- bzys=#{bzys}, -->lc=#{lc},dfzc=(tz-#{bzys}) where xmbm=#{xmbm}
	</update>
	<update id="updatelmgz" parameterType="lxsh">
		update lxsh_lmgz set bzys=#{bzys},lc=#{lc},dfzc=(tz-#{bzys}) where xmbm=#{xmbm}
	</update>
	<update id="updatexj" parameterType="lxsh">
		update lxsh_xj set bzys=#{bzys},lc=#{lc},dfzc=(tz-#{bzys}) where xmbm=#{xmbm}
	</update>
	<delete id="deleteLx" parameterType="lxsh">
		delete from lxsh_lx where xmid=#{xmbm} and id=#{id} 
	</delete>
	<select id="cxqdmc" parameterType="lxsh" resultType="lxsh">
		select min(f006) qdmc from gpsroad g,
       (SELECT MIN(ABS(ROADSTART- to_number(#{qdzh}))) a FROM gpsroad where SUBSTR(roadcode,1,4) = #{ghlxbh}) t
       where SUBSTR(g.roadcode,1,4) = #{ghlxbh} and (g.roadstart=to_number(#{qdzh})+t.a or g.roadstart=to_number(#{qdzh})-t.a )
	</select>
	<select id="cxzdmc" parameterType="lxsh" resultType="lxsh">
		select min(f010) zdmc from gpsroad g,
       (SELECT MIN(ABS(ROADENDS-to_number(#{qdzh}))) a FROM gpsroad where SUBSTR(roadcode,1,4) = #{ghlxbh}) t
       where SUBSTR(g.roadcode,1,4) = #{ghlxbh} and (g.ROADENDS=to_number(#{qdzh})+t.a or g.ROADENDS=to_number(#{qdzh})-t.a )
	</select>
	<delete id="deletekxlx" parameterType="hashmap">
		delete from lxsh_lx where xmid=#{xmbm} and jdbs='1'
	</delete>
	<select id="selectlxbyxmid" parameterType="lxsh" resultType="lxsh">
		select * from lxsh_lx where xmid=#{xmbm} and jdbs='0' and sffirst='1'
	</select>
	<select id="sfylx" parameterType="lxsh" resultType="lxsh">
		select count(*) shzt from lxsh_lx where xmid=#{xmbm} and jdbs=#{jdbs} and sffirst='0'
	</select>
	<select id="qqglGpszh" parameterType="lxsh" resultType="lxsh">
		select gpsqdzh qdzh,gpszdzh zdzh from  lxsh_lx where lxbm=#{ghlxbh} and xmid=#{xmbm} and jdbs='0' and sffirst='1'
	</select>
	<select id="selectlxbyxmid1" parameterType="lxsh" resultType="lxsh">
		select * from lxsh_lx where xmid=#{xmbm} and jdbs=#{jdbs}
	</select>
	
	<select id="querylxshSjgz" parameterType="lxsh" resultType="elist">
		select decode(lx.sffirst,'1',t.xmbm,'') v_0,decode(lx.sffirst,'1',t.xmmc,'') v_1,lx.lxbm v_2,lx.lxmc v_3,lx.qdzh v_4,lx.zdzh v_5,lx.ghlxbm v_6,lx.ghlxmc v_7,lx.ghqdzh v_8,lx.ghzdzh v_9,
		lx.gxlxbm v_10,lx.gxqdzh v_11,lx.gxzdzh v_12,lx.qdmc v_13,lx.zdmc v_14,lx.jsxz v_15,lx.gydw v_16,lx.xzqh v_17,t.tsdq v_18,lx.jsjsdj v_19,
		lx.xjsdj v_20,substr(t.xmbm,0,4) v_21,t.jhkgn v_22,t.jhwgn v_23,t.tz v_24,lx.bzcs v_25
		from LXSH_SJGZ t right join
		(select * from lxsh_lx where 1=1 and jdbs='0' order by sffirst desc) lx on t.xmbm=lx.xmid where 1=1
<!-- 		and sbthcd &lt;=#{sbthcd} -->
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%1___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="jsjsdj !='' and jsjsdj !=null">
			${jsjsdj}
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		order by t.xmbm desc
	</select>
	<select id="querylxshLmgz" parameterType="lxsh" resultType="elist">
		select decode(lx.sffirst,'1',t.xmbm,'') v_0,decode(lx.sffirst,'1',t.xmmc,'') v_1,lx.lxbm v_2,lx.lxmc v_3,lx.qdzh v_4,lx.zdzh v_5,lx.ghlxbm v_6,lx.ghlxmc v_7,lx.ghqdzh v_8,lx.ghzdzh v_9,
		lx.gxlxbm v_10,lx.gxqdzh v_11,lx.gxzdzh v_12,lx.qdmc v_13,lx.zdmc v_14,lx.jsxz v_15,lx.gydw v_16,lx.xzqh v_17,t.tsdq v_18,lx.jsjsdj v_19,
		lx.xjsdj v_20,substr(t.xmbm,0,4) v_21,t.jhkgn v_22,t.jhwgn v_23,t.tz v_24,lx.bzcs v_25
		from LXSH_LMGZ t right join
		(select * from lxsh_lx where 1=1 and jdbs='0' order by sffirst desc) lx on t.xmbm=lx.xmid where 1=1
<!-- 		and sbthcd &lt;=#{sbthcd} -->
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%2___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="jsjsdj !='' and jsjsdj !=null">
			${jsjsdj}
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		order by t.xmbm desc
	</select>
	<select id="querylxshXj" parameterType="lxsh" resultType="elist">
		select decode(lx.sffirst,'1',t.xmbm,'') v_0,decode(lx.sffirst,'1',t.xmmc,'') v_1,lx.lxbm v_2,lx.lxmc v_3,lx.qdzh v_4,lx.zdzh v_5,lx.ghlxbm v_6,lx.ghlxmc v_7,lx.ghqdzh v_8,lx.ghzdzh v_9,
		lx.gxlxbm v_10,lx.gxqdzh v_11,lx.gxzdzh v_12,lx.qdmc v_13,lx.zdmc v_14,lx.jsxz v_15,lx.gydw v_16,lx.xzqh v_17,t.tsdq v_18,lx.jsjsdj v_19,
		lx.xjsdj v_20,substr(t.xmbm,0,4) v_21,t.jhkgn v_22,t.jhwgn v_23,t.tz v_24,lx.bzcs v_25
		from LXSH_XJ t,
		(select * from lxsh_lx where 1=1 and jdbs='0' order by sffirst desc) lx  where 1=1 and t.xmbm(+)=lx.xmid
<!-- 		and sbthcd &lt;=#{sbthcd} -->
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%3___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="jsjsdj !='' and jsjsdj !=null">
			${jsjsdj}
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		order by t.xmbm desc
	</select>
	
	<select id="querykxxSjgz" parameterType="lxsh" resultType="elist">
		select decode(lx.sffirst,'1',t.xmbm,'') v_0,decode(lx.sffirst,'1',t.xmmc,'') v_1,
		lx.xzqh v_2,lx.lxbm v_3,lx.lxmc v_4,lx.qdzh v_5,lx.zdzh v_6,
		lx.ghlxbm v_7,lx.ghlxmc v_8,lx.ghqdzh v_9,lx.ghzdzh v_10,
		lx.gxlxbm v_11,lx.gxqdzh v_12,lx.gxzdzh v_13,
		lx.lc v_14,lx.yilc v_15,lx.erlc v_16,lx.sanlc v_17,lx.silc v_18,lx.dwlc v_19,lx.wllc v_20,
		lx.jhyilc v_21,lx.jherlc v_22,lx.jhsanlc v_23,lx.jhsilc v_24,lx.jhdwlc v_25,lx.jhwllc v_26,
		lx.jsxz v_27,t.dq_m v_28,t.dq v_29,t.jsjsdj v_30,
		t.sd_m v_31,t.sd v_32,t.kgny v_33,t.wgny v_34,t.bzdw v_35,decode(lx.sffirst,'1',t.tzgs,'') v_36,decode(lx.sffirst,'1',t.dfzc,'') v_37,
		decode(lx.sffirst,'1',t.yhdk,'') v_38,decode(lx.sffirst,'1',t.gkpfwh,'') v_39,decode(lx.sffirst,'1',t.pfsj,'') v_40 
		
		from KXXYJ_SJGZ t right join
		(select * from lxsh_lx where 1=1 and jdbs='1' ) lx on t.xmbm=lx.xmid where 1=1
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and t.xmbm in (select xmid from lxsh_lx where jdbs='1' and xmid like '%1___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="jsjsdj !='' and jsjsdj !=null">
			${jsjsdj}
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		order by t.xmbm desc, lx.sffirst desc
	</select>
	<select id="querykxxLmgz" parameterType="lxsh" resultType="elist">
		select decode(lx.sffirst,'1',t.xmbm,'') v_0,decode(lx.sffirst,'1',t.xmmc,'') v_1,
		lx.xzqh v_2,lx.lxbm v_3,lx.lxmc v_4,lx.qdzh v_5,lx.zdzh v_6,
		lx.ghlxbm v_7,lx.ghlxmc v_8,lx.ghqdzh v_9,lx.ghzdzh v_10,
		lx.gxlxbm v_11,lx.gxqdzh v_12,lx.gxzdzh v_13,
		lx.lc v_14,lx.yilc v_15,lx.erlc v_16,lx.sanlc v_17,lx.silc v_18,lx.dwlc v_19,lx.wllc v_20,
		lx.jhyilc v_21,lx.jherlc v_22,lx.jhsanlc v_23,lx.jhsilc v_24,lx.jhdwlc v_25,lx.jhwllc v_26,
		lx.jsxz v_27,t.dq_m v_28,t.dq v_29,t.jsjsdj v_30,
		t.sd_m v_31,t.sd v_32,t.kgny v_33,t.wgny v_34,t.bzdw v_35,decode(lx.sffirst,'1',t.tzgs,'') v_36,decode(lx.sffirst,'1',t.dfzc,'') v_37,
		decode(lx.sffirst,'1',t.yhdk,'') v_38,decode(lx.sffirst,'1',t.gkpfwh,'') v_39,decode(lx.sffirst,'1',t.pfsj,'') v_40 
		from KXXYJ_LMGZ t right join (select * from lxsh_lx where 1=1 and jdbs='1') lx on t.xmbm=lx.xmid where 1=1
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and t.xmbm in (select xmid from lxsh_lx where jdbs='1' and xmid like '%2___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl like '%'||#{lsjl}||'%'
		</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="jsjsdj !='' and jsjsdj !=null">
			${jsjsdj}
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		order by t.xmbm desc,lx.sffirst desc
	</select>
	<select id="querykxxXj" parameterType="lxsh" resultType="elist">
		select decode(lx.sffirst,'1',t.xmbm,'') v_0,decode(lx.sffirst,'1',t.xmmc,'') v_1,lx.xzqh v_2,lx.lxbm v_3,lx.qdzh v_4,lx.zdzh v_5,lx.lc v_6,lx.xjlxbm v_7,lx.xjqdzh v_8,lx.xjzdzh v_9,lx.xjlc v_10,
		lx.yilc v_11,lx.erlc v_12,lx.sanlc v_13,lx.silc v_14,lx.dwlc v_15,lx.wllc v_16,'新建' v_17,t.dq_m v_18,t.dq v_19,t.jsjsdj v_20,t.sd_m v_21,t.sd v_22,
		t.kgny v_23,t.wgny v_24,t.bzdw v_25,decode(lx.sffirst,'1',t.tzgs,'') v_26,decode(lx.sffirst,'1',t.dfzc,'') v_27,decode(lx.sffirst,'1',t.yhdk,'') v_28,decode(lx.sffirst,'1',t.gkpfwh,'') v_29,decode(lx.sffirst,'1',t.pfsj,'') v_30 
		from KXXYJ_XJ t right join
		(select * from lxsh_lx where 1=1 and jdbs='1' ) lx on t.xmbm=lx.xmid where 1=1
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and t.xmbm in (select xmid from lxsh_lx where jdbs='1' and xmid like '%3___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl like '%'||#{lsjl}||'%'
		</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="jsjsdj !='' and jsjsdj !=null">
			${jsjsdj}
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		order by t.xmbm desc,lx.sffirst desc
	</select>
	<insert id="importsjgzlxsh" parameterType="hashMap">
		insert into LXSH_SJGZ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm)
		values(sys_guid(),#{2},#{3},#{1},to_char(to_number(#{5})-to_number(#{4})),#{20},#{4},#{5},#{6},#{7},#{26},#{27},#{24},#{25},#{xmbm},#{28},#{bzys},to_char(to_number(#{28})-to_number(#{bzys})),#{22},#{21},(select id from XTGL_XZQH where trim(name) = #{22}),(select id from XTGL_DEPARTMENT where trim(name) = #{21}),substr(#{xmbm},0,4),'9',(select id from XTGL_DEPARTMENT where trim(name) = #{21}))
	</insert>
	<insert id="importlmgzlxsh" parameterType="hashMap">
		insert into LXSH_LMGZ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm)
		values(sys_guid(),#{2},#{3},#{1},to_char(to_number(#{5})-to_number(#{4})),#{14},#{4},#{5},#{6},#{7},#{20},#{21},#{18},#{19},#{xmbm},#{22},#{bzys},to_char(to_number(#{22})-to_number(#{bzys})),#{16},#{15},(select id from XTGL_XZQH where trim(name) = #{16}),(select id from XTGL_DEPARTMENT where trim(name) = #{15}),substr(#{xmbm},0,4),'9',(select id from XTGL_DEPARTMENT where trim(name) = #{15}))
	</insert>
	<insert id="importlmgzlxshlx" parameterType="hashMap">
		insert into LXSH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh,
		yilc,erlc,sanlc,silc,dwlc,wllc)
		values(sys_guid(),#{xmbm},#{1},#{2},#{16},(select id from XTGL_XZQH where trim(name) = #{16}),#{15},(select id from XTGL_DEPARTMENT where trim(name) = #{15}),#{4},#{5},#{18},to_char(to_number(#{5})-to_number(#{4})),#{19},#{14},#{6},#{7},#{bzys},'1','0',#{4},#{5},
		#{8},#{9},#{10},#{11},#{12},#{13})
	</insert>
	<insert id="importxjlxsh" parameterType="hashMap">
		insert into LXSH_XJ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,
		yhdk)
		values(sys_guid(),#{2},#{3},#{1},to_char(to_number(#{5})-to_number(#{4})),#{18},#{4},#{5},#{6},#{7},#{24},#{25},#{22},#{23},#{xmbm},#{26},#{27},to_char(to_number(#{26})-to_number(#{27})),#{20},#{19},(select id from XTGL_XZQH where trim(name) = #{20}),(select id from XTGL_DEPARTMENT where trim(name) = #{19}),substr(#{xmbm},0,4),'9',(select id from XTGL_DEPARTMENT where trim(name) = #{19}),
		#{28})
	</insert>
	<insert id="importxjlxshlx" parameterType="hashMap">
		insert into LXSH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh,
		xjlxbm,xjqdzh,xjzdzh,xjlc,yilc,erlc,sanlc,silc,dwlc,wllc)
		values(sys_guid(),#{xmbm},#{1},#{2},#{20},(select id from XTGL_XZQH where trim(name) = #{20}),#{19},(select id from XTGL_DEPARTMENT where trim(name) = #{19}),#{4},#{5},#{22},to_char(to_number(#{5})-to_number(#{4})),#{23},#{18},#{6},#{7},#{bzys},'1','0',#{4},#{5},
		#{8},#{9},#{10},#{11},#{12},#{13},#{14},#{15},#{16},#{17})
	</insert>
	<insert id="importsjgzlxshlx" parameterType="hashMap">
		insert into LXSH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh,
		yilc,erlc,sanlc,silc,dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc)
		values(sys_guid(),#{xmbm},#{1},#{2},#{22},(select id from XTGL_XZQH where trim(name) = #{22}),#{21},(select id from XTGL_DEPARTMENT where trim(name) = #{21}),#{4},#{5},#{24},to_char(to_number(#{5})-to_number(#{4})),#{25},#{20},#{6},#{7},#{bzys},'1','0',#{4},#{5},
		#{8},#{9},#{10},#{11},#{12},#{13},#{14},#{15},#{16},#{17},#{18},#{19})
	</insert>
	
	<select id="selectWqbzbz" resultType="wqbzbz">
		select t.* from xtgl_wqbzbz t order by decode(t.bzjb,'省级',1,'市级',2),decode(t.qllx,'特大桥',1,'大桥',2,'中桥',3,'小桥',4),decode(t.jsxz,'拆除重建',1,'加固改造',2)
	</select>
	<insert id="tjwqbzbz" parameterType="wqbzbz">
		insert into xtgl_wqbzbz (id,qllx,jsxz,jsdj,bzje,zdkd,bzjb,jsdj1)
		values(sys_guid(),#{qllx},#{jsxz},#{jsdj},#{bzje},#{zdkd},#{bzjb},#{jsdj1})
	</insert>
	<insert id="xgwqbzbz" parameterType="wqbzbz">
		update xtgl_wqbzbz
		set qllx=#{qllx},jsxz=#{jsxz},jsdj=#{jsdj},bzje=#{bzje},zdkd=#{zdkd},bzjb=#{bzjb},jsdj1=#{jsdj1}
		where id=#{id}
	</insert>
	<delete id="delwqbzbz" parameterType="wqbzbz">
		delete from xtgl_wqbzbz where id=#{id}
	</delete>
	<select id="queryXmQqfx" parameterType="java.util.Map" resultType="kxxyj">
		select distinct * from table(funlxjdbs('','')) 
		where xmbm like to_char(sysdate,'yyyy')||'%'
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="shzt!=null and shzt!=''">and shzt = #{shzt}</if>
		<if test="jsxz!=null and jsxz!=''">and jsxz = #{jsxz}</if>
		<if test="lxbm!=null and lxbm!=''">and lxbm like '%'||#{lxbm}||'%' </if>
		<if test="wgny!=null and wgny!=''">and wgny like #{wgny}||'%'</if>
		<if test="xmbm!=null and xmbm!=''">and xmbm in (${xmbm})</if>
		order by xmbm
	</select>
	<select id="queryBeformXm" parameterType="java.util.Map" resultType="java.util.Map">
		select substr(roadcode,1,4) roadcode,min(roadstart) roadstart,max(roadends) roadends,max(decode(f026,null,f025,f026)) wgnf,
		sum(roadlen) lc,sum(decode(f014,2,roadlen,0)) yj,sum(decode(f014,3,roadlen,0)) ej,sum(decode(f014,4,roadlen,0)) Sj,
		sum(decode(f014,5,roadlen,0)) SIj,sum(decode(f014,6,roadlen,0)) WL
		from gpsroad  WHERE substr(roadcode,1,4) in(${lxbm}) group by substr(roadcode,1,4)
	</select>
	<select id="queryBeformXmByXzqh" parameterType="java.util.Map" resultType="java.util.Map">
		select substr(roadcode,0,1) roadcode,min(roadstart) roadstart,max(roadends) roadends,max(decode(f026,null,f025,f026)) wgnf,
	    sum(roadlen) lc,sum(decode(f014,2,roadlen,0)) yj,sum(decode(f014,3,roadlen,0)) ej,sum(decode(f014,4,roadlen,0)) Sj,
	    sum(decode(f014,5,roadlen,0)) SIj,sum(decode(f014,6,roadlen,0)) WL,#{xzqhmc} xzqhmc
	    from gpsroad  WHERE substr(roadcode,0,1) in('S','G') and (roadcode like '%'||#{xzqhdm}||'%') group by substr(roadcode,0,1)
	</select>
	<select id="queryNdwg" parameterType="java.util.Map" resultType="java.util.Map">
		select xmid,lxbm
		,decode(substr(xmid,11,1),1,sum(l.yilc),3,0) yilc
		,decode(substr(xmid,11,1),1,sum(l.erlc),3,0) erlc
		,decode(substr(xmid,11,1),1,sum(l.sanlc),3,0) sanlc
		,decode(substr(xmid,11,1),1,sum(l.silc),3,0) silc
		,decode(substr(xmid,11,1),1,sum(l.dwlc),3,0) dwlc
		,decode(substr(xmid,11,1),1,sum(l.wllc),3,0) wllc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhyilc),0),3,nvl(sum(l.yilc),0)) jhyilc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jherlc),0),3,nvl(sum(l.erlc),0)) jherlc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhsanlc),0),3,nvl(sum(l.sanlc),0)) jhsanlc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhsilc),0),3,nvl(sum(l.silc),0)) jhsilc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhdwlc),0),3,nvl(sum(l.dwlc),0)) jhdwlc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhwllc),0),3,nvl(sum(l.wllc),0)) jhwllc
		from lxsh_lx l where ${xmbm} group by xmid,lxbm 
	</select>
	<select id="queryNdwgXzqh" parameterType="java.util.Map" resultType="java.util.Map">
		select 
		<if test="qb==false">substr(xmid,5,6) xzqhdm,</if>
		<if test="qb==true">'江西省' xzqhmc,</if>
		substr(lxbm,0,1) lxbm
		,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,sum(dwlc) dwlc,sum(wllc) wllc
		,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(sanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc 
		from(select xmid,lxbm
		,decode(substr(xmid,11,1),1,l.yilc,3,0) yilc,decode(substr(xmid,11,1),1,l.erlc,3,0) erlc
		,decode(substr(xmid,11,1),1,l.sanlc,3,0) sanlc,decode(substr(xmid,11,1),1,l.silc,3,0) silc
		,decode(substr(xmid,11,1),1,l.dwlc,3,0) dwlc,decode(substr(xmid,11,1),1,l.wllc,3,0) wllc
		,decode(substr(xmid,11,1),1,nvl(l.jhyilc,0),3,nvl(l.yilc,0)) jhyilc,decode(substr(xmid,11,1),1,nvl(l.jherlc,0),3,nvl(l.erlc,0)) jherlc
		,decode(substr(xmid,11,1),1,nvl(l.jhsanlc,0),3,nvl(l.sanlc,0)) jhsanlc,decode(substr(xmid,11,1),1,nvl(l.jhsilc,0),3,nvl(l.silc,0)) jhsilc
		,decode(substr(xmid,11,1),1,nvl(l.jhdwlc,0),3,nvl(l.dwlc,0)) jhdwlc,decode(substr(xmid,11,1),1,nvl(l.jhwllc,0),3,nvl(l.wllc,0)) jhwllc
		from lxsh_lx l where substr(lxbm,0,1) in('S','G') and (${xmbm})) 
		group by <if test="qb==false">substr(xmid,5,6),</if>substr(lxbm,0,1)
	</select>
	<select id="queryLxshLjLmsj" resultType="java.util.Map" parameterType="lxsh">
    	select count(xmbm) xmsl,sum(tz) tz,sum(lc) lc,sum(bzcs) bzcs,(sum(tz)-sum(bzcs)) dftz,'0' sbz,'0' sjl from(
			select t.xmbm,t.tz ,sum(lx.lc) lc,sum(lx.bzcs) bzcs from LXSH_SJGZ t left join 
			(select xmid,(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)) lc,xjsdj,jsjsdj,lxbm,bzcs from lxsh_lx where jdbs='0' ) lx 
			on t.xmbm=lx.xmid where 1=1 and sbthcd &lt;=#{sbthcd}
			<if test="gydw!='' and gydw!= null ">${gydw}</if>
			<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
			<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		
			<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
			<if test="sbzt1!='' and sbzt1!= null ">
				and to_char(sbzt) like '%'||#{sbzt1}||'%'
			</if>
			<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
			<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
			<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%1___' and ${gldj})</if>
			<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
			<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
			<if test="lxmc !='' and lxmc != null ">
				and lxmc like '%'||#{lxmc}||'%'
			</if>
			<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
			group by xmbm,tz
		)
	</select>
	<select id="queryLxshShLjLmsj" resultType="java.util.Map" parameterType="lxsh">
    	select count(xmbm) xmsl,sum(tz) tz,sum(lc) lc,sum(bzcs) bzcs 
    	from(
			select t.xmbm,t.tz ,sum(lx.lc) lc,sum(lx.bzcs) bzcs,(sum(tz)-sum(bzcs)) dftz,'0' sbz,'0' sjl 
			from LXSH_SJGZ t left join 
			(select xmid,(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)) lc,xjsdj,jsjsdj,lxbm,bzcs 
			from lxsh_lx where jdbs='0' 
			<if test="ghlxmc!='' and ghlxmc!= null ">and ghlxmc=#{ghlxmc}</if>
			) lx 
			on t.xmbm=lx.xmid where 1=1 <if test="sbzt!='' and sbzt!= null ">and sbzt=#{sbzt}</if>
			<if test="gydw!='' and gydw!= null ">${gydw}</if>
			<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
			<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
			<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
			<if test="sbzt1!='' and sbzt1!= null ">and sbzt=#{sbzt1}</if>
			<if test="shzt!='' and shzt!= null ">
				and shzt=#{shzt}
			</if>
			<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
			<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
			<if test="jsjsdj!='' and jsjsdj!= null ">and ${jsjsdj}</if>
			<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%1___' and ${gldj})</if>
			<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
			<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
			group by xmbm,tz
		)
	</select>
	<select id="queryLxshLjLmgz" resultType="java.util.Map" parameterType="lxsh">
		select count(xmbm) xmsl,sum(tz) tz,sum(lc) lc,sum(bzcs) bzcs,(sum(tz)-sum(bzcs)) dftz,'0' sbz,'0' sjl from(
			select t.xmbm,t.tz ,sum(lx.lc) lc,sum(lx.bzcs) bzcs from LXSH_LMGZ t left join 
			(select xmid, sum((case when substr(xmid,11,1)='1' then to_number(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
					  else nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) 
					end)) lc, min(xjsdj) xjsdj, min(jsjsdj) jsjsdj, min(lxbm) lxbm, min(bzcs) bzcs from lxsh_lx where jdbs = '0' group by xmid ) lx 
			on t.xmbm=lx.xmid where 1=1 and sbthcd &lt;=#{sbthcd}
			<if test="gydw!='' and gydw!= null ">${gydw}</if>
			<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
			<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
			<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
			<if test="sbzt1!='' and sbzt1!= null ">
				and to_char(sbzt) like '%'||#{sbzt1}||'%'
			</if>
			<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
			<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
			<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%2___' and ${gldj})</if>
			<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
			
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
			group by xmbm,tz
		)
	</select>
	<select id="queryLxshShLjLmgz" resultType="java.util.Map" parameterType="lxsh">
		select count(xmbm) xmsl,sum(tz) tz,sum(lc) lc,sum(bzcs) bzcs,(sum(tz)-sum(bzcs)) dftz,'0' sbz,'0' sjl from(
			select t.xmbm,t.tz ,sum(lx.lc) lc,sum(lx.bzcs) bzcs,(sum(tz)-sum(bzcs)) dftz,'0' sbz,'0' sjl from LXSH_LMGZ t left join 
			(select xmid, sum((case when substr(xmid,11,1)='1' then to_number(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
					  else nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) 
					end)) lc, min(xjsdj) xjsdj, min(jsjsdj) jsjsdj, min(lxbm) lxbm, min(bzcs) bzcs 
			from lxsh_lx where jdbs = '0' 
			<if test="ghlxmc!='' and ghlxmc!= null ">and ghlxmc=#{ghlxmc}</if>
			
			group by xmid) lx 
			on t.xmbm=lx.xmid where 1=1  <if test="sbzt!='' and sbzt!= null ">and sbzt=#{sbzt}</if>
			<if test="gydw!='' and gydw!= null ">${gydw}</if>
			<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
			<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
			<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
			<if test="sbzt1!='' and sbzt1!= null ">and sbzt=#{sbzt1}</if>
			<if test="shzt!='' and shzt!= null ">
				and shzt=#{shzt}
			</if>
			<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
			<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
			<if test="jsjsdj!='' and jsjsdj!= null ">and ${jsjsdj}</if>
			<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%2___' and ${gldj})</if>
			<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
			<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
			group by xmbm,tz
		)
	</select>
	<select id="queryLxshLjXj" resultType="java.util.Map" parameterType="lxsh">
		select count(xmbm) xmsl,nvl(sum(tz),0) tz,nvl(sum(lc),0) lc,nvl(sum(bzcs),0) bzcs,(sum(tz)-sum(bzcs)) dftz,'0' sbz,'0' sjl from(
			select t.xmbm,t.tz ,sum(lx.lc) lc,sum(lx.bzcs) bzcs,(sum(tz)-sum(bzcs)) dftz,'0' sbz,'0' sjl from LXSH_XJ t left join 
			(select xmid, sum((case when substr(xmid,11,1)='1' then to_number(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
					  else nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) 
					end)) lc, min(xjsdj) xjsdj, min(jsjsdj) jsjsdj, min(lxbm) lxbm, min(bzcs) bzcs from lxsh_lx where jdbs = '0' group by xmid ) lx on t.xmbm=lx.xmid 
			where 1=1 and sbthcd &lt;=#{sbthcd}
			<if test="gydw!='' and gydw!= null ">${gydw}</if>
			<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
			<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
			<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
			<if test="sbzt1!='' and sbzt1!= null ">
				and to_char(sbzt) like '%'||#{sbzt1}||'%'
			</if>
			<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
			<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
			<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%3___' and ${gldj})</if>
			<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
			<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
			group by xmbm,tz
		)
	</select>
	<select id="queryLxshShLjXj" resultType="java.util.Map" parameterType="lxsh">
		select count(xmbm) xmsl,nvl(sum(tz),0) tz,nvl(sum(lc),0) lc,nvl(sum(bzcs),0) bzcs,(sum(tz)-sum(bzcs)) dftz,'0' sbz,'0' sjl from(
			select t.xmbm,t.tz ,sum(lx.lc) lc,sum(lx.bzcs) bzcs,(sum(tz)-sum(bzcs)) dftz,'0' sbz,'0' sjl from LXSH_XJ t left join 
			(select xmid, sum((case when substr(xmid,11,1)='1' then to_number(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
					  else nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) 
					end)) lc, min(xjsdj) xjsdj, min(jsjsdj) jsjsdj, min(lxbm) lxbm, min(bzcs) bzcs 
			from lxsh_lx where jdbs = '0' 
			<if test="ghlxmc!='' and ghlxmc!= null ">and ghlxmc=#{ghlxmc}</if>
		     group by xmid ) lx 
			on t.xmbm=lx.xmid where 1=1 <if test="sbzt!='' and sbzt!= null ">and sbzt=#{sbzt}</if>
			<if test="gydw!='' and gydw!= null ">${gydw}</if>
			<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
			<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
			<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
			<if test="sbzt1!='' and sbzt1!= null ">and sbzt=#{sbzt1}</if>
			<if test="shzt!='' and shzt!= null ">
				and shzt=#{shzt}
			</if>
			<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
			<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
			<if test="jsjsdj!='' and jsjsdj!= null ">and ${jsjsdj}</if>
			<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%3___' and ${gldj})</if>
			<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
			<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
			group by xmbm,tz
		)
	</select>
	
	<update id="thxmsqshyh" parameterType="String">
		update xmsq_yhdzx set sqzt='0' where ${value}
	</update>
	<update id="thxmsqshsh" parameterType="String">
		update xmsq_sh set sqzt='0' where ${value}
	</update>
	<update id="thxmsqshyhzx" parameterType="String">
		update xmsq_yhzx set sqzt='0' where ${value}
	</update>
	
	<select id="selectYbmrsjd" parameterType="wqbzbz" resultType="wqbzbz">
		select id,decode(xmlx,'gcgl_wqgz','危桥','gcgl_abgc','安保','gcgl_zhfz','灾害','gcgl_gcgzgj','路面改造','gcgl_gcgzsj','改建','gcgl_sh','灾毁重建','gcgl_yhdzx','养护大中修','gcgl_xj','新建') xmlx,jzsj,yf from xtgl_ybmrsj where 1=1 and xmlx=#{xmlx} order by to_number(yf)
	</select>
	
	<update id="xgybmrsjd" parameterType="wqbzbz">
		update xtgl_ybmrsj set jzsj=#{jzsj} where id=#{id}
	</update>
	
	<select id="selectYbsjd" parameterType="wqbzbz" resultType="wqbzbz">
		select id,decode(xmlx,'gcgl_wqgz','危桥','gcgl_abgc','安保','gcgl_zhfz','灾害','gcgl_gcgzgj','路面改造','gcgl_gcgzsj','改建','gcgl_sh','灾毁重建','gcgl_yhdzx','养护大中修','gcgl_xj','新建') xmlx,jzsj,nf,yf from xtgl_ybsjd where 1=1 and xmlx=#{xmlx} and nf=#{nf} order by to_number(yf)
	</select>
	<insert id="tjybsjd" parameterType="wqbzbz">
		insert into xtgl_ybsjd(id,xmlx,nf,yf,jzsj) values(sys_guid(),#{xmlx},#{nf},#{yf},#{jzsj})
	</insert>
	<update id="xgybsjd" parameterType="wqbzbz">
		update xtgl_ybsjd set nf=#{nf},yf=#{yf},jzsj=#{jzsj} where id=#{id}
	</update>
	<delete id="delybsjd" parameterType="wqbzbz">
		delete from xtgl_ybsjd where id=#{id}
	</delete>
	
	<select id="cxybsjd1" parameterType="wqbzbz" resultType="wqbzbz">
		select * from xtgl_ybsjd where xmlx=#{xmlx} and nf=#{nf1} and yf=#{yf1}
	</select>
	<select id="cxybsjd2" parameterType="wqbzbz" resultType="wqbzbz">
		select * from xtgl_ybmrsj where xmlx=#{xmlx} and yf=#{yf1}
	</select>
	<update id="cxsfcgsjd" parameterType="wqbzbz">
		update ${xmlx} set sfcgsjd=#{qllx} where id=#{id}
	</update>
	<insert id="qxxmgj" parameterType="lxsh">
		insert into jhsh_sjgz_qx select * from jhsh_sjgz where xmbm=#{xmbm}
	</insert>
	<delete id="qxxmgjdel" parameterType="lxsh">
		delete from jhsh_sjgz where xmbm=#{xmbm}
	</delete>
	<insert id="qxxmgj1" parameterType="lxsh">
		insert into jhsh_sjgz select * from jhsh_sjgz_qx where xmbm=#{xmbm}
	</insert>
	<delete id="qxxmgjdel1" parameterType="lxsh">
		delete from jhsh_sjgz_qx where xmbm=#{xmbm}
	</delete>
	
	<insert id="qxxmlm" parameterType="lxsh">
		insert into jhsh_lmgz_qx select * from jhsh_lmgz where xmbm=#{xmbm}
	</insert>
	<delete id="qxxmlmdel" parameterType="lxsh">
		delete from jhsh_lmgz where xmbm=#{xmbm}
	</delete>
	<insert id="qxxmlm1" parameterType="lxsh">
		insert into jhsh_lmgz select * from jhsh_lmgz_qx where xmbm=#{xmbm}
	</insert>
	<delete id="qxxmlmdel1" parameterType="lxsh">
		delete from jhsh_lmgz_qx where xmbm=#{xmbm}
	</delete>
	
	<insert id="qxxmxj" parameterType="lxsh">
		insert into jhsh_xj_qx select * from jhsh_xj where xmbm=#{xmbm}
	</insert>
	<delete id="qxxmxjdel" parameterType="lxsh">
		delete from jhsh_xj where xmbm=#{xmbm}
	</delete>
	<insert id="qxxmxj1" parameterType="lxsh">
		insert into jhsh_xj select * from jhsh_xj_qx where xmbm=#{xmbm}
	</insert>
	<delete id="qxxmxjdel1" parameterType="lxsh">
		delete from jhsh_xj_qx where xmbm=#{xmbm}
	</delete>
	
	<insert id="qxxmyh" parameterType="lxsh">
		insert into jhsh_yhdzx_qx select * from jhsh_yhdzx where xmbm=#{xmbm}
	</insert>
	<delete id="qxxmyhdel" parameterType="lxsh">
		delete from jhsh_yhdzx where xmbm=#{xmbm}
	</delete>
	<insert id="qxxmyh1" parameterType="lxsh">
		insert into jhsh_yhdzx select * from jhsh_yhdzx_qx where xmbm=#{xmbm}
	</insert>
	<delete id="qxxmyhdel1" parameterType="lxsh">
		delete from jhsh_yhdzx_qx where xmbm=#{xmbm}
	</delete>
	
	<insert id="qxxmzh" parameterType="lxsh">
		insert into jhsh_sh_qx select * from jhsh_sh where xmbm=#{xmbm}
	</insert>
	<delete id="qxxmzhdel" parameterType="lxsh">
		delete from jhsh_sh where xmbm=#{xmbm}
	</delete>
	<insert id="qxxmzh1" parameterType="lxsh">
		insert into jhsh_sh select * from jhsh_sh_qx where xmbm=#{xmbm}
	</insert>
	<delete id="qxxmzhdel1" parameterType="lxsh">
		delete from jhsh_sh_qx where xmbm=#{xmbm}
	</delete>
	
	<select id="selectgsdgzList" parameterType="lxsh" resultType="lxsh">
		select * from (select rownum num ,xmklx,t.id,t.xmbm,to_char(sbzt) sbzt1,t.xmnf,t.xzqhdm,t.xmmc,t.shzt,t.jhkgn,t.jhwgn,t.jsxz,
		t.gydwdm,t.sbthcd,t.lsjl,t.ghlxbh,t.gydw,t.xzqh,t.tz,t.bzys,t.dfzc,t.tsdq ,lx.*,sl.xmsl,sl.zlc jszlc  from lxgsdgz t left join
		(select xmid,lxbm,qdzh minqdzh,zdzh maxzdzh,qdmc,zdmc,lc,xjsdj,jsjsdj,yilc,erlc,sanlc,silc,dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,decode(substr(xmid,11,1),'3',xjlxbm,ghlxbm) ghlxbm,ghlxmc,decode(substr(xmid,11,1),'3',xjqdzh,ghqdzh) ghqdzh,decode(substr(xmid,11,1),'3',xjzdzh,ghzdzh) ghzdzh,gxlxbm,gxqdzh,gxzdzh 
		from lxsh_lx where jdbs='0' and sffirst='1' 
		) lx on t.xmbm=lx.xmid
		left join ( select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='0' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1 and  sbthcd &lt;=#{sbthcd}
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="jsjsdj!='' and jsjsdj!= null ">and ${jsjsdj}</if>
		
		<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%1___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
		order by xmbm desc,sbzt1 
	</select>
	<select id="selectgsdgzListCount" parameterType="lxsh" resultType="int">
		select count(t.xmbm) from lxgsdgz t left join (select xmid,lxbm,lc,xjsdj,jsjsdj
		from lxsh_lx where jdbs='0' and sffirst='1') lx on t.xmbm=lx.xmid where 1=1 and sbthcd &lt;=#{sbthcd}
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="jsjsdj!='' and jsjsdj!= null ">and ${jsjsdj}</if>
		<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%1___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
	</select>
	<select id="queryLxshLjgsd" resultType="java.util.Map" parameterType="lxsh">
    	select count(xmbm) xmsl,nvl(sum(tz),0) tz,nvl(sum(lc),0) lc,nvl(sum(bzcs),0) bzcs,(sum(tz)-sum(bzcs)) dftz,'0' sbz,'0' sjl from(
			select t.xmbm,t.tz ,sum(lx.lc) lc,sum(t.bzys) bzcs from lxgsdgz t left join 
			(select  xmid,jsxz,
					(case when substr(xmid,11,1)='1' then to_number(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
					  else nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0) 
					end) lc from lxsh_lx where jdbs='0' 
			) lx 
			on t.xmbm=lx.xmid where 1=1 and sbthcd &lt;=#{sbthcd}
			<if test="gydw!='' and gydw!= null ">${gydw}</if>
			<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
			<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
			
			<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
			<if test="sbzt1!='' and sbzt1!= null ">
				and to_char(sbzt) like '%'||#{sbzt1}||'%'
			</if>
			<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
			<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
			<if test="jsjsdj!='' and jsjsdj!= null ">and ${jsjsdj}</if>
			<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%1___' and ${gldj})</if>
			<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
			
			<if test="lxmc !='' and lxmc != null ">
				and lxmc like '%'||#{lxmc}||'%'
			</if>
			<if test="xmlx1 !='' and xmlx1 != null ">
				${xmlx1}
			</if>
			<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
			<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
			
			<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
			group by xmbm,tz
		)
	</select>
	<select id="querylxshgsd" parameterType="lxsh" resultType="elist">
		select 
		decode(lx.sffirst,'1',t.xmbm,'') v_0,decode(lx.sffirst,'1',t.xmmc,'') v_1,lx.lxbm v_2,lx.lxmc v_3,lx.qdzh v_4,lx.zdzh v_5,lx.ghlxbm v_6,lx.ghlxmc v_7,lx.ghqdzh v_8,lx.ghzdzh v_9,
		lx.gxlxbm v_10,lx.gxqdzh v_11,lx.gxzdzh v_12,lx.qdmc v_13,lx.zdmc v_14,lx.jsxz v_15,lx.gydw v_16,lx.xzqh v_17,t.tsdq v_18,lx.jsjsdj v_19,
		lx.xjsdj v_20,substr(t.xmbm,0,4) v_21,t.jhkgn v_22,t.jhwgn v_23,t.tz v_24,lx.bzcs v_25
		from lxgsdgz t right join
		(select * from lxsh_lx where 1=1 and jdbs='0' ) lx on t.xmbm=lx.xmid where 1=1

		and sbthcd &lt;=#{sbthcd}
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and xmbm in (select xmid from lxsh_lx where xmid like '%1___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		
		<if test="jsjsdj !='' and jsjsdj !=null">
			${jsjsdj}
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		order by t.xmbm desc,lx.sffirst desc
	</select>
	<select id="querykxxgsd" parameterType="lxsh" resultType="elist">
		select decode(lx.sffirst,'1',t.xmbm,'') v_0,decode(lx.sffirst,'1',t.xmmc,'') v_1,
		lx.xzqh v_2,lx.lxbm v_3,lx.lxmc v_4,lx.qdzh v_5,lx.zdzh v_6,
		lx.ghlxbm v_7,lx.ghlxmc v_8,lx.ghqdzh v_9,lx.ghzdzh v_10,
		lx.gxlxbm v_11,lx.gxqdzh v_12,lx.gxzdzh v_13,
		lx.lc v_14,lx.yilc v_15,lx.erlc v_16,lx.sanlc v_17,lx.silc v_18,lx.dwlc v_19,lx.wllc v_20,
		lx.jhyilc v_21,lx.jherlc v_22,lx.jhsanlc v_23,lx.jhsilc v_24,lx.jhdwlc v_25,lx.jhwllc v_26,
		lx.jsxz v_27,t.dq_m v_28,t.dq v_29,t.jsjsdj v_30,
		t.sd_m v_31,t.sd v_32,t.kgny v_33,t.wgny v_34,t.bzdw v_35,decode(lx.sffirst,'1',t.tzgs,'') v_36,decode(lx.sffirst,'1',t.dfzc,'') v_37,
		decode(lx.sffirst,'1',t.yhdk,'') v_38,decode(lx.sffirst,'1',t.gkpfwh,'') v_39,decode(lx.sffirst,'1',t.pfsj,'') v_40 
		from kxgsdgz t right join
		(select * from lxsh_lx where 1=1 and jdbs='1' ) lx on t.xmbm=lx.xmid where 1=1
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and t.xmbm in (select xmid from lxsh_lx where jdbs='1' and xmid like '%1___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and lsjl like '%'||#{lsjl}||'%'</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="jsjsdj!='' and jsjsdj!= null ">and ${jsjsdj}</if>
		<if test="ghlxmc !='' and ghlxmc != null ">
			and lx.ghlxmc like '%'||#{ghlxmc}||'%'
		</if>
		
		order by t.xmbm desc,lx.sffirst desc
	</select>
	<select id="selectWqjlbz" resultType="wqbzbz">
		select * from xtgl_wqjlbz 
	</select>
	
	<update id="thwshlxsh45" parameterType="lxsh">
		update ${bz} set yhcsh='0' where xmbm in (${xmbm})
	</update>
	<update id="thwshlxsh" parameterType="lxsh">
		update ${bz} set shzt='0' where xmbm in (${xmbm})
	</update>
	<delete id="thwshlxshkxx" parameterType="lxsh">
		delete from ${bzcs} where xmbm in (${xmbm}) 
	</delete>
	<delete id="thwshlxshkxxlx" parameterType="lxsh">
		delete from lxsh_lx where xmid in (${xmbm}) and jdbs=#{jdbs}
	</delete>
	
	<update id="thlxshsbgsd" parameterType="lxsh">
		update ${bz} set sbzt='0',sbthcd=#{sbthcd},thyy=#{thyy} where xmbm in (${xmbm})
	</update>
	
	<update id="thlxshsbyhsh" parameterType="lxsh">
		update ${bz} set sqzt='0',thyy=#{thyy} where xmbm in (${xmbm})
	</update>
	<update id="thlxshsbyhshyhc" parameterType="lxsh">
		update ${bz} set sqzt='9',thyyyhc=#{thyyyhc} where xmbm in (${xmbm})
	</update>
	<select id="sfkythlxwsh" parameterType="lxsh" resultType="lxsh">
		select * from ${bzcs} where xmbm in (${xmbm}) 
	</select>
	
	<insert id="qxxm" parameterType="String">
	${value}
	</insert>
	
</mapper>

