<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.wnjh">
	<select id="selectimportXmbm" parameterType="String" resultType="String">
		${value}
	</select>
	<select id="selectXmbm" parameterType="String" resultType="String">
		select max(substr(xmbm,-3)) from lxsh_sjgz where xmbm like ${value}||'%'
	</select>
	<select id="selectlmgzXmbm" parameterType="String" resultType="String">
		select max(substr(xmbm,-3)) from lxsh_lmgz where xmbm like ${value}||'%'
	</select>
	<select id="selectxjXmbm" parameterType="String" resultType="String">
		select max(substr(xmbm,-3)) from lxsh_xj where xmbm like ${value}||'%'
	</select>
	<select id="selectbzcs" parameterType="lxsh" resultType="lxsh">
		select bzzj bzys from PLAN_FLWBZBZ where xmlx=#{xmlx} and gldj=#{gldj} and jsdj like #{jsdj}||'%'
	</select>
	<select id="selectGjwnjhcf" parameterType="lxsh" resultType="lxsh">
		select * from wnjh_sjgz where ghlxbh=#{ghlxbh} and ((qdzh&lt;=#{qdzh} and zdzh>#{qdzh}) or (qdzh&lt;#{zdzh} and zdzh>=#{zdzh}))
	</select>
	<select id="selectLmwnjhcf" parameterType="lxsh" resultType="lxsh">
		select * from wnjh_lmgz where ghlxbh=#{ghlxbh} and ((qdzh&lt;=#{qdzh} and zdzh>#{qdzh}) or (qdzh&lt;#{zdzh} and zdzh>=#{zdzh}))
	</select>
	<select id="selectXjwnjhcf" parameterType="lxsh" resultType="lxsh">
		select * from wnjh_xj where ghlxbh=#{ghlxbh} and ((qdzh&lt;=#{qdzh} and zdzh>#{qdzh}) or (qdzh&lt;#{zdzh} and zdzh>=#{zdzh}))
	</select>
	<insert id="insertGjwnjh" parameterType="lxsh">
		insert into WNJH_SJGZ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,tsdq,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,lsjl,bz,yhdk,gz,sz,ghxlxbm,ghxlxmc,xmklx,qqkzzt<if test="xzqhdm2 != null">,xzqhdm2</if>)
		values(#{xmbm},#{lxmc},#{xmmc},#{ghlxbh},#{lc},#{jsxz},#{qdzh},#{zdzh},#{qdmc},#{zdmc},#{jhkgn},#{jhwgn},#{jsjsdj},#{xjsdj},#{xmbm},#{tz},#{bzys},#{dfzc},#{tsdq},#{xzqh},#{gydw},#{xzqhdm},#{gydwdm},#{xmnf},#{sbthcd},#{tbbmbm},#{lsjl},#{bz},#{yhdk},#{gz},#{sz},#{ghxlxbm},#{ghxlxmc},#{xmklx},'未开展'<if test="xzqhdm2 != null">,#{xzqhdm2}</if>)
	</insert>
	<insert id="insertLmwnjh" parameterType="lxsh">
		insert into WNJH_LMGZ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,tsdq,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,lsjl,bz,yhdk,gz,sz,ghxlxbm,ghxlxmc,xmklx,qqkzzt<if test="xzqhdm2 != null">,xzqhdm2</if>)
		values(#{xmbm},#{lxmc},#{xmmc},#{ghlxbh},#{lc},#{jsxz},#{qdzh},#{zdzh},#{qdmc},#{zdmc},#{jhkgn},#{jhwgn},#{jsjsdj},#{xjsdj},#{xmbm},#{tz},#{bzys},#{dfzc},#{tsdq},#{xzqh},#{gydw},#{xzqhdm},#{gydwdm},#{xmnf},#{sbthcd},#{tbbmbm},#{lsjl},#{bz},#{yhdk},#{gz},#{sz},#{ghxlxbm},#{ghxlxmc},#{xmklx},'未开展'<if test="xzqhdm2 != null">,#{xzqhdm2}</if>)
	</insert>
	<insert id="insertXjwnjh" parameterType="lxsh">
		insert into WNJH_XJ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,tsdq,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,lsjl,bz,yhdk,gz,sz,xmklx,qqkzzt<if test="xzqhdm2 != null">,xzqhdm2</if>)
		values(#{xmbm},#{lxmc},#{xmmc},#{ghlxbh},#{lc},#{jsxz},#{qdzh},#{zdzh},#{qdmc},#{zdmc},#{jhkgn},#{jhwgn},#{jsjsdj},#{xjsdj},#{xmbm},#{tz},#{bzys},#{dfzc},#{tsdq},#{xzqh},#{gydw},#{xzqhdm},#{gydwdm},#{xmnf},#{sbthcd},#{tbbmbm},#{lsjl},#{bz},#{yhdk},#{gz},#{sz},#{xmklx},'未开展'<if test="xzqhdm2 != null">,#{xzqhdm2}</if>)
	</insert>
	<insert id="insertlx" parameterType="lxsh">
		insert into WNJH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh
		<if test="xjlxbm!='' and xjlxbm!=null">,xjlxbm</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,xjqdzh</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,xjzdzh</if>
		<if test="xjlc!='' and xjlc!=null">,xjlc</if>
		,yilc,erlc,sanlc,silc,dwlc,wllc
		<if test="jhyilc!=null">,jhyilc</if>
		<if test="jherlc!=null">,jherlc</if>
		<if test="jhsanlc!=null">,jhsanlc</if>
		<if test="jhsilc!=null">,jhsilc</if>
		<if test="jhdwlc!=null">,jhdwlc</if>
		<if test="jhwllc!=null">,jhwllc</if>
		<if test="jhlc!=null">,jhlc</if>
		<if test="ghxlxbm !=null">,ghxlxbm</if>
		<if test="ghxlxmc !=null">,ghxlxmc</if>
		<if test="ghlxbm !=null">,ghlxbm</if>
		<if test="ghlxmc !=null">,ghlxmc</if>
		<if test="ghqdzh !=null">,ghqdzh</if>
		<if test="ghzdzh !=null">,ghzdzh</if>
		<if test="gxlxbm !=null">,gxlxbm</if>
		<if test="gxqdzh !=null">,gxqdzh</if>
		<if test="gxzdzh !=null">,gxzdzh</if>
		
		)
		values(sys_guid(),#{xmbm},#{ghlxbh},#{lxmc},#{xzqh},#{xzqhdm},#{gydw},#{gydwdm},#{qdzh},#{zdzh},#{jsjsdj},#{lc},#{xjsdj},#{jsxz},#{qdmc},#{zdmc},#{bzys},'1',#{jdbs},#{gpsqdzh},#{gpszdzh}
		<if test="xjlxbm!='' and xjlxbm!=null">,#{xjlxbm}</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,#{xjqdzh}</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,#{xjzdzh}</if>
		<if test="xjlc!='' and xjlc!=null">,#{xjlc}</if>
		,#{yilc},#{erlc},#{sanlc},#{silc},#{dwlc},#{wllc}
		<if test="jhyilc!=null">,#{jhyilc}</if>
		<if test="jherlc!=null">,#{jherlc}</if>
		<if test="jhsanlc!=null">,#{jhsanlc}</if>
		<if test="jhsilc!=null">,#{jhsilc}</if>
		<if test="jhdwlc!=null">,#{jhdwlc}</if>
		<if test="jhwllc!=null">,#{jhwllc}</if>
		<if test="jhlc!=null">,#{jhlc}</if>
		<if test="ghxlxbm !=null">,#{ghxlxbm}</if>
		<if test="ghxlxmc !=null">,#{ghxlxmc}</if>
		<if test="ghlxbm !=null">,#{ghlxbm}</if>
		<if test="ghlxmc !=null">,#{ghlxmc}</if>
		<if test="ghqdzh !=null">,#{ghqdzh}</if>
		<if test="ghzdzh !=null">,#{ghzdzh}</if>
		<if test="gxlxbm !=null">,#{gxlxbm}</if>
		<if test="gxqdzh !=null">,#{gxqdzh}</if>
		<if test="gxzdzh !=null">,#{gxzdzh}</if>
		)
	</insert>
	<update id="updateGjlsjl" parameterType="lxsh">
	update ${xmlx} set lsjl=#{lsjl} where id=#{xmbm}
	</update>
	<insert id="insertGjlxwnjh" parameterType="lxsh">
		insert into WNJH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,gpsqdzh,gpszdzh
		<if test="xjlxbm!='' and xjlxbm!=null">,xjlxbm</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,xjqdzh</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,xjzdzh</if>
		<if test="xjlc!='' and xjlc!=null">,xjlc</if>
		,yilc,erlc,sanlc,silc,dwlc,wllc
		<if test="jhyilc!=null">,jhyilc</if>
		<if test="jherlc!=null">,jherlc</if>
		<if test="jhsanlc!=null">,jhsanlc</if>
		<if test="jhsilc!=null">,jhsilc</if>
		<if test="jhdwlc!=null">,jhdwlc</if>
		<if test="jhwllc!=null">,jhwllc</if>
		<if test="jhlc!=null">,jhlc</if>
		<if test="ghxlxbm !=null">,ghxlxbm</if>
		<if test="ghxlxmc !=null">,ghxlxmc</if>
		<if test="ghlxbm !=null">,ghlxbm</if>
		<if test="ghlxmc !=null">,ghlxmc</if>
		<if test="ghqdzh !=null">,ghqdzh</if>
		<if test="ghzdzh !=null">,ghzdzh</if>
		<if test="gxlxbm !=null">,gxlxbm</if>
		<if test="gxqdzh !=null">,gxqdzh</if>
		<if test="gxzdzh !=null">,gxzdzh</if>
		)
		values(sys_guid(),#{xmbm},#{ghlxbh},#{lxmc},#{xzqh},#{xzqhdm},#{gydw},#{gydwdm},#{qdzh},#{zdzh},#{jsjsdj},#{lc},#{xjsdj},#{jsxz},#{qdmc},#{zdmc},'0','0',#{gpsqdzh},#{gpszdzh}
		<if test="xjlxbm!='' and xjlxbm!=null">,#{xjlxbm}</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,#{xjqdzh}</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,#{xjzdzh}</if>
		<if test="xjlc!='' and xjlc!=null">,#{xjlc}</if>
		,#{yilc},#{erlc},#{sanlc},#{silc},#{dwlc},#{wllc}
		<if test="jhyilc!=null">,#{jhyilc}</if>
		<if test="jherlc!=null">,#{jherlc}</if>
		<if test="jhsanlc!=null">,#{jhsanlc}</if>
		<if test="jhsilc!=null">,#{jhsilc}</if>
		<if test="jhdwlc!=null">,#{jhdwlc}</if>
		<if test="jhwllc!=null">,#{jhwllc}</if>
		<if test="jhlc!=null">,#{jhlc}</if>
		<if test="ghxlxbm !=null">,#{ghxlxbm}</if>
		<if test="ghxlxmc !=null">,#{ghxlxmc}</if>
		<if test="ghlxbm !=null">,#{ghlxbm}</if>
		<if test="ghlxmc !=null">,#{ghlxmc}</if>
		<if test="ghqdzh !=null">,#{ghqdzh}</if>
		<if test="ghzdzh !=null">,#{ghzdzh}</if>
		<if test="gxlxbm !=null">,#{gxlxbm}</if>
		<if test="gxqdzh !=null">,#{gxqdzh}</if>
		<if test="gxzdzh !=null">,#{gxzdzh}</if>
		
		)
	</insert>
	
	<select id="querylxlist" parameterType="lxsh" resultType="lxsh">
		select t.*,bzcs bzys,xmid xmbm,lxbm ghlxbh from lxsh_lx t where xmid=#{xmbm} and jdbs=#{jdbs}
	</select>
	<!--  华丽的分割线________________________________________________________华丽的分割线 -->
	<select id="selectGjwnjh" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.*,lx.*,decode(lx1.sl,null,'0',lx1.sl) sl,lx2.zjhlc from WNJH_SJGZ t left join
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(jhsanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc,sum(jhlc) jhlc
		,WMSYS.WM_CONCAT(to_char(ghlxbm)) ghlxbm,WMSYS.WM_CONCAT(to_char(ghqdzh)) ghqdzh
		,WMSYS.WM_CONCAT(to_char(ghzdzh)) ghzdzh,WMSYS.WM_CONCAT(to_char(ghlxmc)) ghlxmc
		,WMSYS.WM_CONCAT(to_char(gxlxbm)) gxlxbm,WMSYS.WM_CONCAT(to_char(gxqdzh)) gxqdzh
		,WMSYS.WM_CONCAT(to_char(gxzdzh)) gxzdzh
		from WNJH_LX where sffirst='1' group by xmid) lx on t.id=lx.xmid 
		left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
		left join (select xmid,decode(min(jsxz),'改建',nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0),nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
   		replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
   		replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
    	replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'改建工程' xmlx1 
    	from WNJH_LX group by xmid) lx2 on t.id=lx2.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and ghlxbmtj like '%'||#{ghlxbh}||'%'
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="ghxlxbm!=null and ghxlxbm!=''">
			and (t.id in (select distinct xmid from lx_clsd1 where ghlxbm like '%'||#{ghxlxbm}||'%')
				or t.id in (select xmid from wnjh_lx where ghlxbm like '%'||#{ghxlxbm}||'%')
			)
		</if>
		<if test="ghxlxmc!='' and ghxlxmc!= null ">
			and (t.id in (select distinct xmid from lx_clsd1 where ghlxmc like '%'||#{ghxlxmc}||'%')
				or t.id in (select xmid from wnjh_lx where ghlxmc like '%'||#{ghxlxmc}||'%')
			)
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by xmnf
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
	</select>
	<select id="selectGjwnjhCount" parameterType="lxsh" resultType="int">
		select count(*) from (
		select rownum num ,t.*,lx.*,decode(lx1.sl,null,'0',lx1.sl) sl,lx2.zjhlc from WNJH_SJGZ t left join
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(jhsanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc,sum(jhlc) jhlc
		from WNJH_LX where sffirst='1' group by xmid) lx on t.id=lx.xmid 
		left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
		left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
   		replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
   		replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
    	replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'改建工程' xmlx1 
    	from WNJH_LX group by xmid) lx2 on t.id=lx2.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and ghlxbmtj like '%'||#{ghlxbh}||'%'
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="ghxlxbm!=null and ghxlxbm!=''">
			and (t.id in (select distinct xmid from lx_clsd1 where ghlxbm like '%'||#{ghxlxbm}||'%')
				or t.id in (select xmid from wnjh_lx where ghlxbm like '%'||#{ghxlxbm}||'%')
			)
		</if>
		<if test="ghxlxmc!='' and ghxlxmc!= null ">
			and (t.id in (select distinct xmid from lx_clsd1 where ghlxmc like '%'||#{ghxlxmc}||'%')
				or t.id in (select xmid from wnjh_lx where ghlxmc like '%'||#{ghxlxmc}||'%')
			)
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by xmnf
		) t1
	</select>
	<select id="selectLmwnjh" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.lsjl,t.xmnf,t.gz,t.sz,t.jhkgn,t.jhwgn,t.jsxz,t.yhdk,t.bz,t.id,t.lxmc,t.shzt,t.xmmc,t.xmbm,t.gydw,t.xzqh,t.ghlxbh,t.qdmc,t.zdmc,t.xjsdj,t.jsjsdj,t.tz,t.bzys,t.dfzc,t.tsdq,lx.*,lx1.sl,lx2.jhlc,t.qqkzzt  from wnjh_lmgz t left join 
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(lc) lc,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,WMSYS.WM_CONCAT(to_char(ghlxbm)) ghlxbm,WMSYS.WM_CONCAT(to_char(ghqdzh)) ghqdzh
		,WMSYS.WM_CONCAT(to_char(ghzdzh)) ghzdzh,WMSYS.WM_CONCAT(to_char(ghlxmc)) ghlxmc
		,WMSYS.WM_CONCAT(to_char(gxlxbm)) gxlxbm,WMSYS.WM_CONCAT(to_char(gxqdzh)) gxqdzh
		,WMSYS.WM_CONCAT(to_char(gxzdzh)) gxzdzh from wnjh_lx where sffirst='1' group by xmid) lx on t.id=lx.xmid left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid 
		left join (select xmid,decode(min(jsxz),'改建',nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0),nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0))  jhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
   		replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
   		replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
    	replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'改建工程' xmlx1 
    	from WNJH_LX group by xmid) lx2 on t.id=lx2.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and ghlxbmtj like '%'||#{ghlxbh}||'%'
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="ghxlxbm!=null and ghxlxbm!=''">
			and (t.id in (select distinct xmid from lx_clsd1 where ghlxbm like '%'||#{ghxlxbm}||'%')
				or t.id in (select xmid from wnjh_lx where ghlxbm like '%'||#{ghxlxbm}||'%')
			)
		</if>
		<if test="ghxlxmc!='' and ghxlxmc!= null ">
			and (t.id in (select distinct xmid from lx_clsd1 where ghlxmc like '%'||#{ghxlxmc}||'%')
				or t.id in (select xmid from wnjh_lx where ghlxmc like '%'||#{ghxlxmc}||'%')
			)
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by xmnf
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
	</select>
	<select id="selectLmwnjhCount" parameterType="lxsh" resultType="int">
		select count(*) from (
		select rownum num ,t.lsjl,t.xmnf,t.gz,t.sz,t.jhkgn,t.jhwgn,t.jsxz,t.yhdk,t.bz,t.id,t.lxmc,t.shzt,t.xmmc,t.xmbm,t.gydw,t.xzqh,t.ghlxbh,t.qdmc,t.zdmc,t.xjsdj,t.jsjsdj,t.tz,t.bzys,t.dfzc,t.tsdq,lx.*,lx1.sl,lx2.jhlc  from wnjh_lmgz t left join 
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(lc) lc,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc from wnjh_lx where sffirst='1' group by xmid) lx on t.id=lx.xmid left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid 
		left join (select xmid,sum(lc) jhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
   		replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
   		replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
    	replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'改建工程' xmlx1 
    	from WNJH_LX group by xmid) lx2 on t.id=lx2.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and ghlxbmtj like '%'||#{ghlxbh}||'%'
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="ghxlxbm!=null and ghxlxbm!=''">
			and (t.id in (select distinct xmid from lx_clsd1 where ghlxbm like '%'||#{ghxlxbm}||'%')
				or t.id in (select xmid from wnjh_lx where ghlxbm like '%'||#{ghxlxbm}||'%')
			)
		</if>
		<if test="ghxlxmc!='' and ghxlxmc!= null ">
			and (t.id in (select distinct xmid from lx_clsd1 where ghlxmc like '%'||#{ghxlxmc}||'%')
				or t.id in (select xmid from wnjh_lx where ghlxmc like '%'||#{ghxlxmc}||'%')
			)
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by xmnf
		) t1
	</select>
	
	<select id="selectXjwnjh" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.*,tt.bzys1,lx1.*,lx2.sl,lx3.jhlc from WNJH_XJ t left join (select xmid,sum(bzcs) bzys1 from wnjh_lx where sffirst='1' group by xmid) tt on t.id=tt.xmid left join 
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,max(xjlxbm) xjlxbm,max(xjqdzh) xjqdzh,max(xjzdzh) xjzdzh,max(xjlc) xjlc
		from wnjh_lx where sffirst='1' group by xmid) lx1 on t.id=lx1.xmid left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx2 on t.id=lx2.xmid
		left join (select xmid,decode(min(jsxz),'改建',nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0),nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0))  jhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
   		replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
   		replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
    	replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'改建工程' xmlx1 
    	from WNJH_LX group by xmid) lx3 on t.id=lx3.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and ghlxbmtj like '%'||#{ghlxbh}||'%'
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="ghxlxbm!=null and ghxlxbm!=''">
			and (t.id in (select distinct xmid from lx_clsd1 where ghlxbm like '%'||#{ghxlxbm}||'%')
				or t.id in (select xmid from wnjh_lx where ghlxbm like '%'||#{ghxlxbm}||'%')
			)
		</if>
		<if test="ghxlxmc!='' and ghxlxmc!= null ">
			and (t.id in (select distinct xmid from lx_clsd1 where ghlxmc like '%'||#{ghxlxmc}||'%')
				or t.id in (select xmid from wnjh_lx where ghlxmc like '%'||#{ghxlxmc}||'%')
			)
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by xmnf
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
	</select>
	<select id="selectXjwnjhCount" parameterType="lxsh" resultType="int">
		select count(*) from (
		select rownum num ,t.*,tt.bzys1,lx1.*,lx2.sl,lx3.jhlc from WNJH_XJ t left join (select xmid,sum(bzcs) bzys1 from wnjh_lx where sffirst='1' group by xmid) tt on t.id=tt.xmid left join 
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,max(xjlxbm) xjlxbm,max(xjqdzh) xjqdzh,max(xjzdzh) xjzdzh,max(xjlc) xjlc
		from wnjh_lx where sffirst='1' group by xmid) lx1 on t.id=lx1.xmid left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx2 on t.id=lx2.xmid
		left join (select xmid,sum(xjlc) jhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
   		replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
   		replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
    	replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'改建工程' xmlx1 
    	from WNJH_LX group by xmid) lx3 on t.id=lx3.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and ghlxbmtj like '%'||#{ghlxbh}||'%'
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="ghxlxbm!=null and ghxlxbm!=''">
			and (t.id in (select distinct xmid from lx_clsd1 where ghlxbm like '%'||#{ghxlxbm}||'%')
				or t.id in (select xmid from wnjh_lx where ghlxbm like '%'||#{ghxlxbm}||'%')
			)
		</if>
		<if test="ghxlxmc!='' and ghxlxmc!= null ">
			and (t.id in (select distinct xmid from lx_clsd1 where ghlxmc like '%'||#{ghxlxmc}||'%')
				or t.id in (select xmid from wnjh_lx where ghlxmc like '%'||#{ghxlxmc}||'%')
			)
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by xmnf
		) t1
	</select>
	
	
	
	<select id="wnjhGpsroad" parameterType="lxsh" resultType="lxsh">
		<!-- select lxbm ghlxbh,lxmc,qdzh,zdzh,qzlc lc,qdmc,zdmc,yjsdj xjsdj,xzqhdm xzqh
		from table(funNoLmlx(#{ghlxbh},#{xzqh})) order by lxbm,qdzh -->

		select distinct substr(ylxbm,0,4) ghlxbh,yqdzh qdzh,yzdzh zdzh,substr(xlxbm,0,4) xlxbm,xqdzh,xzdzh,xlxmc,ylxmc lxmc,cfld from ghlx where ylxbm like #{ghlxbh}||'%'||#{xzqh}||'%'
		order by to_number(yqdzh)
		
	</select>
	<select id="wnjhGpsroad1" parameterType="lxsh" resultType="lxsh">
		select max(lxmc) lxmc
		from table(funNoLmlx(#{ghlxbh},(select id from XTGL_XZQH where name=#{xzqh}))) order by lxbm,qdzh
	</select>
	
	<select id="selectSjgzlxList" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,xmid xmbm,lxbm ghlxbh,t.*,decode(jsxz,'改建',nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0), nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) zjhlc  from WNJH_LX t where 1=1 and sffirst!='1'
		<if test="xmbm!='' and xmbm!= null ">
			and xmid like '%'||#{xmbm}||'%'
		</if>
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
	</select>
	<select id="selectSjgzlxListCount" parameterType="lxsh" resultType="int">
		select count(*) from WNJH_LX where 1=1 and sffirst!='1'
		<if test="xmbm!='' and xmbm!= null ">
			and xmid like '%'||#{xmbm}||'%'
		</if>
	</select>

	<delete id="deletelmgzkxx" parameterType="hashmap">
		delete from kxxyj_lmgz where xmbm=#{xmbm}
	</delete>
	<delete id="deletesjgzkxx" parameterType="hashmap">
		delete from kxxyj_sjgz where xmbm=#{xmbm}
	</delete>
	<delete id="deletexjkxx" parameterType="hashmap">
		delete from kxxyj_xj where xmbm=#{xmbm}
	</delete>

	<update id="updateSjgz" parameterType="lxsh">
		update wnjh_sjgz set lxmc=#{lxmc},ghlxbh=#{ghlxbh},qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},xjsdj=#{xjsdj},jhkgn=#{jhkgn},jhwgn=#{jhwgn},tz=#{tz},bzys=#{bzys},dfzc=#{dfzc},gydw=#{gydw},gydwdm=#{gydwdm},xzqhdm=#{xzqhdm},xzqh=#{xzqh},tsdq=#{tsdq},yhdk=#{yhdk},bz=#{bz},xmmc=#{xmmc},xmnf=#{xmnf},gz=#{gz},sz=#{sz},lsjl=#{lsjl}
		<if test="ghxlxbm !=null">,ghxlxbm=#{ghxlxbm}</if>
		<if test="ghxlxmc !=null">,ghxlxmc=#{ghxlxmc}</if>
		<if test="xmklx !=null">,xmklx=#{xmklx}</if>
		<if test="xzqhdm2 != null">,xzqhdm2=#{xzqhdm2}</if>  
		where id=#{xmbm}
	</update>
	<update id="updateLmgz" parameterType="lxsh">
		update wnjh_LMGZ set lxmc=#{lxmc},ghlxbh=#{ghlxbh},qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},xjsdj=#{xjsdj},jhkgn=#{jhkgn},jhwgn=#{jhwgn},tz=#{tz},bzys=#{bzys},dfzc=#{dfzc},gydw=#{gydw},gydwdm=#{gydwdm},xzqhdm=#{xzqhdm},xzqh=#{xzqh},tsdq=#{tsdq},yhdk=#{yhdk},bz=#{bz},xmmc=#{xmmc},xmnf=#{xmnf},gz=#{gz},sz=#{sz},lsjl=#{lsjl}
		<if test="ghxlxbm !=null">,ghxlxbm=#{ghxlxbm}</if>
		<if test="ghxlxmc !=null">,ghxlxmc=#{ghxlxmc}</if>
		<if test="xmklx !=null">,xmklx=#{xmklx}</if>
		<if test="xzqhdm2 != null">,xzqhdm2=#{xzqhdm2}</if>  
		where id=#{xmbm}
	</update>
	<update id="updateXj" parameterType="lxsh">
		update wnjh_XJ set ghlxbh=#{ghlxbh},lxmc=#{lxmc},xjsdj=#{xjsdj},qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},jhkgn=#{jhkgn},jhwgn=#{jhwgn},tz=#{tz},bzys=#{bzys},dfzc=#{dfzc},gydw=#{gydw},gydwdm=#{gydwdm},xzqhdm=#{xzqhdm},xzqh=#{xzqh},tsdq=#{tsdq},bz=#{bz},yhdk=#{yhdk},xmmc=#{xmmc},xmnf=#{xmnf},gz=#{gz},sz=#{sz}

		<if test="lsjl !=null">,lsjl=#{lsjl}</if>
		<if test="ghxlxbm !=null">,ghxlxbm=#{ghxlxbm}</if>
		<if test="ghxlxmc !=null">,ghxlxmc=#{ghxlxmc}</if>
		<if test="xmklx !=null">,xmklx=#{xmklx}</if>
		<if test="xzqhdm2 != null">,xzqhdm2=#{xzqhdm2}</if>  
		where id=#{xmbm}
	</update>
	<update id="updateSjgzlx" parameterType="lxsh">
		update WNJH_LX set lxbm=#{ghlxbh},qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},bzcs=#{bzys},xjsdj=#{xjsdj}
		<if test="xzqh!='' and xzqh!=null">,xzqh=#{xzqh}</if>
		<if test="gydw!='' and gydw!=null">,gydw=#{gydw}</if>
		<if test="xzqhdm!='' and xzqhdm!=null">,xzqhdm=#{xzqhdm}</if>
		<if test="gydwdm!='' and gydwdm!=null">,gydwdm=#{gydwdm}</if>
		<if test="xjlxbm!='' and xjlxbm!=null">,xjlxbm=#{xjlxbm}</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,xjqdzh=#{xjqdzh}</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,xjzdzh=#{xjzdzh}</if>
		<if test="xjlc!='' and xjlc!=null">,xjlc=#{xjlc}</if>
		<if test="yilc!='' and yilc!=null">,yilc=#{yilc}</if><if test="erlc!='' and erlc!=null">,erlc=#{erlc}</if>
		<if test="xjlc!='' and xjlc!=null">,sanlc=#{sanlc}</if><if test="silc!='' and silc!=null">,silc=#{silc}</if>
		<if test="dwlc!='' and dwlc!=null">,dwlc=#{dwlc}</if><if test="wllc!='' and wllc!=null">,wllc=#{wllc}</if>
		<if test="jhyilc!=null">,jhyilc=#{jhyilc}</if>
		<if test="jherlc!=null">,jherlc=#{jherlc}</if>
		<if test="jhsanlc!=null">,jhsanlc=#{jhsanlc}</if>
		<if test="jhsilc!=null">,jhsilc=#{jhsilc}</if>
		<if test="jhdwlc!=null">,jhdwlc=#{jhdwlc}</if>
		<if test="jhwllc!=null">,jhwllc=#{jhwllc}</if>
		<if test="jhlc!=null">,jhlc=#{jhlc}</if>
		<if test="ghxlxbm !=null">,ghxlxbm=#{ghxlxbm}</if>
		<if test="ghxlxmc !=null">,ghxlxmc=#{ghxlxmc}</if>
		<if test="ghlxbm !=null">,ghlxbm=#{ghlxbm}</if>
		<if test="ghlxmc !=null">,ghlxmc=#{ghlxmc}</if>
		<if test="ghqdzh !=null">,ghqdzh=#{ghqdzh}</if>
		<if test="ghzdzh !=null">,ghzdzh=#{ghzdzh}</if>
		<if test="gxlxbm !=null">,gxlxbm=#{gxlxbm}</if>
		<if test="gxqdzh !=null">,gxqdzh=#{gxqdzh}</if>
		<if test="gxzdzh !=null">,gxzdzh=#{gxzdzh}</if>
		where xmid=#{xmbm} and sffirst='1' 
	</update>
	<update id="updatewnjhsjlx" parameterType="lxsh">
		update WNJH_LX set lxbm=#{ghlxbh},qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},xjsdj=#{xjsdj}
		<if test="xzqh!='' and xzqh!=null">,xzqh=#{xzqh}</if>
		<if test="gydw!='' and gydw!=null">,gydw=#{gydw}</if>
		<if test="xzqhdm!='' and xzqhdm!=null">,xzqhdm=#{xzqhdm}</if>
		<if test="gydwdm!='' and gydwdm!=null">,gydwdm=#{gydwdm}</if>
		<if test="xjlxbm!='' and xjlxbm!=null">,xjlxbm=#{xjlxbm}</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,xjqdzh=#{xjqdzh}</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,xjzdzh=#{xjzdzh}</if>
		<if test="xjlc!='' and xjlc!=null">,xjlc=#{xjlc}</if>
		<if test="yilc!='' and yilc!=null">,yilc=#{yilc}</if><if test="erlc!='' and erlc!=null">,erlc=#{erlc}</if>
		<if test="xjlc!='' and xjlc!=null">,sanlc=#{sanlc}</if><if test="silc!='' and silc!=null">,silc=#{silc}</if>
		<if test="dwlc!='' and dwlc!=null">,dwlc=#{dwlc}</if><if test="wllc!='' and wllc!=null">,wllc=#{wllc}</if>
		<if test="jhyilc!=null">,jhyilc=#{jhyilc}</if>
		<if test="jherlc!=null">,jherlc=#{jherlc}</if>
		<if test="jhsanlc!=null">,jhsanlc=#{jhsanlc}</if>
		<if test="jhsilc!=null">,jhsilc=#{jhsilc}</if>
		<if test="jhdwlc!=null">,jhdwlc=#{jhdwlc}</if>
		<if test="jhwllc!=null">,jhwllc=#{jhwllc}</if>
		<if test="jhlc!=null">,jhlc=#{jhlc}</if>
		<if test="ghxlxbm !=null">,ghxlxbm=#{ghxlxbm}</if>
		<if test="ghxlxmc !=null">,ghxlxmc=#{ghxlxmc}</if>
		<if test="ghlxbm !=null">,ghlxbm=#{ghlxbm}</if>
		<if test="ghlxmc !=null">,ghlxmc=#{ghlxmc}</if>
		<if test="ghqdzh !=null">,ghqdzh=#{ghqdzh}</if>
		<if test="ghzdzh !=null">,ghzdzh=#{ghzdzh}</if>
		<if test="gxlxbm !=null">,gxlxbm=#{gxlxbm}</if>
		<if test="gxqdzh !=null">,gxqdzh=#{gxqdzh}</if>
		<if test="gxzdzh !=null">,gxzdzh=#{gxzdzh}</if>
		where xmid=#{xmbm} and id=#{id} 
	</update>
	
	<select id="queryMaxbzcs" parameterType="lxsh" resultType="double">
		select sum(to_number(bzcs)) from WNJH_LX where xmid=#{xmbm} 
	</select>
	<select id="queryMaxlc" parameterType="lxsh" resultType="double">
		select sum(to_number(lc)) from WNJH_LX where xmid=#{xmbm} 
	</select>
	<select id="cxwnghsjByid" parameterType="lxsh" resultType="lxsh">
		select xmmc, ghlxbh, jhkgn, jhwgn, l.jsjsdj, l.xjsdj,l.ghxlxbm,l.ghxlxmc,l.xmklx, 
		xmbm, tz, bzys, dfzc, tsdq, l.xzqh, l.gydw, l.xzqhdm, l.xzqhdm2, l.gydwdm, tbbmbm, tbbmmc, tbsj, shzt, sbzt, xmnf, sbthcd,  lsjl, bz, yhdk,gz,sz, 
		xmid, lxbm, l1.lxmc,l1.qdzh, l1.zdzh, l1.jsjsdj, l1.lc, l1.xjsdj, l.jsxz, l1.qdmc, l1.zdmc, bzcs, sffirst, jdbs, 
		gpsqdzh, gpszdzh, jsfa, yilc, erlc, sanlc, silc, dwlc, wllc,jhyilc, jherlc, jhsanlc, jhsilc, jhdwlc, jhwllc,jhlc,l1.ghlxbm,l1.ghqdzh,l1.ghzdzh,l1.ghlxmc,l1.gxlxbm,l1.gxqdzh,l1.gxzdzh
		from wnjh_sjgz l left join wnjh_lx l1 on l.id=l1.xmid where l.id=#{xmbm}  and l1.sffirst='1'
	</select>
	<select id="cxwnghlmByid" parameterType="lxsh" resultType="lxsh">
		select xmmc, ghlxbh, jhkgn, jhwgn, l.jsjsdj, l.xjsdj,l.ghxlxbm,l.ghxlxmc,l.xmklx,  
		xmbm, tz, bzys, dfzc, tsdq, l.xzqh, l.gydw, l.xzqhdm, l.xzqhdm2, l.gydwdm, tbbmbm, tbbmmc, tbsj, shzt, sbzt, xmnf, sbthcd,  lsjl, bz, yhdk,gz,sz, 
		xmid, lxbm, l1.lxmc,l1.qdzh, l1.zdzh, l1.jsjsdj, l1.lc, l1.xjsdj, l1.jsxz, l1.qdmc, l1.zdmc, bzcs, sffirst, jdbs, 
		gpsqdzh, gpszdzh, jsfa, yilc, erlc, sanlc, silc, dwlc, wllc,jhyilc, jherlc, jhsanlc, jhsilc, jhdwlc, jhwllc,l1.ghlxbm,l1.ghqdzh,l1.ghzdzh,l1.ghlxmc,l1.gxlxbm,l1.gxqdzh,l1.gxzdzh 
		from wnjh_lmgz l left join wnjh_lx l1 on l.id=l1.xmid where l.id=#{xmbm}  and l1.sffirst='1'
	</select>
	<select id="cxwnghxjByid" parameterType="lxsh" resultType="lxsh">
		select xmmc, ghlxbh, jhkgn, jhwgn, l.jsjsdj, l.xjsdj,l.ghxlxbm,l.ghxlxmc,l.xmklx,  
		xmbm, tz, bzys, dfzc, tsdq, l.xzqh, l.gydw, l.xzqhdm, l.xzqhdm2, l.gydwdm, tbbmbm, tbbmmc, tbsj, shzt, sbzt, xmnf, sbthcd,  lsjl, bz, yhdk,gz,sz, 
		xmid, lxbm, l1.lxmc,l1.qdzh, l1.zdzh, l1.jsjsdj, l1.lc, l1.xjsdj, l1.jsxz, l1.qdmc, l1.zdmc, bzcs, sffirst, jdbs, 
		gpsqdzh, gpszdzh, jsfa, yilc, erlc, sanlc, silc, dwlc, wllc,jhyilc, jherlc, jhsanlc, jhsilc, jhdwlc, jhwllc,l1.xjlxbm,l1.xjqdzh,l1.xjzdzh,l1.xjlc,l1.ghlxbm,l1.ghqdzh,l1.ghzdzh,l1.ghlxmc,l1.gxlxbm,l1.gxqdzh,l1.gxzdzh  
		from wnjh_xj l left join wnjh_lx l1 on l.id=l1.xmid where l.id=#{xmbm}  and l1.sffirst='1'
	</select>
	<delete id="delwnjhSjgz" parameterType="hashmap">
		delete from WNJH_SJGZ where id=#{xmbm}
	</delete>
	<delete id="delwnjhLmgz" parameterType="hashmap">
		delete from WNJH_LMGZ where id=#{xmbm}
	</delete>
	<delete id="delwnjhXj" parameterType="hashmap">
		delete from WNJH_XJ where id=#{xmbm}
	</delete>
	<delete id="delwnjhSjgzlx" parameterType="hashmap">
		delete from WNJH_LX where xmid=#{xmbm}
	</delete>	
	<delete id="deleteWnlx" parameterType="lxsh">
		delete from WNJH_LX where id=#{id}
	</delete>	
	<select id="queryshsjgz" parameterType="string" resultType="lxsh">
		select * from LXSH_SJGZ where ${value}
	</select>
	<select id="queryshlmgz" parameterType="string" resultType="lxsh">
		select * from LXSH_LMGZ where ${value}
	</select>
	<select id="queryshxj" parameterType="string" resultType="lxsh">
		select * from LXSH_XJ where ${value}
	</select>
	<insert id="insertsjgzkxx" parameterType="lxsh">
		insert into kxxyj_sjgz(id,xmmc,xmbm,xzqh,xzqhdm,qdzh,zdzh,jsjsdj,jsxz,yhdk,dfzc)
		values(sys_guid(),#{xmmc},#{xmbm},#{xzqh},#{xzqhdm},#{qdzh},#{zdzh},#{jsjsdj},#{jsxz},#{yhdk},#{dfzc})
	</insert>
	<insert id="insertlmgzkxx" parameterType="lxsh">
		insert into kxxyj_lmgz(id,xmmc,xmbm,xzqh,xzqhdm,qdzh,zdzh,jsjsdj,jsxz,yhdk,dfzc)
		values(sys_guid(),#{xmmc},#{xmbm},#{xzqh},#{xzqhdm},#{qdzh},#{zdzh},#{jsjsdj},#{jsxz},#{yhdk},#{dfzc})
	</insert>
	<insert id="insertxjkxx" parameterType="lxsh">
		insert into kxxyj_xj(id,xmmc,xmbm,xzqh,xzqhdm,qdzh,zdzh,jsjsdj,jsxz,yhdk,dfzc)
		values(sys_guid(),#{xmmc},#{xmbm},#{xzqh},#{xzqhdm},#{qdzh},#{zdzh},#{jsjsdj},#{jsxz},#{yhdk},#{dfzc})
	</insert>
	
	<select id="Lmgzsfkxx" parameterType="string" resultType="lxsh">
		select * from kxxyj_lmgz where 1=1 and ${value} and sbthcd is not null
	</select>
	<select id="sjgzsfkxx" parameterType="string" resultType="lxsh">
		select * from kxxyj_sjgz where 1=1 and ${value} and sbthcd is not null
	</select>
	<select id="Xjsfkxx" parameterType="string" resultType="lxsh">
		select * from kxxyj_xj where 1=1 and ${value} and sbthcd is not null
	</select>
	<select id="qqglGpsroad" parameterType="lxsh" resultType="lxsh">
		select lxbm ghlxbh,lxmc,qdzh,zdzh,qzlc lc,qdmc,zdmc,yjsdj xjsdj
		from table(funNoLmlx(#{ghlxbh},#{xzqh})) order by lxbm,qdzh
	</select>
	<update id="updatesjgz" parameterType="lxsh">
		update lxsh_sjgz set bzys=#{bzys},lc=#{lc},dfzc=(tz-#{bzys}) 
		
		where xmbm=#{xmbm}
	</update>
	<update id="updatelmgz" parameterType="lxsh">
		update lxsh_lmgz set bzys=#{bzys},lc=#{lc},dfzc=(tz-#{bzys})
		
		 where xmbm=#{xmbm}
	</update>
	<update id="updatexj" parameterType="lxsh">
		update lxsh_xj set bzys=#{bzys},lc=#{lc},dfzc=(tz-#{bzys})
		
		 where xmbm=#{xmbm}
	</update>
	<delete id="deleteLx" parameterType="lxsh">
		delete from lxsh_lx where xmid=#{xmbm} and id=#{id} 
	</delete>
	<select id="cxqdmc" parameterType="lxsh" resultType="lxsh">
		select min(f006) qdmc from gpsroad g,
       (SELECT MIN(ABS(ROADSTART- to_number(#{qdzh}))) a FROM gpsroad where SUBSTR(roadcode,1,4) = #{ghlxbh}) t
       where SUBSTR(g.roadcode,1,4) = #{ghlxbh} and (g.roadstart=to_number(#{qdzh})+t.a or g.roadstart=to_number(#{qdzh})-t.a )
	</select>
	<select id="cxzdmc" parameterType="lxsh" resultType="lxsh">
		select min(f010) zdmc from gpsroad g,
       (SELECT MIN(ABS(ROADENDS-to_number(#{qdzh}))) a FROM gpsroad where SUBSTR(roadcode,1,4) = #{ghlxbh}) t
       where SUBSTR(g.roadcode,1,4) = #{ghlxbh} and (g.ROADENDS=to_number(#{qdzh})+t.a or g.ROADENDS=to_number(#{qdzh})-t.a )
	</select>
	<delete id="deletekxlx" parameterType="hashmap">
		delete from lxsh_lx where xmid=#{xmbm} and jdbs='1'
	</delete>
	<select id="selectlxbyxmid" parameterType="lxsh" resultType="lxsh">
		select * from lxsh_lx where xmid=#{xmbm} and jdbs='0' and sffirst='1'
	</select>
	<select id="sfylx" parameterType="lxsh" resultType="lxsh">
		select count(*) shzt from wnjh_lx where xmid=#{xmbm} and sffirst='0'
	</select>
	<select id="qqglGpszh" parameterType="lxsh" resultType="lxsh">
		select gpsqdzh qdzh,gpszdzh zdzh from  wnjh_lx where lxbm=#{ghlxbh} and xmid=#{xmbm} and sffirst='1'
	</select>
	<select id="selectlxbyxmid1" parameterType="lxsh" resultType="lxsh">
		select lxbm,qdzh,zdzh from wnjh_lx where xmid=#{xmbm}
	</select>
	
	<select id="querywnjhSjgz" parameterType="lxsh" resultType="elist">
		select t.xmmc v_0,lx.lxbm v_1,lx.lxmc v_2,lx.qdzh v_3,lx.zdzh v_4,
		lx.ghlxbm v_5,lx.ghlxmc v_6,lx.ghqdzh v_7,lx.ghzdzh v_8,
		lx.gxlxbm v_9,lx.gxqdzh v_10,lx.gxzdzh v_11,lx.wlc v_12,
		lx.qdmc v_13,lx.zdmc v_14,lx.jsxz v_15,lx.gydw v_16,lx.xzqh v_17,t.tsdq v_18,lx.jsjsdj v_19,lx.xjsdj v_20,t.xmnf v_21,t.jhkgn v_22,t.jhwgn v_23,decode(lx.sffirst,'1',t.tz,'') v_24,decode(lx.sffirst,'1',lx.bzcs,'') v_25,t.xmklx v_26,t.bz v_27
		from WNJH_SJGZ t right join
		(select w.*,(case when jsxz like '%改建%' then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
					  when jsxz like '%新建%' then xjlc
					    else lc
        end) wlc
		from WNJH_LX w where 1=1 and jdbs='0' ) lx on t.id=lx.xmid where 1=1
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from wnjh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by t.id desc,lx.sffirst desc
	</select>
	<select id="querywnjhLmgz" parameterType="lxsh" resultType="elist">
		select 
		t.xmmc v_0,lx.lxbm v_1,lx.lxmc v_2,lx.qdzh v_3,lx.zdzh v_4,
		lx.ghlxbm v_5,lx.ghlxmc v_6,lx.ghqdzh v_7,lx.ghzdzh v_8,
		lx.gxlxbm v_9,lx.gxqdzh v_10,lx.gxzdzh v_11,lx.wlc v_12,
		lx.qdmc v_13,lx.zdmc v_14,lx.jsxz v_15,lx.gydw v_16,lx.xzqh v_17,t.tsdq v_18,lx.jsjsdj v_19,lx.xjsdj v_20,t.xmnf v_21,t.jhkgn v_22,t.jhwgn v_23,decode(lx.sffirst,'1',t.tz,'') v_24,decode(lx.sffirst,'1',lx.bzcs,'') v_25,t.xmklx v_26,t.bz v_27
		from WNJH_LMGZ t right join
		(select w.*,(case when jsxz like '%改建%' then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
					  when jsxz like '%新建%' then xjlc
					    else lc
        end) wlc
		from WNJH_LX w where 1=1 and jdbs='0' ) lx on t.id=lx.xmid where 1=1
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from wnjh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by t.id desc,lx.sffirst desc
	</select>
	<select id="querywnjhXj" parameterType="lxsh" resultType="elist">
		select 
			t.xmmc v_0,lx.lxbm v_1,lx.lxmc v_2,lx.qdzh v_3,lx.zdzh v_4,
		lx.ghlxbm v_5,lx.ghlxmc v_6,lx.ghqdzh v_7,lx.ghzdzh v_8,
		lx.gxlxbm v_9,lx.gxqdzh v_10,lx.gxzdzh v_11,lx.wlc v_12,
		lx.qdmc v_13,lx.zdmc v_14,lx.jsxz v_15,lx.gydw v_16,lx.xzqh v_17,t.tsdq v_18,lx.jsjsdj v_19,lx.xjsdj v_20,t.xmnf v_21,t.jhkgn v_22,t.jhwgn v_23,decode(lx.sffirst,'1',t.tz,'') v_24,decode(lx.sffirst,'1',lx.bzcs,'') v_25,t.xmklx v_26,t.bz v_27
		from WNJH_XJ t,
		(select w.*,(case when jsxz like '%改建%' then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
					  when jsxz like '%新建%' then xjlc
					    else lc
        end) wlc
		from WNJH_LX w where 1=1  ) lx  where 1=1 and t.xmbm(+)=lx.xmid
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and xmbm in (select distinct xmid from wnjh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by t.id desc,lx.sffirst desc	
	</select>

	<insert id="importsjgzwnjh" parameterType="hashMap">
		insert into WNJH_SJGZ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,tsdq,yhdk)
		values(#{xmbm},#{lxmc},#{1},#{2},to_char(to_number(#{4})-to_number(#{3})),#{11},#{3},#{4},#{qdmc},#{zdmc},#{16},#{17},#{14},#{15},#{xmbm},#{18},#{19},to_char(to_number(#{18})-to_number(#{19})),#{13},#{12},(select id from XTGL_XZQH where trim(name) = #{13}),(select id from XTGL_DEPARTMENT where trim(name) = #{12}),#{0},'7',(select id from XTGL_DEPARTMENT where trim(name) = #{12}),#{tsdq},'0')
	</insert>
	<insert id="importlmgzwnjh" parameterType="hashMap">
		insert into WNJH_LMGZ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,tsdq,yhdk)
		values(#{xmbm},#{lxmc},#{1},#{2},to_char(to_number(#{4})-to_number(#{3})),#{5},#{3},#{4},#{qdmc},#{zdmc},#{10},#{11},#{8},#{9},#{xmbm},#{12},#{13},to_char(to_number(#{12})-to_number(#{13})),#{7},#{6},(select id from XTGL_XZQH where trim(name) = #{7}),(select id from XTGL_DEPARTMENT where trim(name) = #{6}),#{0},'7',(select id from XTGL_DEPARTMENT where trim(name) = #{6}),#{tsdq},'0')
	</insert>
	<insert id="importxjwnjh" parameterType="hashMap">
		insert into WNJH_XJ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,
		tsdq,yhdk)
		values(#{xmbm},#{3},#{1},#{2},to_char(to_number(#{5})-to_number(#{4})),#{18},#{4},#{5},#{6},#{7},#{24},#{25},#{22},#{23},#{xmbm},#{26},#{27},to_char(to_number(#{26})-to_number(#{27})),#{20},#{19},(select id from XTGL_XZQH where trim(name) = #{20}),(select id from XTGL_DEPARTMENT where trim(name) = #{19}),#{0},'7',(select id from XTGL_DEPARTMENT where trim(name) = #{19}),
		#{21},'0')
	</insert>
	<insert id="importsjgzwnjhlx" parameterType="hashMap">
		insert into WNJH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh,
		yilc,erlc,sanlc,silc,dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,jhlc)
		values(sys_guid(),#{xmbm},#{2},#{lxmc},#{13},(select id from XTGL_XZQH where trim(name) = #{13}),#{12},(select id from XTGL_DEPARTMENT where trim(name) = #{12}),#{3},#{4},#{14},to_char(to_number(#{4})-to_number(#{3})),#{15},#{11},#{qdmc},#{zdmc},#{19},'1','0',#{3},#{4},
		#{yilc},#{erlc},#{sanlc},#{silc},#{dwlc},#{wllc},#{5},#{6},#{7},#{8},#{9},#{10},(#{5}+#{6}+#{7}+#{8}+#{9}+#{10}))
	</insert>
	<insert id="importlmgzwnjhlx" parameterType="hashMap">
		insert into WNJH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh,
		yilc,erlc,sanlc,silc,dwlc,wllc)
		values(sys_guid(),#{xmbm},#{2},#{lxmc},#{7},(select id from XTGL_XZQH where trim(name) = #{7}),#{6},(select id from XTGL_DEPARTMENT where trim(name) = #{6}),#{3},#{4},#{8},to_char(to_number(#{4})-to_number(#{3})),#{9},#{5},#{qdmc},#{zdmc},#{13},'1','0',#{3},#{4},
		#{yilc},#{erlc},#{sanlc},#{silc},#{dwlc},#{wllc})
	</insert>
	<insert id="importxjwnjhlx" parameterType="hashMap">
		insert into WNJH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh,
		xjlxbm,xjqdzh,xjzdzh,xjlc,yilc,erlc,sanlc,silc,dwlc,wllc)
		values(sys_guid(),#{xmbm},#{2},#{3},#{20},(select id from XTGL_XZQH where trim(name) = #{20}),#{19},(select id from XTGL_DEPARTMENT where trim(name) = #{19}),#{4},#{5},#{22},to_char(to_number(#{5})-to_number(#{4})),#{23},#{18},#{6},#{7},#{27},'1','0',#{4},#{5},
		#{8},#{9},#{10},#{11},#{12},#{13},#{14},#{15},#{16},#{17})
	</insert>

	<select id="selectWqbzbz" resultType="wqbzbz">
		select t.* from xtgl_wqbzbz t order by decode(t.bzjb,'省级',1,'市级',2),decode(t.qllx,'特大桥',1,'大桥',2,'中桥',3,'小桥',4),decode(t.jsxz,'拆除重建',1,'加固改造',2)
	</select>
	<insert id="tjwqbzbz" parameterType="wqbzbz">
		insert into xtgl_wqbzbz (id,qllx,jsxz,jsdj,bzje,zdkd,bzjb,jsdj1)
		values(sys_guid(),#{qllx},#{jsxz},#{jsdj},#{bzje},#{zdkd},#{bzjb},#{jsdj1})
	</insert>
	<insert id="xgwqbzbz" parameterType="wqbzbz">
		update xtgl_wqbzbz
		set qllx=#{qllx},jsxz=#{jsxz},jsdj=#{jsdj},bzje=#{bzje},zdkd=#{zdkd},bzjb=#{bzjb},jsdj1=#{jsdj1}
		where id=#{id}
	</insert>
	<delete id="delwqbzbz" parameterType="wqbzbz">
		delete from xtgl_wqbzbz where id=#{id}
	</delete>
	<select id="queryXmQqfx" parameterType="java.util.Map" resultType="kxxyj">
		select distinct * from table(funlxjdbs('','')) 
		where xmbm like to_char(sysdate,'yyyy')||'%'
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="shzt!=null and shzt!=''">and shzt = #{shzt}</if>
		<if test="jsxz!=null and jsxz!=''">and jsxz = #{jsxz}</if>
		<if test="lxbm!=null and lxbm!=''">and lxbm like '%'||#{lxbm}||'%' </if>
		<if test="wgny!=null and wgny!=''">and (wgny = #{wgny} or wgny = to_char(to_date(#{wgny},'yyyy-mm-ss'),'yyyy') or wgny = to_char( to_date(#{wgny},'yyyy-MM-ss'),'yyyy-mm'))</if>
		<if test="xmbm!=null and xmbm!=''">and xmbm in (${xmbm})</if>
		order by xmbm
	</select>
	<select id="queryBeformXm" parameterType="java.util.Map" resultType="java.util.Map">
		select substr(roadcode,1,4) roadcode,min(roadstart) roadstart,max(roadends) roadends,max(decode(f026,null,f025,f026)) wgnf,
		sum(roadlen) lc,sum(decode(f014,2,roadlen,0)) yj,sum(decode(f014,3,roadlen,0)) ej,sum(decode(f014,4,roadlen,0)) Sj,
		sum(decode(f014,5,roadlen,0)) SIj,sum(decode(f014,6,roadlen,0)) WL
		from gpsroad  WHERE substr(roadcode,1,4) in(${lxbm}) group by substr(roadcode,1,4)
	</select>
	<select id="queryBeformXmByXzqh" parameterType="java.util.Map" resultType="java.util.Map">
		select substr(roadcode,0,1) roadcode,min(roadstart) roadstart,max(roadends) roadends,max(decode(f026,null,f025,f026)) wgnf,
	    sum(roadlen) lc,sum(decode(f014,2,roadlen,0)) yj,sum(decode(f014,3,roadlen,0)) ej,sum(decode(f014,4,roadlen,0)) Sj,
	    sum(decode(f014,5,roadlen,0)) SIj,sum(decode(f014,6,roadlen,0)) WL,#{xzqhmc} xzqhmc
	    from gpsroad  WHERE substr(roadcode,0,1) in('S','G') and (roadcode like '%'||#{xzqhdm}||'%') group by substr(roadcode,0,1)
	</select>
	<select id="queryNdwg" parameterType="java.util.Map" resultType="java.util.Map">
		select xmid,lxbm
		,decode(substr(xmid,11,1),1,sum(l.yilc),3,0) yilc
		,decode(substr(xmid,11,1),1,sum(l.erlc),3,0) erlc
		,decode(substr(xmid,11,1),1,sum(l.sanlc),3,0) sanlc
		,decode(substr(xmid,11,1),1,sum(l.silc),3,0) silc
		,decode(substr(xmid,11,1),1,sum(l.dwlc),3,0) dwlc
		,decode(substr(xmid,11,1),1,sum(l.wllc),3,0) wllc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhyilc),0),3,nvl(sum(l.yilc),0)) jhyilc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jherlc),0),3,nvl(sum(l.erlc),0)) jherlc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhsanlc),0),3,nvl(sum(l.sanlc),0)) jhsanlc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhsilc),0),3,nvl(sum(l.silc),0)) jhsilc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhdwlc),0),3,nvl(sum(l.dwlc),0)) jhdwlc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhwllc),0),3,nvl(sum(l.wllc),0)) jhwllc
		from lxsh_lx l where ${xmbm} group by xmid,lxbm 
	</select>
	<select id="queryNdwgXzqh" parameterType="java.util.Map" resultType="java.util.Map">
		select 
		<if test="qb==false">substr(xmid,5,6) xzqhdm,</if>
		<if test="qb==true">'江西省' xzqhmc,</if>
		substr(lxbm,0,1) lxbm
		,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,sum(dwlc) dwlc,sum(wllc) wllc
		,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(sanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc 
		from(select xmid,lxbm
		,decode(substr(xmid,11,1),1,l.yilc,3,0) yilc,decode(substr(xmid,11,1),1,l.erlc,3,0) erlc
		,decode(substr(xmid,11,1),1,l.sanlc,3,0) sanlc,decode(substr(xmid,11,1),1,l.silc,3,0) silc
		,decode(substr(xmid,11,1),1,l.dwlc,3,0) dwlc,decode(substr(xmid,11,1),1,l.wllc,3,0) wllc
		,decode(substr(xmid,11,1),1,nvl(l.jhyilc,0),3,nvl(l.yilc,0)) jhyilc,decode(substr(xmid,11,1),1,nvl(l.jherlc,0),3,nvl(l.erlc,0)) jherlc
		,decode(substr(xmid,11,1),1,nvl(l.jhsanlc,0),3,nvl(l.sanlc,0)) jhsanlc,decode(substr(xmid,11,1),1,nvl(l.jhsilc,0),3,nvl(l.silc,0)) jhsilc
		,decode(substr(xmid,11,1),1,nvl(l.jhdwlc,0),3,nvl(l.dwlc,0)) jhdwlc,decode(substr(xmid,11,1),1,nvl(l.jhwllc,0),3,nvl(l.wllc,0)) jhwllc
		from lxsh_lx l where substr(lxbm,0,1) in('S','G') and (${xmbm})) 
		group by <if test="qb==false">substr(xmid,5,6),</if>substr(lxbm,0,1)
	</select>
	<select id="showgjtj" parameterType="lxsh" resultType="lxsh">
		select count(*) sl,nvl(sum(tz),0) tz,nvl(sum(bzys),0) bzys,nvl(sum(zlc),0) lc,nvl((sum(tz)-sum(bzys)),0) dftz,'0' sbz,'0' sjl  from (
	    select rownum num ,t.*,lx.*,decode(lx1.sl,null,'0',lx1.sl) sl,lx2.zjhlc,lx2.lc zlc from WNJH_SJGZ t left join
	    (select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
	    sum(dwlc) dwlc,sum(wllc) wllc,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(jhsanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc,sum(jhlc) jhlc
	    from WNJH_LX where sffirst='1' group by xmid) lx on t.id=lx.xmid 
	    left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
	    left join (select xmid,decode(min(jsxz),'改建',nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0),nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0))  zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
        nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0) lc,
        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'改建工程' xmlx1 
        from WNJH_LX group by xmid) lx2 on t.id=lx2.xmid
	    where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and ghlxbmtj like '%'||#{ghlxbh}||'%'
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="ghxlxbm!=null and ghxlxbm!=''">
			and (t.id in (select distinct xmid from lx_clsd1 where ghlxbm like '%'||#{ghxlxbm}||'%')
			)
		</if>
		<if test="ghxlxmc!='' and ghxlxmc!= null ">
			and (t.id in (select distinct xmid from lx_clsd1 where ghlxmc like '%'||#{ghxlxmc}||'%')
			)
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by xmnf
		) t1
	</select>
	<select id="showlmtj" parameterType="lxsh" resultType="lxsh">
		select count(*) sl,sum(tz) tz,sum(bzys) bzys,sum(jhlc) lc,(sum(tz)-sum(bzys)) dftz,'0' sbz,'0' sjl  from (
		select rownum num ,t.lsjl,t.xmnf,t.gz,t.sz,t.jhkgn,t.jhwgn,t.jsxz,t.yhdk,t.bz,t.id,t.lxmc,t.shzt,t.xmmc,t.xmbm,t.gydw,t.xzqh,t.ghlxbh,t.qdmc,t.zdmc,t.xjsdj,t.jsjsdj,t.tz,t.bzys,t.dfzc,t.tsdq,lx.*,lx1.sl,lx2.jhlc  from wnjh_lmgz t left join 
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(lc) lc,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc from wnjh_lx where sffirst='1' group by xmid) lx on t.id=lx.xmid left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid 
		left join (select xmid,decode(min(jsxz),'改建',nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0),nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0))  jhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
   		replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
   		replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
    	replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'改建工程' xmlx1 
    	from WNJH_LX group by xmid) lx2 on t.id=lx2.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and ghlxbmtj like '%'||#{ghlxbh}||'%'
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="ghxlxbm!=null and ghxlxbm!=''">
			and (t.id in (select distinct xmid from lx_clsd1 where ghlxbm like '%'||#{ghxlxbm}||'%')
			)
		</if>
		<if test="ghxlxmc!='' and ghxlxmc!= null ">
			and (t.id in (select distinct xmid from lx_clsd1 where ghlxmc like '%'||#{ghxlxmc}||'%')
			)
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by xmnf
		) t1
	</select>
	<select id="showxjtj" parameterType="lxsh" resultType="lxsh">
		select count(*) sl,sum(tz) tz,sum(bzys) bzys,sum(jhlc) lc,(sum(tz)-sum(bzys)) dftz,'0' sbz,'0' sjl  from (
		select rownum num ,t.*,tt.bzys1,lx1.*,lx2.sl,lx3.jhlc from WNJH_XJ t left join (select xmid,sum(bzcs) bzys1 from wnjh_lx where sffirst='1' group by xmid) tt on t.id=tt.xmid left join 
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,max(xjlxbm) xjlxbm,max(xjqdzh) xjqdzh,max(xjzdzh) xjzdzh,max(xjlc) xjlc
		from wnjh_lx where sffirst='1' group by xmid) lx1 on t.id=lx1.xmid left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx2 on t.id=lx2.xmid
		left join (select xmid,decode(min(jsxz),'改建',nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0),nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0))  jhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
   		replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
   		replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
    	replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'改建工程' xmlx1 
    	from WNJH_LX group by xmid) lx3 on t.id=lx3.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and ghlxbmtj like '%'||#{ghlxbh}||'%'
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="ghxlxbm!=null and ghxlxbm!=''">
			and (t.id in (select distinct xmid from lx_clsd1 where ghlxbm like '%'||#{ghxlxbm}||'%')
			)
		</if>
		<if test="ghxlxmc!='' and ghxlxmc!= null ">
			and (t.id in (select distinct xmid from lx_clsd1 where ghlxmc like '%'||#{ghxlxmc}||'%')
			)
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by xmnf
		) t1
	</select>
	<select id="selectJxAndGj" parameterType="lxsh" resultType="lxsh">
		select * from (
		select w.id,w.xmmc,w.jhwgn,l.xzqh,l.xzqhdm,l.lxbm,l.lxmc,l.qdzh,l.zdzh,l.jsxz,l.yilc,l.erlc,l.sanlc,l.silc,l.wllc,
		l.jhyilc,l.jherlc,l.jhsanlc,l.jhsilc,l.jhwllc from wnjh_lmgz w left join wnjh_lx l on w.id = l.xmid
		union all
		select w.id,w.xmmc,w.jhwgn,l.xzqh,l.xzqhdm,l.lxbm,l.lxmc,l.qdzh,l.zdzh,l.jsxz,l.yilc,l.erlc,l.sanlc,l.silc,l.wllc ,
		l.jhyilc,l.jherlc,l.jhsanlc,l.jhsilc,l.jhwllc from wnjh_xj w left join wnjh_lx l on w.id = l.xmid)
		where 1=1
		<if test="xzqh!=null and xzqh!=''">${xzqh}</if>
		<if test="lxbm!=null and lxbm!=''"> and lxbm like #{lxbm}||'%'</if>
		<if test="id!=null and id!=''"> and id in (${id})</if>
	</select>
	<select id="selectYlx" parameterType="lxsh" resultType="java.util.Map">
		select substr(roadcode,1,4) roadcode,min(roadstart) roadstart,max(roadends) roadends,max(decode(f026,null,f025,f026)) wgnf,
		sum(roadlen) lc,sum(decode(f014,2,roadlen,0)) yj,sum(decode(f014,3,roadlen,0)) ej,sum(decode(f014,4,roadlen,0)) Sj,
		sum(decode(f014,5,roadlen,0)) SIj,sum(decode(f014,6,roadlen,0)) WL
		from gpsroad  WHERE substr(roadcode,1,4) in(${lxbm}) group by substr(roadcode,1,4)
	</select>
	<select id="selectYSj" parameterType="java.util.Map" resultType="java.util.Map">
		select substr(roadcode,0,1) roadcode,min(roadstart) roadstart,max(roadends) roadends,max(decode(f026,null,f025,f026)) wgnf,
	    sum(roadlen) lc,sum(decode(f014,2,roadlen,0)) yj,sum(decode(f014,3,roadlen,0)) ej,sum(decode(f014,4,roadlen,0)) Sj,
	    sum(decode(f014,5,roadlen,0)) SIj,sum(decode(f014,6,roadlen,0)) WL,#{xzqhmc} xzqhmc
	    from gpsroad  WHERE substr(roadcode,0,1) in('S','G') 
	    and (roadcode like '%'||#{xzqhdm}||'%')
	     group by substr(roadcode,0,1)
	</select>
	<select id="selectGhSj" parameterType="java.util.Map" resultType="java.util.Map">
		select 
		<if test="qb==false">#{xzqhdm} xzqhdm,</if>
		<if test="qb==true">'江西省' xzqhmc,</if>
		substr(lxbm,0,1) lxbm
		,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,sum(dwlc) dwlc,sum(wllc) wllc
		,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(sanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc 
		from(select xmid,lxbm ,l.yilc,l.erlc ,l.sanlc,l.silc ,l.dwlc,l.wllc,l.jhyilc,l.jherlc ,l.jhsanlc,l.jhsilc,l.jhdwlc,l.jhwllc
		from wnjh_lx l where substr(lxbm,0,1) in('S','G') and xzqhdm like #{xzqhdm}||'%') 
		group by substr(lxbm,0,1)
	</select>
	
	
	
	<select id="selectGsdwnjh" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.*,lx.*,decode(lx1.sl,null,'0',lx1.sl) sl,lx2.zjhlc from wngsdgz t left join
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(jhsanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc,sum(jhlc) jhlc,max(xjlxbm) xjlxbm,min(xjqdzh) xjqdzh,max(xjzdzh) xjzdzh,min(ghlxbm) ghlxbm,max(ghqdzh) ghqdzh,max(ghzdzh) ghzdzh
		from WNJH_LX where sffirst='1' group by xmid) lx on t.id=lx.xmid 
		left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
		left join (select xmid,
		sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
        from (select  xmid,jsxz,
        (case when jsxz like '%改建%' then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)
        when jsxz like '%新建%' then to_number(xjlc)
        else to_number(lc)
        end) jhlc,lxbm,lxmc,(case when jsxz like '%新建%' then xjlxbm 
        else ghxlxbm
        end) ghxlxbm,ghxlxmc,jsjsdj,xjsdj
        from WNJH_LX ) group by xmid) lx2 on t.id=lx2.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and ghlxbmtj like '%'||#{ghlxbh}||'%'
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by xmnf
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
	</select>
	<select id="selectGsdwnjhCount" parameterType="lxsh" resultType="int">
		select count(*) from (
		select rownum num ,t.*,lx.*,decode(lx1.sl,null,'0',lx1.sl) sl,lx2.zjhlc from wngsdgz t left join
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(jhsanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc,sum(jhlc) jhlc
		from WNJH_LX where sffirst='1' group by xmid) lx on t.id=lx.xmid 
		left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
		left join (select xmid,
		sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
        from (select  xmid,jsxz,
        (case when jsxz like '%改建%' then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)
        when jsxz like '%新建%' then to_number(xjlc)
        else to_number(lc)
        end) jhlc,lxbm,lxmc,(case when jsxz like '%新建%' then xjlxbm 
        else ghxlxbm
        end) ghxlxbm,ghxlxmc,jsjsdj,xjsdj
        from WNJH_LX ) group by xmid) lx2 on t.id=lx2.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and ghlxbmtj like '%'||#{ghlxbh}||'%'
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by xmnf
		) t1
	</select>
	<select id="showgsdtj" parameterType="lxsh" resultType="lxsh">
		select count(*) sl,sum(tz) tz,sum(bzys) bzys,sum(zjhlc) lc,'0' cgs,'0' sbz,'0' sjl,(sum(tz)-sum(bzys)) dftz  from (
		select rownum num ,t.*,lx.*,decode(lx1.sl,null,'0',lx1.sl) sl,lx2.zjhlc from wngsdgz t left join
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(jhsanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc,sum(jhlc) jhlc
		from WNJH_LX where sffirst='1' group by xmid) lx on t.id=lx.xmid 
		left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
		left join (select xmid,
		sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,?L>
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
        from (select  xmid,jsxz,
        (case when jsxz like '%改建%' then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)
        when jsxz like '%新建%' then to_number(xjlc)
        else nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)
        end) jhlc,lxbm,lxmc,(case when jsxz like '%新建%' then xjlxbm 
        else ghxlxbm
        end) ghxlxbm,ghxlxmc,jsjsdj,xjsdj
        from WNJH_LX ) group by xmid) lx2 on t.id=lx2.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and ghlxbmtj like '%'||#{ghlxbh}||'%'
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by xmnf
		) t1
	</select>
	<select id="querywnjhGsdgz" parameterType="lxsh" resultType="elist">
		select * from (
		select t.xmmc v_0,lx.lxbm v_1,lx.lxmc v_2,lx.qdzh v_3,lx.zdzh v_4,
		lx.ghlxbm v_5,lx.ghlxmc v_6,lx.ghqdzh v_7,lx.ghzdzh v_8,
		lx.gxlxbm v_9,lx.gxqdzh v_10,lx.gxzdzh v_11,lx.wlc v_12,
		lx.qdmc v_13,lx.zdmc v_14,lx.jsxz v_15,lx.gydw v_16,lx.xzqh v_17,t.tsdq v_18,lx.jsjsdj v_19,lx.xjsdj v_20,t.xmnf v_21,t.jhkgn v_22,t.jhwgn v_23,decode(lx.sffirst,'1',t.tz,'') v_24,decode(lx.sffirst,'1',lx.bzcs,'') v_25,t.xmklx v_26,t.bz v_27,decode(lx1.sl,null,'0',lx1.sl) sl,lx2.zjhlc from wngsdgz t left join
		(select w.*,(case when jsxz like '%改建%' then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
					  when jsxz like '%新建%' then xjlc
					    else lc
        end) wlc
		from WNJH_LX w) lx on t.id=lx.xmid 
		left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
		left join (select xmid,
		sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
        from (select  xmid,jsxz,
        (case when jsxz like '%改建%' then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
					  when jsxz like '%新建%' then xjlc
					    else lc
        end) jhlc,lxbm,lxmc,(case when jsxz like '%新建%' then xjlxbm 
        else ghxlxbm
        end) ghxlxbm,ghxlxmc,jsjsdj,xjsdj
        from WNJH_LX ) group by xmid) lx2 on t.id=lx2.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and ghlxbmtj like '%'||#{ghlxbh}||'%'
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			and ghxlxbmtj like '%'||#{ghxlxbm}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by t.id,lx.sffirst desc
		) t1
	</select>
	
	
	<select id="getWngjinfobyid" parameterType="String" resultType="lxsh">
		select * from wnjh_sjgz where id=#{value}
	</select>
	<select id="getWnlminfobyid" parameterType="String" resultType="lxsh">
		select * from wnjh_lmgz where id=#{value}
	</select>
	<select id="getWnxjinfobyid" parameterType="String" resultType="lxsh">
		select * from wnjh_xj where id=#{value}
	</select>
	<update id="updateWnxmjd" parameterType="lxsh">
		update ${bz} set xmjd=#{xmjd} where id in (select wnid from ${bzcs} where xmbm in(${xmbm}))
	</update>
</mapper>

