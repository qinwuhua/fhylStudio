<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.wnjh">
	<insert id="insertlxcfld" parameterType="lxsh">
		insert into lx_cfld(id,lxid,cfld,cfqd,cfzd)
		select sys_guid(),#{id},lxbm,qdzh,zdzh from table(fun_cfld(#{ghlxbm},${ghqdzh},${ghzdzh}))
	</insert>
	<delete id="deletelxcfld" parameterType="lxsh">
		delete from lx_cfld where lxid=#{id}
	</delete>
	<select id="selectimportXmbm" parameterType="String" resultType="String">
		${value}
	</select>
	<select id="selectXmbm" parameterType="String" resultType="String">
		select max(substr(xmbm,-3)) from lxsh_sjgz where xmbm like ${value}||'%'
	</select>
	<select id="selectlmgzXmbm" parameterType="String" resultType="String">
		select max(substr(xmbm,-3)) from lxsh_lmgz where xmbm like ${value}||'%'
	</select>
	<select id="selectxjXmbm" parameterType="String" resultType="String">
		select max(substr(xmbm,-3)) from lxsh_xj where xmbm like ${value}||'%'
	</select>
	<select id="selectbzcs" parameterType="lxsh" resultType="lxsh">
		select bzzj bzys from PLAN_FLWBZBZ where xmlx=#{xmlx} and gldj=#{gldj} and jsdj like #{jsdj}||'%'
	</select>
	<select id="selectGjwnjhcf" parameterType="lxsh" resultType="lxsh">
		select * from wnjh_sjgz where 
		xmbm in(
		select xmid from wnjh_lx where ghlxbm = #{ghlxbh} 
		and (xzqhdm like rtrim(#{xzqh},'0')||'%' or xzqhdm2 like rtrim(#{xzqh},'0')||'%')
		and ghqdzh&lt;#{zdzh} 
		and ghzdzh>#{qdzh}
		)
	</select>
	<select id="selectLmwnjhcf" parameterType="lxsh" resultType="lxsh">
		select * from wnjh_lmgz where 
		xmbm in(
		select xmid from wnjh_lx where ghlxbm = #{ghlxbh} 
		and (xzqhdm like rtrim(#{xzqh},'0')||'%' or xzqhdm2 like rtrim(#{xzqh},'0')||'%')
		and ghqdzh&lt;#{zdzh} 
		and ghzdzh>#{qdzh}
		)
	</select>
	<select id="selectXjwnjhcf" parameterType="lxsh" resultType="lxsh">
		select * from wnjh_xj where 
		xmbm in(
		select xmid from wnjh_lx where xjlxbm = #{ghlxbh} 
		and (xzqhdm like rtrim(#{xzqh},'0')||'%' or xzqhdm2 like rtrim(#{xzqh},'0')||'%')
		and xjqdzh&lt;#{zdzh} 
		and xjzdzh>#{qdzh}
		)
	</select>
	<insert id="insertGjwnjh" parameterType="lxsh">
		insert into WNJH_SJGZ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,tsdq,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,lsjl,bz,yhdk,gz,sz,ghxlxbm,ghxlxmc,xmklx,qqkzzt<if test="xzqhdm2 != null">,xzqhdm2</if><if test="lsxmbm !=null">,lsxmbm</if>
		<if test="lsxmid !=null">,lsxmid</if>)
		values(#{xmbm},#{lxmc},#{xmmc},#{ghlxbh},#{lc},#{jsxz},#{qdzh},#{zdzh},#{qdmc},#{zdmc},#{jhkgn},#{jhwgn},#{jsjsdj},#{xjsdj},#{xmbm},#{tz},#{bzys},#{dfzc},#{tsdq},#{xzqh},#{gydw},#{xzqhdm},#{gydwdm},#{xmnf},#{sbthcd},#{tbbmbm},#{lsjl},#{bz},#{yhdk},#{gz},#{sz},#{ghxlxbm},#{ghxlxmc},#{xmklx},'未开展'<if test="xzqhdm2 != null">,#{xzqhdm2}</if><if test="lsxmbm !=null">,#{lsxmbm}</if>
		<if test="lsxmid !=null">,#{lsxmid}</if>)
	</insert>
	<insert id="insertLmwnjh" parameterType="lxsh">
		insert into WNJH_LMGZ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,tsdq,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,lsjl,bz,yhdk,gz,sz,ghxlxbm,ghxlxmc,xmklx,qqkzzt<if test="xzqhdm2 != null">,xzqhdm2</if><if test="lsxmbm !=null">,lsxmbm</if>
		<if test="lsxmid !=null">,lsxmid</if>)
		values(#{xmbm},#{lxmc},#{xmmc},#{ghlxbh},#{lc},#{jsxz},#{qdzh},#{zdzh},#{qdmc},#{zdmc},#{jhkgn},#{jhwgn},#{jsjsdj},#{xjsdj},#{xmbm},#{tz},#{bzys},#{dfzc},#{tsdq},#{xzqh},#{gydw},#{xzqhdm},#{gydwdm},#{xmnf},#{sbthcd},#{tbbmbm},#{lsjl},#{bz},#{yhdk},#{gz},#{sz},#{ghxlxbm},#{ghxlxmc},#{xmklx},'未开展'<if test="xzqhdm2 != null">,#{xzqhdm2}</if><if test="lsxmbm !=null">,#{lsxmbm}</if>
		<if test="lsxmid !=null">,#{lsxmid}</if>)
	</insert>
	<insert id="insertXjwnjh" parameterType="lxsh">
		insert into WNJH_XJ( qqkzzt
		<if test="xmbm != null">,id</if>
		<if test="lxmc != null">,lxmc</if>
		<if test="xmmc != null">,xmmc</if>
		<if test="ghlxbh != null">,ghlxbh</if>
		<if test="lc != null">,lc</if>
		<if test="jsxz != null">,jsxz</if>
		<if test="qdzh != null">,qdzh</if>
		<if test="zdzh != null">,zdzh</if>
		<if test="qdmc != null">,qdmc</if>
		<if test="zdmc != null">,zdmc</if>
		<if test="jhkgn != null">,jhkgn</if>
		<if test="jhwgn != null">,jhwgn</if>
		<if test="jsjsdj != null">,jsjsdj</if>
		<if test="xjsdj != null">,xjsdj</if>
		<if test="xmbm != null">,xmbm</if>
		<if test="tz != null">,tz</if>
		<if test="bzys != null">,bzys</if>
		<if test="dfzc != null">,dfzc</if>
		<if test="tsdq != null">,tsdq</if>
		<if test="xzqh != null">,xzqh</if>
		<if test="gydw != null">,gydw</if>
		<if test="xzqhdm != null">,xzqhdm</if>
		<if test="gydwdm != null">,gydwdm</if>
		<if test="xmnf != null">,xmnf</if>
		<if test="sbthcd != null">,sbthcd</if>
		<if test="tbbmbm != null">,tbbmbm</if>
		<if test="lsjl != null">,lsjl</if>
		<if test="bz != null">,bz</if>
		<if test="yhdk != null">,yhdk</if>
		<if test="gz != null">,gz</if>
		<if test="sz != null">,sz</if>
		<if test="xmklx != null">,xmklx</if>
		
		<if test="xzqhdm2 != null">,xzqhdm2</if><if test="lsxmbm !=null">,lsxmbm</if>
		<if test="lsxmid !=null">,lsxmid</if>)
		values(
		'未开展'
		<if test="xmbm != null">,#{xmbm}</if>
		<if test="lxmc != null">,#{lxmc}</if>
		<if test="xmmc != null">,#{xmmc}</if>
		<if test="ghlxbh != null">,#{ghlxbh}</if>
		<if test="lc != null">,#{lc}</if>
		<if test="jsxz != null">,#{jsxz}</if>
		<if test="qdzh != null">,#{qdzh}</if>
		<if test="zdzh != null">,#{zdzh}</if>
		<if test="qdmc != null">,#{qdmc}</if>
		<if test="zdmc != null">,#{zdmc}</if>
		<if test="jhkgn != null">,#{jhkgn}</if>
		<if test="jhwgn != null">,#{jhwgn}</if>
		<if test="jsjsdj != null">,#{jsjsdj}</if>
		<if test="xjsdj != null">,#{xjsdj}</if>
		<if test="xmbm != null">,#{xmbm}</if>
		<if test="tz != null">,#{tz}</if>
		<if test="bzys != null">,#{bzys}</if>
		<if test="dfzc != null">,#{dfzc}</if>
		<if test="tsdq != null">,#{tsdq}</if>
		<if test="xzqh != null">,#{xzqh}</if>
		<if test="gydw != null">,#{gydw}</if>
		<if test="xzqhdm != null">,#{xzqhdm}</if>
		<if test="gydwdm != null">,#{gydwdm}</if>
		<if test="xmnf != null">,#{xmnf}</if>
		<if test="sbthcd != null">,#{sbthcd}</if>
		<if test="tbbmbm != null">,#{tbbmbm}</if>
		<if test="lsjl != null">,#{lsjl}</if>
		<if test="bz != null">,#{bz}</if>
		<if test="yhdk != null">,#{yhdk}</if>
		<if test="gz != null">,#{gz}</if>
		<if test="sz != null">,#{sz}</if>
		<if test="xmklx != null">,#{xmklx}</if>
		<if test="xzqhdm2 != null">,#{xzqhdm2}</if><if test="lsxmbm !=null">,#{lsxmbm}</if>
		<if test="lsxmid !=null">,#{lsxmid}</if>)
	</insert>
	<insert id="insertlx" parameterType="lxsh">
		insert into WNJH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh
		<if test="xjlxbm!='' and xjlxbm!=null">,xjlxbm</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,xjqdzh</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,xjzdzh</if>
		<if test="xjlc!='' and xjlc!=null">,xjlc</if>
		,yilc,erlc,sanlc,silc,dwlc,wllc
		<if test="jhyilc!=null">,jhyilc</if>
		<if test="jherlc!=null">,jherlc</if>
		<if test="jhsanlc!=null">,jhsanlc</if>
		<if test="jhsilc!=null">,jhsilc</if>
		<if test="jhdwlc!=null">,jhdwlc</if>
		<if test="jhwllc!=null">,jhwllc</if>
		<if test="jhlc!=null">,jhlc</if>
		<if test="ghxlxbm !=null">,ghxlxbm</if>
		<if test="ghxlxmc !=null">,ghxlxmc</if>
		<if test="ghlxbm !=null">,ghlxbm</if>
		<if test="ghlxmc !=null">,ghlxmc</if>
		<if test="ghqdzh !=null">,ghqdzh</if>
		<if test="ghzdzh !=null">,ghzdzh</if>
		<if test="gxlxbm !=null">,gxlxbm</if>
		<if test="gxqdzh !=null">,gxqdzh</if>
		<if test="gxzdzh !=null">,gxzdzh</if>
		
		)
		values(#{id},#{xmbm},#{ghlxbh},#{lxmc},#{xzqh},#{xzqhdm},#{gydw},#{gydwdm},#{qdzh},#{zdzh},#{jsjsdj},#{lc},#{xjsdj},#{jsxz},#{qdmc},#{zdmc},#{bzys},'1',#{jdbs},#{gpsqdzh},#{gpszdzh}
		<if test="xjlxbm!='' and xjlxbm!=null">,#{xjlxbm}</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,#{xjqdzh}</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,#{xjzdzh}</if>
		<if test="xjlc!='' and xjlc!=null">,#{xjlc}</if>
		,#{yilc},#{erlc},#{sanlc},#{silc},#{dwlc},#{wllc}
		<if test="jhyilc!=null">,#{jhyilc}</if>
		<if test="jherlc!=null">,#{jherlc}</if>
		<if test="jhsanlc!=null">,#{jhsanlc}</if>
		<if test="jhsilc!=null">,#{jhsilc}</if>
		<if test="jhdwlc!=null">,#{jhdwlc}</if>
		<if test="jhwllc!=null">,#{jhwllc}</if>
		<if test="jhlc!=null">,#{jhlc}</if>
		<if test="ghxlxbm !=null">,#{ghxlxbm}</if>
		<if test="ghxlxmc !=null">,#{ghxlxmc}</if>
		<if test="ghlxbm !=null">,#{ghlxbm}</if>
		<if test="ghlxmc !=null">,#{ghlxmc}</if>
		<if test="ghqdzh !=null">,#{ghqdzh}</if>
		<if test="ghzdzh !=null">,#{ghzdzh}</if>
		<if test="gxlxbm !=null">,#{gxlxbm}</if>
		<if test="gxqdzh !=null">,#{gxqdzh}</if>
		<if test="gxzdzh !=null">,#{gxzdzh}</if>
		)
	</insert>
	<update id="updateGjlsjl" parameterType="lxsh">
	update ${xmlx} set lsjl=#{lsjl} where id=#{xmbm}
	</update>
	<insert id="insertGjlxwnjh" parameterType="lxsh">
		insert into WNJH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,gpsqdzh,gpszdzh
		<if test="xjlxbm!='' and xjlxbm!=null">,xjlxbm</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,xjqdzh</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,xjzdzh</if>
		<if test="xjlc!='' and xjlc!=null">,xjlc</if>
		,yilc,erlc,sanlc,silc,dwlc,wllc
		<if test="jhyilc!=null">,jhyilc</if>
		<if test="jherlc!=null">,jherlc</if>
		<if test="jhsanlc!=null">,jhsanlc</if>
		<if test="jhsilc!=null">,jhsilc</if>
		<if test="jhdwlc!=null">,jhdwlc</if>
		<if test="jhwllc!=null">,jhwllc</if>
		<if test="jhlc!=null">,jhlc</if>
		<if test="ghxlxbm !=null">,ghxlxbm</if>
		<if test="ghxlxmc !=null">,ghxlxmc</if>
		<if test="ghlxbm !=null">,ghlxbm</if>
		<if test="ghlxmc !=null">,ghlxmc</if>
		<if test="ghqdzh !=null">,ghqdzh</if>
		<if test="ghzdzh !=null">,ghzdzh</if>
		<if test="gxlxbm !=null">,gxlxbm</if>
		<if test="gxqdzh !=null">,gxqdzh</if>
		<if test="gxzdzh !=null">,gxzdzh</if>
		)
		values(#{id},#{xmbm},#{ghlxbh},#{lxmc},#{xzqh},#{xzqhdm},#{gydw},#{gydwdm},#{qdzh},#{zdzh},#{jsjsdj},#{lc},#{xjsdj},#{jsxz},#{qdmc},#{zdmc},'0','0',#{gpsqdzh},#{gpszdzh}
		<if test="xjlxbm!='' and xjlxbm!=null">,#{xjlxbm}</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,#{xjqdzh}</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,#{xjzdzh}</if>
		<if test="xjlc!='' and xjlc!=null">,#{xjlc}</if>
		,#{yilc},#{erlc},#{sanlc},#{silc},#{dwlc},#{wllc}
		<if test="jhyilc!=null">,#{jhyilc}</if>
		<if test="jherlc!=null">,#{jherlc}</if>
		<if test="jhsanlc!=null">,#{jhsanlc}</if>
		<if test="jhsilc!=null">,#{jhsilc}</if>
		<if test="jhdwlc!=null">,#{jhdwlc}</if>
		<if test="jhwllc!=null">,#{jhwllc}</if>
		<if test="jhlc!=null">,#{jhlc}</if>
		<if test="ghxlxbm !=null">,#{ghxlxbm}</if>
		<if test="ghxlxmc !=null">,#{ghxlxmc}</if>
		<if test="ghlxbm !=null">,#{ghlxbm}</if>
		<if test="ghlxmc !=null">,#{ghlxmc}</if>
		<if test="ghqdzh !=null">,#{ghqdzh}</if>
		<if test="ghzdzh !=null">,#{ghzdzh}</if>
		<if test="gxlxbm !=null">,#{gxlxbm}</if>
		<if test="gxqdzh !=null">,#{gxqdzh}</if>
		<if test="gxzdzh !=null">,#{gxzdzh}</if>
		
		)
	</insert>
	
	<select id="querylxlist" parameterType="lxsh" resultType="lxsh">
		select t.*,bzcs bzys,xmid xmbm,lxbm ghlxbh from lxsh_lx t where xmid=#{xmbm} and jdbs=#{jdbs}
	</select>
	<!--  华丽的分割线________________________________________________________华丽的分割线 -->
	<select id="selectGjwnjh" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.*,lx.*,decode(lx1.sl,null,'0',lx1.sl) sl,lx2.zjhlc from WNJH_SJGZ t left join
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(jhsanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc,sum(jhlc) jhlc
		,WMSYS.WM_CONCAT(to_char(ghlxbm)) ghlxbm,WMSYS.WM_CONCAT(to_char(ghqdzh)) ghqdzh
		,WMSYS.WM_CONCAT(to_char(ghzdzh)) ghzdzh,WMSYS.WM_CONCAT(to_char(ghlxmc)) ghlxmc
		,WMSYS.WM_CONCAT(to_char(gxlxbm)) gxlxbm,WMSYS.WM_CONCAT(to_char(gxqdzh)) gxqdzh
		,WMSYS.WM_CONCAT(to_char(gxzdzh)) gxzdzh
		from WNJH_LX where sffirst='1' group by xmid) lx on t.id=lx.xmid 
		left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
		left join (select xmid,decode(min(jsxz),'改建',nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0),nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(decode(jsxz,'新建',xjlxbm,ghlxbm)),',',',') ghxlxbmtj,
   		replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
   		replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
    	replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'改建工程' xmlx1 
    	from WNJH_LX group by xmid) lx2 on t.id=lx2.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			${ghlxbh}
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			${ghxlxbm}
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmjd !='' and xmjd != null ">
			and xmjd like '%'||#{xmjd}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by xmnf
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
	</select>
	<select id="selectGjwnjhCount" parameterType="lxsh" resultType="int">
		select count(*) from (
		select rownum num ,t.*,lx.*,decode(lx1.sl,null,'0',lx1.sl) sl,lx2.zjhlc from WNJH_SJGZ t left join
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(jhsanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc,sum(jhlc) jhlc
		from WNJH_LX where sffirst='1' group by xmid) lx on t.id=lx.xmid 
		left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
		left join (select xmid,sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(decode(jsxz,'新建',xjlxbm,ghlxbm)),',',',') ghxlxbmtj,
   		replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
   		replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
    	replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'改建工程' xmlx1 
    	from WNJH_LX group by xmid) lx2 on t.id=lx2.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			${ghlxbh}
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			${ghxlxbm}
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmjd !='' and xmjd != null ">
			and xmjd like '%'||#{xmjd}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by xmnf
		) t1
	</select>
	<select id="selectLmwnjh" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.lsjl,t.xmnf,t.gz,t.sz,t.jhkgn,t.jhwgn,t.jsxz,t.yhdk,t.bz,t.id,t.lxmc,t.shzt,t.xmmc,t.xmbm,t.gydw,t.xzqh,t.ghlxbh,t.qdmc,t.zdmc,t.xjsdj,t.jsjsdj,t.tz,t.bzys,t.dfzc,t.tsdq,lx.*,lx1.sl,lx2.jhlc,t.qqkzzt,t.xmjd,t.xmklx from wnjh_lmgz t left join 
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(lc) lc,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,WMSYS.WM_CONCAT(to_char(ghlxbm)) ghlxbm,WMSYS.WM_CONCAT(to_char(ghqdzh)) ghqdzh
		,WMSYS.WM_CONCAT(to_char(ghzdzh)) ghzdzh,WMSYS.WM_CONCAT(to_char(ghlxmc)) ghlxmc
		,WMSYS.WM_CONCAT(to_char(gxlxbm)) gxlxbm,WMSYS.WM_CONCAT(to_char(gxqdzh)) gxqdzh
		,WMSYS.WM_CONCAT(to_char(gxzdzh)) gxzdzh from wnjh_lx where sffirst='1' group by xmid) lx on t.id=lx.xmid left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid 
		left join (select xmid,decode(min(jsxz),'改建',nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0),nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0))  jhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(decode(jsxz,'新建',xjlxbm,ghlxbm)),',',',') ghxlxbmtj,
   		replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
   		replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
    	replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'路面改造工程' xmlx1 
    	from WNJH_LX group by xmid) lx2 on t.id=lx2.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			${ghlxbh}
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			${ghxlxbm}
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		<if test="xmjd !='' and xmjd != null ">
			and xmjd like '%'||#{xmjd}||'%'
		</if>
		order by xmnf
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
	</select>
	<select id="selectLmwnjhCount" parameterType="lxsh" resultType="int">
		select count(*) from (
		select rownum num ,t.lsjl,t.xmnf,t.gz,t.sz,t.jhkgn,t.jhwgn,t.jsxz,t.yhdk,t.bz,t.id,t.lxmc,t.shzt,t.xmmc,t.xmbm,t.gydw,t.xzqh,t.ghlxbh,t.qdmc,t.zdmc,t.xjsdj,t.jsjsdj,t.tz,t.bzys,t.dfzc,t.tsdq,lx.*,lx1.sl,lx2.jhlc  from wnjh_lmgz t left join 
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(lc) lc,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc from wnjh_lx where sffirst='1' group by xmid) lx on t.id=lx.xmid left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid 
		left join (select xmid,sum(lc) jhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(decode(jsxz,'新建',xjlxbm,ghlxbm)),',',',') ghxlxbmtj,
   		replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
   		replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
    	replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'路面改造工程' xmlx1 
    	from WNJH_LX group by xmid) lx2 on t.id=lx2.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			${ghlxbh}
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			${ghxlxbm}
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		<if test="xmjd !='' and xmjd != null ">
			and xmjd like '%'||#{xmjd}||'%'
		</if>
		order by xmnf
		) t1
	</select>
	
	<select id="selectXjwnjh" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.*,tt.bzys1,lx1.*,lx2.sl,lx3.jhlc from WNJH_XJ t left join (select xmid,sum(bzcs) bzys1 from wnjh_lx where sffirst='1' group by xmid) tt on t.id=tt.xmid 
		left join 
		(select qdzh minqdzh,zdzh maxzdzh,xmid,yilc yilc,erlc erlc,sanlc sanlc,silc silc,
		dwlc dwlc,wllc wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,xjlxbm xjlxbm,xjqdzh xjqdzh,xjzdzh xjzdzh,xjlc xjlc,gxlxbm,gxqdzh,gxzdzh
		from wnjh_lx where sffirst='1') lx1 on t.id=lx1.xmid left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx2 on t.id=lx2.xmid
		left join (select xmid,decode(min(jsxz),'改建',nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0),nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))  jhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(decode(jsxz,'新建',xjlxbm,ghlxbm)),',',',') ghxlxbmtj,
   		replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
   		replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
    	replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'新建工程' xmlx1 
    	from WNJH_LX group by xmid) lx3 on t.id=lx3.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			${ghlxbh}
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			${ghxlxbm}
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		<if test="xmjd !='' and xmjd != null ">
			and xmjd like '%'||#{xmjd}||'%'
		</if>
		order by xmnf
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
	</select>
	<select id="selectXjwnjhCount" parameterType="lxsh" resultType="int">
		select count(*) from (
		select rownum num ,t.*,tt.bzys1,lx1.*,lx2.sl,lx3.jhlc from WNJH_XJ t left join (select xmid,sum(bzcs) bzys1 from wnjh_lx where sffirst='1' group by xmid) tt on t.id=tt.xmid left join 
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,max(xjlxbm) xjlxbm,max(xjqdzh) xjqdzh,max(xjzdzh) xjzdzh,max(xjlc) xjlc
		from wnjh_lx where sffirst='1' group by xmid) lx1 on t.id=lx1.xmid left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx2 on t.id=lx2.xmid
		left join (select xmid,sum(xjlc) jhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(decode(jsxz,'新建',xjlxbm,ghlxbm)),',',',') ghxlxbmtj,
   		replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
   		replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
    	replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'新建工程' xmlx1 
    	from WNJH_LX group by xmid) lx3 on t.id=lx3.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			${ghlxbh}
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			${ghxlxbm}
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmjd !='' and xmjd != null ">
			and xmjd like '%'||#{xmjd}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		order by xmnf
		) t1
	</select>
	
	
	
	<select id="wnjhGpsroad" parameterType="lxsh" resultType="lxsh">
		select distinct substr(ylxbm,0,4) ghlxbh,to_char(yqdzh,'FM9999990.000') qdzh,to_char(yzdzh,'FM9999990.000') zdzh,substr(xlxbm,0,4) xlxbm,substr(xlxbm,0,4) ghlxbm,to_char(xqdzh,'FM9999990.000') ghqdzh,to_char(xzdzh,'FM9999990.000') ghzdzh,xlxmc ghlxmc,ylxmc lxmc,cfld,cfqd,cfzd,lmkd,lmlx,xzqh from ghlx where ylxbm like #{ghlxbh}||'%'||#{xzqh}||'%'
		order by to_number(yqdzh)
		
	</select>
	<select id="wnjhGpsroad1" parameterType="lxsh" resultType="lxsh">
		select max(lxmc) lxmc
		from table(funNoLmlx(#{ghlxbh},(select id from XTGL_XZQH where name=#{xzqh}))) order by lxbm,qdzh
	</select>
	
	<select id="selectSjgzlxList" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,xmid xmbm,lxbm ghlxbh,t.*,decode(jsxz,'改建',nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0), nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)) zjhlc  from WNJH_LX t where 1=1 and sffirst!='1'
		<if test="xmbm!='' and xmbm!= null ">
			and xmid like '%'||#{xmbm}||'%'
		</if>
		) t1 
	</select>
	<select id="selectSjgzlxListCount" parameterType="lxsh" resultType="int">
		select count(*) from WNJH_LX where 1=1 and sffirst!='1'
		<if test="xmbm!='' and xmbm!= null ">
			and xmid like '%'||#{xmbm}||'%'
		</if>
	</select>

	<delete id="deletelmgzkxx" parameterType="hashmap">
		delete from kxxyj_lmgz where xmbm=#{xmbm}
	</delete>
	<delete id="deletesjgzkxx" parameterType="hashmap">
		delete from kxxyj_sjgz where xmbm=#{xmbm}
	</delete>
	<delete id="deletexjkxx" parameterType="hashmap">
		delete from kxxyj_xj where xmbm=#{xmbm}
	</delete>

	<update id="updateSjgz" parameterType="lxsh">
		update wnjh_sjgz set lxmc=#{lxmc},ghlxbh=#{ghlxbh},qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},xjsdj=#{xjsdj},jhkgn=#{jhkgn},jhwgn=#{jhwgn},tz=#{tz},bzys=#{bzys},dfzc=#{dfzc},gydw=#{gydw},gydwdm=#{gydwdm},xzqhdm=#{xzqhdm},xzqh=#{xzqh},tsdq=#{tsdq},yhdk=#{yhdk},bz=#{bz},xmmc=#{xmmc},xmnf=#{xmnf},gz=#{gz},sz=#{sz},lsjl=#{lsjl}
		<if test="ghxlxbm !=null">,ghxlxbm=#{ghxlxbm}</if>
		<if test="ghxlxmc !=null">,ghxlxmc=#{ghxlxmc}</if>
		<if test="xmklx !=null">,xmklx=#{xmklx}</if>
		<if test="xzqhdm2 != null">,xzqhdm2=#{xzqhdm2}</if> 
		<if test="lsxmbm !=null">,lsxmbm=#{lsxmbm}</if>
		<if test="lsxmid !=null">,lsxmid=#{lsxmid}</if> 
		where id=#{xmbm}
	</update>
	<update id="updateLmgz" parameterType="lxsh">
		update wnjh_LMGZ set lxmc=#{lxmc}
		,ghlxbh=#{ghlxbh}
		,qdzh=#{qdzh}
		,zdzh=#{zdzh}
		,qdmc=#{qdmc}
		,zdmc=#{zdmc}
		,lc=#{lc}
		,jsxz=#{jsxz}
		,jsjsdj=#{jsjsdj}
		,xjsdj=#{xjsdj}
		,jhkgn=#{jhkgn}
		,jhwgn=#{jhwgn}
		,tz=#{tz}
		,bzys=#{bzys}
		,dfzc=#{dfzc}
		,gydw=#{gydw}
		,gydwdm=#{gydwdm}
		,xzqhdm=#{xzqhdm}
		,xzqh=#{xzqh}
		,tsdq=#{tsdq}
		,yhdk=#{yhdk}
		,bz=#{bz}
		,xmmc=#{xmmc}
		,xmnf=#{xmnf}
		,gz=#{gz}
		,sz=#{sz}
		<if test="lsjl !=null">,lsjl=#{lsjl}</if>
		<if test="ghxlxbm !=null">,ghxlxbm=#{ghxlxbm}</if>
		<if test="ghxlxmc !=null">,ghxlxmc=#{ghxlxmc}</if>
		<if test="xmklx !=null">,xmklx=#{xmklx}</if>
		<if test="xzqhdm2 != null">,xzqhdm2=#{xzqhdm2}</if>  
		<if test="lsxmbm !=null">,lsxmbm=#{lsxmbm}</if>
		<if test="lsxmid !=null">,lsxmid=#{lsxmid}</if> 
		where id=#{xmbm}
	</update>
	<update id="updateXj" parameterType="lxsh">
		update wnjh_XJ set ghlxbh=#{ghlxbh},lxmc=#{lxmc},xjsdj=#{xjsdj},qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},jhkgn=#{jhkgn},jhwgn=#{jhwgn},tz=#{tz},bzys=#{bzys},dfzc=#{dfzc},gydw=#{gydw},gydwdm=#{gydwdm},xzqhdm=#{xzqhdm},xzqh=#{xzqh},tsdq=#{tsdq},bz=#{bz},yhdk=#{yhdk},xmmc=#{xmmc},xmnf=#{xmnf},gz=#{gz},sz=#{sz}

		<if test="lsjl !=null">,lsjl=#{lsjl}</if>
		<if test="ghxlxbm !=null">,ghxlxbm=#{ghxlxbm}</if>
		<if test="ghxlxmc !=null">,ghxlxmc=#{ghxlxmc}</if>
		<if test="xmklx !=null">,xmklx=#{xmklx}</if>
		<if test="xzqhdm2 != null">,xzqhdm2=#{xzqhdm2}</if>
		<if test="lsxmbm !=null">,lsxmbm=#{lsxmbm}</if>
		<if test="lsxmid !=null">,lsxmid=#{lsxmid}</if>   
		where id=#{xmbm}
	</update>
	<update id="updateSjgzlx" parameterType="lxsh">
		update WNJH_LX set lxbm=#{ghlxbh},qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},bzcs=#{bzys},xjsdj=#{xjsdj}
		<if test="xzqh!='' and xzqh!=null">,xzqh=#{xzqh}</if>
		<if test="gydw!='' and gydw!=null">,gydw=#{gydw}</if>
		<if test="xzqhdm!='' and xzqhdm!=null">,xzqhdm=#{xzqhdm}</if>
		<if test="gydwdm!='' and gydwdm!=null">,gydwdm=#{gydwdm}</if>
		<if test="xjlxbm!='' and xjlxbm!=null">,xjlxbm=#{xjlxbm}</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,xjqdzh=#{xjqdzh}</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,xjzdzh=#{xjzdzh}</if>
		<if test="xjlc!='' and xjlc!=null">,xjlc=#{xjlc}</if>
		<if test="yilc!='' and yilc!=null">,yilc=#{yilc}</if><if test="erlc!='' and erlc!=null">,erlc=#{erlc}</if>
		<if test="xjlc!='' and xjlc!=null">,sanlc=#{sanlc}</if><if test="silc!='' and silc!=null">,silc=#{silc}</if>
		<if test="dwlc!='' and dwlc!=null">,dwlc=#{dwlc}</if><if test="wllc!='' and wllc!=null">,wllc=#{wllc}</if>
		<if test="jhyilc!=null">,jhyilc=#{jhyilc}</if>
		<if test="jherlc!=null">,jherlc=#{jherlc}</if>
		<if test="jhsanlc!=null">,jhsanlc=#{jhsanlc}</if>
		<if test="jhsilc!=null">,jhsilc=#{jhsilc}</if>
		<if test="jhdwlc!=null">,jhdwlc=#{jhdwlc}</if>
		<if test="jhwllc!=null">,jhwllc=#{jhwllc}</if>
		<if test="jhlc!=null">,jhlc=#{jhlc}</if>
		<if test="ghxlxbm !=null">,ghxlxbm=#{ghxlxbm}</if>
		<if test="ghxlxmc !=null">,ghxlxmc=#{ghxlxmc}</if>
		<if test="ghlxbm !=null">,ghlxbm=#{ghlxbm}</if>
		<if test="ghlxmc !=null">,ghlxmc=#{ghlxmc}</if>
		<if test="ghqdzh !=null">,ghqdzh=#{ghqdzh}</if>
		<if test="ghzdzh !=null">,ghzdzh=#{ghzdzh}</if>
		<if test="gxlxbm !=null">,gxlxbm=#{gxlxbm}</if>
		<if test="gxqdzh !=null">,gxqdzh=#{gxqdzh}</if>
		<if test="gxzdzh !=null">,gxzdzh=#{gxzdzh}</if>
		<if test="gpsqdzh !=null">,gpsqdzh=#{gpsqdzh}</if>
		<if test="gpszdzh !=null">,gpszdzh=#{gpszdzh}</if>
		where xmid=#{xmbm} and sffirst='1' 
	</update>
	<select id="querywnjhlxid" parameterType="lxsh" resultType="string">
	select id from wnjh_lx where xmid=#{xmbm} and sffirst='1'
	</select>
	
	<update id="updatewnjhsjlx" parameterType="lxsh">
		update WNJH_LX set lxbm=#{ghlxbh},qdzh=#{qdzh},zdzh=#{zdzh},qdmc=#{qdmc},zdmc=#{zdmc},lc=#{lc},jsxz=#{jsxz},jsjsdj=#{jsjsdj},xjsdj=#{xjsdj}
		<if test="xzqh!='' and xzqh!=null">,xzqh=#{xzqh}</if>
		<if test="gydw!='' and gydw!=null">,gydw=#{gydw}</if>
		<if test="xzqhdm!='' and xzqhdm!=null">,xzqhdm=#{xzqhdm}</if>
		<if test="gydwdm!='' and gydwdm!=null">,gydwdm=#{gydwdm}</if>
		<if test="xjlxbm!='' and xjlxbm!=null">,xjlxbm=#{xjlxbm}</if>
		<if test="xjqdzh!='' and xjqdzh!=null">,xjqdzh=#{xjqdzh}</if>
		<if test="xjzdzh!='' and xjzdzh!=null">,xjzdzh=#{xjzdzh}</if>
		<if test="xjlc!='' and xjlc!=null">,xjlc=#{xjlc}</if>
		<if test="yilc!='' and yilc!=null">,yilc=#{yilc}</if><if test="erlc!='' and erlc!=null">,erlc=#{erlc}</if>
		<if test="xjlc!='' and xjlc!=null">,sanlc=#{sanlc}</if><if test="silc!='' and silc!=null">,silc=#{silc}</if>
		<if test="dwlc!='' and dwlc!=null">,dwlc=#{dwlc}</if><if test="wllc!='' and wllc!=null">,wllc=#{wllc}</if>
		<if test="jhyilc!=null">,jhyilc=#{jhyilc}</if>
		<if test="jherlc!=null">,jherlc=#{jherlc}</if>
		<if test="jhsanlc!=null">,jhsanlc=#{jhsanlc}</if>
		<if test="jhsilc!=null">,jhsilc=#{jhsilc}</if>
		<if test="jhdwlc!=null">,jhdwlc=#{jhdwlc}</if>
		<if test="jhwllc!=null">,jhwllc=#{jhwllc}</if>
		<if test="jhlc!=null">,jhlc=#{jhlc}</if>
		<if test="ghxlxbm !=null">,ghxlxbm=#{ghxlxbm}</if>
		<if test="ghxlxmc !=null">,ghxlxmc=#{ghxlxmc}</if>
		<if test="ghlxbm !=null">,ghlxbm=#{ghlxbm}</if>
		<if test="ghlxmc !=null">,ghlxmc=#{ghlxmc}</if>
		<if test="ghqdzh !=null">,ghqdzh=#{ghqdzh}</if>
		<if test="ghzdzh !=null">,ghzdzh=#{ghzdzh}</if>
		<if test="gxlxbm !=null">,gxlxbm=#{gxlxbm}</if>
		<if test="gxqdzh !=null">,gxqdzh=#{gxqdzh}</if>
		<if test="gxzdzh !=null">,gxzdzh=#{gxzdzh}</if>
		<if test="gpsqdzh !=null">,gpsqdzh=#{gpsqdzh}</if>
		<if test="gpszdzh !=null">,gpszdzh=#{gpszdzh}</if>
		where xmid=#{xmbm} and id=#{id} 
	</update>
	
	<select id="queryMaxbzcs" parameterType="lxsh" resultType="double">
		select sum(to_number(bzcs)) from WNJH_LX where xmid=#{xmbm} 
	</select>
	<select id="queryMaxlc" parameterType="lxsh" resultType="double">
		select sum(to_number(lc)) from WNJH_LX where xmid=#{xmbm} 
	</select>
	<select id="cxwnghsjByid" parameterType="lxsh" resultType="lxsh">
		select xmmc, ghlxbh, jhkgn, jhwgn, l.jsjsdj, l.xjsdj,l.ghxlxbm,l.ghxlxmc,l.xmklx, 
		xmbm, tz, bzys, dfzc, tsdq, l.xzqh, l.gydw, l.xzqhdm, l.xzqhdm2, l.gydwdm, tbbmbm, tbbmmc, tbsj, shzt, sbzt, xmnf, sbthcd,  lsjl, bz, yhdk,gz,sz, 
		xmid, lxbm, l1.lxmc,l1.qdzh, l1.zdzh, l1.jsjsdj, l1.lc, l1.xjsdj, l.jsxz, l1.qdmc, l1.zdmc, bzcs, sffirst, jdbs, qqkzzt,
		gpsqdzh, gpszdzh, jsfa, yilc, erlc, sanlc, silc, dwlc, wllc,jhyilc, jherlc, jhsanlc, jhsilc, jhdwlc, jhwllc,jhlc,l1.ghlxbm,l1.ghqdzh,l1.ghzdzh,l1.ghlxmc,l1.gxlxbm,l1.gxqdzh,l1.gxzdzh
		from wnjh_sjgz l left join wnjh_lx l1 on l.id=l1.xmid where l.id=#{xmbm}  and l1.sffirst='1'
	</select>
	<select id="cxwnghlmByid" parameterType="lxsh" resultType="lxsh">
		select xmmc, ghlxbh, jhkgn, jhwgn, l.jsjsdj, l.xjsdj,l.ghxlxbm,l.ghxlxmc,l.xmklx,  
		xmbm, tz, bzys, dfzc, tsdq, l.xzqh, l.gydw, l.xzqhdm, l.xzqhdm2, l.gydwdm, tbbmbm, tbbmmc, tbsj, shzt, sbzt, xmnf, sbthcd,  lsjl, bz, yhdk,gz,sz, 
		xmid, lxbm, l1.lxmc,l1.qdzh, l1.zdzh, l1.jsjsdj, l1.lc, l1.xjsdj, l1.jsxz, l1.qdmc, l1.zdmc, bzcs, sffirst, jdbs, qqkzzt,
		gpsqdzh, gpszdzh, jsfa, yilc, erlc, sanlc, silc, dwlc, wllc,jhyilc, jherlc, jhsanlc, jhsilc, jhdwlc, jhwllc,l1.ghlxbm,l1.ghqdzh,l1.ghzdzh,l1.ghlxmc,l1.gxlxbm,l1.gxqdzh,l1.gxzdzh 
		from wnjh_lmgz l left join wnjh_lx l1 on l.id=l1.xmid where l.id=#{xmbm}  and l1.sffirst='1'
	</select>
	<select id="cxwnghxjByid" parameterType="lxsh" resultType="lxsh">
		select xmmc, ghlxbh, jhkgn, jhwgn, l.jsjsdj, l.xjsdj,l.ghxlxbm,l.ghxlxmc,l.xmklx,  
		xmbm, tz, bzys, dfzc, tsdq, l.xzqh, l.gydw, l.xzqhdm, l.xzqhdm2, l.gydwdm, tbbmbm, tbbmmc, tbsj, shzt, sbzt, xmnf, sbthcd,  lsjl, bz, yhdk,gz,sz, 
		xmid, lxbm, l1.lxmc,l1.qdzh, l1.zdzh, l1.jsjsdj, l1.lc, l1.xjsdj, l1.jsxz, l1.qdmc, l1.zdmc, bzcs, sffirst, jdbs, qqkzzt,
		gpsqdzh, gpszdzh, jsfa, yilc, erlc, sanlc, silc, dwlc, wllc,jhyilc, jherlc, jhsanlc, jhsilc, jhdwlc, jhwllc,l1.xjlxbm,l1.xjqdzh,l1.xjzdzh,l1.xjlc,l1.ghlxbm,l1.ghqdzh,l1.ghzdzh,l1.ghlxmc,l1.gxlxbm,l1.gxqdzh,l1.gxzdzh  
		from wnjh_xj l left join wnjh_lx l1 on l.id=l1.xmid where l.id=#{xmbm}  and l1.sffirst='1'
	</select>
	<delete id="delwnjhSjgz" parameterType="hashmap">
		delete from WNJH_SJGZ where id=#{xmbm}
	</delete>
	<delete id="delwnjhLmgz" parameterType="hashmap">
		delete from WNJH_LMGZ where id=#{xmbm}
	</delete>
	<delete id="delwnjhXj" parameterType="hashmap">
		delete from WNJH_XJ where id=#{xmbm}
	</delete>
	<delete id="delwnjhSjgzlx" parameterType="hashmap">
		delete from WNJH_LX where xmid=#{xmbm}
	</delete>	
	<delete id="deleteWnlx" parameterType="lxsh">
		delete from WNJH_LX where id=#{id}
	</delete>	
	<select id="queryshsjgz" parameterType="string" resultType="lxsh">
		select * from LXSH_SJGZ where ${value}
	</select>
	<select id="queryshlmgz" parameterType="string" resultType="lxsh">
		select * from LXSH_LMGZ where ${value}
	</select>
	<select id="queryshxj" parameterType="string" resultType="lxsh">
		select * from LXSH_XJ where ${value}
	</select>
	<insert id="insertsjgzkxx" parameterType="lxsh">
		insert into kxxyj_sjgz(id,xmmc,xmbm,xzqh,xzqhdm,qdzh,zdzh,jsjsdj,jsxz,yhdk,dfzc)
		values(sys_guid(),#{xmmc},#{xmbm},#{xzqh},#{xzqhdm},#{qdzh},#{zdzh},#{jsjsdj},#{jsxz},#{yhdk},#{dfzc})
	</insert>
	<insert id="insertlmgzkxx" parameterType="lxsh">
		insert into kxxyj_lmgz(id,xmmc,xmbm,xzqh,xzqhdm,qdzh,zdzh,jsjsdj,jsxz,yhdk,dfzc)
		values(sys_guid(),#{xmmc},#{xmbm},#{xzqh},#{xzqhdm},#{qdzh},#{zdzh},#{jsjsdj},#{jsxz},#{yhdk},#{dfzc})
	</insert>
	<insert id="insertxjkxx" parameterType="lxsh">
		insert into kxxyj_xj(id,xmmc,xmbm,xzqh,xzqhdm,qdzh,zdzh,jsjsdj,jsxz,yhdk,dfzc)
		values(sys_guid(),#{xmmc},#{xmbm},#{xzqh},#{xzqhdm},#{qdzh},#{zdzh},#{jsjsdj},#{jsxz},#{yhdk},#{dfzc})
	</insert>
	
	<select id="Lmgzsfkxx" parameterType="string" resultType="lxsh">
		select * from kxxyj_lmgz where 1=1 and ${value} and sbthcd is not null
	</select>
	<select id="sjgzsfkxx" parameterType="string" resultType="lxsh">
		select * from kxxyj_sjgz where 1=1 and ${value} and sbthcd is not null
	</select>
	<select id="Xjsfkxx" parameterType="string" resultType="lxsh">
		select * from kxxyj_xj where 1=1 and ${value} and sbthcd is not null
	</select>
	<select id="qqglGpsroad" parameterType="lxsh" resultType="lxsh">
		select lxbm ghlxbh,lxmc,qdzh,zdzh,qzlc lc,qdmc,zdmc,yjsdj xjsdj
		from table(funNoLmlx(#{ghlxbh},#{xzqh})) order by lxbm,qdzh
	</select>
	<update id="updatesjgz" parameterType="lxsh">
		update lxsh_sjgz set bzys=#{bzys},lc=#{lc},dfzc=(tz-#{bzys}) 
		
		where xmbm=#{xmbm}
	</update>
	<update id="updatelmgz" parameterType="lxsh">
		update lxsh_lmgz set bzys=#{bzys},lc=#{lc},dfzc=(tz-#{bzys})
		
		 where xmbm=#{xmbm}
	</update>
	<update id="updatexj" parameterType="lxsh">
		update lxsh_xj set bzys=#{bzys},lc=#{lc},dfzc=(tz-#{bzys})
		
		 where xmbm=#{xmbm}
	</update>
	<delete id="deleteLx" parameterType="lxsh">
		delete from lxsh_lx where xmid=#{xmbm} and id=#{id} 
	</delete>
	<select id="cxqdmc" parameterType="lxsh" resultType="lxsh">
		select min(f006) qdmc from gpsroad g,
       (SELECT MIN(ABS(ROADSTART- to_number(#{qdzh}))) a FROM gpsroad where SUBSTR(roadcode,1,4) = #{ghlxbh}) t
       where SUBSTR(g.roadcode,1,4) = #{ghlxbh} and (g.roadstart=to_number(#{qdzh})+t.a or g.roadstart=to_number(#{qdzh})-t.a )
	</select>
	<select id="cxzdmc" parameterType="lxsh" resultType="lxsh">
		select min(f010) zdmc from gpsroad g,
       (SELECT MIN(ABS(ROADENDS-to_number(#{qdzh}))) a FROM gpsroad where SUBSTR(roadcode,1,4) = #{ghlxbh}) t
       where SUBSTR(g.roadcode,1,4) = #{ghlxbh} and (g.ROADENDS=to_number(#{qdzh})+t.a or g.ROADENDS=to_number(#{qdzh})-t.a )
	</select>
	<delete id="deletekxlx" parameterType="hashmap">
		delete from lxsh_lx where xmid=#{xmbm} and jdbs='1'
	</delete>
	<select id="selectlxbyxmid" parameterType="lxsh" resultType="lxsh">
		select * from lxsh_lx where xmid=#{xmbm} and jdbs='0' and sffirst='1'
	</select>
	<select id="sfylx" parameterType="lxsh" resultType="lxsh">
		select count(*) shzt from wnjh_lx where xmid=#{xmbm} and sffirst='0'
	</select>
	<select id="qqglGpszh" parameterType="lxsh" resultType="lxsh">
		select gpsqdzh qdzh,gpszdzh zdzh from  wnjh_lx where lxbm=#{ghlxbh} and xmid=#{xmbm} and sffirst='1'
	</select>
	<select id="selectlxbyxmid1" parameterType="lxsh" resultType="lxsh">
		select * from wnjh_lx where xmid=#{xmbm}
	</select>
	
	<select id="querywnjhSjgz" parameterType="lxsh" resultType="elist">
		<!-- select t.xmmc v_0,lx.lxbm v_1,lx.lxmc v_2,lx.qdzh v_3,lx.zdzh v_4,
		lx.ghlxbm v_5,lx.ghlxmc v_6,lx.ghqdzh v_7,lx.ghzdzh v_8,
		lx.gxlxbm v_9,lx.gxqdzh v_10,lx.gxzdzh v_11,lx.wlc v_12,
		lx.qdmc v_13,lx.zdmc v_14,lx.jsxz v_15,lx.gydw v_16,lx.xzqh v_17,t.tsdq v_18,lx.jsjsdj v_19,lx.xjsdj v_20,t.xmnf v_21,t.jhkgn v_22,t.jhwgn v_23,decode(lx.sffirst,'1',t.tz,'') v_24,decode(lx.sffirst,'1',lx.bzcs,'') v_25,t.xmklx v_26,t.bz v_27
		from WNJH_SJGZ t right join
		(select w.*,(case when jsxz like '%改建%' then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
					  when jsxz like '%新建%' then xjlc
					    else lc
        end) wlc
		from WNJH_LX w where 1=1 and jdbs='0' ) lx on t.id=lx.xmid 
		left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
		left join (select xmid,
		sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,
		replace(WMSYS.WM_CONCAT(decode(jsxz,'新建',xjlxbm,ghlxbm)),',',',') ghxlxbmtj,
        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'改建工程' xmlx1
        from (select  xmid,jsxz,
        (case when jsxz like '%改建%' then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
					  when jsxz like '%新建%' then xjlc
					    else lc
        end) jhlc,lxbm,lxmc,(case when jsxz like '%新建%' then xjlxbm 
        else ghxlxbm
        end) ghxlxbm,ghxlxmc,jsjsdj,xjsdj,xjlxbm,ghlxbm
        from WNJH_LX ) group by xmid) lx2 on t.id=lx2.xmid
		where 1=1 -->
		
		
       select rownum v_0,t.xmmc v_1,t.qqkzzt v_2, t.xmjd v_3,
    decode(instr(RemoveSameStr(lx2.ylxbm,','),','),0,RemoveSameStr(lx2.ylxbm,','),lx2.ylxbm) v_4,
    decode(instr(RemoveSameStr(lx2.ylxmc,','),','),0,RemoveSameStr(lx2.ylxmc,','),lx2.ylxmc) v_5,
    lx2.qdzh v_6,lx2.zdzh v_7,
    decode(instr(RemoveSameStr(lx2.ghlxbm,','),','),0,RemoveSameStr(lx2.ghlxbm,','),lx2.ghlxbm)  v_8,
    decode(instr(RemoveSameStr(lx2.ghlxmc,','),','),0,RemoveSameStr(lx2.ghlxmc,','),lx2.ghlxmc) v_9,
    lx2.ghqdzh v_10,lx2.ghzdzh v_11,
     decode(instr(RemoveSameStr(lx2.gxlxbm,','),','),0,RemoveSameStr(lx2.gxlxbm,','),lx2.gxlxbm) v_12,
     lx2.gxqdzh v_13,lx2.gxzdzh v_14,to_char(lx2.zjhlc,'fm9999999990.000') v_15,
     decode(instr(RemoveSameStr(lx2.qdmc,','),','),0,RemoveSameStr(lx2.qdmc,','),lx2.qdmc) v_16,
     decode(instr(RemoveSameStr(lx2.zdmc,','),','),0,RemoveSameStr(lx2.zdmc,','),lx2.zdmc) v_17,
     lx2.jsxz v_18,t.gydw v_19,t.xzqh v_20,t.tsdq v_21,
     RemoveSameStr(lx2.jsjsdjtj,',') v_22,RemoveSameStr(lx2.xjsdjtj,',') v_23,t.xmnf v_24,
     t.jhkgn v_25,t.jhwgn v_26,t.tz v_27,lx2.bzcs v_28,t.xmklx v_29,t.bz v_30
    from WNJH_SJGZ t 
    left join (select xmid,sum(jhlc) zjhlc,sum(bzcs) bzcs,
        replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,
        replace(WMSYS.WM_CONCAT(decode(jsxz,'新建',xjlxbm,ghlxbm)),',',',') ghxlxbmtj,
        replace(WMSYS.WM_CONCAT(jsjsdj),'、',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),'、',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,
        replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,
        replace(WMSYS.WM_CONCAT(distinct(jsxz)),',',',') jsxz,
        replace(max(qdzh), ',.', ',0.') qdzh,replace(max(zdzh), ',.', ',0.') zdzh,
        replace(max(ghqdzh), ',.', ',0.') ghqdzh,replace(max(ghzdzh), ',.', ',0.') ghzdzh,
        replace(max(gxqdzh), ',.', ',0.') gxqdzh,replace(max(gxzdzh), ',.', ',0.') gxzdzh,
        max(ghlxbm) ghlxbm,max(ylxbm) ylxbm,max(ghlxmc) ghlxmc,max(ylxmc) ylxmc,max(gxlxbm) gxlxbm,
        max(qdmc) qdmc,max(zdmc) zdmc
        from (select  xmid,jsxz,lxmc,lxbm,bzcs,
        (case when jsxz like '%改建%' then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)
            when jsxz like '%新建%' then to_number(xjlc)
            else nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)
        end) jhlc,(case when jsxz like '%新建%' then xjlxbm 
        else ghxlxbm
        end) ghxlxbm,ghxlxmc,jsjsdj,xjsdj,xjlxbm,
               WMSYS.WM_CONCAT(ghlxmc)over( PARTITION BY xmid ORDER BY id,ghlxmc) ghlxmc,
               WMSYS.WM_CONCAT(lxmc)over( PARTITION BY xmid ORDER BY id,lxmc) ylxmc,
               WMSYS.WM_CONCAT(ghlxbm)over( PARTITION BY xmid ORDER BY id,ghlxbm) ghlxbm,
               WMSYS.WM_CONCAT(lxbm)over( PARTITION BY xmid ORDER BY id,lxbm) ylxbm,
               WMSYS.WM_CONCAT((case when qdzh like '.%' then 0||qdzh when qdzh like '%,.%' then replace(qdzh, ',.', ',0.') else qdzh end ))over( PARTITION BY xmid ORDER BY id,qdzh) qdzh,
               WMSYS.WM_CONCAT((case when zdzh like '.%' then 0||zdzh when zdzh like '%,.%' then replace(zdzh, ',.', ',0.') else zdzh end ))over( PARTITION BY xmid ORDER BY id,zdzh) zdzh,
               WMSYS.WM_CONCAT((case when ghqdzh like '.%' then 0||ghqdzh when ghqdzh like '%,.%' then replace(ghqdzh, ',.', ',0.') else ghqdzh end ))over( PARTITION BY xmid ORDER BY id,ghqdzh) ghqdzh,
               WMSYS.WM_CONCAT((case when ghzdzh like '.%' then 0||ghzdzh when ghzdzh like '%,.%' then replace(ghzdzh, ',.', ',0.') else ghzdzh end ))over( PARTITION BY xmid ORDER BY id,ghzdzh) ghzdzh,
               WMSYS.WM_CONCAT(gxlxbm)over( PARTITION BY xmid ORDER BY id,gxlxbm) gxlxbm,
               WMSYS.WM_CONCAT((case when gxqdzh like '.%' then 0||gxqdzh when gxqdzh like '%,.%' then replace(gxqdzh, ',.', ',0.') else gxqdzh end ))over( PARTITION BY xmid ORDER BY id,gxqdzh) gxqdzh,
               WMSYS.WM_CONCAT((case when gxzdzh like '.%' then 0||gxzdzh when gxzdzh like '%,.%' then replace(gxzdzh, ',.', ',0.') else gxzdzh end ))over( PARTITION BY xmid ORDER BY id,gxzdzh) gxzdzh,
               WMSYS.WM_CONCAT(qdmc)over( PARTITION BY xmid ORDER BY id,qdmc) qdmc,
               WMSYS.WM_CONCAT(zdmc)over( PARTITION BY xmid ORDER BY id,zdmc) zdmc
        from WNJH_LX ) group by xmid) lx2 on t.id=lx2.xmid
    where 1=1
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj!='' and jsjsdj!= null ">
			${jsjsdj}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
<!-- 			and xmbm in (select distinct xmid from wnjh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%') -->
			${ghlxbh}
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
<!-- 			and ghxlxbmtj like '%'||#{ghxlxbm}||'%' -->
			${ghxlxbm}
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmjd !='' and xmjd != null ">
			and xmjd like '%'||#{xmjd}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
<!-- 		order by t.id desc,lx.sffirst desc -->
	</select>
	<select id="querywnjhLmgz" parameterType="lxsh" resultType="elist">
		<!-- select 
		t.xmmc v_0,lx.lxbm v_1,lx.lxmc v_2,lx.qdzh v_3,lx.zdzh v_4,
		lx.ghlxbm v_5,lx.ghlxmc v_6,lx.ghqdzh v_7,lx.ghzdzh v_8,
		lx.gxlxbm v_9,lx.gxqdzh v_10,lx.gxzdzh v_11,lx.wlc v_12,
		lx.qdmc v_13,lx.zdmc v_14,lx.jsxz v_15,lx.gydw v_16,lx.xzqh v_17,t.tsdq v_18,lx.jsjsdj v_19,lx.xjsdj v_20,t.xmnf v_21,t.jhkgn v_22,t.jhwgn v_23,decode(lx.sffirst,'1',t.tz,'') v_24,decode(lx.sffirst,'1',lx.bzcs,'') v_25,t.xmklx v_26,t.bz v_27
		from WNJH_LMGZ t right join
		(select w.*,(case when jsxz like '%改建%' then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
					  when jsxz like '%新建%' then xjlc
					    else lc
        end) wlc
		from WNJH_LX w where 1=1 and jdbs='0' ) lx on t.id=lx.xmid 
		left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
		left join (select xmid,
		sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,
		replace(WMSYS.WM_CONCAT(decode(jsxz,'新建',xjlxbm,ghlxbm)),',',',') ghxlxbmtj,
        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'路面改造工程' xmlx1
        from (select  xmid,jsxz,
        (case when jsxz like '%改建%' then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
					  when jsxz like '%新建%' then xjlc
					    else lc
        end) jhlc,lxbm,lxmc,(case when jsxz like '%新建%' then xjlxbm 
        else ghxlxbm
        end) ghxlxbm,ghxlxmc,jsjsdj,xjsdj,xjlxbm,ghlxbm
        from WNJH_LX ) group by xmid) lx2 on t.id=lx2.xmid
		where 1=1 -->
		
    select rownum v_0,t.xmmc v_1,t.qqkzzt v_2,t.xmjd v_3,
    decode(instr(RemoveSameStr(lx2.ylxbm,','),','),0,RemoveSameStr(lx2.ylxbm,','),lx2.ylxbm) v_4,
    decode(instr(RemoveSameStr(lx2.ylxmc,','),','),0,RemoveSameStr(lx2.ylxmc,','),lx2.ylxmc) v_5,
    lx2.qdzh v_6,lx2.zdzh v_7,
    decode(instr(RemoveSameStr(lx2.ghlxbm,','),','),0,RemoveSameStr(lx2.ghlxbm,','),lx2.ghlxbm)  v_8,
    decode(instr(RemoveSameStr(lx2.ghlxmc,','),','),0,RemoveSameStr(lx2.ghlxmc,','),lx2.ghlxmc) v_9,
    lx2.ghqdzh v_10,lx2.ghzdzh v_11,
     decode(instr(RemoveSameStr(lx2.gxlxbm,','),','),0,RemoveSameStr(lx2.gxlxbm,','),lx2.gxlxbm) v_12,
     lx2.gxqdzh v_13,lx2.gxzdzh v_14,to_char(lx2.zjhlc,'fm9999999990.000') v_15,
     decode(instr(RemoveSameStr(lx2.qdmc,','),','),0,RemoveSameStr(lx2.qdmc,','),lx2.qdmc) v_16,
     decode(instr(RemoveSameStr(lx2.zdmc,','),','),0,RemoveSameStr(lx2.zdmc,','),lx2.zdmc) v_17,
     lx2.jsxz v_18,t.gydw v_19,t.xzqh v_20,t.tsdq v_21,
     RemoveSameStr(lx2.jsjsdjtj,',') v_22,RemoveSameStr(lx2.xjsdjtj,',') v_23,t.xmnf v_24,
     t.jhkgn v_25,t.jhwgn v_26,t.tz v_27,lx2.bzcs v_28,t.xmklx v_29,t.bz v_30
    from WNJH_LMGZ t 
    left join (select xmid,sum(jhlc) zjhlc,sum(bzcs) bzcs,
        replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,
        replace(WMSYS.WM_CONCAT(decode(jsxz,'新建',xjlxbm,ghlxbm)),',',',') ghxlxbmtj,
        replace(WMSYS.WM_CONCAT(jsjsdj),'、',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),'、',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,
        replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,
        replace(WMSYS.WM_CONCAT(distinct(jsxz)),',',',') jsxz,
        replace(max(qdzh), ',.', ',0.') qdzh,replace(max(zdzh), ',.', ',0.') zdzh,
        replace(max(ghqdzh), ',.', ',0.') ghqdzh,replace(max(ghzdzh), ',.', ',0.') ghzdzh,
        replace(max(gxqdzh), ',.', ',0.') gxqdzh,replace(max(gxzdzh), ',.', ',0.') gxzdzh,
        max(ghlxbm) ghlxbm,max(ylxbm) ylxbm,max(ghlxmc) ghlxmc,max(ylxmc) ylxmc,max(gxlxbm) gxlxbm,
        max(qdmc) qdmc,max(zdmc) zdmc
        from (select  xmid,jsxz,lxmc,lxbm,bzcs,
        (case when jsxz like '%改建%' then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)
            when jsxz like '%新建%' then to_number(xjlc)
            else nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)
        end) jhlc,(case when jsxz like '%新建%' then xjlxbm 
        else ghxlxbm
        end) ghxlxbm,ghxlxmc,jsjsdj,xjsdj,xjlxbm,
               WMSYS.WM_CONCAT(ghlxmc)over( PARTITION BY xmid ORDER BY id,ghlxmc) ghlxmc,
               WMSYS.WM_CONCAT(lxmc)over( PARTITION BY xmid ORDER BY id,lxmc) ylxmc,
               WMSYS.WM_CONCAT(ghlxbm)over( PARTITION BY xmid ORDER BY id,ghlxbm) ghlxbm,
               WMSYS.WM_CONCAT(lxbm)over( PARTITION BY xmid ORDER BY id,lxbm) ylxbm,
               WMSYS.WM_CONCAT((case when qdzh like '.%' then 0||qdzh when qdzh like '%,.%' then replace(qdzh, ',.', ',0.') else qdzh end ))over( PARTITION BY xmid ORDER BY id,qdzh) qdzh,
               WMSYS.WM_CONCAT((case when zdzh like '.%' then 0||zdzh when zdzh like '%,.%' then replace(zdzh, ',.', ',0.') else zdzh end ))over( PARTITION BY xmid ORDER BY id,zdzh) zdzh,
               WMSYS.WM_CONCAT((case when ghqdzh like '.%' then 0||ghqdzh when ghqdzh like '%,.%' then replace(ghqdzh, ',.', ',0.') else ghqdzh end ))over( PARTITION BY xmid ORDER BY id,ghqdzh) ghqdzh,
               WMSYS.WM_CONCAT((case when ghzdzh like '.%' then 0||ghzdzh when ghzdzh like '%,.%' then replace(ghzdzh, ',.', ',0.') else ghzdzh end ))over( PARTITION BY xmid ORDER BY id,ghzdzh) ghzdzh,
               WMSYS.WM_CONCAT(gxlxbm)over( PARTITION BY xmid ORDER BY id,gxlxbm) gxlxbm,
               WMSYS.WM_CONCAT((case when gxqdzh like '.%' then 0||gxqdzh when gxqdzh like '%,.%' then replace(gxqdzh, ',.', ',0.') else gxqdzh end ))over( PARTITION BY xmid ORDER BY id,gxqdzh) gxqdzh,
               WMSYS.WM_CONCAT((case when gxzdzh like '.%' then 0||gxzdzh when gxzdzh like '%,.%' then replace(gxzdzh, ',.', ',0.') else gxzdzh end ))over( PARTITION BY xmid ORDER BY id,gxzdzh) gxzdzh,
               WMSYS.WM_CONCAT(qdmc)over( PARTITION BY xmid ORDER BY id,qdmc) qdmc,
               WMSYS.WM_CONCAT(zdmc)over( PARTITION BY xmid ORDER BY id,zdmc) zdmc
        from WNJH_LX ) group by xmid) lx2 on t.id=lx2.xmid
    where 1=1
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj!='' and jsjsdj!= null ">
			${jsjsdj}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
<!-- 			and xmbm in (select distinct xmid from wnjh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%') -->
			${ghlxbh}
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
<!-- 			and ghxlxbmtj like '%'||#{ghxlxbm}||'%' -->
			${ghxlxbm}
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmjd !='' and xmjd != null ">
			and xmjd like '%'||#{xmjd}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
<!-- 		order by t.id desc,lx.sffirst desc -->
	</select>
	<select id="querywnjhXj" parameterType="lxsh" resultType="elist">
		<!-- select 
			t.xmmc v_0,lx.lxbm v_1,lx.lxmc v_2,lx.qdzh v_3,lx.zdzh v_4,
		lx.ghlxbm v_5,lx.ghlxmc v_6,lx.ghqdzh v_7,lx.ghzdzh v_8,
		lx.gxlxbm v_9,lx.gxqdzh v_10,lx.gxzdzh v_11,lx.wlc v_12,
		lx.qdmc v_13,lx.zdmc v_14,lx.jsxz v_15,lx.gydw v_16,lx.xzqh v_17,t.tsdq v_18,lx.jsjsdj v_19,lx.xjsdj v_20,t.xmnf v_21,t.jhkgn v_22,t.jhwgn v_23,decode(lx.sffirst,'1',t.tz,'') v_24,decode(lx.sffirst,'1',lx.bzcs,'') v_25,t.xmklx v_26,t.bz v_27
		from WNJH_XJ t left join 
		(select w.*,(case when jsxz like '%改建%' then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
					  when jsxz like '%新建%' then xjlc
					    else lc
        end) wlc
		from WNJH_LX w where 1=1  ) lx  on lx.xmid=t.xmbm
		left join 
		(select qdzh minqdzh,zdzh maxzdzh,xmid,yilc yilc,erlc erlc,sanlc sanlc,silc silc,
		dwlc dwlc,wllc wllc,xjlxbm xjlxbm,xjqdzh xjqdzh,xjzdzh xjzdzh,xjlc xjlc
		from wnjh_lx where sffirst='1') lx1 on t.id=lx1.xmid left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx2 on t.id=lx2.xmid
		left join (select xmid,decode(min(jsxz),'改建',nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0),nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0))  jhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(decode(jsxz,'新建',xjlxbm,ghlxbm)),',',',') ghxlxbmtj,
   		replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
   		replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
    	replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'新建工程' xmlx1 
    	from WNJH_LX group by xmid) lx3 on t.id=lx3.xmid
		where 1=1  -->
		
    select rownum v_0,t.xmmc v_1,t.qqkzzt v_2,t.xmjd v_3,
    decode(instr(RemoveSameStr(lx2.ylxbm,','),','),0,RemoveSameStr(lx2.ylxbm,','),lx2.ylxbm) v_4,
    decode(instr(RemoveSameStr(lx2.ylxmc,','),','),0,RemoveSameStr(lx2.ylxmc,','),lx2.ylxmc) v_5,
    lx2.qdzh v_6,lx2.zdzh v_7,
    decode(instr(RemoveSameStr(lx2.ghlxbm,','),','),0,RemoveSameStr(lx2.ghlxbm,','),lx2.ghlxbm)  v_8,
    decode(instr(RemoveSameStr(lx2.ghlxmc,','),','),0,RemoveSameStr(lx2.ghlxmc,','),lx2.ghlxmc) v_9,
    lx2.ghqdzh v_10,lx2.ghzdzh v_11,
     decode(instr(RemoveSameStr(lx2.gxlxbm,','),','),0,RemoveSameStr(lx2.gxlxbm,','),lx2.gxlxbm) v_12,
     lx2.gxqdzh v_13,lx2.gxzdzh v_14,to_char(lx2.zjhlc,'fm9999999990.000') v_15,
     decode(instr(RemoveSameStr(lx2.qdmc,','),','),0,RemoveSameStr(lx2.qdmc,','),lx2.qdmc) v_16,
     decode(instr(RemoveSameStr(lx2.zdmc,','),','),0,RemoveSameStr(lx2.zdmc,','),lx2.zdmc) v_17,
     lx2.jsxz v_18,t.gydw v_19,t.xzqh v_20,t.tsdq v_21,
     RemoveSameStr(lx2.jsjsdjtj,',') v_22,RemoveSameStr(lx2.xjsdjtj,',') v_23,t.xmnf v_24,
     t.jhkgn v_25,t.jhwgn v_26,t.tz v_27,lx2.bzcs v_28,t.xmklx v_29,t.bz v_30
    from WNJH_XJ t 
    left join (select xmid,sum(jhlc) zjhlc,sum(bzcs) bzcs,
        replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,
        replace(WMSYS.WM_CONCAT(decode(jsxz,'新建',xjlxbm,ghlxbm)),',',',') ghxlxbmtj,
        replace(WMSYS.WM_CONCAT(jsjsdj),'、',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),'、',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,
        replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,
        replace(WMSYS.WM_CONCAT(distinct(jsxz)),',',',') jsxz,
        replace(max(qdzh), ',.', ',0.') qdzh,replace(max(zdzh), ',.', ',0.') zdzh,
        replace(max(ghqdzh), ',.', ',0.') ghqdzh,replace(max(ghzdzh), ',.', ',0.') ghzdzh,
        replace(max(gxqdzh), ',.', ',0.') gxqdzh,replace(max(gxzdzh), ',.', ',0.') gxzdzh,
        max(ghlxbm) ghlxbm,max(ylxbm) ylxbm,max(ghlxmc) ghlxmc,max(ylxmc) ylxmc,max(gxlxbm) gxlxbm,
        max(qdmc) qdmc,max(zdmc) zdmc
        from (select  xmid,jsxz,lxmc,lxbm,bzcs,
        (case when jsxz like '%改建%' then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)
            when jsxz like '%新建%' then to_number(xjlc)
            else nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)
        end) jhlc,(case when jsxz like '%新建%' then xjlxbm 
        else ghxlxbm
        end) ghxlxbm,ghxlxmc,jsjsdj,xjsdj,xjlxbm,
               WMSYS.WM_CONCAT(ghlxmc)over( PARTITION BY xmid ORDER BY id,ghlxmc) ghlxmc,
               WMSYS.WM_CONCAT(lxmc)over( PARTITION BY xmid ORDER BY id,lxmc) ylxmc,
               WMSYS.WM_CONCAT(ghlxbm)over( PARTITION BY xmid ORDER BY id,ghlxbm) ghlxbm,
               WMSYS.WM_CONCAT(lxbm)over( PARTITION BY xmid ORDER BY id,lxbm) ylxbm,
               WMSYS.WM_CONCAT((case when qdzh like '.%' then 0||qdzh when qdzh like '%,.%' then replace(qdzh, ',.', ',0.') else qdzh end ))over( PARTITION BY xmid ORDER BY id,qdzh) qdzh,
               WMSYS.WM_CONCAT((case when zdzh like '.%' then 0||zdzh when zdzh like '%,.%' then replace(zdzh, ',.', ',0.') else zdzh end ))over( PARTITION BY xmid ORDER BY id,zdzh) zdzh,
               WMSYS.WM_CONCAT((case when ghqdzh like '.%' then 0||ghqdzh when ghqdzh like '%,.%' then replace(ghqdzh, ',.', ',0.') else ghqdzh end ))over( PARTITION BY xmid ORDER BY id,ghqdzh) ghqdzh,
               WMSYS.WM_CONCAT((case when ghzdzh like '.%' then 0||ghzdzh when ghzdzh like '%,.%' then replace(ghzdzh, ',.', ',0.') else ghzdzh end ))over( PARTITION BY xmid ORDER BY id,ghzdzh) ghzdzh,
               WMSYS.WM_CONCAT(gxlxbm)over( PARTITION BY xmid ORDER BY id,gxlxbm) gxlxbm,
               WMSYS.WM_CONCAT((case when gxqdzh like '.%' then 0||gxqdzh when gxqdzh like '%,.%' then replace(gxqdzh, ',.', ',0.') else gxqdzh end ))over( PARTITION BY xmid ORDER BY id,gxqdzh) gxqdzh,
               WMSYS.WM_CONCAT((case when gxzdzh like '.%' then 0||gxzdzh when gxzdzh like '%,.%' then replace(gxzdzh, ',.', ',0.') else gxzdzh end ))over( PARTITION BY xmid ORDER BY id,gxzdzh) gxzdzh,
               WMSYS.WM_CONCAT(qdmc)over( PARTITION BY xmid ORDER BY id,qdmc) qdmc,
               WMSYS.WM_CONCAT(zdmc)over( PARTITION BY xmid ORDER BY id,zdmc) zdmc
        from WNJH_LX ) group by xmid) lx2 on t.id=lx2.xmid
    where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			${ghlxbh}
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			${ghxlxbm}
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		<if test="xmjd !='' and xmjd != null ">
			and xmjd like '%'||#{xmjd}||'%'
		</if>
<!-- 		order by t.id desc,lx.sffirst desc	 -->
	</select>

	<insert id="importsjgzwnjh" parameterType="hashMap">
		insert into WNJH_SJGZ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,tsdq,yhdk)
		values(#{xmbm},#{lxmc},#{1},#{2},to_char(to_number(#{4})-to_number(#{3})),#{11},#{3},#{4},#{qdmc},#{zdmc},#{16},#{17},#{14},#{15},#{xmbm},#{18},#{19},to_char(to_number(#{18})-to_number(#{19})),#{13},#{12},(select id from XTGL_XZQH where trim(name) = #{13}),(select id from XTGL_DEPARTMENT where trim(name) = #{12}),#{0},'7',(select id from XTGL_DEPARTMENT where trim(name) = #{12}),#{tsdq},'0')
	</insert>
	<insert id="importlmgzwnjh" parameterType="hashMap">
		insert into WNJH_LMGZ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,tsdq,yhdk)
		values(#{xmbm},#{lxmc},#{1},#{2},to_char(to_number(#{4})-to_number(#{3})),#{5},#{3},#{4},#{qdmc},#{zdmc},#{10},#{11},#{8},#{9},#{xmbm},#{12},#{13},to_char(to_number(#{12})-to_number(#{13})),#{7},#{6},(select id from XTGL_XZQH where trim(name) = #{7}),(select id from XTGL_DEPARTMENT where trim(name) = #{6}),#{0},'7',(select id from XTGL_DEPARTMENT where trim(name) = #{6}),#{tsdq},'0')
	</insert>
	<insert id="importxjwnjh" parameterType="hashMap">
		insert into WNJH_XJ( id,lxmc,xmmc,ghlxbh,lc,jsxz,qdzh,zdzh,qdmc,zdmc,jhkgn,jhwgn,jsjsdj,xjsdj,xmbm,tz,bzys,dfzc,xzqh,gydw,xzqhdm,gydwdm,xmnf,sbthcd,tbbmbm,
		tsdq,yhdk)
		values(#{xmbm},#{3},#{1},#{2},to_char(to_number(#{5})-to_number(#{4})),#{18},#{4},#{5},#{6},#{7},#{24},#{25},#{22},#{23},#{xmbm},#{26},#{27},to_char(to_number(#{26})-to_number(#{27})),#{20},#{19},(select id from XTGL_XZQH where trim(name) = #{20}),(select id from XTGL_DEPARTMENT where trim(name) = #{19}),#{0},'7',(select id from XTGL_DEPARTMENT where trim(name) = #{19}),
		#{21},'0')
	</insert>
	<insert id="importsjgzwnjhlx" parameterType="hashMap">
		insert into WNJH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh,
		yilc,erlc,sanlc,silc,dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,jhlc)
		values(sys_guid(),#{xmbm},#{2},#{lxmc},#{13},(select id from XTGL_XZQH where trim(name) = #{13}),#{12},(select id from XTGL_DEPARTMENT where trim(name) = #{12}),#{3},#{4},#{14},to_char(to_number(#{4})-to_number(#{3})),#{15},#{11},#{qdmc},#{zdmc},#{19},'1','0',#{3},#{4},
		#{yilc},#{erlc},#{sanlc},#{silc},#{dwlc},#{wllc},#{5},#{6},#{7},#{8},#{9},#{10},(#{5}+#{6}+#{7}+#{8}+#{9}+#{10}))
	</insert>
	<insert id="importlmgzwnjhlx" parameterType="hashMap">
		insert into WNJH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh,
		yilc,erlc,sanlc,silc,dwlc,wllc)
		values(sys_guid(),#{xmbm},#{2},#{lxmc},#{7},(select id from XTGL_XZQH where trim(name) = #{7}),#{6},(select id from XTGL_DEPARTMENT where trim(name) = #{6}),#{3},#{4},#{8},to_char(to_number(#{4})-to_number(#{3})),#{9},#{5},#{qdmc},#{zdmc},#{13},'1','0',#{3},#{4},
		#{yilc},#{erlc},#{sanlc},#{silc},#{dwlc},#{wllc})
	</insert>
	<insert id="importxjwnjhlx" parameterType="hashMap">
		insert into WNJH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh,
		xjlxbm,xjqdzh,xjzdzh,xjlc,yilc,erlc,sanlc,silc,dwlc,wllc)
		values(sys_guid(),#{xmbm},#{2},#{3},#{20},(select id from XTGL_XZQH where trim(name) = #{20}),#{19},(select id from XTGL_DEPARTMENT where trim(name) = #{19}),#{4},#{5},#{22},to_char(to_number(#{5})-to_number(#{4})),#{23},#{18},#{6},#{7},#{27},'1','0',#{4},#{5},
		#{8},#{9},#{10},#{11},#{12},#{13},#{14},#{15},#{16},#{17})
	</insert>

	<select id="selectWqbzbz" resultType="wqbzbz">
		select t.* from xtgl_wqbzbz t order by decode(t.bzjb,'省级',1,'市级',2),decode(t.qllx,'特大桥',1,'大桥',2,'中桥',3,'小桥',4),decode(t.jsxz,'拆除重建',1,'加固改造',2)
	</select>
	<insert id="tjwqbzbz" parameterType="wqbzbz">
		insert into xtgl_wqbzbz (id,qllx,jsxz,jsdj,bzje,zdkd,bzjb,jsdj1)
		values(sys_guid(),#{qllx},#{jsxz},#{jsdj},#{bzje},#{zdkd},#{bzjb},#{jsdj1})
	</insert>
	<insert id="xgwqbzbz" parameterType="wqbzbz">
		update xtgl_wqbzbz
		set qllx=#{qllx},jsxz=#{jsxz},jsdj=#{jsdj},bzje=#{bzje},zdkd=#{zdkd},bzjb=#{bzjb},jsdj1=#{jsdj1}
		where id=#{id}
	</insert>
	<delete id="delwqbzbz" parameterType="wqbzbz">
		delete from xtgl_wqbzbz where id=#{id}
	</delete>
	<select id="queryXmQqfx" parameterType="java.util.Map" resultType="kxxyj">
		select distinct * from table(funlxjdbs('','')) 
		where xmbm like to_char(sysdate,'yyyy')||'%'
		<if test="xzqhdm!=null and xzqhdm!=''">and ${xzqhdm}</if>
		<if test="shzt!=null and shzt!=''">and shzt = #{shzt}</if>
		<if test="jsxz!=null and jsxz!=''">and jsxz = #{jsxz}</if>
		<if test="lxbm!=null and lxbm!=''">and lxbm like '%'||#{lxbm}||'%' </if>
		<if test="wgny!=null and wgny!=''">and (wgny = #{wgny} or wgny = to_char(to_date(#{wgny},'yyyy-mm-ss'),'yyyy') or wgny = to_char( to_date(#{wgny},'yyyy-MM-ss'),'yyyy-mm'))</if>
		<if test="xmbm!=null and xmbm!=''">and xmbm in (${xmbm})</if>
		order by xmbm
	</select>
	<select id="queryBeformXm" parameterType="java.util.Map" resultType="java.util.Map">
		select substr(roadcode,1,4) roadcode,min(roadstart) roadstart,max(roadends) roadends,max(decode(f026,null,f025,f026)) wgnf,
		sum(roadlen) lc,sum(decode(f014,2,roadlen,0)) yj,sum(decode(f014,3,roadlen,0)) ej,sum(decode(f014,4,roadlen,0)) Sj,
		sum(decode(f014,5,roadlen,0)) SIj,sum(decode(f014,6,roadlen,0)) WL
		from gpsroad  WHERE substr(roadcode,1,4) in(${lxbm}) group by substr(roadcode,1,4)
	</select>
	<select id="queryBeformXmByXzqh" parameterType="java.util.Map" resultType="java.util.Map">
		select substr(roadcode,0,1) roadcode,min(roadstart) roadstart,max(roadends) roadends,max(decode(f026,null,f025,f026)) wgnf,
	    sum(roadlen) lc,sum(decode(f014,2,roadlen,0)) yj,sum(decode(f014,3,roadlen,0)) ej,sum(decode(f014,4,roadlen,0)) Sj,
	    sum(decode(f014,5,roadlen,0)) SIj,sum(decode(f014,6,roadlen,0)) WL,#{xzqhmc} xzqhmc
	    from gpsroad  WHERE substr(roadcode,0,1) in('S','G') and (roadcode like '%'||#{xzqhdm}||'%') group by substr(roadcode,0,1)
	</select>
	<select id="queryNdwg" parameterType="java.util.Map" resultType="java.util.Map">
		select xmid,lxbm
		,decode(substr(xmid,11,1),1,sum(l.yilc),3,0) yilc
		,decode(substr(xmid,11,1),1,sum(l.erlc),3,0) erlc
		,decode(substr(xmid,11,1),1,sum(l.sanlc),3,0) sanlc
		,decode(substr(xmid,11,1),1,sum(l.silc),3,0) silc
		,decode(substr(xmid,11,1),1,sum(l.dwlc),3,0) dwlc
		,decode(substr(xmid,11,1),1,sum(l.wllc),3,0) wllc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhyilc),0),3,nvl(sum(l.yilc),0)) jhyilc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jherlc),0),3,nvl(sum(l.erlc),0)) jherlc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhsanlc),0),3,nvl(sum(l.sanlc),0)) jhsanlc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhsilc),0),3,nvl(sum(l.silc),0)) jhsilc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhdwlc),0),3,nvl(sum(l.dwlc),0)) jhdwlc
		,decode(substr(xmid,11,1),1,nvl(sum(l.jhwllc),0),3,nvl(sum(l.wllc),0)) jhwllc
		from lxsh_lx l where ${xmbm} group by xmid,lxbm 
	</select>
	<select id="queryNdwgXzqh" parameterType="java.util.Map" resultType="java.util.Map">
		select 
		<if test="qb==false">substr(xmid,5,6) xzqhdm,</if>
		<if test="qb==true">'江西省' xzqhmc,</if>
		substr(lxbm,0,1) lxbm
		,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,sum(dwlc) dwlc,sum(wllc) wllc
		,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(sanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc 
		from(select xmid,lxbm
		,decode(substr(xmid,11,1),1,l.yilc,3,0) yilc,decode(substr(xmid,11,1),1,l.erlc,3,0) erlc
		,decode(substr(xmid,11,1),1,l.sanlc,3,0) sanlc,decode(substr(xmid,11,1),1,l.silc,3,0) silc
		,decode(substr(xmid,11,1),1,l.dwlc,3,0) dwlc,decode(substr(xmid,11,1),1,l.wllc,3,0) wllc
		,decode(substr(xmid,11,1),1,nvl(l.jhyilc,0),3,nvl(l.yilc,0)) jhyilc,decode(substr(xmid,11,1),1,nvl(l.jherlc,0),3,nvl(l.erlc,0)) jherlc
		,decode(substr(xmid,11,1),1,nvl(l.jhsanlc,0),3,nvl(l.sanlc,0)) jhsanlc,decode(substr(xmid,11,1),1,nvl(l.jhsilc,0),3,nvl(l.silc,0)) jhsilc
		,decode(substr(xmid,11,1),1,nvl(l.jhdwlc,0),3,nvl(l.dwlc,0)) jhdwlc,decode(substr(xmid,11,1),1,nvl(l.jhwllc,0),3,nvl(l.wllc,0)) jhwllc
		from lxsh_lx l where substr(lxbm,0,1) in('S','G') and (${xmbm})) 
		group by <if test="qb==false">substr(xmid,5,6),</if>substr(lxbm,0,1)
	</select>
	<select id="showgjtj" parameterType="lxsh" resultType="lxsh">
		select count(*) sl,nvl(sum(tz),0) tz,nvl(sum(bzys),0) bzys,nvl(sum(zlc),0) lc,nvl((sum(tz)-sum(bzys)),0) dftz,'0' sbz,'0' sjl  from (
	    select rownum num ,t.*,lx.*,decode(lx1.sl,null,'0',lx1.sl) sl,lx2.zjhlc,lx2.lc zlc from WNJH_SJGZ t left join
	    (select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
	    sum(dwlc) dwlc,sum(wllc) wllc,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(jhsanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc,sum(jhlc) jhlc
	    from WNJH_LX where sffirst='1' group by xmid) lx on t.id=lx.xmid 
	    left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
	    left join (select xmid,decode(min(jsxz),'改建',nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0),nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0))  zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(decode(jsxz,'新建',xjlxbm,ghlxbm)),',',',') ghxlxbmtj,
        nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0) lc,
        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'改建工程' xmlx1 
        from WNJH_LX group by xmid) lx2 on t.id=lx2.xmid
	    where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			${ghlxbh}
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			${ghxlxbm}
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		<if test="xmjd !='' and xmjd != null ">
			and xmjd like '%'||#{xmjd}||'%'
		</if>
		order by xmnf
		) t1
	</select>
	<select id="showlmtj" parameterType="lxsh" resultType="lxsh">
		select count(*) sl,sum(tz) tz,sum(bzys) bzys,sum(jhlc) lc,(sum(tz)-sum(bzys)) dftz,'0' sbz,'0' sjl  from (
		select rownum num ,t.lsjl,t.xmnf,t.gz,t.sz,t.jhkgn,t.jhwgn,t.jsxz,t.yhdk,t.bz,t.id,t.lxmc,t.shzt,t.xmmc,t.xmbm,t.gydw,t.xzqh,t.ghlxbh,t.qdmc,t.zdmc,t.xjsdj,t.jsjsdj,t.tz,t.bzys,t.dfzc,t.tsdq,lx.*,lx1.sl,lx2.jhlc  from wnjh_lmgz t left join 
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(lc) lc,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc from wnjh_lx where sffirst='1' group by xmid) lx on t.id=lx.xmid left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid 
		left join (select xmid,decode(min(jsxz),'改建',nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0),nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0))  jhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(decode(jsxz,'新建',xjlxbm,ghlxbm)),',',',') ghxlxbmtj,
   		replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
   		replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
    	replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,'路面改造工程' xmlx1 
    	from WNJH_LX group by xmid) lx2 on t.id=lx2.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			${ghlxbh}
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			${ghxlxbm}
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		<if test="xmjd !='' and xmjd != null ">
			and xmjd like '%'||#{xmjd}||'%'
		</if>
		order by xmnf
		) t1
	</select>
	<select id="showxjtj" parameterType="lxsh" resultType="lxsh">
		select count(*) sl,sum(tz) tz,sum(bzys) bzys,sum(zjhlc) lc,'0' cgs,'0' sbz,'0' sjl,(sum(tz)-sum(bzys)) dftz  from (
    select rownum num ,t.*,lx.*,decode(lx1.sl,null,'0',lx1.sl) sl,lx2.zjhlc from wnjh_xj t left join
    (select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
    sum(dwlc) dwlc,sum(wllc) wllc,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(jhsanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc,sum(jhlc) jhlc
    from WNJH_LX where sffirst='1' group by xmid) lx on t.id=lx.xmid 
    left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
    left join (select xmid,
    sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
        from (select  xmid,jsxz,
        (case when jsxz like '%改建%' then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)
        when jsxz like '%新建%' then to_number(xjlc)
        else nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)
        end) jhlc,lxbm,lxmc,(case when jsxz like '%新建%' then xjlxbm 
        else ghxlxbm
        end) ghxlxbm,ghxlxmc,jsjsdj,xjsdj
        from WNJH_LX ) group by xmid) lx2 on t.id=lx2.xmid
    where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			${ghlxbh}
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			${ghxlxbm}
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		<if test="xmjd !='' and xmjd != null ">
			and xmjd like '%'||#{xmjd}||'%'
		</if>
		order by xmnf
		) t1
	</select>
	<select id="selectJxAndGj" parameterType="lxsh" resultType="lxsh">
		select * from (
		select w.id,w.xmmc,w.jhwgn,l.xzqh,l.xzqhdm,l.lxbm,l.lxmc,l.qdzh,l.zdzh,l.jsxz,l.yilc,l.erlc,l.sanlc,l.silc,l.wllc,
		l.jhyilc,l.jherlc,l.jhsanlc,l.jhsilc,l.jhwllc from wnjh_lmgz w left join wnjh_lx l on w.id = l.xmid
		union all
		select w.id,w.xmmc,w.jhwgn,l.xzqh,l.xzqhdm,l.lxbm,l.lxmc,l.qdzh,l.zdzh,l.jsxz,l.yilc,l.erlc,l.sanlc,l.silc,l.wllc ,
		l.jhyilc,l.jherlc,l.jhsanlc,l.jhsilc,l.jhwllc from wnjh_xj w left join wnjh_lx l on w.id = l.xmid)
		where 1=1
		<if test="xzqh!=null and xzqh!=''">${xzqh}</if>
		<if test="lxbm!=null and lxbm!=''"> and lxbm like #{lxbm}||'%'</if>
		<if test="id!=null and id!=''"> and id in (${id})</if>
	</select>
	<select id="selectYlx" parameterType="lxsh" resultType="java.util.Map">
		select substr(roadcode,1,4) roadcode,min(roadstart) roadstart,max(roadends) roadends,max(decode(f026,null,f025,f026)) wgnf,
		sum(roadlen) lc,sum(decode(f014,2,roadlen,0)) yj,sum(decode(f014,3,roadlen,0)) ej,sum(decode(f014,4,roadlen,0)) Sj,
		sum(decode(f014,5,roadlen,0)) SIj,sum(decode(f014,6,roadlen,0)) WL
		from gpsroad  WHERE substr(roadcode,1,4) in(${lxbm}) group by substr(roadcode,1,4)
	</select>
	<select id="selectYSj" parameterType="java.util.Map" resultType="java.util.Map">
		select substr(roadcode,0,1) roadcode,min(roadstart) roadstart,max(roadends) roadends,max(decode(f026,null,f025,f026)) wgnf,
	    sum(roadlen) lc,sum(decode(f014,2,roadlen,0)) yj,sum(decode(f014,3,roadlen,0)) ej,sum(decode(f014,4,roadlen,0)) Sj,
	    sum(decode(f014,5,roadlen,0)) SIj,sum(decode(f014,6,roadlen,0)) WL,#{xzqhmc} xzqhmc
	    from gpsroad  WHERE substr(roadcode,0,1) in('S','G') 
	    and (roadcode like '%'||#{xzqhdm}||'%')
	     group by substr(roadcode,0,1)
	</select>
	<select id="selectGhSj" parameterType="java.util.Map" resultType="java.util.Map">
		select 
		<if test="qb==false">#{xzqhdm} xzqhdm,</if>
		<if test="qb==true">'江西省' xzqhmc,</if>
		substr(lxbm,0,1) lxbm
		,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,sum(dwlc) dwlc,sum(wllc) wllc
		,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(sanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc 
		from(select xmid,lxbm ,l.yilc,l.erlc ,l.sanlc,l.silc ,l.dwlc,l.wllc,l.jhyilc,l.jherlc ,l.jhsanlc,l.jhsilc,l.jhdwlc,l.jhwllc
		from wnjh_lx l where substr(lxbm,0,1) in('S','G') and xzqhdm like #{xzqhdm}||'%') 
		group by substr(lxbm,0,1)
	</select>
	<select id="cxwnxmkbyxmbm" parameterType="lxsh" resultType="lxsh">
		select rownum num ,t.*,lx.*,decode(lx1.sl,null,'0',lx1.sl) sl,lx2.zjhlc from wngsdgz t left join
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(jhsanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc,sum(jhlc) jhlc,max(xjlxbm) xjlxbm,min(xjqdzh) xjqdzh,max(xjzdzh) xjzdzh,decode(min(jsxz), '新建', min(xjlxbm), min(ghlxbm)) ghlxbm,decode(min(jsxz), '新建', min(xjqdzh), min(ghqdzh)) ghqdzh, decode(min(jsxz), '新建', max(xjzdzh), max(ghzdzh)) ghzdzh
		from WNJH_LX where sffirst='1' group by xmid) lx on t.id=lx.xmid 
		left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
		left join (select xmid,
		sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
        from (select  xmid,jsxz,
        (case when jsxz like '%改建%' then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)
        when jsxz like '%新建%' then to_number(xjlc)
        else to_number(lc)
        end) jhlc,lxbm,lxmc,(case when jsxz like '%新建%' then xjlxbm 
        else ghxlxbm
        end) ghxlxbm,ghxlxmc,jsjsdj,xjsdj
        from WNJH_LX ) group by xmid) lx2 on t.id=lx2.xmid
		where 1=1 and t.xmbm=#{xmbm}
	</select>
	
	
	<select id="selectGsdwnjh" parameterType="lxsh" resultType="lxsh">
		select * from (
		select rownum num ,t.*,lx.*,decode(lx1.sl,null,'0',lx1.sl) sl,lx2.zjhlc from wngsdgz t left join
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(jhsanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc,sum(jhlc) jhlc,max(xjlxbm) xjlxbm,min(xjqdzh) xjqdzh,max(xjzdzh) xjzdzh,decode(min(jsxz), '新建', min(xjlxbm), min(ghlxbm)) ghlxbm,decode(min(jsxz), '新建', min(xjqdzh), min(ghqdzh)) ghqdzh, decode(min(jsxz), '新建', max(xjzdzh), max(ghzdzh)) ghzdzh
		from WNJH_LX where sffirst='1' group by xmid) lx on t.id=lx.xmid 
		left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
		left join (select xmid,
		sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
        from (select  xmid,jsxz,
        (case when jsxz like '%改建%' then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)
        when jsxz like '%新建%' then to_number(xjlc)
        else to_number(lc)
        end) jhlc,lxbm,lxmc,(case when jsxz like '%新建%' then xjlxbm 
        else ghxlxbm
        end) ghxlxbm,ghxlxmc,jsjsdj,xjsdj
        from WNJH_LX ) group by xmid) lx2 on t.id=lx2.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			${ghlxbh}
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			${ghxlxbm}
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		<if test="xmjd !='' and xmjd != null ">
			and t.xmjd like '%'||#{xmjd}||'%'
		</if>
		order by xmnf
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows}
	</select>
	<select id="selectGsdwnjhCount" parameterType="lxsh" resultType="int">
		select count(*) from (
		select rownum num ,t.*,lx.*,decode(lx1.sl,null,'0',lx1.sl) sl,lx2.zjhlc from wngsdgz t left join
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(jhsanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc,sum(jhlc) jhlc
		from WNJH_LX where sffirst='1' group by xmid) lx on t.id=lx.xmid 
		left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
		left join (select xmid,
		sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
        from (select  xmid,jsxz,
        (case when jsxz like '%改建%' then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)
        when jsxz like '%新建%' then to_number(xjlc)
        else to_number(lc)
        end) jhlc,lxbm,lxmc,(case when jsxz like '%新建%' then xjlxbm 
        else ghxlxbm
        end) ghxlxbm,ghxlxmc,jsjsdj,xjsdj
        from WNJH_LX ) group by xmid) lx2 on t.id=lx2.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			${ghlxbh}
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			${ghxlxbm}
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		<if test="xmjd !='' and xmjd != null ">
			and t.xmjd like '%'||#{xmjd}||'%'
		</if>
		order by xmnf
		) t1
	</select>
	<select id="showgsdtj" parameterType="lxsh" resultType="lxsh">
		select count(*) sl,sum(tz) tz,sum(bzys) bzys,sum(zjhlc) lc,'0' cgs,'0' sbz,'0' sjl,(sum(tz)-sum(bzys)) dftz  from (
		select rownum num ,t.*,lx.*,decode(lx1.sl,null,'0',lx1.sl) sl,lx2.zjhlc from wngsdgz t left join
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(jhsanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc,sum(jhlc) jhlc
		from WNJH_LX where sffirst='1' group by xmid) lx on t.id=lx.xmid 
		left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
		left join (select xmid,
		sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
        from (select  xmid,jsxz,
        (case when jsxz like '%改建%' then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)
        when jsxz like '%新建%' then to_number(xjlc)
        else nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)
        end) jhlc,lxbm,lxmc,(case when jsxz like '%新建%' then xjlxbm 
        else ghxlxbm
        end) ghxlxbm,ghxlxmc,jsjsdj,xjsdj
        from WNJH_LX ) group by xmid) lx2 on t.id=lx2.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			${ghlxbh}
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			${ghxlxbm}
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		<if test="xmjd !='' and xmjd != null ">
			and xmjd like '%'||#{xmjd}||'%'
		</if>
		order by xmnf
		) t1
	</select>
	<select id="querywnjhGsdgz" parameterType="lxsh" resultType="elist">
		<!-- select * from (
		select t.xmmc v_0,lx.lxbm v_1,lx.lxmc v_2,lx.qdzh v_3,lx.zdzh v_4,
		lx.ghlxbm v_5,lx.ghlxmc v_6,lx.ghqdzh v_7,lx.ghzdzh v_8,
		lx.gxlxbm v_9,lx.gxqdzh v_10,lx.gxzdzh v_11,lx.wlc v_12,
		lx.qdmc v_13,lx.zdmc v_14,lx.jsxz v_15,lx.gydw v_16,lx.xzqh v_17,t.tsdq v_18,lx.jsjsdj v_19,lx.xjsdj v_20,t.xmnf v_21,t.jhkgn v_22,t.jhwgn v_23,decode(lx.sffirst,'1',t.tz,'') v_24,decode(lx.sffirst,'1',lx.bzcs,'') v_25,t.xmklx v_26,t.bz v_27,decode(lx1.sl,null,'0',lx1.sl) sl,lx2.zjhlc from wngsdgz t left join
		(select w.*,(case when jsxz like '%改建%' then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
					  when jsxz like '%新建%' then xjlc
					    else lc
        end) wlc
		from WNJH_LX w) lx on t.id=lx.xmid 
		left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
		left join (select xmid,
		sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,
		replace(WMSYS.WM_CONCAT(decode(jsxz,'新建',xjlxbm,ghlxbm)),',',',') ghxlxbmtj,
        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
        from (select  xmid,jsxz,
        (case when jsxz like '%改建%' then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
					  when jsxz like '%新建%' then xjlc
					    else lc
        end) jhlc,lxbm,lxmc,(case when jsxz like '%新建%' then xjlxbm 
        else ghxlxbm
        end) ghxlxbm,ghxlxmc,jsjsdj,xjsdj,xjlxbm,ghlxbm
        from WNJH_LX ) group by xmid) lx2 on t.id=lx2.xmid
		where 1=1 -->
        select rownum v_0,t.xmmc v_1,t.qqkzzt v_2,t.xmjd v_3,
    decode(instr(RemoveSameStr(lx2.ylxbm,','),','),0,RemoveSameStr(lx2.ylxbm,','),lx2.ylxbm) v_4,
    decode(instr(RemoveSameStr(lx2.ylxmc,','),','),0,RemoveSameStr(lx2.ylxmc,','),lx2.ylxmc) v_5,
    lx2.qdzh v_6,lx2.zdzh v_7,
    decode(instr(RemoveSameStr(lx2.ghlxbm,','),','),0,RemoveSameStr(lx2.ghlxbm,','),lx2.ghlxbm)  v_8,
    decode(instr(RemoveSameStr(lx2.ghlxmc,','),','),0,RemoveSameStr(lx2.ghlxmc,','),lx2.ghlxmc) v_9,
    lx2.ghqdzh v_10,lx2.ghzdzh v_11,
     decode(instr(RemoveSameStr(lx2.gxlxbm,','),','),0,RemoveSameStr(lx2.gxlxbm,','),lx2.gxlxbm) v_12,
     lx2.gxqdzh v_13,lx2.gxzdzh v_14,to_char(lx2.zjhlc,'fm9999999990.000') v_15,
     decode(instr(RemoveSameStr(lx2.qdmc,','),','),0,RemoveSameStr(lx2.qdmc,','),lx2.qdmc) v_16,
     decode(instr(RemoveSameStr(lx2.zdmc,','),','),0,RemoveSameStr(lx2.zdmc,','),lx2.zdmc) v_17,
     lx2.jsxz v_18,t.gydw v_19,t.xzqh v_20,t.tsdq v_21,
     RemoveSameStr(lx2.jsjsdjtj,',') v_22,RemoveSameStr(lx2.xjsdjtj,',') v_23,t.xmnf v_24,
     t.jhkgn v_25,t.jhwgn v_26,t.tz v_27,lx2.bzcs v_28,t.xmklx v_29,t.bz v_30
    from wngsdgz t 
    left join (select xmid,sum(jhlc) zjhlc,sum(bzcs) bzcs,
        replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,
        replace(WMSYS.WM_CONCAT(decode(jsxz,'新建',xjlxbm,ghlxbm)),',',',') ghxlxbmtj,
        replace(WMSYS.WM_CONCAT(jsjsdj),'、',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),'、',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,
        replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj,
        replace(WMSYS.WM_CONCAT(distinct(jsxz)),',',',') jsxz,
        replace(max(qdzh), ',.', ',0.') qdzh,replace(max(zdzh), ',.', ',0.') zdzh,
        replace(max(ghqdzh), ',.', ',0.') ghqdzh,replace(max(ghzdzh), ',.', ',0.') ghzdzh,
        replace(max(gxqdzh), ',.', ',0.') gxqdzh,replace(max(gxzdzh), ',.', ',0.') gxzdzh,
        max(ghlxbm) ghlxbm,max(ylxbm) ylxbm,max(ghlxmc) ghlxmc,max(ylxmc) ylxmc,max(gxlxbm) gxlxbm,
        max(qdmc) qdmc,max(zdmc) zdmc
        from (select  xmid,jsxz,lxmc,lxbm,bzcs,
        (case when jsxz like '%改建%' then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)
            when jsxz like '%新建%' then to_number(xjlc)
            else nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)
        end) jhlc,(case when jsxz like '%新建%' then xjlxbm 
        else ghxlxbm
        end) ghxlxbm,ghxlxmc,jsjsdj,xjsdj,xjlxbm,
               WMSYS.WM_CONCAT(ghlxmc)over( PARTITION BY xmid ORDER BY id,ghlxmc) ghlxmc,
               WMSYS.WM_CONCAT(lxmc)over( PARTITION BY xmid ORDER BY id,lxmc) ylxmc,
               WMSYS.WM_CONCAT(ghlxbm)over( PARTITION BY xmid ORDER BY id,ghlxbm) ghlxbm,
               WMSYS.WM_CONCAT(lxbm)over( PARTITION BY xmid ORDER BY id,lxbm) ylxbm,
               WMSYS.WM_CONCAT((case when qdzh like '.%' then 0||qdzh when qdzh like '%,.%' then replace(qdzh, ',.', ',0.') else qdzh end ))over( PARTITION BY xmid ORDER BY id,qdzh) qdzh,
               WMSYS.WM_CONCAT((case when zdzh like '.%' then 0||zdzh when zdzh like '%,.%' then replace(zdzh, ',.', ',0.') else zdzh end ))over( PARTITION BY xmid ORDER BY id,zdzh) zdzh,
               WMSYS.WM_CONCAT((case when ghqdzh like '.%' then 0||ghqdzh when ghqdzh like '%,.%' then replace(ghqdzh, ',.', ',0.') else ghqdzh end ))over( PARTITION BY xmid ORDER BY id,ghqdzh) ghqdzh,
               WMSYS.WM_CONCAT((case when ghzdzh like '.%' then 0||ghzdzh when ghzdzh like '%,.%' then replace(ghzdzh, ',.', ',0.') else ghzdzh end ))over( PARTITION BY xmid ORDER BY id,ghzdzh) ghzdzh,
               WMSYS.WM_CONCAT(gxlxbm)over( PARTITION BY xmid ORDER BY id,gxlxbm) gxlxbm,
               WMSYS.WM_CONCAT((case when gxqdzh like '.%' then 0||gxqdzh when gxqdzh like '%,.%' then replace(gxqdzh, ',.', ',0.') else gxqdzh end ))over( PARTITION BY xmid ORDER BY id,gxqdzh) gxqdzh,
               WMSYS.WM_CONCAT((case when gxzdzh like '.%' then 0||gxzdzh when gxzdzh like '%,.%' then replace(gxzdzh, ',.', ',0.') else gxzdzh end ))over( PARTITION BY xmid ORDER BY id,gxzdzh) gxzdzh,
               WMSYS.WM_CONCAT(qdmc)over( PARTITION BY xmid ORDER BY id,qdmc) qdmc,
               WMSYS.WM_CONCAT(zdmc)over( PARTITION BY xmid ORDER BY id,zdmc) zdmc
        from WNJH_LX ) group by xmid) lx2 on t.id=lx2.xmid
    where 1=1  
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
<!-- 			and ghlxbmtj like '%'||#{ghlxbh}||'%' -->
			${ghlxbh}
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
<!-- 			and ghxlxbmtj like '%'||#{ghxlxbm}||'%' -->
			${ghxlxbm}
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		<if test="xmjd !='' and xmjd != null ">
			and xmjd like '%'||#{xmjd}||'%'
		</if>
<!-- 		order by t.id,lx.sffirst desc -->
<!-- 		) t1 -->
	</select>
	
	
	<select id="getWngjinfobyid" parameterType="String" resultType="lxsh">
		select * from wnjh_sjgz where id=#{value}
	</select>
	<select id="getWnlminfobyid" parameterType="String" resultType="lxsh">
		select * from wnjh_lmgz where id=#{value}
	</select>
	<select id="getWnxjinfobyid" parameterType="String" resultType="lxsh">
		select * from wnjh_xj where id=#{value}
	</select>
	<update id="updateWnxmjd" parameterType="lxsh">
		update ${bz} set xmjd=#{xmjd} where id in (select wnid from ${bzcs} where xmbm in(${xmbm}))
	</update>
	
	<update id="updateWnxmjd_sjgz" parameterType="lxsh">
		update ${bz} set xmjd=#{xmjd} where id in (${wnid})
	</update>
	
	<select id="ckylwjgads" parameterType="lxsh" resultType="elist">
	(select to_char('1') xzqhdm,#{bz}||'小计' v_0,sum(lc) v_1,sum(decode(jsdj,'一级公路',lc,0)) v_2,sum(decode(jsdj,'二级公路',lc,0)) v_3,sum(decode(jsdj,'三级公路',lc,0)) v_4,sum(decode(jsdj,'四级公路',lc,0)) v_5,sum(decode(jsdj,'等外公路',lc,0)) v_6, 
	to_char(decode(sum(lc),0,0,round((sum(decode(jsdj,'一级公路',lc,'二级公路',lc,0))/sum(lc)*100),1)))||'%' v_7,
	to_char(decode(sum(lc),0,0,round((sum(decode(jsdj,'一级公路',lc,'二级公路',lc,'三级公路',lc,0))/sum(lc)*100),1)))||'%' v_8
	from nwggmgxgps where 1=1
	<if test="nwgxzdj != null and nwgxzdj != ''">${nwgxzdj}</if>
	)
	union all
	(select to_char(min(xzqhdm)) xzqhdm,to_char(xzqh) v_0,sum(lc) v_1,sum(decode(jsdj,'一级公路',lc,0)) v_2,sum(decode(jsdj,'二级公路',lc,0)) v_3,sum(decode(jsdj,'三级公路',lc,0)) v_4,sum(decode(jsdj,'四级公路',lc,0)) v_5,sum(decode(jsdj,'等外公路',lc,0)) v_6, 
	to_char(decode(sum(lc),0,0,round((sum(decode(jsdj,'一级公路',lc,'二级公路',lc,0))/sum(lc)*100),1)))||'%' v_7,
	to_char(decode(sum(lc),0,0,round((sum(decode(jsdj,'一级公路',lc,'二级公路',lc,'三级公路',lc,0))/sum(lc)*100),1)))||'%' v_8
	from nwggmgxgps where 1=1
	<if test="nwgxzdj != null and nwgxzdj != ''">${nwgxzdj}</if>
	group by xzqh)
	order by xzqhdm
	
	
	</select>
	<select id="ckylwjgalx" parameterType="lxsh" resultType="elist">
	(select to_char('1') xzqhdm,#{bz}||'小计' v_0,sum(lc) v_1,sum(decode(jsdj,'一级公路',lc,0)) v_2,sum(decode(jsdj,'二级公路',lc,0)) v_3,sum(decode(jsdj,'三级公路',lc,0)) v_4,sum(decode(jsdj,'四级公路',lc,0)) v_5,sum(decode(jsdj,'等外公路',lc,0)) v_6, 
	to_char(decode(sum(lc),0,0,round((sum(decode(jsdj,'一级公路',lc,'二级公路',lc,0))/sum(lc)*100),1)))||'%' v_7,
	to_char(decode(sum(lc),0,0,round((sum(decode(jsdj,'一级公路',lc,'二级公路',lc,'三级公路',lc,0))/sum(lc)*100),1)))||'%' v_8,'1' lxbm
	from nwggmgxgps where 1=1
	<if test="nwgxzdj != null and nwgxzdj != ''">${nwgxzdj}</if>
	)
	union all
	(select to_char(min(xzqhdm)) xzqhdm,to_char(lxbm) v_0,sum(lc) v_1,sum(decode(jsdj,'一级公路',lc,0)) v_2,sum(decode(jsdj,'二级公路',lc,0)) v_3,sum(decode(jsdj,'三级公路',lc,0)) v_4,sum(decode(jsdj,'四级公路',lc,0)) v_5,sum(decode(jsdj,'等外公路',lc,0)) v_6, 
	to_char(decode(sum(lc),0,0,round((sum(decode(jsdj,'一级公路',lc,'二级公路',lc,0))/sum(lc)*100),1)))||'%' v_7,
	to_char(decode(sum(lc),0,0,round((sum(decode(jsdj,'一级公路',lc,'二级公路',lc,'三级公路',lc,0))/sum(lc)*100),1)))||'%' v_8,to_char(lxbm) lxbm
	from nwggmgxgps where 1=1
	<if test="nwgxzdj != null and nwgxzdj != ''">${nwgxzdj}</if>
	group by lxbm)
	order by lxbm,xzqhdm
	
	
	</select>
	
	<select id="selectGsdxzxm" parameterType="lxsh" resultType="lxsh">
		select rownum num ,t.*,lx.*,decode(lx1.sl,null,'0',lx1.sl) sl,lx2.zjhlc from wngsdgz t left join
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(jhsanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc,sum(jhlc) jhlc,max(xjlxbm) xjlxbm,min(xjqdzh) xjqdzh,max(xjzdzh) xjzdzh,min(ghlxbm) ghlxbm,max(ghqdzh) ghqdzh,max(ghzdzh) ghzdzh
		from WNJH_LX where sffirst='1' group by xmid) lx on t.id=lx.xmid 
		left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
		left join (select xmid,
		sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
        from (select  xmid,jsxz,
        (case when jsxz like '%改建%' then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)
        when jsxz like '%新建%' then to_number(xjlc)
        else to_number(lc)
        end) jhlc,lxbm,lxmc,(case when jsxz like '%新建%' then xjlxbm 
        else ghxlxbm
        end) ghxlxbm,ghlxmc ghxlxmc,jsjsdj,xjsdj
        from WNJH_LX ) group by xmid) lx2 on t.id=lx2.xmid
		where 1=1 and (xmlx1='改建工程' or xmlx1='新建工程')
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and xmnf in (${xmnf})
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			${jsdj}
		</if>
		<if test="jsjsdj !='' and jsjsdj != null ">
			${jsjsdj}
		</if>
		<if test="lsjl!='' and lsjl!= null ">
			and lsjl=#{lsjl}
		</if>
		<if test="gldj!='' and gldj!= null ">
			${gldj}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			${ghlxbh}
		</if>
		<if test="ghxlxbm !='' and ghxlxbm != null ">
			${ghxlxbm}
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and ghlxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghxlxmc !='' and ghxlxmc != null ">
			and ghxlxmctj like '%'||#{ghxlxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="qqkzzt !='' and qqkzzt != null ">
			and qqkzzt like '%'||#{qqkzzt}||'%'
		</if>
		<if test="xmklx !='' and xmklx != null ">
			and xmklx like '%'||#{xmklx}||'%'
		</if>
		<if test="gydw!='36' and gydw!=null">
			and znsjck is null
		</if>
		<if test="nwgxzdj != null and nwgxzdj != ''">${nwgxzdj}</if>
		
		order by xmnf

	</select>
	
	<select id="selectGsdyxzxm" parameterType="lxsh" resultType="lxsh">
		select rownum num ,t.*,lx.*,decode(lx1.sl,null,'0',lx1.sl) sl,lx2.zjhlc from wngsdgz t left join
		(select min(qdzh) minqdzh,max(zdzh) maxzdzh,xmid,sum(yilc) yilc,sum(erlc) erlc,sum(sanlc) sanlc,sum(silc) silc,
		sum(dwlc) dwlc,sum(wllc) wllc,sum(jhyilc) jhyilc,sum(jherlc) jherlc,sum(jhsanlc) jhsanlc,sum(jhsilc) jhsilc,sum(jhdwlc) jhdwlc,sum(jhwllc) jhwllc,sum(jhlc) jhlc,max(xjlxbm) xjlxbm,min(xjqdzh) xjqdzh,max(xjzdzh) xjzdzh,min(ghlxbm) ghlxbm,max(ghqdzh) ghqdzh,max(ghzdzh) ghzdzh
		from WNJH_LX where sffirst='1' group by xmid) lx on t.id=lx.xmid 
		left join (select xmid,count(*) sl from WNJH_LX where sffirst!=1 group by xmid) lx1 on t.id=lx1.xmid
		left join (select xmid,
		sum(jhlc) zjhlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') ghlxbmtj,replace(WMSYS.WM_CONCAT(ghxlxbm),',',',') ghxlxbmtj,
        replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsjsdjtj,
        replace(WMSYS.WM_CONCAT(xjsdj),',',',') xjsdjtj,
        replace(WMSYS.WM_CONCAT(lxmc),',',',') ghlxmctj,replace(WMSYS.WM_CONCAT(ghxlxmc),',',',') ghxlxmctj
        from (select  xmid,jsxz,
        (case when jsxz like '%改建%' then nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)
        when jsxz like '%新建%' then to_number(xjlc)
        else to_number(lc)
        end) jhlc,lxbm,lxmc,(case when jsxz like '%新建%' then xjlxbm 
        else ghxlxbm
        end) ghxlxbm,ghlxmc ghxlxmc,jsjsdj,xjsdj
        from WNJH_LX ) group by xmid) lx2 on t.id=lx2.xmid
		where 1=1 and (xmlx1='改建工程' or xmlx1='新建工程')
		
		<if test="xmbm != null and xmbm != ''">${xmbm}</if>
		
		order by xmnf

	</select>
	
	
	
	<select id="ckxlwjgads" parameterType="lxsh" resultType="elist">
	
	(select to_char('1') xzqhdm,#{bz}||'小计' v_0,sum(v_1) v_1,sum(v_2) v_2,sum(v_3) v_3,sum(v_4) v_4,sum(v_5) v_5,sum(v_6) v_6,
	to_char(round((sum(v_2)+sum(v_3))/sum(v_1)*100,1))||'%' v_7,
	to_char(round((sum(v_2)+sum(v_3)+sum(v_4))/sum(v_1)*100,1))||'%' v_8
	from(
	select to_char(lxbm) lxbm,to_char(xzqhdm) xzqhdm,xzqh,decode(fun_sfylx(to_char(lxbm)||substr(to_char(xzqhdm),0,4)),'是',(nvl(xyi + xer + xsan + xsi + xdw, 0) -nvl(yi + er + san + si + dw, 0)),nvl(xyi + xer + xsan + xsi + xdw, 0)) v_1,bhyi v_2,bher v_3,bhsan v_4,bhsi v_5,bhdw v_6
	from nwggmgxwn where 1=1 and xmid in (${xmbm})
	union all
	select to_char(lxbm) lxbm,to_char(xzqhdm) xzqhdm,xzqh,lc v_1,decode(jsdj,'一级公路',lc,0) v_2,decode(jsdj,'二级公路',lc,0) v_3,decode(jsdj,'三级公路',lc,0) v_4,decode(jsdj,'四级公路',lc,0) v_5,decode(jsdj,'等外公路',lc,0) v_6
	from nwggmgxgps
	) where 1=1 
	<if test="nwgxzdj != null and nwgxzdj != ''">${nwgxzdj}</if>
	)
	union all
	(select min(xzqhdm) xzqhdm,to_char(xzqh) v_0,sum(v_1) v_1,sum(v_2) v_2,sum(v_3) v_3,sum(v_4) v_4,sum(v_5) v_5,sum(v_6) v_6,
	to_char(round((sum(v_2)+sum(v_3))/sum(v_1)*100,1))||'%' v_7,
	to_char(round((sum(v_2)+sum(v_3)+sum(v_4))/sum(v_1)*100,1))||'%' v_8
	from(
	select to_char(lxbm) lxbm,to_char(xzqhdm) xzqhdm,xzqh,decode(fun_sfylx(to_char(lxbm)||substr(to_char(xzqhdm),0,4)),'是',(nvl(xyi + xer + xsan + xsi + xdw, 0) -nvl(yi + er + san + si + dw, 0)),nvl(xyi + xer + xsan + xsi + xdw, 0)) v_1,bhyi v_2,bher v_3,bhsan v_4,bhsi v_5,bhdw v_6
	from nwggmgxwn where 1=1 and xmid in (${xmbm})
	union all
	select to_char(lxbm) lxbm,to_char(xzqhdm) xzqhdm,xzqh,lc v_1,decode(jsdj,'一级公路',lc,0) v_2,decode(jsdj,'二级公路',lc,0) v_3,decode(jsdj,'三级公路',lc,0) v_4,decode(jsdj,'四级公路',lc,0) v_5,decode(jsdj,'等外公路',lc,0) v_6
	from nwggmgxgps
	) where 1=1 
	<if test="nwgxzdj != null and nwgxzdj != ''">${nwgxzdj}</if>
	group by xzqh
	)
	order by xzqhdm
	</select>
	<select id="ckxlwjgalx" parameterType="lxsh" resultType="elist">
	(select to_char('1') xzqhdm,#{bz}||'小计' v_0,sum(v_1) v_1,sum(v_2) v_2,sum(v_3) v_3,sum(v_4) v_4,sum(v_5) v_5,sum(v_6) v_6,
	to_char(round((sum(v_2)+sum(v_3))/sum(v_1)*100,1))||'%' v_7,
	to_char(round((sum(v_2)+sum(v_3)+sum(v_4))/sum(v_1)*100,1))||'%' v_8,'1' lxbm
	from(
	select to_char(lxbm) lxbm,to_char(xzqhdm) xzqhdm,xzqh,decode(fun_sfylx(to_char(lxbm)||substr(to_char(xzqhdm),0,4)),'是',(nvl(xyi + xer + xsan + xsi + xdw, 0) -nvl(yi + er + san + si + dw, 0)),nvl(xyi + xer + xsan + xsi + xdw, 0)) v_1,bhyi v_2,bher v_3,bhsan v_4,bhsi v_5,bhdw v_6
	from nwggmgxwn where 1=1 and xmid in (${xmbm})
	union all
	select to_char(lxbm) lxbm,to_char(xzqhdm) xzqhdm,xzqh,lc v_1,decode(jsdj,'一级公路',lc,0) v_2,decode(jsdj,'二级公路',lc,0) v_3,decode(jsdj,'三级公路',lc,0) v_4,decode(jsdj,'四级公路',lc,0) v_5,decode(jsdj,'等外公路',lc,0) v_6
	from nwggmgxgps
	) where 1=1 
	<if test="nwgxzdj != null and nwgxzdj != ''">${nwgxzdj}</if>
	)
	union all
	(select min(xzqhdm) xzqhdm,to_char(lxbm) v_0,sum(v_1) v_1,sum(v_2) v_2,sum(v_3) v_3,sum(v_4) v_4,sum(v_5) v_5,sum(v_6) v_6,
	to_char(round((sum(v_2)+sum(v_3))/sum(v_1)*100,1))||'%' v_7,
	to_char(round((sum(v_2)+sum(v_3)+sum(v_4))/sum(v_1)*100,1))||'%' v_8,to_char(lxbm) lxbm
	from(
	select to_char(lxbm) lxbm,to_char(xzqhdm) xzqhdm,xzqh,decode(fun_sfylx(to_char(lxbm)||substr(to_char(xzqhdm),0,4)),'是',(nvl(xyi + xer + xsan + xsi + xdw, 0) -nvl(yi + er + san + si + dw, 0)),nvl(xyi + xer + xsan + xsi + xdw, 0)) v_1,bhyi v_2,bher v_3,bhsan v_4,bhsi v_5,bhdw v_6
	from nwggmgxwn where 1=1 and xmid in (${xmbm})
	union all
	select to_char(lxbm) lxbm,to_char(xzqhdm) xzqhdm,xzqh,lc v_1,decode(jsdj,'一级公路',lc,0) v_2,decode(jsdj,'二级公路',lc,0) v_3,decode(jsdj,'三级公路',lc,0) v_4,decode(jsdj,'四级公路',lc,0) v_5,decode(jsdj,'等外公路',lc,0) v_6
	from nwggmgxgps
	) where 1=1 
	<if test="nwgxzdj != null and nwgxzdj != ''">${nwgxzdj}</if>
	group by lxbm
	)
	order by lxbm,xzqhdm
	
	</select>
	
	<select id="xljgbhads" parameterType="lxsh" resultType="elist">
	
	(select to_char('1') xzqhdm,#{bz}||'小计' v_0,sum(v_2)+sum(v_3)+sum(v_4)+sum(v_5)+sum(v_6) v_1,sum(v_2) v_2,sum(v_3) v_3,sum(v_4) v_4,sum(v_5) v_5,sum(v_6) v_6
	from(
	select to_char(lxbm) lxbm,to_char(xzqhdm) xzqhdm,xzqh,decode(fun_sfylx(to_char(lxbm)||substr(to_char(xzqhdm),0,4)),'是',(nvl(xyi + xer + xsan + xsi + xdw, 0) -nvl(yi + er + san + si + dw, 0)),nvl(xyi + xer + xsan + xsi + xdw, 0)) v_1,bhyi v_2,bher v_3,bhsan v_4,bhsi v_5,bhdw v_6
	from nwggmgxwn where 1=1 and xmid in (${xmbm})
	
	) where 1=1 
	<if test="nwgxzdj != null and nwgxzdj != ''">${nwgxzdj}</if>
	)
	union all
	(select min(xzqhdm) xzqhdm,to_char(xzqh) v_0,sum(v_2)+sum(v_3)+sum(v_4)+sum(v_5)+sum(v_6) v_1,sum(v_2) v_2,sum(v_3) v_3,sum(v_4) v_4,sum(v_5) v_5,sum(v_6) v_6
	from(
	select to_char(lxbm) lxbm,to_char(xzqhdm) xzqhdm,xzqh,decode(fun_sfylx(to_char(lxbm)||substr(to_char(xzqhdm),0,4)),'是',(nvl(xyi + xer + xsan + xsi + xdw, 0) -nvl(yi + er + san + si + dw, 0)),nvl(xyi + xer + xsan + xsi + xdw, 0)) v_1,bhyi v_2,bher v_3,bhsan v_4,bhsi v_5,bhdw v_6
	from nwggmgxwn where 1=1 and xmid in (${xmbm})
	) where 1=1 
	<if test="nwgxzdj != null and nwgxzdj != ''">${nwgxzdj}</if>
	group by xzqh
	)
	order by xzqhdm
	</select>
	<select id="xljgbhalx" parameterType="lxsh" resultType="elist">
	(select to_char('1') xzqhdm,#{bz}||'小计' v_0,sum(v_2)+sum(v_3)+sum(v_4)+sum(v_5)+sum(v_6) v_1,sum(v_2) v_2,sum(v_3) v_3,sum(v_4) v_4,sum(v_5) v_5,sum(v_6) v_6,'1' lxbm

	from(
	select to_char(lxbm) lxbm,to_char(xzqhdm) xzqhdm,xzqh,decode(fun_sfylx(to_char(lxbm)||substr(to_char(xzqhdm),0,4)),'是',(nvl(xyi + xer + xsan + xsi + xdw, 0) -nvl(yi + er + san + si + dw, 0)),nvl(xyi + xer + xsan + xsi + xdw, 0)) v_1,bhyi v_2,bher v_3,bhsan v_4,bhsi v_5,bhdw v_6
	from nwggmgxwn where 1=1 and xmid in (${xmbm})
	
	) where 1=1 
	<if test="nwgxzdj != null and nwgxzdj != ''">${nwgxzdj}</if>
	)
	union all
	(select min(xzqhdm) xzqhdm,to_char(lxbm) v_0,sum(v_2)+sum(v_3)+sum(v_4)+sum(v_5)+sum(v_6) v_1,sum(v_2) v_2,sum(v_3) v_3,sum(v_4) v_4,sum(v_5) v_5,sum(v_6) v_6,to_char(lxbm) lxbm

	from(
	select to_char(lxbm) lxbm,to_char(xzqhdm) xzqhdm,xzqh,decode(fun_sfylx(to_char(lxbm)||substr(to_char(xzqhdm),0,4)),'是',(nvl(xyi + xer + xsan + xsi + xdw, 0) -nvl(yi + er + san + si + dw, 0)),nvl(xyi + xer + xsan + xsi + xdw, 0)) v_1,bhyi v_2,bher v_3,bhsan v_4,bhsi v_5,bhdw v_6
	from nwggmgxwn where 1=1 and xmid in (${xmbm})
	
	) where 1=1 
	<if test="nwgxzdj != null and nwgxzdj != ''">${nwgxzdj}</if>
	group by lxbm
	)
	order by lxbm,xzqhdm
	
	</select>
	
	<select id="queryTjbxx" parameterType="lxsh" resultType="lxsh">
     select wq.id,gt.lsxmid,(select name from xtgl_xzqh where id in gt.XZQHDM) xzqhdm,xzqh,ghlxbm,xmmc,tsdq,ghqdzh,ghzdzh,jsxz,
      decode(gt.JSXZ,'改建',lc,'路面改造',lc,'新建',jszlc)lc,
      decode(gt.JSXZ,'改建',yilc,'路面改造',yilc,'新建',jhyilc)yilc,
      decode(gt.JSXZ,'改建',erlc,'路面改造',erlc,'新建',jherlc)erlc,
      decode(gt.JSXZ,'改建',sanlc,'路面改造',sanlc,'新建',jhsanlc)sanlc,
      decode(gt.JSXZ,'改建',silc,'路面改造',silc,'新建',jhsilc) silc,
      decode(gt.JSXZ,'改建',dwlc,'路面改造',dwlc,'新建',jhdwlc) dwlc,
      decode(gt.JSXZ,'改建',jszlc,'路面改造',lc,'新建',lc)jszlc,
      decode(gt.JSXZ,'改建',jhyilc,'路面改造',yilc,'新建',yilc)jhyilc,
      decode(gt.JSXZ,'改建',jherlc,'路面改造',erlc,'新建',erlc)jherlc,
      decode(gt.JSXZ,'改建',jhsanlc,'路面改造',sanlc,'新建',sanlc)jhsanlc, 
      QL_YM,SD_YM,KGSJ,WGSJ,SCXDNF,round(ZTZ,0) ZTZ,GKSB,HYSCSB,HYSCYJ,TGSJ,GKPFWH,PFSJ,sjpfwh,sjpfsj,
      wq.xmbm,ghwh,ghpfsj,ydwh,ydpfsj,gt.xmbm lsxmbm,wq.xmbm,wq.ghwh,wq.ghpfsj,
      wq.ydwh,wq.ydpfsj,nvl(gt.YJGDQL,0) yjgdql,nvl(gt.EJGDQL,0) ejgdql,nvl(gt.YJSDQL,0)yjsdql,nvl(gt.EJSDQL,0) ejsdql,nvl(gt.SJSDQL,0) sjsdql,
      nvl(gt.YJGDSD,0) yjgdsd,nvl(gt.EJGDSD,0) ejgdsd,nvl(gt.YJSDSD,0) yjsdsd,nvl(gt.EJSDSD,0) ejsdsd,nvl(gt.SJSDSD,0) sjsdsd,cgs,wq.sgtpfsj,wq.xmkbm,wq.mbkgn,wq.mbwgn,wq.sfhysc,wq.sfgksc,wq.sgtpf,gt.jaf,gt.sjl,gt.sbzzj,gt.xmklx,
      gt.lxbm,gt.qdzh,gt.zdzh
     from gsdgz_tjb gt
     left join wnjh_qqxmtjb wq on gt.lsxmid = wq.wnjhid
     where 1=1
       <if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="jsxz !='' and jsxz != null ">
			${jsxz}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and gt.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmbm !='' and xmbm != null ">
			and gt.xmbm like '%'||#{xmbm}||'%'
		</if>
		<if test="ghlxbm !='' and ghlxbm != null ">
			and gt.ghlxbm like '%'||#{ghlxbm}||'%'
		</if>
	  order by gt.xzqhdm
	</select>
		
	<update id="insertOrUpdateWnqqtjb" parameterType="lxsh">
	  begin
      UPDATE wnjh_qqxmtjb j set
      j.wnjhid=#{lsxmid,jdbcType=VARCHAR},
      j.xmbm=#{xmbm,jdbcType=VARCHAR},
      j.ghwh=#{ghwh,jdbcType=VARCHAR},
      j.ghpfsj=#{ghpfsj,jdbcType=VARCHAR},
      j.ydwh=#{ydwh,jdbcType=VARCHAR},
      j.ydpfsj=#{ydpfsj,jdbcType=VARCHAR},
      j.xmkbm=#{xmkbm,jdbcType=VARCHAR},
      j.mbkgn=#{mbkgn,jdbcType=VARCHAR},
      j.mbwgn=#{mbwgn,jdbcType=VARCHAR},
      j.sgtpf=#{sgtpf,jdbcType=VARCHAR},
      j.sgtpfsj=#{sgtpfsj,jdbcType=VARCHAR},
      j.sfhysc=#{sfhysc,jdbcType=VARCHAR},
      j.sfgksc=#{sfgksc,jdbcType=VARCHAR}     
      WHERE j.id = #{id};
      if sql%notfound then
      INSERT INTO wnjh_qqxmtjb(id,wnjhid,xmbm,ghwh,ghpfsj,ydwh,ydpfsj,xmkbm,mbkgn,mbwgn,sgtpf,sgtpfsj,sfhysc,sfgksc) 
              VALUES (sys_guid(),#{lsxmid,jdbcType=VARCHAR},#{xmbm,jdbcType=VARCHAR},#{ghwh,jdbcType=VARCHAR},#{ghpfsj,jdbcType=VARCHAR},#{ydwh,jdbcType=VARCHAR},#{ydpfsj,jdbcType=VARCHAR},
                      #{xmkbm,jdbcType=VARCHAR},#{mbkgn,jdbcType=VARCHAR},#{mbwgn,jdbcType=VARCHAR},#{sgtpf,jdbcType=VARCHAR},#{sgtpfsj,jdbcType=VARCHAR},#{sfhysc,jdbcType=VARCHAR},#{sfgksc,jdbcType=VARCHAR}
              );
      end if;
      end;
	</update>
		
	<select id="exportWnqqtjExcel" parameterType="lxsh" resultType="elist">
	  select to_char(rownum) v_0, (select name from xtgl_xzqh where id in gt.XZQHDM) v_1,xzqh v_2,
	  ghlxbm v_3,lxbm v_4,xmmc v_5, wq.xmbm v_6, wq.xmkbm v_7,
	  tsdq v_8, ghqdzh v_9,ghzdzh v_10,qdzh v_11, zdzh v_12,jsxz v_13,
	  decode(gt.JSXZ,'改建',lc,'路面改造',lc,'新建',jszlc)v_14,
      decode(gt.JSXZ,'改建',yilc,'路面改造',yilc,'新建',jhyilc)v_15,
      decode(gt.JSXZ,'改建',erlc,'路面改造',erlc,'新建',jherlc)v_16,
      decode(gt.JSXZ,'改建',sanlc,'路面改造',sanlc,'新建',jhsanlc)v_17,
      decode(gt.JSXZ,'改建',silc,'路面改造',silc,'新建',jhsilc) v_18,
      decode(gt.JSXZ,'改建',dwlc,'路面改造',dwlc,'新建',jhdwlc) v_19,
      decode(gt.JSXZ,'改建',jszlc,'路面改造',lc,'新建',lc)v_20,
      decode(gt.JSXZ,'改建',jhyilc,'路面改造',yilc,'新建',yilc)v_21,
      decode(gt.JSXZ,'改建',jherlc,'路面改造',erlc,'新建',erlc)v_22,
      decode(gt.JSXZ,'改建',jhsanlc,'路面改造',sanlc,'新建',sanlc)v_23,
	  ql_ym v_24, sd_ym v_25,
	  scxdnf v_26,round(ztz,0) v_27,
	  cgs v_28, gt.sbzzj v_29, gt.sjl v_30,
	  wq.mbkgn v_31, wq.mbwgn v_32,
	  case wq.sfhysc when '1' then '是' else '' end v_33,
	  case wq.sfgksc when '1' then '是' else '' end v_34, 
	  hyscyj v_35,tgsj v_36,gkpfwh v_37,pfsj v_38,sjpfwh v_39,sjpfsj v_40, wq.sgtpf v_41, wq.sgtpfsj v_42,
	  ghwh v_43,ghpfsj v_44,
	  ydwh v_45,ydpfsj v_46,gt.xmbm v_47,gt.jaf v_48,gt.xmklx v_49
	  from gsdgz_tjb gt 
      left join wnjh_qqxmtjb wq on gt.lsxmid = wq.wnjhid
 	  where 1=1 
        <if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="jsxz !='' and jsxz != null ">
			${jsxz}
		</if>
		<if test="xmmc !='' and xmmc != null ">
			and gt.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmbm !='' and xmbm != null ">
			and gt.xmbm like '%'||#{xmbm}||'%'
		</if>
		<if test="ghlxbm !='' and ghlxbm != null ">
			and gt.ghlxbm like '%'||#{ghlxbm}||'%'
		</if>
      order by gt.xzqhdm
	</select>
	
    <select id="queryXmQqjdhzb1Total" parameterType="lxsh" resultType="elist">
    select '合计'v_0,nvl(sum(v_1),0)v_1,nvl(sum(v_2),0)v_2 ,nvl(sum(v_3),0)v_3,nvl(round((sum(v_1)-sum(v_3)) *100/sum(v_1)),0)||'%'v_4,nvl(sum(v_5),0)v_5,nvl(round((sum(v_1)-sum(v_5)) *100/sum(v_1)),0)||'%'v_6,nvl(sum(v_7),0)v_7,nvl(round((sum(v_1)-sum(v_7)) *100/sum(v_1)),0)||'%'v_8,nvl(sum(v_9),0)v_9,nvl(sum(v_10),0)v_10,
nvl(sum(v_11),0)v_11,nvl(sum(v_12),0)v_12,nvl(sum(v_13),0)v_13,nvl(sum(v_14),0)v_14,nvl(sum(v_15),0)v_15,nvl(sum(v_16),0)v_16,nvl(sum(v_17),0)v_17,nvl(sum(v_18),0)v_18,nvl(sum(v_19),0)v_19,nvl(sum(v_20),0)v_20,nvl(sum(v_21),0)v_21,nvl(sum(v_22),0)v_22,nvl(sum(v_23),0)v_23,nvl(sum(v_24),0)v_24,
nvl(sum(v_25),0)v_25,nvl(sum(v_26),0)v_26,nvl(sum(v_27),0)v_27,nvl(round((sum(v_24)-sum(v_27)) *100/sum(v_24)),0)||'%'v_28,nvl(sum(v_29),0)v_29,nvl(round((sum(v_24)-sum(v_29)) *100/sum(v_24)),0)||'%'v_30,nvl(sum(v_31),0)v_31,nvl(sum(v_32),0)v_32,nvl(sum(v_33),0)v_33,nvl(sum(v_34),0)v_34,nvl(sum(v_35),0)v_35,nvl(sum(v_36),0)v_36,nvl(sum(v_37),0)v_37,
nvl(sum(v_38),0)v_38,nvl(sum(v_39),0)v_39,nvl(round((sum(v_36)-sum(v_39)) *100/sum(v_36)),0)||'%'v_40,nvl(sum(v_41),0)v_41,nvl(round((sum(v_36)-sum(v_41)) *100/sum(v_36)),0)||'%'v_42,nvl(sum(v_43),0)v_43,nvl(sum(v_44),0)v_44,nvl(sum(v_45),0)v_45,nvl(sum(v_46),0)v_46,nvl(sum(v_47),0)v_47,nvl(sum(v_48),0)v_48,nvl(sum(v_49),0)v_49,nvl(sum(v_50),0)v_50,nvl(sum(v_51),0)v_51,nvl(sum(v_52),0)v_52 from(
select gt.XZQHDM,count(gt.LSXMID) v_1, sum(decode(gt.SCSHZT,'1',0,1)) v_2, sum(decode(gt.GKSHZT,'1',0,1))v_3,round(sum(decode(gt.GKSHZT,'1',1,0)) *100/ count(gt.LSXMID))v_4,
sum(decode(gt.CSSHZT,'1',0,1))v_5,round(sum(decode(gt.CSSHZT,'1',1,0)) *100/ count(gt.LSXMID))v_6,sum(decode(wq.sgtpf,'',1,0))v_7,round(sum(decode(wq.sgtpf,'',0,1)) *100/ count(gt.LSXMID))v_8,
sum(case when wq.xmbm like '%库外%' then 1 else 0 end) v_48, sum(case when wq.xmbm like '%库外%' then decode(gt.SCSHZT,'1',0,1) else 0 end)v_49,sum(case when wq.xmbm like '%库外%' then decode(gt.GKSHZT,'1',0,1) else 0 end)v_50,
sum(case when wq.xmbm like '%库外%' then decode(gt.CSSHZT,'1',0,1) else 0 end)v_51,sum(case when wq.xmbm like '%库外%' then decode(wq.sgtpf,'',1,0) else 0 end)v_52
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid group by xzqhdm)t1,
(select gt.XZQHDM,count(gt.LSXMID) v_9,sum(decode(gt.SCSHZT,'1',0,1))v_10,sum(decode(gt.GKSHZT,'1',0,1))v_11,sum(decode(gt.CSSHZT,'1',0,1))v_12,sum(decode(wq.sgtpf,'',1,0))v_13
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where gt.TSDQ like '%扶贫地区%' group by xzqhdm )t2,
(select gt.XZQHDM,count(gt.LSXMID) v_14,sum(decode(gt.SCSHZT,'1',0,1))v_15,sum(decode(gt.GKSHZT,'1',0,1))v_16,sum(decode(gt.CSSHZT,'1',0,1))v_17,sum(decode(wq.sgtpf,'',1,0))v_18,sum(case when wq.xmbm like '%库外%' then 1 else 0 end)v_19,
sum(case when wq.xmbm like '%库外%' then decode(gt.SCSHZT,'1',0,1)else 0 end) v_20,sum(case when wq.xmbm like '%库外%' then decode(gt.GKSHZT,'1',0,1)else 0 end) v_21,sum(case when wq.xmbm like '%库外%' then decode(gt.CSSHZT,'1',0,1)else 0 end) v_22,
sum(case when wq.xmbm like '%库外%' then decode(wq.sgtpf,'',1,0)else 0 end) v_23
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where to_number(wq.mbkgn) &lt; to_number('2018') group by xzqhdm)t3, 
(select gt.XZQHDM,count(gt.LSXMID) v_24,sum(decode(gt.SCSHZT,'1',0,1))v_25,sum(decode(gt.GKSHZT,'1',0,1))v_26,sum(decode(gt.CSSHZT,'1',0,1))v_27,
round(sum(decode(gt.CSSHZT,'1',1,0)) *100/ count(gt.LSXMID)) v_28,sum(decode(wq.sgtpf,'',1,0))v_29,round(sum(decode(wq.sgtpf,'',0,1)) *100/ count(gt.LSXMID)) v_30,
sum(case when wq.xmbm like '%库外%' then 1 else 0 end)v_31,sum(case when wq.xmbm like '%库外%' then decode(gt.SCSHZT,'1',0,1)else 0 end) v_32,
sum(case when wq.xmbm like '%库外%' then decode(gt.GKSHZT,'1',0,1)else 0 end) v_33,sum(case when wq.xmbm like '%库外%' then decode(gt.CSSHZT,'1',0,1)else 0 end) v_34,
sum(case when wq.xmbm like '%库外%' then decode(wq.sgtpf,'',1,0)else 0 end) v_35
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where to_number(wq.mbkgn) = to_number('2018') group by xzqhdm)t4, 
(select gt.XZQHDM,count(gt.LSXMID) v_36,sum(decode(gt.SCSHZT,'1',0,1))v_37,sum(decode(gt.GKSHZT,'1',0,1))v_38,sum(decode(gt.CSSHZT,'1',0,1))v_39,
round(sum(decode(gt.CSSHZT,'1',1,0)) *100/ count(gt.LSXMID)) v_40,sum(decode(wq.sgtpf,'',1,0))v_41,round(sum(decode(wq.sgtpf,'',0,1)) *100/ count(gt.LSXMID)) v_42
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where to_number(wq.mbkgn) = to_number('2019') group by xzqhdm)t5,
(select gt.XZQHDM,count(gt.LSXMID) v_43,sum(decode(gt.SCSHZT,'1',0,1))v_44,sum(decode(gt.GKSHZT,'1',0,1))v_45,sum(decode(gt.CSSHZT,'1',0,1))v_46,sum(decode(wq.sgtpf,'',1,0))v_47
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where to_number(wq.mbkgn) = to_number('2020') group by xzqhdm)t6 
where t1.xzqhdm = t2.xzqhdm(+) and t1.xzqhdm = t3.xzqhdm(+) and t1.xzqhdm = t4.xzqhdm(+) and t1.xzqhdm = t5.xzqhdm(+)and t1.xzqhdm = t6.xzqhdm(+) 
    <if test="xzqh!='' and xzqh!= null ">
		${xzqh}
	</if>
order by t1.xzqhdm	
</select>

    <select id="queryXmQqjdhzb1" parameterType="lxsh" resultType="elist">
      select (select name from xtgl_xzqh where id in (t1.XZQHDM))v_0,nvl(v_1,0)v_1,nvl(v_2,0)v_2 ,nvl(v_3,0)v_3,nvl(v_4,0)||'%'v_4,nvl(v_5,0)v_5,nvl(v_6,0)||'%'v_6,nvl(v_7,0)v_7,nvl(v_8,0)||'%'v_8,nvl(v_9,0)v_9,nvl(v_10,0)v_10,
nvl(v_11,0)v_11,nvl(v_12,0)v_12,nvl(v_13,0)v_13,nvl(v_14,0)v_14,nvl(v_15,0)v_15,nvl(v_16,0)v_16,nvl(v_17,0)v_17,nvl(v_18,0)v_18,nvl(v_19,0)v_19,nvl(v_20,0)v_20,nvl(v_21,0)v_21,nvl(v_22,0)v_22,nvl(v_23,0)v_23,nvl(v_24,0)v_24,
nvl(v_25,0)v_25,nvl(v_26,0)v_26,nvl(v_27,0)v_27,nvl(v_28,0)||'%'v_28,nvl(v_29,0)v_29,nvl(v_30,0)||'%'v_30,nvl(v_31,0)v_31,nvl(v_32,0)v_32,nvl(v_33,0)v_33,nvl(v_34,0)v_34,nvl(v_35,0)v_35,nvl(v_36,0)v_36,nvl(v_37,0)v_37,
nvl(v_38,0)v_38,nvl(v_39,0)v_39,nvl(v_40,0)||'%'v_40,nvl(v_41,0)v_41,nvl(v_42,0)||'%'v_42,nvl(v_43,0)v_43,nvl(v_44,0)v_44,nvl(v_45,0)v_45,nvl(v_46,0)v_46,nvl(v_47,0)v_47,nvl(v_48,0)v_48,nvl(v_49,0)v_49,nvl(v_50,0)v_50,nvl(v_51,0)v_51,nvl(v_52,0)v_52 from(
select gt.XZQHDM,count(gt.LSXMID) v_1, sum(decode(gt.SCSHZT,'1',0,1)) v_2, sum(decode(gt.GKSHZT,'1',0,1))v_3,round(sum(decode(gt.GKSHZT,'1',1,0)) *100/ count(gt.LSXMID))v_4,
sum(decode(gt.CSSHZT,'1',0,1))v_5,round(sum(decode(gt.CSSHZT,'1',1,0)) *100/ count(gt.LSXMID))v_6,sum(decode(wq.sgtpf,'',1,0))v_7,round(sum(decode(wq.sgtpf,'',0,1)) *100/ count(gt.LSXMID))v_8,
sum(case when wq.xmbm like '%库外%' then 1 else 0 end) v_48, sum(case when wq.xmbm like '%库外%' then decode(gt.SCSHZT,'1',0,1) else 0 end)v_49,sum(case when wq.xmbm like '%库外%' then decode(gt.GKSHZT,'1',0,1) else 0 end)v_50,
sum(case when wq.xmbm like '%库外%' then decode(gt.CSSHZT,'1',0,1) else 0 end)v_51,sum(case when wq.xmbm like '%库外%' then decode(wq.sgtpf,'',1,0) else 0 end)v_52
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid group by xzqhdm)t1,
(select gt.XZQHDM,count(gt.LSXMID) v_9,sum(decode(gt.SCSHZT,'1',0,1))v_10,sum(decode(gt.GKSHZT,'1',0,1))v_11,sum(decode(gt.CSSHZT,'1',0,1))v_12,sum(decode(wq.sgtpf,'',1,0))v_13
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where gt.TSDQ like '%扶贫地区%' group by xzqhdm )t2,
(select gt.XZQHDM,count(gt.LSXMID) v_14,sum(decode(gt.SCSHZT,'1',0,1))v_15,sum(decode(gt.GKSHZT,'1',0,1))v_16,sum(decode(gt.CSSHZT,'1',0,1))v_17,sum(decode(wq.sgtpf,'',1,0))v_18,sum(case when wq.xmbm like '%库外%' then 1 else 0 end)v_19,
sum(case when wq.xmbm like '%库外%' then decode(gt.SCSHZT,'1',0,1)else 0 end) v_20,sum(case when wq.xmbm like '%库外%' then decode(gt.GKSHZT,'1',0,1)else 0 end) v_21,sum(case when wq.xmbm like '%库外%' then decode(gt.CSSHZT,'1',0,1)else 0 end) v_22,
sum(case when wq.xmbm like '%库外%' then decode(wq.sgtpf,'',1,0)else 0 end) v_23
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where to_number(wq.mbkgn) &lt; to_number('2018') group by xzqhdm)t3, 
(select gt.XZQHDM,count(gt.LSXMID) v_24,sum(decode(gt.SCSHZT,'1',0,1))v_25,sum(decode(gt.GKSHZT,'1',0,1))v_26,sum(decode(gt.CSSHZT,'1',0,1))v_27,
round(sum(decode(gt.CSSHZT,'1',1,0)) *100/ count(gt.LSXMID)) v_28,sum(decode(wq.sgtpf,'',1,0))v_29,round(sum(decode(wq.sgtpf,'',0,1)) *100/ count(gt.LSXMID)) v_30,
sum(case when wq.xmbm like '%库外%' then 1 else 0 end)v_31,sum(case when wq.xmbm like '%库外%' then decode(gt.SCSHZT,'1',0,1)else 0 end) v_32,
sum(case when wq.xmbm like '%库外%' then decode(gt.GKSHZT,'1',0,1)else 0 end) v_33,sum(case when wq.xmbm like '%库外%' then decode(gt.CSSHZT,'1',0,1)else 0 end) v_34,
sum(case when wq.xmbm like '%库外%' then decode(wq.sgtpf,'',1,0)else 0 end) v_35
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where to_number(wq.mbkgn) = to_number('2018') group by xzqhdm)t4, 
(select gt.XZQHDM,count(gt.LSXMID) v_36,sum(decode(gt.SCSHZT,'1',0,1))v_37,sum(decode(gt.GKSHZT,'1',0,1))v_38,sum(decode(gt.CSSHZT,'1',0,1))v_39,
round(sum(decode(gt.CSSHZT,'1',1,0)) *100/ count(gt.LSXMID)) v_40,sum(decode(wq.sgtpf,'',1,0))v_41,round(sum(decode(wq.sgtpf,'',0,1)) *100/ count(gt.LSXMID)) v_42
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where to_number(wq.mbkgn) = to_number('2019') group by xzqhdm)t5,
(select gt.XZQHDM,count(gt.LSXMID) v_43,sum(decode(gt.SCSHZT,'1',0,1))v_44,sum(decode(gt.GKSHZT,'1',0,1))v_45,sum(decode(gt.CSSHZT,'1',0,1))v_46,sum(decode(wq.sgtpf,'',1,0))v_47
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where to_number(wq.mbkgn) = to_number('2020') group by xzqhdm)t6 
where t1.xzqhdm = t2.xzqhdm(+) and t1.xzqhdm = t3.xzqhdm(+) and t1.xzqhdm = t4.xzqhdm(+) and t1.xzqhdm = t5.xzqhdm(+)and t1.xzqhdm = t6.xzqhdm(+)
    <if test="xzqh!='' and xzqh!= null ">
		${xzqh}
	</if>
order by t1.xzqhdm	
    
    </select>

    <select id="queryXmQqjdhzb2Total" parameterType="lxsh" resultType="elist">
     select '合计'v_0,sum(v_1)v_1,sum(v_2)v_2,sum(v_3)v_3,sum(v_4)v_4,sum(v_5)v_5,sum(v_6)v_6,round((sum(v_4)-sum(v_6))*100/sum(v_4))||'%' v_7,
sum(v_8)v_8,round((sum(v_4)-sum(v_8))*100/sum(v_4))||'%' v_9,sum(v_10)v_10,round((sum(v_4)-sum(v_10))*100/sum(v_4))||'%'v_11,
sum(v_12)v_12,sum(v_13)v_13,sum(v_14)v_14,round((sum(v_12)-sum(v_14))*100/sum(v_12))||'%' v_15,sum(v_16)v_16,
round((sum(v_12)-sum(v_16))*100/sum(v_12))||'%' v_17,sum(v_18)v_18,round((sum(v_12)-sum(v_18))*100/sum(v_12))||'%' v_19,
sum(v_20)v_20,sum(v_21)v_21,sum(v_22)v_22,round((sum(v_20)-sum(v_22))*100/sum(v_20))||'%' v_23,
sum(v_24)v_24,round((sum(v_20)-sum(v_24))*100/sum(v_20))||'%' v_25,sum(v_26)v_26,round((sum(v_20)-sum(v_26))*100/sum(v_20))||'%' v_27,
sum(v_28)v_28,sum(v_29)v_29,sum(v_30)v_30,round((sum(v_28)-sum(v_30))*100/sum(v_28))||'%' v_31,sum(v_32)v_32,round((sum(v_28)-sum(v_32))*100/sum(v_28))||'%' v_33,
sum(v_34)v_34,round((sum(v_28)-sum(v_34))*100/sum(v_28))||'%' v_35 from 
(select xzqhdm,count(gt.LSXMID) v_1,sum(decode(wq.sfgksc,'1',0,1)) v_2,sum(decode(wq.sfhysc,'1',0,1)) v_3 from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where nvl(wq.xmbm,'0') not like '%库外%' group by xzqhdm)t1,
(select xzqhdm, count(gt.LSXMID) v_4,sum(decode(gt.SCSHZT,'1',0,1)) v_5, sum(decode(gt.GKSHZT,'1',0,1)) v_6, round(sum(decode(gt.GKSHZT,'1',1,0)) *100/ count(gt.LSXMID)) ||'%' v_7,sum(decode(gt.CSSHZT,'1',0,1)) v_8,
round(sum(decode(gt.CSSHZT,'1',1,0)) *100/ count(gt.LSXMID)) ||'%' v_9,sum(decode(wq.sgtpf,'',1,0)) v_10,round(sum(decode(wq.sgtpf,'',0,1)) *100/ count(gt.LSXMID)) ||'%' v_11
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where wq.xmbm like '%部%' group by xzqhdm)t2,
(select xzqhdm,count(gt.LSXMID) v_12,sum(decode(gt.SCSHZT,'1',0,1)) v_13, sum(decode(gt.GKSHZT,'1',0,1)) v_14, round(sum(decode(gt.GKSHZT,'1',1,0)) *100/ count(gt.LSXMID)) ||'%' v_15,
sum(decode(gt.CSSHZT,'1',0,1)) v_16,round(sum(decode(gt.CSSHZT,'1',1,0)) *100/ count(gt.LSXMID)) ||'%' v_17,sum(decode(wq.sgtpf,'',1,0)) v_18,round(sum(decode(wq.sgtpf,'',0,1)) *100/ count(gt.LSXMID)) ||'%' v_19
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where wq.xmbm like '%省%' group by xzqhdm)t3,
(select xzqhdm,count(gt.LSXMID) v_20,sum(decode(gt.SCSHZT,'1',0,1)) v_21, sum(decode(gt.GKSHZT,'1',0,1)) v_22, round(sum(decode(gt.GKSHZT,'1',1,0)) *100/ count(gt.LSXMID)) ||'%' v_23,sum(decode(gt.CSSHZT,'1',0,1)) v_24,
round(sum(decode(gt.CSSHZT,'1',1,0)) *100/ count(gt.LSXMID)) ||'%' v_25,sum(decode(wq.sgtpf,'',1,0)) v_26,round(sum(decode(wq.sgtpf,'',0,1)) *100/ count(gt.LSXMID)) ||'%' v_27
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where (wq.xmbm like '%部%' or wq.xmbm like '%省%') and gt.tsdq like '%扶贫地区%' group by xzqhdm)t4,
(select xzqhdm,count(gt.LSXMID) v_28,sum(decode(gt.SCSHZT,'1',0,1)) v_29, sum(decode(gt.GKSHZT,'1',0,1)) v_30, round(sum(decode(gt.GKSHZT,'1',1,0)) *100/ count(gt.LSXMID)) ||'%' v_31,sum(decode(gt.CSSHZT,'1',0,1)) v_32,
round(sum(decode(gt.CSSHZT,'1',1,0)) *100/ count(gt.LSXMID)) ||'%' v_33,sum(decode(wq.sgtpf,'',1,0)) v_34,round(sum(decode(wq.sgtpf,'',0,1)) *100/ count(gt.LSXMID)) ||'%' v_35
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where wq.xmbm like '%库外%' group by xzqhdm
)t5 where t1.xzqhdm = t2.xzqhdm(+) and t1.xzqhdm=t3.xzqhdm(+) and t1.xzqhdm=t4.xzqhdm(+) and t1.xzqhdm=t5.xzqhdm(+) 
    <if test="xzqh!='' and xzqh!= null ">
		${xzqh}
	</if>
order by t1.xzqhdm
    </select>
    
    <select id="queryXmQqjdhzb2" parameterType="lxsh" resultType="elist">
    select (select name from xtgl_xzqh where id in (t1.xzqhdm)) v_0,nvl(v_1,0) v_1,nvl(v_2,0) v_2,nvl(v_3,0)v_3,nvl(v_4,0)v_4,nvl(v_5,0)v_5,nvl(v_6,0)v_6,nvl(v_7,0)||'%' v_7,nvl(v_8,0)v_8,nvl(v_9,0)||'%'v_9,nvl(v_10,0)v_10,nvl(v_11,0)||'%'v_11,
       nvl(v_12,0)v_12,nvl(v_13,0)v_13,nvl(v_14,0)v_14,nvl(v_15,0)||'%' v_15,nvl(v_16,0)v_16,nvl(v_17,0)||'%'v_17,nvl(v_18,0)v_18,nvl(v_19,0)||'%'v_19,
       nvl(v_20,0)v_20,nvl(v_21,0)v_21,nvl(v_22,0)v_22,nvl(v_23,0)||'%' v_23,nvl(v_24,0)v_24,nvl(v_25,0)||'%'v_25,nvl(v_26,0)v_26,nvl(v_27,0)||'%'v_27,
       nvl(v_28,0)v_28,nvl(v_29,0)v_29,nvl(v_30,0)v_30,nvl(v_31,0)||'%' v_31,nvl(v_32,0)v_32,nvl(v_33,0)||'%'v_33,nvl(v_34,0)v_34,nvl(v_35,0)||'%'v_35 
    from 
(select xzqhdm,count(gt.LSXMID) v_1,sum(decode(wq.sfgksc,'1',0,1)) v_2,sum(decode(wq.sfhysc,'1',0,1)) v_3 from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where nvl(wq.xmbm,'0') not like '%库外%' group by xzqhdm)t1,
(select xzqhdm, count(gt.LSXMID) v_4,sum(decode(gt.SCSHZT,'1',0,1)) v_5, sum(decode(gt.GKSHZT,'1',0,1)) v_6, round(sum(decode(gt.GKSHZT,'1',1,0)) *100/ count(gt.LSXMID)) v_7,sum(decode(gt.CSSHZT,'1',0,1)) v_8,
round(sum(decode(gt.CSSHZT,'1',1,0)) *100/ count(gt.LSXMID)) v_9,sum(decode(wq.sgtpf,'',1,0)) v_10,round(sum(decode(wq.sgtpf,'',0,1)) *100/ count(gt.LSXMID)) v_11
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where wq.xmbm like '%部%' group by xzqhdm)t2,
(select xzqhdm,count(gt.LSXMID) v_12,sum(decode(gt.SCSHZT,'1',0,1)) v_13, sum(decode(gt.GKSHZT,'1',0,1)) v_14, round(sum(decode(gt.GKSHZT,'1',1,0)) *100/ count(gt.LSXMID))v_15,
sum(decode(gt.CSSHZT,'1',0,1)) v_16,round(sum(decode(gt.CSSHZT,'1',1,0)) *100/ count(gt.LSXMID)) v_17,sum(decode(wq.sgtpf,'',1,0)) v_18,round(sum(decode(wq.sgtpf,'',0,1)) *100/ count(gt.LSXMID)) v_19
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where wq.xmbm like '%省%' group by xzqhdm)t3,
(select xzqhdm,count(gt.LSXMID) v_20,sum(decode(gt.SCSHZT,'1',0,1)) v_21, sum(decode(gt.GKSHZT,'1',0,1)) v_22, round(sum(decode(gt.GKSHZT,'1',1,0)) *100/ count(gt.LSXMID))v_23,sum(decode(gt.CSSHZT,'1',0,1)) v_24,
round(sum(decode(gt.CSSHZT,'1',1,0)) *100/ count(gt.LSXMID)) v_25,sum(decode(wq.sgtpf,'',1,0)) v_26,round(sum(decode(wq.sgtpf,'',0,1)) *100/ count(gt.LSXMID))v_27
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where (wq.xmbm like '%部%' or wq.xmbm like '%省%') and gt.tsdq like '%扶贫地区%' group by xzqhdm)t4,
(select xzqhdm,count(gt.LSXMID) v_28,sum(decode(gt.SCSHZT,'1',0,1)) v_29, sum(decode(gt.GKSHZT,'1',0,1)) v_30, round(sum(decode(gt.GKSHZT,'1',1,0)) *100/ count(gt.LSXMID)) v_31,sum(decode(gt.CSSHZT,'1',0,1)) v_32,
round(sum(decode(gt.CSSHZT,'1',1,0)) *100/ count(gt.LSXMID)) v_33,sum(decode(wq.sgtpf,'',1,0)) v_34,round(sum(decode(wq.sgtpf,'',0,1)) *100/ count(gt.LSXMID)) v_35
from gsdgz_tjhzb gt left join wnjh_qqxmtjb wq on gt.LSXMID = wq.wnjhid where wq.xmbm like '%库外%' group by xzqhdm
)t5 where t1.xzqhdm = t2.xzqhdm(+) and t1.xzqhdm=t3.xzqhdm(+) and t1.xzqhdm=t4.xzqhdm(+) and t1.xzqhdm=t5.xzqhdm(+)
    <if test="xzqh!='' and xzqh!= null ">
		${xzqh}
	</if>
order by t1.xzqhdm	  
  </select>

</mapper>

