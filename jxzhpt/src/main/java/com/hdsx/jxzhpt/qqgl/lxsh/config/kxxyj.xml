<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.kxxyj">
	<select id="selectSjgzList" parameterType="lxsh" resultType="kxxyj">
		select * from (
		select rownum num ,t.*,t1.xmklx,t1.lsjl,t1.ghlxbh lxbh,gydwdm1 gydwdm,gydw1 gydw,t1.tsdq,t1.tz, t.shzt sbzt1,t.sbzt sbzts,lx.*,sl.xmsl,sl.zlc jszlc1 from KXXYJ_SJGZ t Left join 
		lxsh_sjgz t1 on t.xmbm=t1.xmbm left join (select qdzh minqdzh,zdzh maxzdzh,xmid,lc,yilc,erlc,sanlc,silc,qdmc,zdmc,
		dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0)) jhlc,ghlxbm,ghlxmc,ghqdzh,ghzdzh from lxsh_lx where jdbs='1' and sffirst='1'
		) lx on t.xmbm=lx.xmid 
		left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='1' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1 
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and t.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmbm!='' and xmbm!= null ">and t.xmbm like '%'||#{xmbm}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(t.sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			and to_char(t.shzt) like '%'||#{shzt}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx t where jdbs='1'and ${jsdj})</if>
		<if test="jsjsdj!='' and jsjsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx  where jdbs='1' and ${jsjsdj})</if>
		<if test="gldj!='' and gldj!= null ">and t.xmbm in (select xmid from lxsh_lx where jdbs='1' and xmid like '%1___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and t1.lsjl like '%'||#{lsjl}||'%'</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
	</select>
	<select id="selectSjgzListCount" parameterType="lxsh" resultType="int">
		select count(*) from KXXYJ_SJGZ t Left join lxsh_sjgz t1 on t.xmbm=t1.xmbm where 1=1
		
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and t.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmbm!='' and xmbm!= null ">and t.xmbm like '%'||#{xmbm}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null "> 
 			and to_char(t.sbzt) like '%'||#{sbzt1}||'%' 
		</if>
		<if test="shzt!='' and shzt!= null ">
			and to_char(t.shzt) like '%'||#{shzt}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx t where jdbs='1'and ${jsdj})</if>
		<if test="jsjsdj!='' and jsjsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx  where jdbs='1' and ${jsjsdj})</if>
		<if test="gldj!='' and gldj!= null ">and t.xmbm in (select xmid from lxsh_lx where jdbs='1' and xmid like '%1___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and t1.lsjl like '%'||#{lsjl}||'%'</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
	</select>
	<select id="selectSjgzkxbgList" parameterType="lxsh" resultType="kxxyj">
		select * from (
		select rownum num ,t.*,t1.lsjl,t1.ghlxbh lxbh,t1.gydwdm, t.shzt sbzt1,lx.*,sl.xmsl from KXXYJ_SJGZ_tz t Left join 
		lxsh_sjgz t1 on t.xmbm=t1.xmbm left join (select qdzh minqdzh,zdzh maxzdzh,xmid,lc,yilc,erlc,sanlc,silc,qdmc,zdmc,
		dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc from lxsh_lx_tz where jdbs='1' and sffirst='1') lx on t.xmbm=lx.xmid 
		left join (select xmid,count(xmid) xmsl from lxsh_lx_tz where jdbs='1' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1 
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and t.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
<!-- 		<if test="sbzt1!='' and sbzt1!= null "> -->
<!-- 			and to_char(t.sbzt) like '%'||#{sbzt1}||'%' -->
<!-- 		</if> -->
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and t.xmbm in (select xmid from lxsh_lx_tz where jdbs='1' and xmid like '%1___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and t1.lsjl like '%'||#{lsjl}||'%'</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="tzxz !='' and tzxz != null ">
			and tzxz like '%'||#{tzxz}||'%'
		</if>
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
	</select>
	<select id="selectSjgzkxbgListCount" parameterType="lxsh" resultType="int">
		select count(*) from KXXYJ_SJGZ_tz t Left join lxsh_sjgz t1 on t.xmbm=t1.xmbm where 1=1
		
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and t.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		
<!-- 		<if test="sbzt1!='' and sbzt1!= null "> -->
<!-- 			and to_char(t.sbzt) like '%'||#{sbzt1}||'%' -->
<!-- 		</if> -->
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and t.xmbm in (select xmid from lxsh_lx_tz where jdbs='1' and xmid like '%1___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and t1.lsjl like '%'||#{lsjl}||'%'</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="tzxz !='' and tzxz != null ">
			and tzxz like '%'||#{tzxz}||'%'
		</if>
	</select>
	
	<select id="selectLmgzkxList" parameterType="lxsh" resultType="kxxyj">
		select * from (
		select rownum num ,t.*,t1.xmklx,t1.lsjl,t1.ghlxbh lxbh,gydwdm1 gydwdm,gydw1 gydw,t1.tsdq,t1.tz, t.shzt sbzt1,t.sbzt sbzts,lx.*,sl.xmsl,sl.zlc jszlc1 from KXXYJ_LMGZ t Left join lxsh_lmgz t1 
		on t.xmbm=t1.xmbm left join (select qdzh minqdzh,zdzh maxzdzh,xmid,lc,yilc,erlc,sanlc,silc,dwlc,wllc,qdmc,zdmc,ghlxbm,ghlxmc,ghqdzh,ghzdzh from lxsh_lx 
		where jdbs='1' and jdbs='1' and sffirst='1'
		
		) lx on t.xmbm=lx.xmid 
		left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='1' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1 
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and t.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmbm!='' and xmbm!= null ">and t.xmbm like '%'||#{xmbm}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(t.sbzt) like '%'||#{sbzt1}||'%' 
		</if>
		<if test="shzt!='' and shzt!= null ">
			and to_char(t.shzt) like '%'||#{shzt}||'%'
		</if> 
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx t where jdbs='1'and ${jsdj})</if>
		<if test="jsjsdj!='' and jsjsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx  where jdbs='1' and ${jsjsdj})</if>
		<if test="gldj!='' and gldj!= null ">and t.xmbm in (select xmid from lxsh_lx where jdbs='1' and xmid like '%2___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and t1.lsjl like '%'||#{lsjl}||'%'</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
	</select>
	<select id="selectLmgzkxListCount" parameterType="lxsh" resultType="int">
		select count(*) from KXXYJ_LMGZ t Left join lxsh_lmgz t1 on t.xmbm=t1.xmbm where 1=1
		
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and t.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmbm!='' and xmbm!= null ">and t.xmbm like '%'||#{xmbm}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null "> -->
			and to_char(t.sbzt) like '%'||#{sbzt1}||'%' 
		</if> 
		<if test="shzt!='' and shzt!= null ">
			and to_char(t.shzt) like '%'||#{shzt}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx t where jdbs='1'and ${jsdj})</if>
		<if test="jsjsdj!='' and jsjsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx  where jdbs='1' and ${jsjsdj})</if>
		<if test="gldj!='' and gldj!= null ">and t.xmbm in (select xmid from lxsh_lx where jdbs='1' and xmid like '%2___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and t1.lsjl like '%'||#{lsjl}||'%'</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
	</select>
	
	<select id="selectLmgzkxbgList" parameterType="lxsh" resultType="kxxyj">
		select * from (
		select rownum num ,t.*,t1.lsjl,t1.ghlxbh lxbh,t1.gydwdm,t.shzt sbzt1,lx.*,sl.xmsl from KXXYJ_LMGZ_tz t Left join lxsh_lmgz t1 
		on t.xmbm=t1.xmbm left join (select qdzh minqdzh,zdzh maxzdzh,xmid,lc,yilc,erlc,sanlc,silc,dwlc,wllc,qdmc,zdmc from lxsh_lx_tz 
		where jdbs='1' and jdbs='1' and sffirst='1') lx on t.xmbm=lx.xmid 
		left join (select xmid,count(xmid) xmsl from lxsh_lx_tz where jdbs='1' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1 
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and t.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
<!-- 		<if test="sbzt1!='' and sbzt1!= null "> -->
<!-- 			and to_char(t.sbzt) like '%'||#{sbzt1}||'%' -->
<!-- 		</if> -->
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and t.xmbm in (select xmid from lxsh_lx_tz where jdbs='1' and xmid like '%2___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and t1.lsjl like '%'||#{lsjl}||'%'</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="tzxz !='' and tzxz != null ">
			and tzxz like '%'||#{tzxz}||'%'
		</if>
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
	</select>
	<select id="selectLmgzkxbgListCount" parameterType="lxsh" resultType="int">
		select count(*) from KXXYJ_LMGZ_tz t Left join lxsh_lmgz t1 on t.xmbm=t1.xmbm where 1=1
		
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and t.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
<!-- 		<if test="sbzt1!='' and sbzt1!= null "> -->
<!-- 			and to_char(t.sbzt) like '%'||#{sbzt1}||'%' -->
<!-- 		</if> -->
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and t.xmbm in (select xmid from lxsh_lx_tz where jdbs='1' and xmid like '%2___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and t1.lsjl like '%'||#{lsjl}||'%'</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="tzxz !='' and tzxz != null ">
			and tzxz like '%'||#{tzxz}||'%'
		</if>
	</select>
	
	<select id="selectXjkxList" parameterType="lxsh" resultType="kxxyj">
		select * from (
		select rownum num ,t.*,t1.lsjl,t1.xmklx,t1.ghlxbh lxbh,gydwdm1 gydwdm,gydw1 gydw,t1.tsdq,t1.tz,t.shzt sbzt1,t.sbzt sbzts,lx.*,sl.xmsl,sl.zlc jszlc1 from KXXYJ_XJ t left join lxsh_xj t1 on t.xmbm=t1.xmbm left join 
		(select qdmc,zdmc,lxmc,qdzh minqdzh,zdzh maxzdzh,xmid, lc,xjlc,yilc,erlc,sanlc,silc,dwlc,wllc,xjlxbm,xjqdzh,xjzdzh
		from lxsh_lx where jdbs='1' and sffirst='1'
		) lx on t.xmbm=lx.xmid 
		left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='1' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1 
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and t.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmbm!='' and xmbm!= null ">and t.xmbm like '%'||#{xmbm}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
 		<if test="sbzt1!='' and sbzt1!= null "> 
 			and to_char(t.sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			and to_char(t.shzt) like '%'||#{shzt}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx t where jdbs='1'and ${jsdj})</if>
		<if test="jsjsdj!='' and jsjsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx  where jdbs='1' and ${jsjsdj})</if>
		<if test="gldj!='' and gldj!= null ">and t.xmbm in (select xmid from lxsh_lx where jdbs='1' and xmid like '%3___' and ${gldj})</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
	</select>
	<select id="selectXjkxListCount" parameterType="lxsh" resultType="int">
		select count(*) from KXXYJ_XJ t Left join lxsh_xj t1 on t.xmbm=t1.xmbm where 1=1
		
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and t.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmbm!='' and xmbm!= null ">and t.xmbm like '%'||#{xmbm}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(t.sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			and to_char(t.shzt) like '%'||#{shzt}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx t where jdbs='1'and ${jsdj})</if>
		<if test="jsjsdj!='' and jsjsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx  where jdbs='1' and ${jsjsdj})</if>
		<if test="gldj!='' and gldj!= null ">and t.xmbm in (select xmid from lxsh_lx where jdbs='1' and xmid like '%3___' and ${gldj})</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
	</select>
	
	<select id="selectXjkxbgList" parameterType="lxsh" resultType="kxxyj">
		select * from (
		select rownum num ,t.*,t1.ghlxbh lxbh,t1.gydwdm,t.shzt sbzt1,lx.*,sl.xmsl from KXXYJ_XJ_tz t left join lxsh_xj t1 on t.xmbm=t1.xmbm left join 
		(select qdmc,zdmc,lxmc,qdzh minqdzh,zdzh maxzdzh,xmid, lc,xjlc,yilc,erlc,sanlc,silc,dwlc,wllc,xjlxbm,xjqdzh,xjzdzh
		from lxsh_lx_tz where jdbs='1' and sffirst='1') lx on t.xmbm=lx.xmid 
		left join (select xmid,count(xmid) xmsl from lxsh_lx_tz where jdbs='1' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1 
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and t.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
<!-- 		<if test="sbzt1!='' and sbzt1!= null "> -->
<!-- 			and to_char(t.sbzt) like '%'||#{sbzt1}||'%' -->
<!-- 		</if> -->
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and t.xmbm in (select xmid from lxsh_lx_tz where jdbs='1' and xmid like '%3___' and ${gldj})</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="tzxz !='' and tzxz != null ">
			and tzxz like '%'||#{tzxz}||'%'
		</if>
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
	</select>
	<select id="selectXjkxbgListCount" parameterType="lxsh" resultType="int">
		select count(*) from KXXYJ_XJ_tz t Left join lxsh_xj t1 on t.xmbm=t1.xmbm where 1=1
		
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and t.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
<!-- 		<if test="sbzt1!='' and sbzt1!= null "> -->
<!-- 			and to_char(t.sbzt) like '%'||#{sbzt1}||'%' -->
<!-- 		</if> -->
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and t.xmbm in (select xmid from lxsh_lx_tz where jdbs='1' and xmid like '%3___' and ${gldj})</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="tzxz !='' and tzxz != null ">
			and tzxz like '%'||#{tzxz}||'%'
		</if>
	</select>
	
	<insert id="insertFile" parameterType="plan_upload">
		insert into plan_upload(filename,filedata,parentid,filetype) values(#{filename},#{filedata},#{parentid},#{filetype})
	</insert>
	<update id="updateSjgzkxx" parameterType="kxxyj">
		update kxxyj_sjgz set xmmc=#{xmmc},qdzh=#{qdzh},zdzh=#{zdzh},jsxz=#{jsxz},dq=#{dq},
		dq_m=#{dq_m},jsjsdj=#{jsjsdj},sd=#{sd},sd_m=#{sd_m},jsdw=#{jsdw},sbthcd=#{sbthcd},tbbmbm=#{tbbmbm},
		kgny=#{kgny},wgny=#{wgny},bzdw=#{bzdw},tzgs=#{tzgs},gkpfwh=#{gkpfwh},pfsj=#{pfsj},xzqh=#{xzqh},xzqhdm=#{xzqhdm},
		dfzc=#{dfzc},yhdk=#{yhdk},jszlc=#{jszlc}<if test="gydw != null">,gydw1=#{gydw}</if>
		<if test="gydwdm != null">,gydwdm1=#{gydwdm}</if>
		where xmbm=#{xmbm}
	</update>
	<update id="updateLmgzkxx" parameterType="kxxyj">
		update kxxyj_lmgz set xmmc=#{xmmc},qdzh=#{qdzh},zdzh=#{zdzh},jsxz=#{jsxz},dq=#{dq},
		dq_m=#{dq_m},jsjsdj=#{jsjsdj},sd=#{sd},sd_m=#{sd_m},jsdw=#{jsdw},sbthcd=#{sbthcd},tbbmbm=#{tbbmbm},
		kgny=#{kgny},wgny=#{wgny},bzdw=#{bzdw},tzgs=#{tzgs},gkpfwh=#{gkpfwh},pfsj=#{pfsj},xzqh=#{xzqh},xzqhdm=#{xzqhdm},
		dfzc=#{dfzc},yhdk=#{yhdk}<if test="gydw != null">,gydw1=#{gydw}</if>
		<if test="gydwdm != null">,gydwdm1=#{gydwdm}</if>
		where xmbm=#{xmbm}
	</update>
	<update id="updateShkxx" parameterType="kxxyj">
		update kxxyj_sh set xmmc=#{xmmc},qdzh=#{qdzh},zdzh=#{zdzh},jsxz=#{jsxz},dq=#{dq},
		dq_m=#{dq_m},jsdj=#{jsjsdj},sd=#{sd},sd_m=#{sd_m},jsdw=#{jsdw},tbbmbm=#{tbbmbm},
		kgny=#{kgny},wgny=#{wgny},bzdw=#{bzdw},tzgs=#{tzgs},gkpfwh=#{gkpfwh},pfsj=#{pfsj},xzqh=#{xzqh},xzqhdm=#{xzqhdm},
		dfzc=#{dfzc},yhdk=#{yhdk}<if test="gydw != null">,gydw1=#{gydw}</if>
		<if test="gydwdm != null">,gydwdm1=#{gydwdm}</if>
		where xmbm=#{xmbm}
	</update>
	<update id="updateXjkxx" parameterType="kxxyj">
		update kxxyj_xj set xmmc=#{xmmc},qdzh=#{qdzh},zdzh=#{zdzh},jsxz=#{jsxz},dq=#{dq},
		dq_m=#{dq_m},jsjsdj=#{jsjsdj},sd=#{sd},sd_m=#{sd_m},jsdw=#{jsdw},sbthcd=#{sbthcd},tbbmbm=#{tbbmbm},
		kgny=#{kgny},wgny=#{wgny},bzdw=#{bzdw},tzgs=#{tzgs},gkpfwh=#{gkpfwh},pfsj=#{pfsj},xzqh=#{xzqh},xzqhdm=#{xzqhdm},
		dfzc=#{dfzc},yhdk=#{yhdk}<if test="gydw != null">,gydw1=#{gydw}</if>
		<if test="gydwdm != null">,gydwdm1=#{gydwdm}</if>
		where xmbm=#{xmbm}
	</update>
	
	<update id="sbsjgzkxx" parameterType="hashmap">
		update KXXYJ_SJGZ set sbzt=1,sbthcd=#{sbthcd} where id=#{id}
	</update>
	<update id="sblmgzkxx" parameterType="hashmap">
		update KXXYJ_LMGZ set sbzt=1,sbthcd=#{sbthcd} where id=#{id}
	</update>
	<update id="sbxjkxx" parameterType="hashmap">
		update KXXYJ_XJ set sbzt=1,sbthcd=#{sbthcd} where id=#{id}
	</update>
	
	<update id="thSjgzkxx" parameterType="hashmap">
		update KXXYJ_SJGZ set sbthcd=#{sbthcd} where id=#{id}
	</update>
	<update id="thLmgzkxx" parameterType="hashmap">
		update KXXYJ_LMGZ set sbthcd=#{sbthcd} where id=#{id}
	</update>
	<update id="thXjkxx" parameterType="hashmap">
		update KXXYJ_XJ set sbthcd=#{sbthcd} where id=#{id}
	</update>
	
	<select id="selectSjgzkxshList" parameterType="lxsh" resultType="kxxyj">
		select * from (
		select rownum num ,t.*,xmklx,t1.ghlxbh lxbh,t1.gydwdm,l.yilc,l.erlc,l.sanlc,l.silc,l.dwlc,l.wllc
		from KXXYJ_SJGZ t Left join lxsh_sjgz t1 on t.xmbm=t1.xmbm left join lxsh_lx l on t1.xmbm=l.xmid where 1=1  and l.sffirst='1' and l.jdbs='1'
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and t.shzt like '%'||#{sbzt1}||'%'
		</if>
	
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by xmbm
	</select>
	<select id="selectSjgzkxshListCount" parameterType="lxsh" resultType="int">
		select count(*) from KXXYJ_SJGZ t Left join lxsh_sjgz t1 on t.xmbm=t1.xmbm where 1=1
		
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and t.shzt like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
	</select>
	
	
	
	<select id="selectLmgzkxshList" parameterType="lxsh" resultType="kxxyj">
		select * from (
		select rownum num ,t.*,xmklx,t1.ghlxbh lxbh,t1.gydwdm,l.qdmc,l.zdmc  from KXXYJ_LMGZ t Left join lxsh_lmgz t1 on t.xmbm=t1.xmbm left join lxsh_lx l on t.xmbm=l.xmid 
		where l.jdbs='1' and l.sffirst='1' 
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and t.shzt like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by xmbm
	</select>
	<select id="selectLmgzkxshListCount" parameterType="lxsh" resultType="int">
		select count(*) from KXXYJ_LMGZ t Left join lxsh_lmgz t1 on t.xmbm=t1.xmbm where 1=1
		
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and t.shzt like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
	</select>
	<select id="selectXjkxshList" parameterType="lxsh" resultType="kxxyj">
		select * from (
		select rownum num ,t.*,xmklx,t1.ghlxbh lxbh,t1.gydwdm  from KXXYJ_XJ t Left join lxsh_xj t1 on t.xmbm=t1.xmbm where 1=1
			
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and t.shzt like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by xmbm
	</select>
	<select id="selectXjkxshListCount" parameterType="lxsh" resultType="int">
		select count(*) from KXXYJ_XJ t Left join lxsh_xj t1 on t.xmbm=t1.xmbm where 1=1
		
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and t.shzt like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
	</select>
	
	<update id="shsjgzkxx" parameterType="hashmap">
		update KXXYJ_SJGZ set shzt=1 where id=#{id}
	</update>
	<select id="queryshsjgz" parameterType="string" resultType="kxxyj">
		select * from KXXYJ_SJGZ where ${value}
	</select>
	
	<update id="shlmgzkxx" parameterType="hashmap">
		update KXXYJ_LMGZ set shzt=1 where id=#{id}
	</update>
	<select id="queryshlmgz" parameterType="string" resultType="kxxyj">
		select * from KXXYJ_LMGZ where ${value}
	</select>
	
	<update id="shxjkxx" parameterType="hashmap">
		update KXXYJ_XJ set shzt=1 where id=#{id}
	</update>
	<select id="queryshxj" parameterType="string" resultType="kxxyj">
		select * from KXXYJ_XJ where ${value}
	</select>
	<insert id="insertsjgzcb" parameterType="kxxyj">
		insert into cbsj_sjgz(id,xmmc,xmbm,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,jsxz,jsdw,dfzc,yhdk,jszlc,kgsj,wgsj,tz)
		select sys_guid(),xmmc,xmbm,xzqh,xzqhdm,gydw1,gydwdm1,qdzh,zdzh,jsjsdj,jsxz,jsdw,dfzc,yhdk,jszlc,kgny,wgny,tzgs from kxxyj_sjgz where xmbm=#{xmbm}
		<!-- insert into cbsj_sjgz(id<if test="xmmc != null ">,xmmc</if><if test="xmbm != null ">,xmbm</if><if test="xzqh != null ">,xzqh</if><if test="qdzh != null ">,qdzh</if><if test="zdzh != null ">,zdzh</if><if test="jsjsdj != null ">,jsjsdj</if><if test="jsxz != null ">,jsxz</if><if test="jsdw != null ">,jsdw</if><if test="dfzc != null ">,dfzc</if><if test="yhdk != null ">,yhdk</if><if test="jszlc != null ">,jszlc</if><if test="kgny != null ">,kgsj</if><if test="wgny != null ">,wgsj</if>)
		values(sys_guid()<if test="xmmc != null ">,#{xmmc}</if><if test="xmbm != null ">,#{xmbm}</if><if test="xzqh != null ">,#{xzqh}</if><if test="qdzh != null ">,#{qdzh}</if><if test="zdzh != null ">,#{zdzh}</if><if test="jsjsdj != null ">,#{jsjsdj}</if><if test="jsxz != null ">,#{jsxz}</if><if test="jsdw != null ">,#{jsdw}</if><if test="dfzc != null ">,#{dfzc}</if><if test="yhdk != null ">,#{yhdk}</if><if test="jszlc != null ">,#{jszlc}</if><if test="kgny != null ">,#{kgny}</if><if test="wgny != null ">,#{wgny}</if>) -->
	</insert>
	<insert id="insertlmgzcb" parameterType="kxxyj">
		 insert into cbsj_lmgz(id,xmmc,xmbm,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,jsxz,jsdw,dfzc,yhdk,kgsj,wgsj,tz)
    	select sys_guid(),xmmc,xmbm,xzqh,xzqhdm,gydw1,gydwdm1,qdzh,zdzh,jsjsdj,jsxz,jsdw,dfzc,yhdk,kgny,wgny,tzgs from kxxyj_lmgz where xmbm=#{xmbm}
		<!-- insert into cbsj_lmgz(id<if test="xmmc != null ">,xmmc</if><if test="xmbm != null ">,xmbm</if><if test="xzqh != null ">,xzqh</if><if test="qdzh != null ">,qdzh</if><if test="zdzh != null ">,zdzh</if><if test="jsjsdj != null ">,jsjsdj</if><if test="jsxz != null ">,jsxz</if><if test="jsdw != null ">,jsdw</if><if test="dfzc != null ">,dfzc</if><if test="yhdk != null ">,yhdk</if><if test="kgny != null ">,kgsj</if><if test="wgny != null ">,wgsj</if>)
		values(sys_guid()<if test="xmmc != null ">,#{xmmc}</if><if test="xmbm != null ">,#{xmbm}</if><if test="xzqh != null ">,#{xzqh}</if><if test="qdzh != null ">,#{qdzh}</if><if test="zdzh != null ">,#{zdzh}</if><if test="jsjsdj != null ">,#{jsjsdj}</if><if test="jsxz != null ">,#{jsxz}</if><if test="jsdw != null ">,#{jsdw}</if><if test="dfzc != null ">,#{dfzc}</if><if test="yhdk != null ">,#{yhdk}</if><if test="kgny != null ">,#{kgny}</if><if test="wgny != null ">,#{wgny}</if>) -->
	</insert>
	<insert id="insertxjcb" parameterType="kxxyj">
		insert into cbsj_xj(id,xmmc,xmbm,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,jsxz,jsdw,dfzc,yhdk,kgsj,wgsj,tz)
		select sys_guid(),k.xmmc,k.xmbm,k.xzqh,k.xzqhdm,k.gydw1,k.gydwdm1,k.qdzh,k.zdzh,k.jsjsdj,k.jsxz,k.jsdw,k.dfzc,k.yhdk,k.kgny,k.wgny,k.tzgs from kxxyj_xj k where xmbm=#{xmbm}
		<!-- insert into cbsj_xj(id<if test="xmmc != null ">,xmmc</if><if test="xmbm != null ">,xmbm</if><if test="xzqh != null ">,xzqh</if><if test="qdzh != null ">,qdzh</if><if test="zdzh != null ">,zdzh</if><if test="jsjsdj != null ">,jsjsdj</if><if test="jsxz != null ">,jsxz</if><if test="jsdw != null ">,jsdw</if><if test="dfzc != null ">,dfzc</if><if test="yhdk != null ">,yhdk</if><if test="kgny != null ">,kgsj</if><if test="wgny != null ">,wgsj</if>)
		values(sys_guid()<if test="xmmc != null ">,#{xmmc}</if><if test="xmbm != null ">,#{xmbm}</if><if test="xzqh != null ">,#{xzqh}</if><if test="qdzh != null ">,#{qdzh}</if><if test="zdzh != null ">,#{zdzh}</if><if test="jsjsdj != null ">,#{jsjsdj}</if><if test="jsxz != null ">,#{jsxz}</if><if test="jsdw != null ">,#{jsdw}</if><if test="dfzc != null ">,#{dfzc}</if><if test="yhdk != null ">,#{yhdk}</if><if test="kgny != null ">,#{kgny}</if><if test="wgny != null ">,#{wgny}</if>) -->
	</insert>
	
	<select id="sjgzsfcb" parameterType="string" resultType="kxxyj">
		select * from cbsj_sjgz where ${value} and sfbj=1
	</select>
	<update id="thSjgzkxx1" parameterType="hashmap">
		update KXXYJ_SJGZ set shzt=0 where xmbm=#{xmbm}
	</update>
	<delete id="deletesjgzcb" parameterType="hashmap">
		delete from cbsj_sjgz where xmbm=#{xmbm}
	</delete>
	
	<select id="lmgzsfcb" parameterType="string" resultType="kxxyj">
		select * from cbsj_lmgz where ${value} and sfbj=1
	</select>
	<update id="thLmgzkxx1" parameterType="hashmap">
		update KXXYJ_LMGZ set shzt=0 where xmbm=#{xmbm}
	</update>
	<delete id="deletelmgzcb" parameterType="hashmap">
		delete from cbsj_lmgz where xmbm=#{xmbm}
	</delete>
	<select id="xjsfcb" parameterType="string" resultType="kxxyj">
		select * from cbsj_xj where ${value} and sfbj=1
	</select>
	<update id="thXjkxx1" parameterType="hashmap">
		update KXXYJ_XJ set shzt=0 where xmbm=#{xmbm}
	</update>
	<delete id="deletexjcb" parameterType="hashmap">
		delete from cbsj_xj where xmbm=#{xmbm}
	</delete>
	<select id="querylxlist" parameterType="kxxyj" resultType="lxsh">
		select t.*,bzcs bzys,xmid xmbm,lxbm ghlxbh from lxsh_lx t where xmid=#{xmbm} and jdbs=#{jdbs}
	</select>
	<insert id="insertLx1" parameterType="lxsh">
		insert into lxsh_lx (xmid, lxbm, lxmc, xzqh, xzqhdm, gydw, gydwdm, qdzh, zdzh, jsjsdj, lc, xjsdj, jsxz, qdmc, zdmc, bzcs, sffirst, jdbs,gpsqdzh,gpszdzh,jsfa,yilc,erlc,sanlc,silc,dwlc,wllc ,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,xjlxbm,xjqdzh,xjzdzh,xjlc,jhlc,ghlxbm,ghlxmc,lqhntmchd,lqhntmc,gxlqhntmchd,gxlqhntmc,snhntmchd,snhntmc,lqlmjdrzshd,lqlmjdrzs,lqlmcbrzshd,lqlmcbrzs,swjchd,swjc,lqlmpmlqjdlzshd,lqlmpmlqjdlzs,lqlmrhlqjdlzshd,lqlmrhlqjdlzs,lqlmcblzshd,lqlmcblzs,xzrxjchd,xzrxjc,swjclzshd,swjclzs,xfchd,xfc,wcsnmbhd,wcsnmb,wcswjchd,wcswjc,snhntmchbhd,snhntmchb,bxhd,bx,snhntmcsshhd,snhntmcssh,sbzj,lxlmkd,xzqhdm2,xzqhmc2,gxlxbm,gxqdzh,gxzdzh,ghqdzh,ghzdzh,snhntmchbmj)
		select xmid, lxbm, lxmc, xzqh, xzqhdm, gydw, gydwdm, qdzh, zdzh, jsjsdj, lc, xjsdj, jsxz, qdmc, zdmc, bzcs, sffirst, to_char(to_number(#{jdbs})),qdzh,zdzh,jsfa,yilc,erlc,sanlc,silc,dwlc,wllc   ,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,xjlxbm,xjqdzh,xjzdzh,xjlc,jhlc,ghlxbm,ghlxmc,lqhntmchd,lqhntmc,gxlqhntmchd,gxlqhntmc,snhntmchd,snhntmc,lqlmjdrzshd,lqlmjdrzs,lqlmcbrzshd,lqlmcbrzs,swjchd,swjc,lqlmpmlqjdlzshd,lqlmpmlqjdlzs,lqlmrhlqjdlzshd,lqlmrhlqjdlzs,lqlmcblzshd,lqlmcblzs,xzrxjchd,xzrxjc,swjclzshd,swjclzs,xfchd,xfc,wcsnmbhd,wcsnmb,wcswjchd,wcswjc,snhntmchbhd,snhntmchb,bxhd,bx,snhntmcsshhd,snhntmcssh,sbzj,lxlmkd,xzqhdm2,xzqhmc2,gxlxbm,gxqdzh,gxzdzh,ghqdzh,ghzdzh,snhntmchbmj from lxsh_lx where xmid in(${xmbm}) and jdbs=to_char(to_number(#{jdbs})-1)
		<!-- insert into LXSH_LX(id,xmid,lxbm,lxmc,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,lc,xjsdj,jsxz,qdmc,zdmc,bzcs,sffirst,jdbs,gpsqdzh,gpszdzh)
		values(sys_guid(),#{xmbm},#{ghlxbh},#{lxmc},#{xzqh},#{xzqhdm},#{gydw},#{gydwdm},#{qdzh},#{zdzh},#{jsjsdj},#{lc},#{xjsdj},#{jsxz},#{qdmc},#{zdmc},#{bzys},#{sffirst},#{jdbs},#{gpsqdzh},#{gpszdzh}) -->
	</insert>
	
	<insert id="insertJgtc" parameterType="gcgl_jgys">
 		insert into plan_upload(filename,filedata,parentid,filetype)
 		values(#{filename},#{filedata},#{jhid},#{filetype})
 	</insert>
 	<insert id="insertWgys" parameterType="gcgl_jgys">
 		insert into plan_upload(filename,filedata,parentid,filetype)
 		 values(#{filename},#{filedata},#{jhid},#{filetype})
 	</insert>
 	
 	<update id="importsjgzkxx" parameterType="hashMap">
		update kxxyj_sjgz set xmmc=#{1},qdzh=#{4},zdzh=#{5},jsxz=#{19},dq=#{21},
		dq_m=#{20},jsjsdj=#{22},sd=#{24},sd_m=#{23},sbthcd=7,tbbmbm='36',
		kgny=#{25},wgny=#{26},bzdw=#{27},tzgs=#{28},dfzc=#{29},yhdk=#{30},gkpfwh=#{31},pfsj=#{32},xzqh=#{2},xzqhdm=substr(#{0},5,6)
		where xmbm=#{0}
	</update>
	<update id="updatesjgzkxxlx" parameterType="hashMap">
		update lxsh_lx set qdzh=#{4},zdzh=#{5},xzqh=#{2},lc=to_number(#{6}),yilc=#{7},erlc=#{8},sanlc=#{9},
		silc=#{10},dwlc=#{11},wllc=#{12},jhyilc=#{13},jherlc=#{14},jhsanlc=#{15},jhsilc=#{16},jhdwlc=#{17},jhwllc=#{18},
		jsjsdj=#{22},xzqhdm=substr(#{0},5,6) where xmid=#{0} and jdbs='1' and sffirst='1'
	</update>
	<update id="importlmgzkxx" parameterType="hashMap">
		update kxxyj_lmgz set xmmc=#{1},qdzh=#{4},zdzh=#{5},jsxz=#{13},dq=#{15},
		dq_m=#{14},jsjsdj=#{16},sd=#{18},sd_m=#{17},sbthcd=7,tbbmbm='36',
		kgny=#{19},wgny=#{20},bzdw=#{21},tzgs=#{22},dfzc=#{23},yhdk=#{24},gkpfwh=#{25},pfsj=#{26},xzqh=#{2},xzqhdm=substr(#{0},5,6)
		where xmbm=#{0}
	</update>
	<update id="updatelmgzkxxlx" parameterType="hashMap">
		update lxsh_lx set qdzh=#{4},zdzh=#{5},xzqh=#{2},lc=#{6},yilc=#{7},erlc=#{8},sanlc=#{9},silc=#{10},dwlc=#{11},wllc=#{12},
		jsjsdj=#{16},xzqhdm=substr(#{0},5,6)
		where xmid=#{0} and jdbs='1' and sffirst='1'
	</update>
	<update id="importxjkxx" parameterType="hashMap">
		update kxxyj_xj set xmmc=#{1},qdzh=#{4},zdzh=#{5},jsxz=#{17},dq=#{19},
		dq_m=#{18},jsjsdj=#{20},sd=#{22},sd_m=#{21},sbthcd=7,tbbmbm='36',
		kgny=#{23},wgny=#{24},bzdw=#{25},tzgs=#{26},dfzc=#{27},yhdk=#{28},gkpfwh=#{29},pfsj=#{30},xzqh=#{2},xzqhdm=substr(#{0},5,6)
		where xmbm=#{0}
	</update>
	<update id="updatexjkxxlx" parameterType="hashMap">
		update lxsh_lx set qdzh=#{4},zdzh=#{5},xzqh=#{2},lc=#{6},xjlxbm=#{7},xjqdzh=#{8},xjzdzh=#{9},xjlc=#{10},
		yilc=#{11},erlc=#{12},sanlc=#{13},silc=#{14},dwlc=#{15},wllc=#{16},jsjsdj=#{20},xzqhdm=substr(#{0},5,6)
		where xmid=#{0} and jdbs='1' and sffirst='1'
	</update>
	
	
	<select id="showsjkxxTjxx" parameterType="lxsh" resultType="lxsh">
		select count(*) sl,nvl(sum(t.tzgs),0) tz,nvl(sum(lx.lc),0) lc,nvl(sum(lx.bzcs),0) bzcs,'0' sbz,'0' sjl,(sum(tz)-sum(bzys)) dftz 
		from KXXYJ_SJGZ t Left join lxsh_sjgz t1 on t.xmbm=t1.xmbm
		left join (select xmid,sum(nvl(jhyilc,0))+sum(nvl(jherlc,0))+sum(nvl(jhsanlc,0))+sum(nvl(jhsilc,0))+sum(nvl(jhdwlc,0))+sum(nvl(jhwllc,0)) lc,min(xjsdj) xjsdj,min(jsjsdj) jsjsdj,min(lxbm) lxbm,sum(bzcs) bzcs 
		from lxsh_lx where jdbs='1' 
		group by xmid) lx on t.xmbm=lx.xmid
		 where 1=1
		
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmbm!='' and xmbm!= null ">
			and t.xmbm like '%'||#{xmbm}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and ${xmnf}
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and t.sbzt like '%'||#{sbzt1}||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			and to_char(t.shzt) like '%'||#{shzt}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx  where jdbs='1'and ${jsdj})</if>
		<if test="jsjsdj!='' and jsjsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx  where jdbs='1' and ${jsjsdj})</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
	</select>
	<select id="showlmkxxTjxx" parameterType="lxsh" resultType="lxsh">
		select count(*) sl,nvl(sum(t.tzgs),0) tz,nvl(sum(lx.lc),0) lc,nvl(sum(lx.bzcs),0) bzcs,'0' sbz,'0' sjl,(sum(tz)-sum(bzys)) dftz from KXXYJ_LMGZ t Left join lxsh_LMgz t1 on t.xmbm=t1.xmbm
		left join (select xmid,sum(lc) lc,min(xjsdj) xjsdj,min(jsjsdj) jsjsdj,min(lxbm) lxbm,sum(bzcs) bzcs
		 from lxsh_lx where jdbs='1' 
		 group by xmid) lx on t.xmbm=lx.xmid
		 where 1=1
		
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmbm!='' and xmbm!= null ">
			and t.xmbm like '%'||#{xmbm}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and ${xmnf}
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and t.sbzt like '%'||#{sbzt1}||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			and to_char(t.shzt) like '%'||#{shzt}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx  where jdbs='1'and ${jsdj})</if>
		<if test="jsjsdj!='' and jsjsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx  where jdbs='1' and ${jsjsdj})</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
	</select>
	<select id="showxjkxxTjxx" parameterType="lxsh" resultType="lxsh">
		select count(*) sl,nvl(sum(t.tzgs),0) tz,nvl(sum(lx.lc),0) lc,nvl(sum(lx.bzcs),0) bzcs,'0' sbz,'0' sjl,(sum(tz)-sum(bzys)) dftz from KXXYJ_XJ t Left join lxsh_xj t1 on t.xmbm=t1.xmbm
		left join (select xmid,sum(xjlc) lc,min(xjsdj) xjsdj,min(jsjsdj) jsjsdj,min(lxbm) lxbm,sum(bzcs) bzcs 
		from lxsh_lx where jdbs='1'
		group by xmid) lx on t.xmbm=lx.xmid
		 where 1=1
		
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmbm!='' and xmbm!= null ">
			and t.xmbm like '%'||#{xmbm}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and ${xmnf}
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and t.sbzt like '%'||#{sbzt1}||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			and to_char(t.shzt) like '%'||#{shzt}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx  where jdbs='1'and ${jsdj})</if>
		<if test="jsjsdj!='' and jsjsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx  where jdbs='1' and ${jsjsdj})</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
	</select>
	
	<select id="showsjkxxbgTjxx" parameterType="lxsh" resultType="lxsh">
		select count(*) sl,nvl(sum(t1.tz),0) tz,nvl(sum(lx.lc),0) lc,nvl(sum(lx.bzcs),0) bzcs from KXXYJ_SJGZ_tz t Left join lxsh_sjgz t1 on t.xmbm=t1.xmbm
		left join (select xmid,sum(lc) lc,min(xjsdj) xjsdj,min(jsjsdj) jsjsdj,min(lxbm) lxbm,sum(bzcs) bzcs from lxsh_lx_TZ where jdbs='1' group by xmid ) lx on t.xmbm=lx.xmid
		 where 1=1
		
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and t.shzt like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
	</select>
	<select id="showlmkxxbgTjxx" parameterType="lxsh" resultType="lxsh">
		select count(*) sl,nvl(sum(t1.tz),0) tz,nvl(sum(lx.lc),0) lc,nvl(sum(lx.bzcs),0) bzcs from KXXYJ_LMGZ_tz t Left join lxsh_LMgz t1 on t.xmbm=t1.xmbm
		left join (select xmid,sum(lc) lc,min(xjsdj) xjsdj,min(jsjsdj) jsjsdj,min(lxbm) lxbm,sum(bzcs) bzcs from lxsh_lx_TZ where jdbs='1' group by xmid ) lx on t.xmbm=lx.xmid
		 where 1=1
		
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and t.shzt like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="tzxz !='' and tzxz != null ">
			and tzxz =#{tzxz}
		</if>
	</select>
	<select id="showxjkxxbgTjxx" parameterType="lxsh" resultType="lxsh">
		select count(*) sl,nvl(sum(t1.tz),0) tz,nvl(sum(lx.lc),0) lc,nvl(sum(lx.bzcs),0) bzcs from KXXYJ_XJ_TZ t Left join lxsh_xj t1 on t.xmbm=t1.xmbm
		left join (select xmid,sum(lc) lc,min(xjsdj) xjsdj,min(jsjsdj) jsjsdj,min(lxbm) lxbm,sum(bzcs) bzcs from lxsh_lx_TZ where jdbs='1' group by xmid ) lx on t.xmbm=lx.xmid
		 where 1=1
		
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and t1.xmnf like '%'||#{xmnf}||'%'
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and t.shzt like '%'||#{sbzt1}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
		<if test="jsdj!='' and jsdj!= null ">
			and t.jsjsdj like '%'||#{jsdj}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		<if test="ghlxbh !='' and ghlxbh != null ">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where lx.lxbm like '%'||#{ghlxbh}||'%')
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="tzxz !='' and tzxz != null ">
			and tzxz =#{tzxz}
		</if>
	</select>
	<!-- sjkx -->
	<update id="tzxzoldtbsjkx" parameterType="lxsh">
		update kxxyj_sjgz set tzxz=#{tzxz},tzsj=to_char(sysdate,'yyyy-mm-dd') where xmbm=#{xmbm}
	</update>
	<update id="tzxzoldtblmkx" parameterType="lxsh">
		update kxxyj_lmgz set tzxz=#{tzxz},tzsj=to_char(sysdate,'yyyy-mm-dd') where xmbm=#{xmbm}
	</update>
	<update id="tzxzoldtbxjkx" parameterType="lxsh">
		update kxxyj_xj set tzxz=#{tzxz},tzsj=to_char(sysdate,'yyyy-mm-dd') where xmbm=#{xmbm}
	</update>
	<update id="tzxzoldtbsjcb" parameterType="lxsh">
		update cbsj_sjgz set tzxz=#{tzxz},tzsj=to_char(sysdate,'yyyy-mm-dd') where xmbm=#{xmbm}
	</update>
	<update id="tzxzoldtblmcb" parameterType="lxsh">
		update cbsj_lmgz set tzxz=#{tzxz},tzsj=to_char(sysdate,'yyyy-mm-dd') where xmbm=#{xmbm}
	</update>
	<update id="tzxzoldtbxjcb" parameterType="lxsh">
		update cbsj_xj set tzxz=#{tzxz},tzsj=to_char(sysdate,'yyyy-mm-dd') where xmbm=#{xmbm}
	</update>
	<update id="tzxzoldtbshcb" parameterType="lxsh">
		update cbsj_sh set tzxz=#{tzxz},tzsj=to_char(sysdate,'yyyy-mm-dd') where xmbm=#{xmbm}
	</update>
	<update id="tzxzoldtbyhcb" parameterType="lxsh">
		update cbsj_yhdzx set tzxz=#{tzxz},tzsj=to_char(sysdate,'yyyy-mm-dd') where xmbm=#{xmbm}
	</update>
	
	<select id="querytzbyxmbmsjkx" parameterType="lxsh" resultType="lxsh">
	 	select * from kxxyj_sjgz_tz where xmbm=#{xmbm}
	 </select>
	 <select id="querytzbyxmbmlmkx" parameterType="lxsh" resultType="lxsh">
	 	select * from kxxyj_lmgz_tz where xmbm=#{xmbm}
	 </select>
	 <select id="querytzbyxmbmxjkx" parameterType="lxsh" resultType="lxsh">
	 	select * from kxxyj_xj_tz where xmbm=#{xmbm}
	 </select>
	 <select id="querytzbyxmbmsjcb" parameterType="lxsh" resultType="lxsh">
	 	select * from cbsj_sjgz_tz where xmbm=#{xmbm}
	 </select>
	 <select id="querytzbyxmbmlmcb" parameterType="lxsh" resultType="lxsh">
	 	select * from cbsj_lmgz_tz where xmbm=#{xmbm}
	 </select>
	 <select id="querytzbyxmbmxjcb" parameterType="lxsh" resultType="lxsh">
	 	select * from cbsj_xj_tz where xmbm=#{xmbm}
	 </select>
	 <select id="querytzbyxmbmshcb" parameterType="lxsh" resultType="lxsh">
	 	select * from cbsj_sh_tz where xmbm=#{xmbm}
	 </select>
	 <select id="querytzbyxmbmyhcb" parameterType="lxsh" resultType="lxsh">
	 	select * from cbsj_yhdzx_tz where xmbm=#{xmbm}
	 </select>
	 
	 <insert id="tzxztjsjkx" parameterType="lxsh">
	 	insert into kxxyj_sjgz_tz select * from kxxyj_sjgz where xmbm=#{xmbm}
	 </insert>
	 <insert id="tzxztjlmkx" parameterType="lxsh">
	 	insert into kxxyj_lmgz_tz select * from kxxyj_lmgz where xmbm=#{xmbm}
	 </insert>
	 <insert id="tzxztjxjkx" parameterType="lxsh">
	 	insert into kxxyj_xj_tz select * from kxxyj_xj where xmbm=#{xmbm}
	 </insert>
	  <insert id="tzxztjsjcb" parameterType="lxsh">
	 	insert into cbsj_sjgz_tz select * from cbsj_sjgz where xmbm=#{xmbm}
	 </insert>
	 <insert id="tzxztjlmcb" parameterType="lxsh">
	 	insert into cbsj_lmgz_tz select * from cbsj_lmgz where xmbm=#{xmbm}
	 </insert>
	 <insert id="tzxztjxjcb" parameterType="lxsh">
	 	insert into cbsj_xj_tz select * from cbsj_xj where xmbm=#{xmbm}
	 </insert>
	 <insert id="tzxztjshcb" parameterType="lxsh">
	 	insert into cbsj_sh_tz select * from cbsj_sh where xmbm=#{xmbm}
	 </insert>
	 <insert id="tzxztjyhcb" parameterType="lxsh">
	 	insert into cbsj_yhdzx_tz select * from cbsj_yhdzx where xmbm=#{xmbm}
	 </insert>
	 
	 <insert id="tzxztjsjkxlx" parameterType="lxsh">
	 	insert into lxsh_lx_tz select * from lxsh_lx where xmid=#{xmbm} and jdbs=#{jdbs}
	 </insert>
	 <update id="tzxzxgsjkx" parameterType="lxsh" >
	 	update kxxyj_sjgz_tz set tzxz=#{tzxz} where xmbm=#{xmbm}
	 </update>
	 <update id="tzxzxglmkx" parameterType="lxsh" >
	 	update kxxyj_lmgz_tz set tzxz=#{tzxz} where xmbm=#{xmbm}
	 </update>
	 <update id="tzxzxgxjkx" parameterType="lxsh" >
	 	update kxxyj_xj_tz set tzxz=#{tzxz} where xmbm=#{xmbm}
	 </update>
	 <update id="tzxzxgsjcb" parameterType="lxsh" >
	 	update cbsj_sjgz_tz set tzxz=#{tzxz} where xmbm=#{xmbm}
	 </update>
	 <update id="tzxzxglmcb" parameterType="lxsh" >
	 	update cbsj_lmgz_tz set tzxz=#{tzxz} where xmbm=#{xmbm}
	 </update>
	 <update id="tzxzxgxjcb" parameterType="lxsh" >
	 	update cbsj_xj_tz set tzxz=#{tzxz} where xmbm=#{xmbm}
	 </update>
	 <update id="tzxzxgshcb" parameterType="lxsh" >
	 	update cbsj_sh_tz set tzxz=#{tzxz} where xmbm=#{xmbm}
	 </update>
	 <update id="tzxzxgyhcb" parameterType="lxsh" >
	 	update cbsj_yhdzx_tz set tzxz=#{tzxz} where xmbm=#{xmbm}
	 </update>
	 
	 <delete id="qxtzxzsjkx" parameterType="lxsh">
	 	delete from  kxxyj_sjgz where xmbm=#{xmbm}
	 </delete>
	 <delete id="qxtzxzlmkx" parameterType="lxsh">
	 	delete from  kxxyj_lmgz where xmbm=#{xmbm}
	 </delete>
	 <delete id="qxtzxzxjkx" parameterType="lxsh">
	 	delete from  kxxyj_xj where xmbm=#{xmbm}
	 </delete>
	 <delete id="qxtzxzsjcb" parameterType="lxsh">
	 	delete from  cbsj_sjgz where xmbm=#{xmbm}
	 </delete>
	 <delete id="qxtzxzlmcb" parameterType="lxsh">
	 	delete from  cbsj_lmgz where xmbm=#{xmbm}
	 </delete>
	 <delete id="qxtzxzxjcb" parameterType="lxsh">
	 	delete from  cbsj_xj where xmbm=#{xmbm}
	 </delete>
	 <delete id="qxtzxzshcb" parameterType="lxsh">
	 	delete from  cbsj_sh where xmbm=#{xmbm}
	 </delete>
	 <delete id="qxtzxzyhcb" parameterType="lxsh">
	 	delete from  cbsj_yhdzx where xmbm=#{xmbm}
	 </delete>
	 
	  <delete id="thtzkxlx" parameterType="lxsh">
	 	delete from  lxsh_lx where xmid=#{xmbm} and jdbs=#{jdbs}
	 </delete>
	  <insert id="thtzsjkx" parameterType="lxsh">
	 	insert into kxxyj_sjgz select * from kxxyj_sjgz_tz where xmbm=#{xmbm}
	 </insert>
	 <insert id="thtzlmkx" parameterType="lxsh">
	 	insert into kxxyj_lmgz select * from kxxyj_lmgz_tz where xmbm=#{xmbm}
	 </insert>
	 <insert id="thtzxjkx" parameterType="lxsh">
	 	insert into kxxyj_xj select * from kxxyj_xj_tz where xmbm=#{xmbm}
	 </insert>
	   <insert id="thtzsjcb" parameterType="lxsh">
	 	insert into cbsj_sjgz select * from cbsj_sjgz_tz where xmbm=#{xmbm}
	 </insert>
	 <insert id="thtzlmcb" parameterType="lxsh">
	 	insert into cbsj_lmgz select * from cbsj_lmgz_tz where xmbm=#{xmbm}
	 </insert>
	 <insert id="thtzxjcb" parameterType="lxsh">
	 	insert into cbsj_xj select * from cbsj_xj_tz where xmbm=#{xmbm}
	 </insert>
	 <insert id="thtzshcb" parameterType="lxsh">
	 	insert into cbsj_sh select * from cbsj_sh_tz where xmbm=#{xmbm}
	 </insert>
	 <insert id="thtzyhcb" parameterType="lxsh">
	 	insert into cbsj_yhdzx select * from cbsj_yhdzx_tz where xmbm=#{xmbm}
	 </insert>
	 
	 
	 <insert id="tjtzkxlx" parameterType="lxsh">
	 	insert into lxsh_lx select * from lxsh_lx_tz where xmid=#{xmbm} and jdbs=#{jdbs}
	 </insert>
	  <delete id="thtznewtbsjkx" parameterType="lxsh">
	 	delete from  kxxyj_sjgz_tz where xmbm=#{xmbm}
	 </delete>
	  <delete id="thtznewtblmkx" parameterType="lxsh">
	 	delete from  kxxyj_lmgz_tz where xmbm=#{xmbm}
	 </delete>
	  <delete id="thtznewtbxjkx" parameterType="lxsh">
	 	delete from  kxxyj_xj_tz where xmbm=#{xmbm}
	 </delete>
	  <delete id="thtznewtbsjcb" parameterType="lxsh">
	 	delete from  cbsj_sjgz_tz where xmbm=#{xmbm}
	 </delete>
	 <delete id="thtznewtblmcb" parameterType="lxsh">
	 	delete from  cbsj_lmgz_tz where xmbm=#{xmbm}
	 </delete>
	 <delete id="thtznewtbxjcb" parameterType="lxsh">
	 	delete from  cbsj_xj_tz where xmbm=#{xmbm}
	 </delete>
	 <delete id="thtznewtbshcb" parameterType="lxsh">
	 	delete from  cbsj_sh_tz where xmbm=#{xmbm}
	 </delete>
	 <delete id="thtznewtbyhcb" parameterType="lxsh">
	 	delete from  cbsj_yhdzx_tz where xmbm=#{xmbm}
	 </delete>
	 
	  <delete id="thtznewtbsjkxlx" parameterType="lxsh">
	 	delete from  lxsh_lx_tz where xmid=#{xmbm} and jdbs=#{jdbs}
	 </delete>
	 <select id="querygkxmXXsj" parameterType="lxsh" resultType="kxxyj">
	 	select rownum num ,t.*,t1.lsjl,t1.ghlxbh lxbh,t1.gydwdm, t.shzt sbzt1,lx.*,sl.xmsl from KXXYJ_SJGZ t Left join 
		lxsh_sjgz t1 on t.xmbm=t1.xmbm left join (select qdzh minqdzh,zdzh maxzdzh,xmid,lc,yilc,erlc,sanlc,silc,
		dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,qdmc,zdmc from lxsh_lx where jdbs='1' and sffirst='1') lx on t.xmbm=lx.xmid 
		left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='1' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1  and t.xmbm=#{xmbm} 
	 </select>
	 <select id="querygkxmXXlm" parameterType="lxsh" resultType="kxxyj">
	 	select rownum num ,t.*,t1.lsjl,t1.ghlxbh lxbh,t1.gydwdm,t.shzt sbzt1,lx.*,sl.xmsl from KXXYJ_LMGZ t Left join lxsh_lmgz t1 
		on t.xmbm=t1.xmbm left join (select qdzh minqdzh,zdzh maxzdzh,xmid,lc,yilc,erlc,sanlc,silc,dwlc,wllc,qdmc,zdmc from lxsh_lx 
		where jdbs='1' and jdbs='1' and sffirst='1') lx on t.xmbm=lx.xmid 
		left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='1' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1  and t.xmbm=#{xmbm} 
	 </select>
	 <select id="querygkxmXXxj" parameterType="lxsh" resultType="kxxyj">
	 	select rownum num ,t.*,t1.ghlxbh lxbh,t1.gydwdm,t.shzt sbzt1,lx.*,sl.xmsl from KXXYJ_XJ t left join lxsh_xj t1 on t.xmbm=t1.xmbm left join 
		(select qdmc,zdmc,lxmc,qdzh minqdzh,zdzh maxzdzh,xmid, lc,xjlc,yilc,erlc,sanlc,silc,dwlc,wllc,xjlxbm,xjqdzh,xjzdzh 
		from lxsh_lx where jdbs='1' and sffirst='1') lx on t.xmbm=lx.xmid 
		left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='1' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1  and t.xmbm=#{xmbm} 
	 </select>
	 
	 
	 
	 
	 <select id="selectgsdkxList" parameterType="lxsh" resultType="kxxyj">
		select * from (
		select rownum num ,t.*,xmklx,t1.lsjl,t1.ghlxbh lxbh,t1.gydwdm,t1.gydw,t1.tsdq,t1.tz, t.shzt sbzt1,t.sbzt sbzts,lx.*,sl.xmsl,sl.zlc jszlc1 from kxgsdgz t Left join 
		lxgsdgz t1 on t.xmbm=t1.xmbm left join (select qdzh minqdzh,zdzh maxzdzh,xmid,lc,yilc,erlc,sanlc,silc,qdmc,zdmc,
		dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,ghlxbm,ghlxmc,ghqdzh,ghzdzh from lxsh_lx where jdbs='1' and sffirst='1'
		) lx on t.xmbm=lx.xmid 
		left join (select xmid,count(xmid) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc from lxsh_lx where jdbs='1' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1 
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and t.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmbm!='' and xmbm!= null ">and t.xmbm like '%'||#{xmbm}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="jsdj!='' and jsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx t where jdbs='1'and ${jsdj})</if>
		<if test="jsjsdj!='' and jsjsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx  where jdbs='1' and ${jsjsdj})</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(t.sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			and to_char(t.shzt) like '%'||#{shzt}||'%'
		</if>
		<if test="gldj!='' and gldj!= null ">and t.xmbm in (select xmid from lxsh_lx where jdbs='1' and xmid like '%1___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and t1.lsjl like '%'||#{lsjl}||'%'</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
	</select>
	<select id="selectgsdkxListCount" parameterType="lxsh" resultType="int">
		select count(*) from kxgsdgz t Left join lxgsdgz t1 on t.xmbm=t1.xmbm where 1=1
		
		<if test="gydw!='' and gydw!= null ">${gydw}</if>
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and t.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmbm!='' and xmbm!= null ">and t.xmbm like '%'||#{xmbm}||'%'</if>
		<if test="xmnf!='' and xmnf!= null ">and ${xmnf}</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(t.sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			and to_char(t.shzt) like '%'||#{shzt}||'%'
		</if>
		<if test="jsdj!='' and jsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx t where jdbs='1'and ${jsdj})</if>
		<if test="jsjsdj!='' and jsjsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx  where jdbs='1' and ${jsjsdj})</if>
		<if test="gldj!='' and gldj!= null ">and t.xmbm in (select xmid from lxsh_lx where jdbs='1' and xmid like '%1___' and ${gldj})</if>
		<if test="lsjl!='' and lsjl!= null ">and t1.lsjl like '%'||#{lsjl}||'%'</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
	</select>
	<select id="showgsdkxxTjxx" parameterType="lxsh" resultType="lxsh">
		select count(*) sl,nvl(sum(t1.tz),0) tz,nvl(sum(lx.lc),0) lc,nvl(sum(t1.bzys),0) bzcs,'0' sbz,'0' sjl,nvl((sum(tz)-sum(bzys)),0) dftz 
		from kxgsdgz t Left join lxgsdgz t1 on t.xmbm=t1.xmbm
		left join (select xmid,sum(lc) lc,min(xjsdj) xjsdj,min(jsjsdj) jsjsdj,min(lxbm) lxbm,sum(bzcs) bzcs 
		from (select  xmid,jsxz,xjsdj,jsjsdj,lxbm,bzcs,
		(case when jsxz like '%改建%' then to_char(nvl(jhyilc,0)+nvl(jherlc,0)+nvl(jhsanlc,0)+nvl(jhsilc,0)+nvl(jhdwlc,0)+nvl(jhwllc,0))
					  when jsxz like '%新建%' then xjlc
					    else lc
<!-- 		nvl(yilc,0)+nvl(erlc,0)+nvl(sanlc,0)+nvl(silc,0)+nvl(dwlc,0)+nvl(wllc,0)  -->
		end) lc
	   from lxsh_lx where jdbs='1'
	   ) group by xmid) lx on t.xmbm=lx.xmid
			 where 1=1
		
		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqh!='' and xzqh!= null ">
			${xzqh}
		</if>
		<if test="xmmc!='' and xmmc!= null ">
			and t.xmmc like '%'||#{xmmc}||'%'
		</if>
		<if test="xmbm!='' and xmbm!= null ">
			and t.xmbm like '%'||#{xmbm}||'%'
		</if>
		<if test="xmnf!='' and xmnf!= null ">
			and ${xmnf}
		</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(t.sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			and to_char(t.shzt) like '%'||#{shzt}||'%'
		</if>
		<if test="tsdq!='' and tsdq!= null ">
			${tsdq}
		</if>
	<!-- 	<if test="jsdj!='' and jsdj!= null ">
			and lx.jsdj like '%'||#{jsdj}||'%'
		</if> -->
		<if test="jsdj!='' and jsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx  where jdbs='1'and ${jsdj})</if>
		<if test="jsjsdj!='' and jsjsdj!= null "> and t.xmbm in (select distinct xmid  from lxsh_lx  where jdbs='1' and ${jsjsdj})</if>
		<if test="gldj!='' and gldj!= null ">
			and ghlxbh like #{gldj}||'%'
		</if>
		
		<if test="lxmc !='' and lxmc != null ">
			and lxmc like '%'||#{lxmc}||'%'
		</if>
		<if test="xmlx1 !='' and xmlx1 != null ">
			${xmlx1}
		</if>
		<if test="ghlxbh!=null and ghlxbh!=''">
			and t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbh})
		</if>
		<if test="ghlxbm!=null and ghlxbm!=''">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where 1=1 ${ghlxbm})
			)
		</if>
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		<if test="xmklx!='' and xmklx!= null ">and xmklx like '%'||#{xmklx}||'%'</if>
		<if test="lsxmnf!='' and lsxmnf!= null ">${lsxmnf}</if>
		<if test="lsxmlx!='' and lsxmlx!= null ">${lsxmlx}</if>
	</select>
	
	
	
	
	<select id="selectShkxList" parameterType="lxsh" resultType="kxxyj">
		select * from (
		select rownum num ,
		t.id,t.xmmc,t.xmbm,t.jsdw,t.xzqh,t.qdzh,t.zdzh,t.dq,t.sd,t.kgny,t.wgny,t.jsdj,t.jsxz,t.gkpfwh,t.pfsj,t.tzgs,t.bzdw,t.xzqhdm,t.shzt,t.sbzt,t.dq_m,t.sd_m,t.tbbmbm,t.dfzc,t.yhdk,t.jszlc,t.tzxz,t.tzsj,t.thyy,
		t1.lsjl,lx.lxbm lxbh,t1.gydwdm,t1.gydw,t1.tsdq,t1.ntz, t.shzt sbzt1,t.sbzt sbzts,lx.*,sl.xmsl,sl.zlc jszlc1 from KXXYJ_SH t Left join 
		xmsq_sh t1 on t.xmbm=t1.xmbm left join (select qdzh minqdzh,zdzh maxzdzh,xmid,lc,yilc,erlc,sanlc,silc,qdmc,zdmc,
		dwlc,wllc,jhyilc,jherlc,jhsanlc,jhsilc,jhdwlc,jhwllc,lxbm,ghlxbm,ghlxmc,ghqdzh,ghzdzh from lxsh_lx where jdbs='1' and sffirst='1') lx on t.xmbm=lx.xmid 
		left join (select xmid,count(*) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') lxbmtj,replace(WMSYS.WM_CONCAT(lxmc),',',',') lxmctj,
		replace(WMSYS.WM_CONCAT(ghlxbm),',',',') ghlxbm,replace(WMSYS.WM_CONCAT(ghlxmc),',',',') ghlxmc,replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsdjtj
  		from lxsh_lx where jdbs='1' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1 
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and t.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf !='' and xmnf != null ">and substr(t.xmbm,0,4) in (${xmnf})</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and ${gldj}</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="lxbm !='' and lxbm != null ">
			and lxbmtj like '%'||#{lxbm}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmctj like '%'||#{lxmc}||'%'
		</if>
		
		<if test="ghlxmc !='' and ghlxmc != null ">
			and sl.ghlxmc like '%'||#{ghlxmc}||'%'
		</if>
		<if test="lsjl!='' and lsjl!= null ">and t1.lsjl like '%'||#{lsjl}||'%'</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(t.sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			and to_char(t.shzt) like '%'||#{shzt}||'%'
		</if>
		
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
		) t2 where t2.num &lt;=(#{page} * #{rows}) and t2.num>(#{page}-1)*#{rows}
		order by sbzt1,xmbm
	</select>
	<select id="selectShkxListCount" parameterType="lxsh" resultType="int">
		select count(*) from KXXYJ_SH t Left join xmsq_sh t1 on t.xmbm=t1.xmbm
		left join (select xmid,count(*) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') lxbmtj,replace(WMSYS.WM_CONCAT(lxmc),',',',') lxmctj,
		replace(WMSYS.WM_CONCAT(ghlxbm),',',',') ghlxbm,replace(WMSYS.WM_CONCAT(ghlxmc),',',',') ghlxmc,replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsdjtj
  		from lxsh_lx where jdbs='1' group by xmid) sl on t.xmbm=sl.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and t.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf !='' and xmnf != null ">and substr(t.xmbm,0,4) in (${xmnf})</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and ${gldj}</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="lxbm !='' and lxbm != null ">
			and lxbmtj like '%'||#{lxbm}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbm !='' and ghlxbm != null ">
			and sl.ghlxbm like '%'||#{ghlxbm}||'%'
		</if>
		<if test="ghlxmc !='' and ghlxmc != null ">
			and sl.ghlxmc like '%'||#{ghlxmc}||'%'
		</if>
		<if test="lsjl!='' and lsjl!= null ">and t1.lsjl like '%'||#{lsjl}||'%'</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(t.sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			and to_char(t.shzt) like '%'||#{shzt}||'%'
		</if>
		
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
	</select>
	<select id="showkxxShxx" parameterType="lxsh" resultType="lxsh">
		select count(*) sl,nvl(sum(t.tzgs),0) tz,nvl(sum(lx.lc),0) lc,'0' bzcs,'0' sbz,'0' sjl,'0' dftz from KXXYJ_SH t Left join xmsq_sh t1 on t.xmbm=t1.xmbm
		left join (select xmid,count(*) xmsl,decode(substr(xmid,11,1),1,(nvl(sum(jhyilc),0)+nvl(sum(jherlc),0)+nvl(sum(jhsanlc),0)+nvl(sum(jhsilc),0)+nvl(sum(jhdwlc),0)+nvl(sum(jhwllc),0)),(nvl(sum(yilc),0)+nvl(sum(erlc),0)+nvl(sum(sanlc),0)+nvl(sum(silc),0)+nvl(sum(dwlc),0)+nvl(sum(wllc),0))) zlc,replace(WMSYS.WM_CONCAT(lxbm),',',',') lxbmtj,replace(WMSYS.WM_CONCAT(lxmc),',',',') lxmctj,
		replace(WMSYS.WM_CONCAT(ghlxbm),',',',') ghlxbm,replace(WMSYS.WM_CONCAT(ghlxmc),',',',') ghlxmc,replace(WMSYS.WM_CONCAT(jsjsdj),',',',') jsdjtj
  		from lxsh_lx where jdbs='1' group by xmid) sl on t.xmbm=sl.xmid
  		left join (select xmid,sum(lc) lc,min(xjsdj) xjsdj,min(jsjsdj) jsjsdj,min(lxbm) lxbm,sum(bzcs) bzcs from lxsh_lx where jdbs='1' group by xmid) lx on t.xmbm=lx.xmid
		where 1=1
		<if test="xzqh!='' and xzqh!= null ">${xzqh}</if>
		<if test="xmmc!='' and xmmc!= null ">and t.xmmc like '%'||#{xmmc}||'%'</if>
		<if test="xmnf !='' and xmnf != null ">and substr(t.xmbm,0,4) in (${xmnf})</if>
		<if test="jsdj!='' and jsdj!= null ">and ${jsdj}</if>
		<if test="gldj!='' and gldj!= null ">and ${gldj}</if>
		<if test="tsdq!='' and tsdq!= null ">${tsdq}</if>
		<if test="lxbm !='' and lxbm != null ">
			and lxbmtj like '%'||#{lxbm}||'%'
		</if>
		<if test="lxmc !='' and lxmc != null ">
			and lxmctj like '%'||#{lxmc}||'%'
		</if>
		<if test="ghlxbm !='' and ghlxbm != null ">
			and sl.ghlxbm like '%'||#{ghlxbm}||'%'
		</if>
		<if test="ghlxmc !='' and ghlxmc != null ">
			and sl.ghlxmc like '%'||#{ghlxmc}||'%'
		</if>
		<if test="lsjl!='' and lsjl!= null ">and t1.lsjl like '%'||#{lsjl}||'%'</if>
		<if test="sbzt1!='' and sbzt1!= null ">
			and to_char(t.sbzt) like '%'||#{sbzt1}||'%'
		</if>
		<if test="shzt!='' and shzt!= null ">
			and to_char(t.shzt) like '%'||#{shzt}||'%'
		</if>
		
		<if test="ghlxmc!='' and ghlxmc!= null ">
			and (t.xmbm in (select distinct xmid from lxsh_lx lx where lx.ghlxmc like '%'||#{ghlxmc}||'%')
			
			)
		</if>
	</select>
	
	
	
	
	<update id="shshkxx" parameterType="lxsh">
		update kxxyj_sh set shzt=1 where xmbm in (${xmbm})
	</update>
	<insert id="insertshcb" parameterType="lxsh">
	insert into cbsj_sh c (xmmc,xmbm,jsdw,xzqh,xzqhdm,gydw,gydwdm,qdzh,zdzh,jsjsdj,jsxz,kgsj,wgsj,gq,lc,jsfa,tz)
    select k.xmmc,x.xmbm,null,k.xzqh,k.xzqhdm,k.gydw1,k.gydwdm1,k.qdzh,k.zdzh,k.jsdj,k.gcfl,k.kgny,k.wgny,x.gq,x.lc,k.jsxz,tzgs 
    from xmsq_sh x left join kxxyj_sh k on x.xmbm=k.xmbm where x.xmbm in (${xmbm})
	</insert>
	
	<update id="sbgcxmkxx" parameterType="lxsh">
	update ${bz} set sbzt='1',sbthcd=#{sbthcd} where xmbm in (${xmbm})
	</update>
	
	<update id="thkxxyjsbzt" parameterType="lxsh">
	update ${bz} set thyy=#{thyy},sbzt=#{sbzt},sbthcd=#{sbthcd} where xmbm in (${xmbm})
	</update>
	<update id="thjhshsb" parameterType="lxsh">
	update ${bz} set thyy=#{thyy},sbzt=#{sbzt} where xmbm in (${xmbm})
	</update>
	
	<select id="sfkythkxxwsh" parameterType="lxsh" resultType="lxsh">
		select * from ${bzcs} where xmbm in (${xmbm}) and shzt='1'
	</select>
	
	<update id="thwshkxx" parameterType="lxsh">
		update ${bz} set shzt='0' where xmbm in (${xmbm})
	</update>
	<delete id="thwshkxxcbsj" parameterType="lxsh">
		delete from ${bzcs} where xmbm in (${xmbm}) 
	</delete>
	<delete id="thwshkxxcbsjlx" parameterType="lxsh">
		delete from lxsh_lx where xmid in (${xmbm}) and jdbs=#{jdbs}
	</delete>
	<delete id="thwshkxxjhsb" parameterType="lxsh">
		delete from ${bzys} where xmbm in (${xmbm}) 
	</delete>
	
	<insert id="insertjhshsb" parameterType="lxsh">
		insert into ${bzcs} (id,xmbm,xmmc, xzqh, qdzh, zdzh, kgsj, wgsj, gkpfwh)
		select sys_guid(),xmbm,xmmc,xzqh,qdzh,zdzh,kgny,wgny,gkpfwh from ${bz} 
		where xmbm in(${xmbm})
	</insert>
	<update id="tzxmgk" parameterType="lxsh">
	update ${bz} set bz=(case when bz like '%'||gkpfwh||'%' then bz when bz is null or bz='' then gkpfwh else bz||','||gkpfwh end),TZXZ='变更' where xmbm=#{xmbm}
	</update>
	<update id="tzxmcb" parameterType="lxsh">
	update ${bz} set bz=(case when bz like '%'||sjpfwh||'%' then bz when bz is null or bz='' then sjpfwh else bz||','||sjpfwh end),TZXZ='变更' where xmbm=#{xmbm}
	</update>
</mapper>
