<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.plan_wqgz">
	<resultMap type="plan_wqgz"  id="wqgz_jh">
		<id property="id" column="id" />
		<result property="sfylrbwqk" column="sfylrbwqk"/>
		<result property="sckid" column="sckid"/>
		<result property="sbnf" column="sbnf"/>
		<result property="sbzt" column="sbzt"/>
		<result property="spzt" column="spzt"/>
		<result property="jhkgsj" column="jhkgsj"/>
		<result property="jhwgsj" column="jhwgsj"/>
		<result property="pfztz" column="pfztz"/>
		<result property="jhsybzje" column="jhsybzje"/>
		<result property="jhsydfzcje" column="jhsydfzcje"/>
		<result property="kgzt" column="kgzt"/>
		<result property="jgzt" column="jgzt"/>
		<result property="sfylsjl" column="sfylsjl"/>
		<result property="sfylrbwqk" column="sfylrbwqk"/>
		<result property="jh_sbthcd" column="jh_sbthcd"/>
		<result property="xlxbm" column="xlxbm"/>
		<result property="xqlbm" column="xqlbm"/>
		<result property="xzxzh" column="xzxzh"/>
		<result property="xlxmc" column="xlxmc"/>
		<result property="xqlmc" column="xqlmc"/>
		<association property="jckwqgz"  resultMap="wqgz_lx" ></association>
	</resultMap>
	<resultMap type="sckwqgz"  id="wqgz_lx">
		<result property="gydw" column="gydw"/>
		<result property="gydwbm" column="gydwbm"/>
		<result property="xzqhmc" column="xzqhmc"/>
		<result property="lxbm" column="lxbm"/>
		<result property="lxmc" column="lxmc"/>
		<result property="qlmc" column="qlmc"/>
		<result property="qlbh" column="qlbh"/>
		<result property="scqlqc" column="scqlqc"/>
		<result property="scqlqk" column="scqlqk"/>
		<result property="qlzxzh" column="qlzxzh"/>
		<result property="akjfl" column="akjfl"/>
	</resultMap>
	<select id="queryWqgzList" parameterType="java.util.Map" resultMap="wqgz_jh">
		select * from 
			(
				select rownum as num,t.* from
				(
					select jh.id,jh.sckid,jh.jh_sbthcd,jh.sbnf,jh.sbzt,jh.spzt,jh.kgzt,jh.jgzt,jh.jhkgsj,jh.jhwgsj,jh.pfztz,sc.bzls as sfylsjl,
					sc.scqlqc,sc.scqlqk,lx.gydw,lx.gydwbm,lx.xzqhdm,lx.xzqhmc,lx.lxmc,lx.lxbm,lx.qlmc,lx.qlbh,lx.qlzxzh,lx.xlxbm,lx.xqlbm,lx.xzxzh,lx.xlxmc,lx.xqlmc 
					from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) 
					left join xmk_wqgz lx on (sc.xmkid=lx.id) where 1=1 and jh.sfylrbwqk='是' <!-- and lx.gydwbm like '2%' -->
	 				<if test="jh.jh_sbthcd!=null and jh.jh_sbthcd!='' and (jh.sbzt==null or jh.sbzt=='') and (jh.spzt==null or jh.spzt=='')">
						and jh.jh_sbthcd=#{jh.jh_sbthcd}
					</if>
				    <if test="(jh.sbzt!=null or jh.spzt!=null) and (jh.sbzt!='' or jh.spzt!='') and jh.jh_sbthcd!=null and jh.jh_sbthcd!=''">
						and (jh.jh_sbthcd=#{jh.jh_sbthcd} or jh.jh_sbthcd=#{jh.jh_sbthcd}+2)
					</if>
	 				<if test="jh.sbnf!=null and jh.sbnf!=''">
	 					and jh.sbnf in (${jh.sbnf})
	 				</if>
	 				<if test="jh.sbzt!=null and jh.sbzt!=''">
	 					and jh.sbzt=#{jh.sbzt}
	 				</if>
	 				<if test="jh.kgzt!=null and jh.kgzt!=''">
	 					and jh.kgzt=#{jh.kgzt}
	 				</if>
	 				<if test="jh.jgzt!=null and jh.jgzt!=''">
	 					and jh.jgzt=#{jh.jgzt}
	 				</if>
	 				<if test="jh.spzt!=null and jh.spzt!=''">
	 					and jh.spzt=#{jh.spzt}
	 				</if>
	 				<if test="jh.sfylsjl!=null and jh.sfylsjl!=''">
			 			and sc.bzls=#{jh.sfylsjl}
				 	</if>
	 				<if test="lx.gydwbm!=null and lx.gydwbm!=''">
	 					and ${lx.gydwbm}
	 				</if>
	 				<if test="lx.xzqhdm!=null and lx.xzqhdm!=''">
	 					and ${lx.xzqhdm}
	 				</if>
	 				<if test="lx.lxmc!=null and lx.lxmc!=''">
	 					and lx.lxmc like '%'||#{lx.lxmc}||'%'
	 				</if>
	 				<if test="lx.lxbm!=null and lx.lxbm!=''">
	 					and lx.lxbm like '%'||#{lx.lxbm}||'%'
	 				</if>
	 				 <if test="lx.jsdj!=null and lx.jsdj!=''">
	 					${lx.jsdj}
	 				</if> 
	 				<if test="lx.gldj!=null and lx.gldj!=''">
	 					${lx.gldj}
	 				</if>
	 				<if test="lx.qlmc!=null and lx.qlmc!=''">
	 					and lx.qlmc like '%'||#{lx.qlmc}||'%'
	 				</if>
	 				<if test="lx.qlbh!=null and lx.qlbh!=''">
	 					and lx.qlbh like '%'||#{lx.qlbh}||'%'
	 				</if>
	 				<if test="lx.akjfl!=null and lx.akjfl!=''">
	 					${lx.akjfl}
	 				</if>
	 				<if test="lx.tsdq!=null and lx.tsdq!=''">
				 		${lx.tsdq}
				 	</if>
				 	<if test="lx.jsxz!=null and lx.jsxz!=''">
	 					and sc.jsxz like '%'||#{lx.jsxz}||'%'
	 				</if>
	 				<if test="lx.xmklx != null and lx.xmklx != ''">
	 					and lx.xmklx like '%'||#{lx.xmklx}||'%'
	 				</if>
	 				order by jh.sbnf desc,jh.jh_sbthcd
	 			) t order by t.sbnf desc,t.jh_sbthcd
 			)
 		where <![CDATA[ num <= (#{page} * #{rows})]]> and num>(#{page}-1)*#{rows}
	</select>
	<select id="queryWqgzList1" parameterType="java.util.Map" resultMap="wqgz_jh">
		select * from 
			(
				select rownum as num,t.* from
				(
					select jh.id,jh.sckid,jh.jh_sbthcd,jh.sbnf,jh.sbzt,jh.spzt,jh.kgzt,jh.jgzt,jh.jhkgsj,jh.jhwgsj,jh.pfztz,sc.bzls as sfylsjl,
					sc.scqlqc,sc.scqlqk,lx.gydw,lx.gydwbm,lx.xzqhdm,lx.xzqhmc,lx.lxmc,lx.lxbm,lx.qlmc,lx.qlbh,lx.qlzxzh 
					from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) 
					left join xmk_wqgz lx on (sc.xmkid=lx.id) where 1=1 and jh.sfylrbwqk='是' <!-- and lx.gydwbm like '2%' -->
	 				<if test="jh.jh_sbthcd!=null and jh.jh_sbthcd!='' and (jh.sbzt==null or jh.sbzt=='') and (jh.spzt==null or jh.spzt=='')">
						and jh.jh_sbthcd=#{jh.jh_sbthcd}
					</if>
				    <if test="(jh.sbzt!=null or jh.spzt!=null) and (jh.sbzt!='' or jh.spzt!='') and jh.jh_sbthcd!=null and jh.jh_sbthcd!=''">
						and (jh.jh_sbthcd=#{jh.jh_sbthcd} or jh.jh_sbthcd=#{jh.jh_sbthcd}+2)
					</if>
	 				<if test="jh.sbnf!=null and jh.sbnf!=''">
	 					and jh.sbnf in (${jh.sbnf})
	 				</if>
	 				<if test="jh.sbzt!=null and jh.sbzt!=''">
	 					and jh.sbzt=#{jh.sbzt}
	 				</if>
	 				<if test="jh.kgzt!=null and jh.kgzt!=''">
	 					and jh.kgzt=#{jh.kgzt}
	 				</if>
	 				<if test="jh.jgzt!=null and jh.jgzt!=''">
	 					and jh.jgzt=#{jh.jgzt}
	 				</if>
	 				<if test="jh.spzt!=null and jh.spzt!=''">
	 					and jh.spzt=#{jh.spzt}
	 				</if>
	 				<if test="jh.sfylsjl!=null and jh.sfylsjl!=''">
			 			and sc.bzls=#{jh.sfylsjl}
				 	</if>
	 				<if test="lx.gydwbm!=null and lx.gydwbm!=''">
	 					and ${lx.gydwbm}
	 				</if>
	 				<if test="lx.xzqhdm!=null and lx.xzqhdm!=''">
	 					and ${lx.xzqhdm}
	 				</if>
	 				<if test="lx.lxmc!=null and lx.lxmc!=''">
	 					and lx.lxmc like '%'||#{lx.lxmc}||'%'
	 				</if>
	 				<if test="lx.lxbm!=null and lx.lxbm!=''">
	 					and lx.lxbm like '%'||#{lx.lxbm}||'%'
	 				</if>
	 				 <if test="lx.jsdj!=null and lx.jsdj!=''">
	 					${lx.jsdj}
	 				</if> 
	 				<if test="lx.gldj!=null and lx.gldj!=''">
	 					${lx.gldj}
	 				</if>
	 				<if test="lx.qlmc!=null and lx.qlmc!=''">
	 					and lx.qlmc like '%'||#{lx.qlmc}||'%'
	 				</if>
	 				<if test="lx.qlbh!=null and lx.qlbh!=''">
	 					and lx.qlbh like '%'||#{lx.qlbh}||'%'
	 				</if>
	 				<if test="lx.akjfl!=null and lx.akjfl!=''">
	 					${lx.akjfl}
	 				</if>
	 				<if test="lx.tsdq!=null and lx.tsdq!=''">
				 		${lx.tsdq}
				 	</if>
				 	<if test="lx.jsxz!=null and lx.jsxz!=''">
	 					and sc.jsxz like '%'||#{lx.jsxz}||'%'
	 				</if>
	 				order by jh.sbnf desc,jh.jh_sbthcd
	 			) t order by t.sbnf desc,t.jh_sbthcd
 			)
	</select>
	<!-- 此方法仅用于导出危桥资金下达Excel的查询 -->
	<select id="queryWqgzList2" parameterType="java.util.Map" resultMap="wqgz_jh">
		select * from 
			(
				select rownum as num,t.* from
				(
					select * from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) 
					left join xmk_wqgz lx on (sc.xmkid=lx.id) where 1=1 
					<if test="jh.sfylrbwqk!=null and jh.sfylrbwqk!=''">
	 					and jh.sfylrbwqk=#{jh.sfylrbwqk}
	 				</if>
					<if test="jh.sbnf!=null and jh.sbnf!=''">
	 					and jh.sbnf in (${jh.sbnf})
	 				</if>
	 				<if test="jh.jh_sbthcd!=null and jh.jh_sbthcd!=''">
						and jh.jh_sbthcd=#{jh.jh_sbthcd}
					</if>
	 				<if test="jh.kgzt!=null and jh.kgzt!=''">
	 					and jh.kgzt=#{jh.kgzt}
	 				</if>
	 				<if test="jh.jgzt!=null and jh.jgzt!=''">
	 					and jh.jgzt=#{jh.jgzt}
	 				</if>
	 				<if test="jh.sfylsjl!=null and jh.sfylsjl!=''">
			 			and sc.bzls=#{jh.sfylsjl}
				 	</if>
	 				<if test="lx.gydwbm!=null and lx.gydwbm!=''">
	 					and ${lx.gydwbm}
	 				</if>
	 				<if test="lx.xzqhdm!=null and lx.xzqhdm!=''">
	 					and ${lx.xzqhdm}
	 				</if>
	 				<if test="lx.lxmc!=null and lx.lxmc!=''">
	 					and lx.lxmc like '%'||#{lx.lxmc}||'%'
	 				</if>
	 				<if test="lx.lxbm!=null and lx.lxbm!=''">
	 					and lx.lxbm like #{lx.lxbm}||'%'
	 				</if>
	 				<if test="lx.jsdj!=null and lx.jsdj!=''">
	 					${lx.jsdj}
	 				</if> 
	 				<if test="lx.gldj!=null and lx.gldj!=''">
	 					${lx.gldj}
	 				</if>
	 				<if test="lx.qlmc!=null and lx.qlmc!=''">
	 					and lx.qlmc like '%'||#{lx.qlmc}||'%'
	 				</if>
	 				<if test="lx.akjfl!=null and lx.akjfl!=''">
	 					and lx.akjfl like #{lx.akjfl}||'%'
	 				</if>
	 				<if test="lx.tsdq!=null and lx.tsdq!=''">
				 		${lx.tsdq}
				 	</if>
				 	<if test="lx.jsxz!=null and lx.jsxz!=''">
	 					and sc.jsxz like '%'||#{lx.jsxz}||'%'
	 				</if>
	 				order by jh.sbzt,jh.spzt,jh.sbnf desc
	 			) t
 			)
	</select>
	<select id="queryWqgzByStatus" parameterType="java.util.Map" resultType="plan_wqgz">
		select * from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) 
		left join xmk_wqgz lx on (sc.xmkid=lx.id) where 1=1 and jh.sfylrbwqk='是'
		<if test="jh.jh_sbthcd!=null and jh.jh_sbthcd!='' and (jh.sbzt==null or jh.sbzt=='') and (jh.spzt==null or jh.spzt=='')">
			and jh.jh_sbthcd=#{jh.jh_sbthcd}
		</if>
		<if test="(jh.sbzt!=null or jh.spzt!=null) and (jh.sbzt!='' or jh.spzt!='') and jh.jh_sbthcd!=null and jh.jh_sbthcd!=''">
			and (jh.jh_sbthcd=#{jh.jh_sbthcd} or jh.jh_sbthcd=#{jh.jh_sbthcd}+2)
		</if>
		<if test="jh.sbnf!=null and jh.sbnf!=''">
	 		and jh.sbnf=#{jh.sbnf}
	 	</if>
	 	<if test="jh.sbzt!=null and jh.sbzt!=''">
	 		and jh.sbzt=#{jh.sbzt}
	 	</if>
	 	<if test="jh.spzt!=null and jh.spzt!=''">
	 		and jh.spzt=#{jh.spzt}
	 	</if>
	 	<if test="lx.gydwbm!=null and lx.gydwbm!=''">
	 		and ${lx.gydwbm}
	 	</if>
	</select>
	<select id="queryWqgzCount"  parameterType="java.util.Map"  resultType="int">
		select count(*) from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) 
		left join xmk_wqgz lx on (sc.xmkid=lx.id) where 1=1 and jh.sfylrbwqk='是' <!-- and lx.gydwbm like '2%' -->
	 	<if test="jh.jh_sbthcd!=null and jh.jh_sbthcd!='' and (jh.sbzt==null or jh.sbzt=='') and (jh.spzt==null or jh.spzt=='')">
			and jh.jh_sbthcd=#{jh.jh_sbthcd}
		</if>
		<if test="(jh.sbzt!=null or jh.spzt!=null) and (jh.sbzt!='' or jh.spzt!='') and jh.jh_sbthcd!=null and jh.jh_sbthcd!=''">
			and (jh.jh_sbthcd=#{jh.jh_sbthcd} or jh.jh_sbthcd=#{jh.jh_sbthcd}+2)
		</if>
	 	<if test="jh.sbnf!=null and jh.sbnf!=''">
	 					and jh.sbnf in (${jh.sbnf})
	 				</if>
	 				<if test="jh.sbzt!=null and jh.sbzt!=''">
	 					and jh.sbzt=#{jh.sbzt}
	 				</if>
	 				<if test="jh.kgzt!=null and jh.kgzt!=''">
	 					and jh.kgzt=#{jh.kgzt}
	 				</if>
	 				<if test="jh.jgzt!=null and jh.jgzt!=''">
	 					and jh.jgzt=#{jh.jgzt}
	 				</if>
	 				<if test="jh.spzt!=null and jh.spzt!=''">
	 					and jh.spzt=#{jh.spzt}
	 				</if>
	 				<if test="jh.sfylsjl!=null and jh.sfylsjl!=''">
			 			and sc.bzls=#{jh.sfylsjl}
				 	</if>
	 				<if test="lx.gydwbm!=null and lx.gydwbm!=''">
	 					and ${lx.gydwbm}
	 				</if>
	 				<if test="lx.xzqhdm!=null and lx.xzqhdm!=''">
	 					and ${lx.xzqhdm}
	 				</if>
	 				<if test="lx.lxmc!=null and lx.lxmc!=''">
	 					and lx.lxmc like '%'||#{lx.lxmc}||'%'
	 				</if>
	 				<if test="lx.lxbm!=null and lx.lxbm!=''">
	 					and lx.lxbm like '%'||#{lx.lxbm}||'%'
	 				</if>
	 				 <if test="lx.jsdj!=null and lx.jsdj!=''">
	 					${lx.jsdj}
	 				</if> 
	 				<if test="lx.gldj!=null and lx.gldj!=''">
	 					${lx.gldj}
	 				</if>
	 				<if test="lx.qlmc!=null and lx.qlmc!=''">
	 					and lx.qlmc like '%'||#{lx.qlmc}||'%'
	 				</if>
	 				<if test="lx.qlbh!=null and lx.qlbh!=''">
	 					and lx.qlbh like '%'||#{lx.qlbh}||'%'
	 				</if>
	 				<if test="lx.akjfl!=null and lx.akjfl!=''">
	 					${lx.akjfl}
	 				</if>
	 				<if test="lx.tsdq!=null and lx.tsdq!=''">
				 		${lx.tsdq}
				 	</if>
				 	<if test="lx.jsxz!=null and lx.jsxz!=''">
	 					and sc.jsxz like '%'||#{lx.jsxz}||'%'
	 				</if>
	 				<if test="lx.xmklx != null and lx.xmklx != ''">
	 					and lx.xmklx like '%'||#{lx.xmklx}||'%'
	 				</if>
	</select>
	<select id="querySumWqgz" parameterType="java.util.Map" resultType="plan_wqgz">
		select count(id) as id,sum(pfztz) as pfztz,sum(jhsybzje) as jhsybzje,
		sum(jhsydfzcje) as jhsydfzcje,sum(bz) pfwh from (
			select count(jh.id) as id,sum(jh.pfztz) as pfztz,sum(jh.jhsybzje) as jhsybzje,
			sum(jh.jhsydfzcje) as jhsydfzcje,decode(sum(xdzj),null,0,sum(xdzj)) bz 
			from xmk_wqgz lx right join sck_wqgz sc on (lx.id=sc.xmkid) 
			right join plan_wqgz jh on (sc.sckid=jh.sckid) left join plan_zjxd zj on jh.id=zj.xmid
			where 1=1 and jh.sfylrbwqk='是' <!-- and lx.gydwbm like '2%' -->
			<if test="jh.jh_sbthcd!=null and jh.jh_sbthcd!='' and (jh.sbzt==null or jh.sbzt=='') and (jh.spzt==null or jh.spzt=='')">
			and jh.jh_sbthcd=#{jh.jh_sbthcd}
		</if>
		<if test="(jh.sbzt!=null or jh.spzt!=null) and (jh.sbzt!='' or jh.spzt!='') and jh.jh_sbthcd!=null and jh.jh_sbthcd!=''">
			and (jh.jh_sbthcd=#{jh.jh_sbthcd} or jh.jh_sbthcd=#{jh.jh_sbthcd}+2)
		</if>
	 	<if test="jh.sbnf!=null and jh.sbnf!=''">
	 					and jh.sbnf in (${jh.sbnf})
	 				</if>
	 				<if test="jh.sbzt!=null and jh.sbzt!=''">
	 					and jh.sbzt=#{jh.sbzt}
	 				</if>
	 				<if test="jh.kgzt!=null and jh.kgzt!=''">
	 					and jh.kgzt=#{jh.kgzt}
	 				</if>
	 				<if test="jh.jgzt!=null and jh.jgzt!=''">
	 					and jh.jgzt=#{jh.jgzt}
	 				</if>
	 				<if test="jh.spzt!=null and jh.spzt!=''">
	 					and jh.spzt=#{jh.spzt}
	 				</if>
	 				<if test="jh.sfylsjl!=null and jh.sfylsjl!=''">
			 			and sc.bzls=#{jh.sfylsjl}
				 	</if>
	 				<if test="lx.gydwbm!=null and lx.gydwbm!=''">
	 					and ${lx.gydwbm}
	 				</if>
	 				<if test="lx.xzqhdm!=null and lx.xzqhdm!=''">
	 					and ${lx.xzqhdm}
	 				</if>
	 				<if test="lx.lxmc!=null and lx.lxmc!=''">
	 					and lx.lxmc like '%'||#{lx.lxmc}||'%'
	 				</if>
	 				<if test="lx.lxbm!=null and lx.lxbm!=''">
	 					and lx.lxbm like '%'||#{lx.lxbm}||'%'
	 				</if>
	 				 <if test="lx.jsdj!=null and lx.jsdj!=''">
	 					${lx.jsdj}
	 				</if> 
	 				<if test="lx.gldj!=null and lx.gldj!=''">
	 					${lx.gldj}
	 				</if>
	 				<if test="lx.qlmc!=null and lx.qlmc!=''">
	 					and lx.qlmc like '%'||#{lx.qlmc}||'%'
	 				</if>
	 				<if test="lx.qlbh!=null and lx.qlbh!=''">
	 					and lx.qlbh like '%'||#{lx.qlbh}||'%'
	 				</if>
	 				<if test="lx.akjfl!=null and lx.akjfl!=''">
	 					${lx.akjfl}
	 				</if>
	 				<if test="lx.tsdq!=null and lx.tsdq!=''">
				 		${lx.tsdq}
				 	</if>
				 	<if test="lx.jsxz!=null and lx.jsxz!=''">
	 					and sc.jsxz like '%'||#{lx.jsxz}||'%'
	 				</if>
	 				<if test="lx.xmklx != null and lx.xmklx != ''">
	 					and lx.xmklx like '%'||#{lx.xmklx}||'%'
	 				</if>
	 				 group by jh.id)
	</select>
	<select id="queryWqgzNfs"  resultType="treenode">
		select distinct t.sbnf as text from PLAN_wqgz t order by t.sbnf
	</select>
	<select id="queryWqgzById" parameterType="string" resultType="plan_wqgz">
		<!-- select * from plan_wqgz jh where jh.id=#{id} -->
		select 	id,sckid,sbnf,jhkgsj,jhwgsj, sjdw,sjpfdw,pfwh, pfsj,pfztz, jhsybzje, jhsydfzcje, sfsqablbz,ablbzsqwh, bz,tbsj,
	 tbbm,spzt,spbm,spsj,sbzt, sbbm, sbsj, xdsj,gkbgmc,gkbglj,sjsgtmc,sjsgtlj,sjkgsj,sjwgsj,sgdw,jldw,htje,sgxkwj,
	jgtcwj,jgyswj,wjsczt,kgzt,jgzt,yjjgsj,wjgyy, jsdw, jhxdwh, xdzt, xfzt,xfsj,xfbm,wjzt,wjsj,gys, sbbmdm,spbmdm,sfylsjl
	from plan_wqgz jh where jh.id=#{id} 
	</select>
	<select id="insertToSheet" parameterType="hashMap" resultType="sjbb">
		select xzqhdm v_0,
		       xzqhmc v_1,
		       sc.sck_lxbm v_2,
		       lxmc v_3,
		       sc.sck_qlbh v_4,
		       qlmc v_5,
		       sc.sck_qlzxzh v_6,
		       sc.jsxz v_7,
		       sc.jsnr v_8,
		       jh.sbnf v_9,
		       to_char(jh.jhkgsj, 'yyyy-mm-dd') v_10,
		       to_char(jh.jhwgsj, 'yyyy-mm-dd') v_11,
		       to_char(jh.xdsj, 'yyyy-mm-dd') v_12,
		       jh.sjdw v_13,
		       jh.sjpfdw v_14,
		       jh.pfwh v_15,
		       to_char(jh.pfsj, 'yyyy-mm-dd') v_16,
		       jh.pfztz v_17,
		       jh.jhsybzje v_18,
		       jh.jhsydfzcje v_19,
		       jh.sfsqablbz v_20,
		       jh.ablbzsqwh v_21,
		       jh.bz v_22
		  from sck_wqgz sc, xmk_wqgz xm, plan_wqgz jh
		  where sc.xmkid = xm.id
	  	  and jh.sckid = sc.sckid
		  and sck_sbzt = '已上报'
		  and jh.spzt='0'
		  and sck_sbthcd &lt;=#{sck_sbthcd} 
		  <if test="tbdw!=null and tbdw!=''">
		 	 and scbmbm like #{tbdw}||'%'
		  </if>
	</select>
	<select id="exportExcel_jh" parameterType="hashMap" resultType="elist">
		select rownum v_0,
       (select name from xtgl_xzqh where id=substr(lx.xzqhdm,0,4)||'00') v_1,lx.xzqhmc v_2,
        lx.xlxbm v_3,lx.xqlbm v_4,lx.xqlmc v_5,to_char(lx.xzxzh,'fm9999999990.000') v_6,
        lx.lxbm v_7,lx.qlbh v_8,lx.qlmc v_9,to_char(lx.qlzxzh,'fm9999999990.000') v_10,
        to_char(sc.scqlqc,'fm9999999990.000') v_11,to_char(sc.scqlqk,'fm9999999990.000') v_12,sc.jsxz v_13,
       nvl(jh.pfztz,0) v_14,nvl(jh.jhsybzje,0) v_15,nvl(jh.jhsydfzcje,0) v_16,
       sc.jsnr v_17,substr(jh.sjkgsj,0,4) v_18,substr(jh.sjwgsj,0,4) v_19,jh.pfwh v_20,
       lx.gydw v_21,jh.bz v_21,t.tsdq v_23
    from plan_wqgz jh
    left join sck_wqgz sc on (jh.sckid = sc.sckid)
    left join xmk_wqgz lx on (sc.xmkid = lx.id) 
    left join (select  replace(WMSYS.WM_CONCAT(distinct(to_char(t.name))),',',',') tsdq,x.xzqhdm 
                from xtgl_xzqhtsdq x left join xtgl_tsdq t on x.parent=t.id  group by x.xzqhdm) t 
               on lx.xzqhdm=t.xzqhdm
    where 1=1  and jh.sfylrbwqk='是'
		<if test="jh.jh_sbthcd!=null and jh.jh_sbthcd!='' and (jh.sbzt==null or jh.sbzt=='') and (jh.spzt==null or jh.spzt=='')">
			and jh.jh_sbthcd=#{jh.jh_sbthcd}
		</if>
		<if test="(jh.sbzt!=null or jh.spzt!=null) and (jh.sbzt!='' or jh.spzt!='') and jh.jh_sbthcd!=null and jh.jh_sbthcd!=''">
			and (jh.jh_sbthcd=#{jh.jh_sbthcd} or jh.jh_sbthcd=#{jh.jh_sbthcd}+2)
		</if>
	 	<if test="jh.sbnf!=null and jh.sbnf!=''">
	 		and jh.sbnf in (${jh.sbnf})
	 	</if>
	 	<if test="jh.sbzt!=null and jh.sbzt!=''">
	 		and jh.sbzt=#{jh.sbzt}
	 	</if>
	 	<if test="jh.kgzt!=null and jh.kgzt!=''">
	 		and jh.kgzt=#{jh.kgzt}
	 	</if>
	 	<if test="jh.jgzt!=null and jh.jgzt!=''">
	 		and jh.jgzt=#{jh.jgzt}
	 	</if>
	 	<if test="jh.spzt!=null and jh.spzt!=''">
	 		and jh.spzt=#{jh.spzt}
	 	</if>
	 	<if test="jh.sfylsjl!=null and jh.sfylsjl!=''">
			and sc.bzls=#{jh.sfylsjl}
		</if>
	 	<if test="lx.gydwbm!=null and lx.gydwbm!=''">
	 		and ${lx.gydwbm}
	 	</if>
	 	<if test="lx.xzqhdm!=null and lx.xzqhdm!=''">
	 		and ${lx.xzqhdm}
	 	</if>
	 	<if test="lx.lxmc!=null and lx.lxmc!=''">
	 		and lx.lxmc like '%'||#{lx.lxmc}||'%'
	 	</if>
	 	<if test="lx.lxbm!=null and lx.lxbm!=''">
	 		and lx.lxbm like #{lx.lxbm}||'%'
	 	</if>
	 	<if test="lx.jsdj!=null and lx.jsdj!=''">
			${lx.jsdj}
		</if> 
		<if test="lx.gldj!=null and lx.gldj!=''">
			${lx.gldj}
		</if>
	 	<if test="lx.qlmc!=null and lx.qlmc!=''">
	 		and lx.qlmc like '%'||#{lx.qlmc}||'%'
	 	</if>
	 	<if test="lx.akjfl!=null and lx.akjfl!=''">
	 		${lx.akjfl}
	 	</if>
	 	<if test="lx.tsdq!=null and lx.tsdq!=''">
	 		${lx.tsdq}
	 	</if>
	 	<if test="lx.jsxz!=null and lx.jsxz!=''">
			and sc.jsxz like '%'||#{lx.jsxz}||'%'
		</if>
		<if test="lx.xmklx != null and lx.xmklx != ''">
	 		and lx.xmklx like '%'||#{lx.xmklx}||'%'
	 	</if>
	</select>
	
	<delete id="dropWqgzById" parameterType="string">
		delete from plan_wqgz jh where jh.id=#{id}
	</delete>
	<delete id="qkWqsfjhlist" parameterType="string">
		update sck_wqgz set sfjh=null where sckid in ( select sckid from plan_wqgz jh where jh.id=#{id})
	</delete>
	<update id="editWqgzById" parameterType="plan_wqgz">
		update plan_wqgz set sbnf=#{sbnf}
		<if test="jhkgsj!=null and jhkgsj!=''">,jhkgsj=#{jhkgsj}</if>
		<if test="sfylrbwqk!=null and sfylrbwqk!=''">,sfylrbwqk=#{sfylrbwqk}</if>
		<if test="jhwgsj!=null and jhwgsj!=''">,jhwgsj=#{jhwgsj}</if>
		<if test="xdsj!=null and xdsj!=''">,xdsj=#{xdsj}</if>
		<if test="pfsj!=null and pfsj!=''">,pfsj=#{pfsj}</if>
		<if test="jhxdwh!=null">,jhxdwh=#{jhxdwh}</if>
		<if test="sjdw!=null">,sjdw=#{sjdw}</if>
		<if test="sjpfdw!=null">,sjpfdw=#{sjpfdw}</if>
		<if test="pfwh!=null">,pfwh=#{pfwh}</if>
		<if test="pfztz!=null">,pfztz=#{pfztz}</if>
		<if test="jhsybzje!=null">,jhsybzje=#{jhsybzje}</if>
		<if test="jhsydfzcje!=null">,jhsydfzcje=#{jhsydfzcje}</if>
		<if test="sfsqablbz!=null">,sfsqablbz=#{sfsqablbz}</if>
		<if test="ablbzsqwh!=null">,ablbzsqwh=#{ablbzsqwh}</if>
		<if test="bz!=null">,bz=#{bz}</if>
		where id=#{id}
	</update>
	<update id="editWqgzSckxx" parameterType="sckwqgz">
		update SCK_WQGZ set sckid=#{sckid}
		<if test="scqlqk!=null">,scqlqk=#{scqlqk}</if>
		<if test="scqlqc!=null">,scqlqc=#{scqlqc}</if>
		<if test="faspsj!=null">,faspsj=#{faspsj}</if>
		<if test="fapgdw!=null">,fapgdw=#{fapgdw}</if>
		<if test="fascdw!=null">,fascdw=#{fascdw}</if>
		<if test="spwh!=null">,spwh=#{spwh}</if>
		<if test="tzgs!=null">,tzgs=#{tzgs}</if>
		<if test="jsxz!=null">,jsxz=#{jsxz}</if>
		<if test="jsnr!=null">,jsnr=#{jsnr}</if>
		<if test="scbz!=null">,scbz=#{scbz}</if>
		where sckid=#{sckid}
	</update>
	<update id="editWqgzStatus" parameterType="plan_wqgz">
		update plan_wqgz set 
			<if test="sbbm!=null and sbbm!=''">sbbm=#{sbbm},</if>
			<if test="sbbmdm!=null and sbbmdm!=''">sbbmdm=#{sbbmdm},</if>
			<if test="sbsj!=null and sbsj!=''">sbsj=#{sbsj},</if>
			<if test="sbzt!=null and sbzt!=''">sbzt=#{sbzt},</if>
			<if test="spbm!=null and spbm!=''">spbm=#{spbm},</if>
			<if test="spbmdm!=null and spbmdm!=''">spbmdm=#{spbmdm},</if>
			<if test="spsj!=null and spsj!=''">spsj=#{spsj},</if>
			<if test="spzt!=null and spzt!=''">spzt=#{spzt},</if>
			jh_sbthcd=#{jh_sbthcd}
		where id=#{id}
	</update>
	<!-- <insert id="importWqgz_jh" parameterType="hashMap">
		insert into PLAN_WQGZ(id,sckid,sbnf,jhkgsj,jhwgsj,xdsj,sjdw,sjpfdw,pfwh,pfsj,pfztz,jhsybzje,jhsydfzcje,sfsqablbz,ablbzsqwh,bz,xdzt)
		values(sys_guid(),(select id from xmk_wqgz where lxbm=#{2}  and qlbh=#{4} and qlzxzh=#{6}),#{9},to_date(#{10},'yyyy-mm-dd'),to_date(#{11},'yyyy-mm-dd'),to_date(#{12},'yyyy-mm-dd'),#{13},#{14},#{15},to_date(#{16},'yyyy-mm-dd'),#{17},#{18},#{19},#{20},#{21},#{22},'0')
	</insert> -->
	<update id="importWqgz_jh" parameterType="hashMap">
		update PLAN_WQGZ set sbnf=#{9},jhkgsj=to_date(#{10},'yyyy-mm-dd'),jhwgsj=to_date(#{11},'yyyy-mm-dd'),xdsj=to_date(#{12},'yyyy-mm-dd'),sjdw=#{13},sjpfdw=#{14},pfwh=#{15},pfsj=to_date(#{16},'yyyy-mm-dd'),pfztz=#{17},jhsybzje=#{18},jhsydfzcje=#{19},sfsqablbz=#{20},ablbzsqwh=#{21},bz=#{22}
		where sckid = (select sckid from sck_wqgz where sck_lxbm=#{2}  and sck_qlbh=#{4} and sck_qlzxzh=#{6})
	</update>
	<update id="updateLrztBySckid" parameterType="java.util.List">
 		update sck_wqgz set lrjh='未列入'  where sckid=#{String}
 	</update>
 	<select id="queryJckWqgz" parameterType="String" resultType="plan_wqgz">
		select * from xmk_wqgz where qlbh=#{String}
	</select>
	<insert id="insertwqFile" parameterType="plan_upload">
		insert into plan_upload(filename,filedata,parentid,filetype) 
		values(#{filename},#{filedata},#{parentid},#{filetype})
	</insert>
 	<select id="queryWqgzFjById" parameterType="string" resultType="plan_wqgz">
		select gkbgmc,gkbgdata,sjsgtmc,sjsgtdata from plan_wqgz jh where jh.id=#{id}
	</select>
	<select id="queryJcktj" resultType="treenode">
		select substr(xm.xzqhdm,0,length(${id})) as id,count(xm.xzqhdm),sum(xm.qlqc) 
		from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) left join xmk_wqgz xm 
		on (sc.xmkid=xm.id) left join  xtgl_xzqh xt on (xm.xzqhdm=xt.id)
		where xm.xzqhdm like ${id}||'%' group by substr(xm.xzqhdm,0,length(${id}))
		<!-- select t1.*,xz.name from (
			select t.parent as id,<![CDATA[count(t.parent)-1]]> as text,NVL(sum(t.qlqc),0) as parent
			from (
			      select distinct xt.parent,jck.xzqhdm,jck.qlqc 
			      from xmk_wqgz jck right join xtgl_xzqh xt on (jck.xzqhdm=xt.id) 
			      order by xt.parent
			) t where t.parent is not null group by t.parent order by t.parent
		)  t1 join xtgl_xzqh xz on (t1.id=xz.id)  order by t1.id -->
	</select>
	<select id="queryJcktj1" resultType="treenode" parameterType="java.util.Map">
		select t.parent as id,xz.name as name,NVL(sum(t.je),0) as text,sum(t.sl) as parent from (
			select distinct xt.parent,jh.sbnf,jhsybzje,
      		(select jhsybzje from plan_wqgz ab1 left join sck_wqgz sc1 on 
      		(ab1.sckid=sc1.sckid) left join xmk_wqgz lx1 on (sc1.xmkid=lx1.id) where ab1.sbnf=#{nf} and ab1.id=jh.id) as je,
      		(select count(jhsybzje) from plan_wqgz ab1 left join sck_wqgz sc1 on 
			(ab1.sckid=sc1.sckid) left join xmk_wqgz lx1 on (sc1.xmkid=lx1.id) where ab1.sbnf=#{nf} and ab1.id=jh.id) as sl
			from plan_wqgz jh left join sck_wqgz sc on 
			(jh.sckid=sc.sckid) left join xmk_wqgz lx on (sc.xmkid=lx.id) right join xtgl_xzqh xt on (lx.xzqhdm=xt.id)
			where xt.parent is not null and jh.sfylrbwqk='是'
		) t join xtgl_xzqh xz on (t.parent=xz.id)
		group by t.parent,xz.name order by t.parent
	</select>
	<select id="queryJhktj2" resultType="treenode" parameterType="java.util.Map">
		select t.sbnf as id,sum(t.jhsybzje) as text,count(t.jhsybzje) as name from (
		select distinct jh.id,jh.sbnf,jh.jhsybzje from 
		plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) 
		left join xmk_wqgz lx on (sc.xmkid=lx.id) 
		where lx.xzqhdm like rtrim(#{xzqhdm},'0')||'%' and jh.sfylrbwqk='是' and jh.sbnf>=#{start} and <![CDATA[jh.sbnf<=#{end}]]>) t
		group by t.sbnf
	</select>
	<select id="queryJhktjt2" resultType="treenode" parameterType="java.util.Map">
		select NVL(sum(t.jhsybzje),0) from (
		select distinct jh.id,jh.sbnf,jh.jhsybzje from 
		plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) 
		left join xmk_wqgz lx on (sc.xmkid=lx.id) 
		where lx.xzqhdm like #{xzqhdm} and jh.sfylrbwqk='是' and jh.sbnf=#{nf}) t
		group by t.sbnf
	</select>
	<select id="queryJhktjt3" resultType="treenode" parameterType="java.util.Map">
		select sbnf as name,sum(jhsybzje) as text from (
			select distinct jh.id,jh.sbnf,jh.jhsybzje 
			from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) 
    		left join xmk_wqgz lx on (sc.xmkid=lx.id) 
    		where jh.sbnf>=#{start} and jh.sfylrbwqk='是' and <![CDATA[jh.sbnf<=#{end}]]> and lx.xzqhdm like #{xzqhdm}) 
    		group by sbnf
	</select>
	<select id="queryGcktj" resultType="treenode" parameterType="java.util.Map">
		select (r.kgzt+r.jgzt) as id,count(r.kgzt+r.jgzt) as name,sum(r.jhsybzje) as text,sum(r.btz+r.qttz) as parent from (
			select jh_lx.id,jh_lx.kgzt,jh_lx.jgzt,jh_lx.jhsybzje,sum(nvl(gcgl.wc_btz,0)) as btz,sum(nvl(gcgl.wc_qttz,0)) as qttz from gcgl_wqgz gcgl 
				right join (select jh.id,jh.kgzt,jh.jgzt,jh.jhsybzje from  plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) 
    			left join xmk_wqgz lx on (sc.xmkid=lx.id) where lx.xzqhdm like #{xzqhdm} and jh.sfylrbwqk='是' and jh.sbnf=#{nf} and jh.spzt='1' and jh.jh_sbthcd='6') jh_lx on gcgl.jhid=jh_lx.id
    	group by jh_lx.id,jh_lx.kgzt,jh_lx.jgzt,jh_lx.jhsybzje) r group by r.kgzt,r.jgzt order by r.kgzt,r.jgzt
	</select>
	<select id="queryGcktjt" resultType="treenode" parameterType="java.util.Map">
		select nvl(sum(r.jhsybzje),0) as text,nvl(sum(r.btz+r.qttz),0) as parent from (
			select jh_lx.id,jh_lx.kgzt,jh_lx.jgzt,jh_lx.jhsybzje,sum(nvl(gcgl.wc_btz,0)) as btz,sum(nvl(gcgl.wc_qttz,0)) as qttz from gcgl_wqgz gcgl 
				right join (select jh.id,jh.kgzt,jh.jgzt,jh.jhsybzje from  plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) 
    			left join xmk_wqgz lx on (sc.xmkid=lx.id) 
    			where jh.spzt='1' and jh.jh_sbthcd='6'  and jh.sfylrbwqk='是'
    			<if test="xzqhdm!=null and xzqhdm!=''">
    				and lx.xzqhdm like #{xzqhdm}
    			</if>) jh_lx on gcgl.jhid=jh_lx.id
    	group by jh_lx.id,jh_lx.kgzt,jh_lx.jgzt,jh_lx.jhsybzje) r
	</select>
	<select id="queryGcktj2" resultType="treenode" parameterType="java.util.Map">
		select nvl(sum(r.bn),0) as id,count(r.bn) as name,nvl(sum(r.fbn),0) as text,count(r.fbn) as parent from (
			select jh.id,jh.kgzt,jh.jgzt,
				(select a.jhsybzje from plan_wqgz a where a.sbnf=#{nf} and a.id=jh.id) as bn,
				(select a.jhsybzje from plan_wqgz a where #{nf}>a.sbnf and a.id=jh.id) as fbn 
			from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) 
			left join xmk_wqgz lx on (sc.xmkid=lx.id) 
			where jh.spzt='1' and jh.jh_sbthcd='6' and jh.sfylrbwqk='是'
		and lx.xzqhdm like #{xzqhdm}) r
	</select>
	<select id="queryWqLs" parameterType="jckwqgz" resultMap="wqgz_jh">
		select jh.id,jh.sbnf,lx.qlmc,lx.qlzxzh from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) 
    	left join xmk_wqgz lx on (sc.xmkid=lx.id) where (lx.qlbh=#{qlbh} or
    	(lx.lxbm=#{lxbm} and lx.qlzxzh=#{qlzxzh})) and jh.id!=#{id} and jh.sfylrbwqk='是'
	</select>
	<update id="editZjById" parameterType="plan_wqgz">
		update plan_wqgz jh set jh.pfztz=#{pfztz},jh.jhsybzje=#{jhsybzje},jh.jhsydfzcje=#{jhsydfzcje}
		where jh.id=#{id}
	</update>
	<select id="exportExcelWqgzJhSh" parameterType="java.util.Map" resultType="plan_wqgz">
		select * from 
			(
				select rownum as num,t.* from
				(
					select jh.id,sc.sckid,lx.xzqhmc,lx.gydw,lx.lxbm,lx.lxmc,lx.qlbh,lx.qlmc,lx.qlzxzh,sc.scqlqc,sc.scqlqk,sc.fapgdw,sc.fascdw,sc.faspsj,sc.spwh,sc.tzgs,sc.jsxz,sc.jsnr,sc.scbz,
					jh.sbnf, jh.jhkgsj  jhkgsj1, jh.jhwgsj  jhwgsj1,jh.sjdw,jh.sjpfdw,jh.pfwh, jh.pfsj pfsj1,jh.sfsqablbz,jh.ablbzsqwh,jh.pfztz,jh.jhsybzje,jh.jhsydfzcje,jh.bz
					from plan_wqgz jh left join sck_wqgz sc on (jh.sckid=sc.sckid) left join xmk_wqgz lx on (sc.xmkid=lx.id) 
					where 1=1 and jh.sfylrbwqk='是'
	 				<if test="jh.jh_sbthcd!=null and jh.jh_sbthcd!='' and (jh.sbzt==null or jh.sbzt=='') and (jh.spzt==null or jh.spzt=='')">
						and jh.jh_sbthcd=#{jh.jh_sbthcd}
					</if>
				    <if test="(jh.sbzt!=null or jh.spzt!=null) and (jh.sbzt!='' or jh.spzt!='') and jh.jh_sbthcd!=null and jh.jh_sbthcd!=''">
						and (jh.jh_sbthcd=#{jh.jh_sbthcd} or jh.jh_sbthcd=#{jh.jh_sbthcd}+2)
					</if>
	 				<if test="jh.sbnf!=null and jh.sbnf!=''">
	 					and jh.sbnf=#{jh.sbnf}
	 				</if>
	 				<if test="jh.sbzt!=null and jh.sbzt!=''">
	 					and jh.sbzt=#{jh.sbzt}
	 				</if>
	 				<if test="jh.kgzt!=null and jh.kgzt!=''">
	 					and jh.kgzt=#{jh.kgzt}
	 				</if>
	 				<if test="jh.jgzt!=null and jh.jgzt!=''">
	 					and jh.jgzt=#{jh.jgzt}
	 				</if>
	 				<if test="jh.spzt!=null and jh.spzt!=''">
	 					and jh.spzt=#{jh.spzt}
	 				</if>
	 				<if test="jh.sfylsjl!=null and jh.sfylsjl!=''">
			 			and sc.bzls=#{jh.sfylsjl}
				 	</if>
	 				<if test="lx.gydwbm!=null and lx.gydwbm!=''">
	 					and ${lx.gydwbm}
	 				</if>
	 				<if test="lx.xzqhdm!=null and lx.xzqhdm!=''">
	 					and ${lx.xzqhdm}
	 				</if>
	 				<if test="lx.lxmc!=null and lx.lxmc!=''">
	 					and lx.lxmc like '%'||#{lx.lxmc}||'%'
	 				</if>
	 				<if test="lx.lxbm!=null and lx.lxbm!=''">
	 					and lx.lxbm like #{lx.lxbm}||'%'
	 				</if>
	 				<!-- <if test="lx.jsdj!=null and lx.jsdj!=''">
	 					and lx.jsdj = #{lx.jsjd}
	 				</if> -->
	 				<if test="lx.qlmc!=null and lx.qlmc!=''">
	 					and lx.qlmc like '%'||#{lx.qlmc}||'%'
	 				</if>
	 				<if test="lx.akjfl!=null and lx.akjfl!=''">
	 					and lx.akjfl like #{lx.akjfl}||'%'
	 				</if>
	 				<if test="lx.tsdq!=null and lx.tsdq!=''">
				 		and lx.xzqhdm in (select t.xzqhdm from xtgl_xzqhtsdq t where t.parent =#{lx.tsdq})
				 	</if>
	 				order by jh.sbnf desc,jh.jh_sbthcd
	 			) t order by t.sbnf desc
 			)
	</select>
	<update id="updateImportWqgzJh" parameterType="plan_wqgz">
		update plan_wqgz set 
		<if test="sbnf!=null">sbnf=#{sbnf},</if>
		<if test="jhkgsj1!=null">jhkgsj=to_date(#{jhkgsj1},'yyyy-mm-dd'),</if>
		<if test="jhwgsj1!=null">jhwgsj=to_date(#{jhwgsj1},'yyyy-mm-dd'),</if>
		<if test="sjdw!=null">sjdw=#{sjdw},</if>
		<if test="sjpfdw!=null">sjpfdw=#{sjpfdw},</if>
		<if test="pfwh!=null">pfwh=#{pfwh},</if>
		<if test="pfsj1!=null and pfsj1!=''">pfsj=to_date(#{pfsj1},'yyyy-MM-dd'),</if>
		<if test="sfsqablbz!=null">sfsqablbz=#{sfsqablbz},</if>
		<if test="ablbzsqwh!=null">ablbzsqwh=#{ablbzsqwh},</if>
		<if test="pfztz!=null">pfztz=#{pfztz},</if>
		<if test="jhsybzje!=null">jhsybzje=#{jhsybzje},</if>
		<if test="jhsydfzcje!=null">jhsydfzcje=#{jhsydfzcje},</if>
		<if test="bz!=null">bz=#{bz},</if>
		id=#{id}
		where id=#{id}
	</update>
	<update id="updateImportWqgzSh" parameterType="plan_wqgz">
		update sck_wqgz set 
		<if test="scqlqk!=null">scqlqk=#{scqlqk},</if>
		<if test="scqlqc!=null">scqlqc=#{scqlqc},</if>
		<if test="fapgdw!=null">fapgdw=#{fapgdw},</if>
		<if test="fascdw!=null">fascdw=#{fascdw},</if>
		<if test="faspsj!=null">faspsj=#{faspsj},</if>
		<if test="spwh!=null">spwh=#{spwh},</if>
		<if test="tzgs!=null">tzgs=#{tzgs},</if>
		<if test="jsxz!=null">jsxz=#{jsxz},</if>
		<if test="jsnr!=null">jsnr=#{jsnr},</if>
		<if test="scbz!=null">scbz=#{scbz},</if>
		sckid=#{sckid}
		where sckid=#{sckid}
	</update>
</mapper>
