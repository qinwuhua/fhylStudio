<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.gcybb">
	<select id="getWqgzybb" parameterType="gcglwqgz" resultType="hashmap">
		select  t3.qlmc v_0,t3.qlbh v_1,t3.qlzxzh v_2,t3.lxbm v_3,t3.lxmc v_4,t3.jsdj v_5,t3.qlqc v_6,t3.kjzc v_7,
		t3.dkzdkj v_8,t3.qlkd v_9,t3.sbjgxs v_10,t3.akjfl,t3.xjgjnd v_13,t3.pddj,t1.pfztz v_16,t1.jhsybzje v_17,
		t1.jhsydfzcje v_18,t4.wc_btz+t4.wc_qttz v_19,t4.wc_btz v_20,t4.wc_qttz v_21,(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_22 ,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_23,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_24,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_25,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_26,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_27,
		t2.jsxz v_34,to_char(t1.jhkgsj,'YYYY') v_35,to_char(t1.jhwgsj,'YYYY') v_36,t2.jsnr v_37,t3.xzqhmc,t3.xmnf
				from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id 
				left join GCGL_WQGZ t4 on t4.jhid=t1.SCKID
					where  
					t1.SCKID in (select jhid from gcgl_wqgz where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			order by t3.xzqhmc,t3.xmnf desc
	</select>
	
	<select id="getWqgzxzqh" parameterType="gcglwqgz" resultType="hashmap">
		select distinct(substr(t3.xzqhdm,0,4)) xzqhdm,substr(t3.xzqhmc,0,3) xzqhmc
				from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id 
				left join GCGL_WQGZ t4 on t4.jhid=t1.SCKID
					where  
					t1.SCKID in (select jhid from gcgl_wqgz where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
	</select>
	<select id="getWqgznf" parameterType="gcglwqgz" resultType="hashmap">
		select t3.xmnf
				from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id 
				left join GCGL_WQGZ t4 on t4.jhid=t1.SCKID
					where  
					t1.SCKID in (select jhid from gcgl_wqgz where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			group by t3.xmnf
			order by t3.xmnf 
	</select>
		<select id="getwqgzlist1" parameterType="gcglwqgz" resultType="elist">
		select sum(t5.v_6) v_6,sum(t5.v_7) v_7,sum(t5.v_8) v_8,sum(t5.v_9) v_9,sum(t5.v_16) v_16,sum(t5.v_17) v_17,sum(t5.v_18) v_18,sum(t5.v_19) v_19,sum(t5.v_20) v_20,sum(t5.v_21) v_21,sum(t5.v_22) v_22,sum(t5.v_23) v_23,sum(t5.v_24) v_24,sum(t5.v_25) v_25,sum(t5.v_26) v_26,sum(t5.v_27) v_27
		from(
		select  t3.qlmc v_0,t3.qlbh v_1,t3.qlzxzh v_2,t3.lxbm v_3,t3.lxmc v_4,t3.jsdj v_5,t3.qlqc v_6,t3.kjzc v_7,
		t3.dkzdkj v_8,t3.qlkd v_9,t3.sbjgxs v_10,t3.akjfl,t3.xjgjnd v_13,t3.pddj,t1.pfztz v_16,t1.jhsybzje v_17,
		t1.jhsydfzcje v_18,t4.wc_btz+t4.wc_qttz v_19,t4.wc_btz v_20,t4.wc_qttz v_21,(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_22 ,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_23,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_24,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_25,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_26,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_27,
		t2.jsxz v_34,to_char(t1.jhkgsj,'YYYY') v_35,to_char(t1.jhwgsj,'YYYY') v_36,t2.jsnr v_37,t3.xzqhmc,t3.xmnf
				from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id 
				left join GCGL_WQGZ t4 on t4.jhid=t1.SCKID
					where  
					t1.SCKID in (select jhid from gcgl_wqgz where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
			order by t3.xzqhmc,t3.xmnf
			) t5
			where 1=1
			<if test="xmnf != null and  xmnf != ''">
					and t5.xmnf like '%'||trim(#{xmnf})||'%'
			</if>
			
	</select>
	
	<select id="getwqgzlist3" parameterType="gcglwqgz" resultType="elist">
		select sum(t5.v_6) v_6,sum(t5.v_7) v_7,sum(t5.v_8) v_8,sum(t5.v_9) v_9,sum(t5.v_16) v_16,sum(t5.v_17) v_17,sum(t5.v_18) v_18,sum(t5.v_19) v_19,sum(t5.v_20) v_20,sum(t5.v_21) v_21,sum(t5.v_22) v_22,sum(t5.v_23) v_23,sum(t5.v_24) v_24,sum(t5.v_25) v_25,sum(t5.v_26) v_26,sum(t5.v_27) v_27
		from(
		select  t3.qlmc v_0,t3.qlbh v_1,t3.qlzxzh v_2,t3.lxbm v_3,t3.lxmc v_4,t3.jsdj v_5,t3.qlqc v_6,t3.kjzc v_7,
		t3.dkzdkj v_8,t3.qlkd v_9,t3.sbjgxs v_10,t3.akjfl,t3.xjgjnd v_13,t3.pddj,t1.pfztz v_16,t1.jhsybzje v_17,
		t1.jhsydfzcje v_18,t4.wc_btz+t4.wc_qttz v_19,t4.wc_btz v_20,t4.wc_qttz v_21,(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_22 ,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_23,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_24,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_25,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_26,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_27,
		t2.jsxz v_34,to_char(t1.jhkgsj,'YYYY') v_35,to_char(t1.jhwgsj,'YYYY') v_36,t2.jsnr v_37,t3.xzqhmc,t3.xmnf
				from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id 
				left join GCGL_WQGZ t4 on t4.jhid=t1.SCKID
					where  
					t1.SCKID in (select jhid from gcgl_wqgz where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			order by t3.xzqhmc,t3.xmnf
			) t5
			where 1=1
			
			
	</select>
	<select id="getwqgzlist4" parameterType="gcglwqgz" resultType="elist">
		select  t3.qlmc v_0,t3.qlbh v_1,t3.qlzxzh v_2,t3.lxbm v_3,t3.lxmc v_4,t3.jsdj v_5,t3.qlqc v_6,t3.kjzc v_7,
		t3.dkzdkj v_8,t3.qlkd v_9,t3.sbjgxs v_10,(case when t3.akjfl='大桥' then '大桥' else '' end) v_11,(case when t3.akjfl='小桥' then '小桥' else '' end) v_12,t3.xjgjnd v_13,(case when t3.pddj='四类' then '四类' else '' end) v_14,(case when t3.pddj='五类' then '五类' else '' end) v_15,t1.pfztz v_16,t1.jhsybzje v_17,
		t1.jhsydfzcje v_18,t4.wc_btz+t4.wc_qttz v_19,t4.wc_btz v_20,t4.wc_qttz v_21,(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_22 ,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_23,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf} ) v_24,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} )+(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_25,
		(select sum(wc_btz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_26,
		(select sum(wc_qttz) from gcgl_wqgz where jhid=t1.sckid and sbyf &lt;= #{sbyf} ) v_27,
		t2.jsxz v_34,to_char(t1.jhkgsj,'YYYY') v_35,to_char(t1.jhwgsj,'YYYY') v_36,t2.jsnr v_37,t3.xzqhmc,t3.xmnf
				from PLAN_WQGZ t1 left join SCK_WQGZ  t2 on t1.SCKID=t2.SCKID left join XMK_WQGZ t3 on t2.xmkid=t3.id 
				left join GCGL_WQGZ t4 on t4.jhid=t1.SCKID
					where  
					t1.SCKID in (select jhid from gcgl_wqgz where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="xmnf != null and  xmnf != ''">
					and t3.xmnf like '%'||trim(#{xmnf})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
			order by t3.xzqhmc
	</select>
	<!-- 安保 -->
	<select id="getabgcybb" parameterType="gcglabgc" resultType="hashmap">
		select t3.lxbm v_0,t3.lxmc v_1,t3.qdzh v_2,t3.zdzh v_3,t3.lxjsdj v_4,t3.gjxjnd v_5,t1.pfztz v_6,t1.JHSYBBZJE v_7,
		t1.JHSYDFZCZJ v_8,t3.yhnr v_9,t2.jsxz v_10,t1.JHWC_C v_11,t3.YHLC v_12,t1.JHKGSJ v_13,t1.JHWGSJ v_14,
		(select BYWC_C from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_15,
		(select BYWC_GL from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_16,
		(select sum(BYWC_C) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_17,
		(select sum(BYWC_GL) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_18,
		(select sum(BYWC_C) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_19,
		(select sum(BYWC_GL) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_20,
		(select WC_BTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf})+(select WC_QTTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_21,
		(select WC_BTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_22,
		(select WC_QTTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_23,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_24,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_25,
		(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_26,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_27,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_28,
		(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_29,
		t2.jsnr v_30	
		from PLAN_ABGC t1 left join SCK_ABGC  t2 on t1.SCKID=t2.SCKID left join XMK_ABGC t3 on t2.xmkid=t3.id 
		left join GCGL_ABGC t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ABGC where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
	</select>
	
	<select id="getabgclist1" parameterType="gcglabgc" resultType="elist">
	select sum(t5.v_6) v_6,sum(t5.v_7) v_7,sum(t5.v_8) v_8,sum(t5.v_11) v_11,sum(t5.v_12) v_12,sum(t5.v_15) v_15,sum(t5.v_16) v_16,sum(t5.v_17) v_17,sum(t5.v_18) v_18,sum(t5.v_19) v_19,sum(t5.v_20) v_20,sum(t5.v_21) v_21,sum(t5.v_22) v_22,sum(t5.v_23) v_23,sum(t5.v_24) v_24,sum(t5.v_25) v_25,sum(t5.v_26) v_26,sum(t5.v_27) v_27,sum(t5.v_28) v_28,sum(t5.v_29) v_29
	from(
		select  
		t3.lxbm v_0,t3.lxmc v_1,t3.qdzh v_2,t3.zdzh v_3,t3.lxjsdj v_4,t3.gjxjnd v_5,t1.pfztz v_6,t1.JHSYBBZJE v_7,
		t1.JHSYDFZCZJ v_8,t3.yhnr v_9,t2.jsxz v_10,t1.JHWC_C v_11,t3.YHLC v_12,t1.JHKGSJ v_13,t1.JHWGSJ v_14,
		(select BYWC_C from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_15,
		(select BYWC_GL from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_16,
		(select sum(BYWC_C) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_17,
		(select sum(BYWC_GL) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_18,
		(select sum(BYWC_C) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_19,
		(select sum(BYWC_GL) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_20,
		(select WC_BTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf})+(select WC_QTTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_21,
		(select WC_BTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_22,
		(select WC_QTTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_23,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_24,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_25,
		(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_26,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_27,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_28,
		(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_29,
		t2.jsnr v_30,t3.xmnf	
		from PLAN_ABGC t1 left join SCK_ABGC  t2 on t1.SCKID=t2.SCKID left join XMK_ABGC t3 on t2.xmkid=t3.id 
		left join GCGL_ABGC t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ABGC where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
			) t5 where 1=1
			<if test="xmnf != null and  xmnf != ''">
					and t5.xmnf like '%'||trim(#{xmnf})||'%'
			</if>
	</select>
	
	<select id="getAbgcxzqh" parameterType="gcglabgc" resultType="hashmap">
		select distinct(substr(t3.xzqhdm,0,4)) xzqhdm,substr(t3.xzqhmc,0,3) xzqhmc
		from PLAN_ABGC t1 left join SCK_ABGC  t2 on t1.SCKID=t2.SCKID left join XMK_ABGC t3 on t2.xmkid=t3.id 
		left join GCGL_ABGC t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ABGC where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
	</select>
	<select id="getAbgcnf" parameterType="gcglabgc" resultType="hashmap">
		select t3.xmnf
		from PLAN_ABGC t1 left join SCK_ABGC  t2 on t1.SCKID=t2.SCKID left join XMK_ABGC t3 on t2.xmkid=t3.id 
		left join GCGL_ABGC t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ABGC where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			group by t3.xmnf
			order by t3.xmnf
	</select>
	<select id="getabgclist4" parameterType="gcglabgc" resultType="elist">
		select t3.lxbm v_0,t3.lxmc v_1,t3.qdzh v_2,t3.zdzh v_3,t3.lxjsdj v_4,t3.gjxjnd v_5,t1.pfztz v_6,t1.JHSYBBZJE v_7,
		t1.JHSYDFZCZJ v_8,t3.yhnr v_9,t2.jsxz v_10,t1.JHWC_C v_11,t3.YHLC v_12,to_char(t1.jhkgsj,'YYYY') v_13,to_char(t1.JHWGSJ,'YYYY')  v_14,
		(select BYWC_C from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_15,
		(select BYWC_GL from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_16,
		(select sum(BYWC_C) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_17,
		(select sum(BYWC_GL) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_18,
		(select sum(BYWC_C) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_19,
		(select sum(BYWC_GL) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_20,
		(select WC_BTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf})+(select WC_QTTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_21,
		(select WC_BTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_22,
		(select WC_QTTZ from GCGL_ABGC where  jhid=t1.sckid and sbyf=#{sbyf}) v_23,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_24,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_25,
		(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_26,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_27,
		(select sum(WC_BTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_28,
		(select sum(WC_QTTZ) from GCGL_ABGC where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_29,
		t2.jsnr v_30	
		from PLAN_ABGC t1 left join SCK_ABGC  t2 on t1.SCKID=t2.SCKID left join XMK_ABGC t3 on t2.xmkid=t3.id 
		left join GCGL_ABGC t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ABGC where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="xmnf != null and  xmnf != ''">
					and t3.xmnf like '%'||trim(#{xmnf})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
	</select>
	
	<!-- 灾害 -->
	<select id="getzhfzybb" parameterType="gcglzhfz" resultType="hashmap">
		select 
		t3.LXBM v_0,t3.LXMC v_1,t3.QDZH v_2,t3.ZDZH v_3,t3.LXJSDJ v_4,t3.GJXJND v_5,
		t1.PFZTZ v_6,t1.JHSYBZJE v_7,t1.JHSYDFZCJE v_8,
		(select BYWCGL from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_9,
		(select sum(BYWCGL) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_10,
		(select sum(BYWCGL) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_11,
		(select WC_BTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf})+(select WC_QTTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_12,
		(select WC_BTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_13,
		(select WC_QTTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_14,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_15,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_16,
		(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_17,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_18,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_19,
		(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_20,
		t2.jsnr v_21,t3.xmnf
		from PLAN_ZHFZ t1 left join SCK_ZHFZ  t2 on t1.SCKID=t2.SCKID left join XMK_ZHFZ t3 on t2.xmkid=t3.id 
		left join GCGL_ZHFZ t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ZHFZ where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
	</select>
	<select id="getzhfzlist1" parameterType="gcglzhfz" resultType="elist">
	select sum(t5.v_6) v_6,sum(t5.v_7) v_7,sum(t5.v_8) v_8,sum(t5.v_9) v_9,sum(t5.v_10) v_10,sum(t5.v_11) v_11,sum(t5.v_12) v_12,sum(t5.v_13) v_13,sum(t5.v_14) v_14,sum(t5.v_15) v_15,sum(t5.v_16) v_16,sum(t5.v_17) v_17,sum(t5.v_18) v_18,sum(t5.v_19) v_19,sum(t5.v_20) v_20
	from(
		select 
		t3.LXBM v_0,t3.LXMC v_1,t3.QDZH v_2,t3.ZDZH v_3,t3.LXJSDJ v_4,t3.GJXJND v_5,
		t1.PFZTZ v_6,t1.JHSYBZJE v_7,t1.JHSYDFZCJE v_8,
		(select BYWCGL from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_9,
		(select sum(BYWCGL) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_10,
		(select sum(BYWCGL) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_11,
		(select WC_BTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf})+(select WC_QTTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_12,
		(select WC_BTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_13,
		(select WC_QTTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_14,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_15,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_16,
		(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_17,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_18,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_19,
		(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_20,
		t2.jsnr v_21,t3.xmnf
		from PLAN_ZHFZ t1 left join SCK_ZHFZ  t2 on t1.SCKID=t2.SCKID left join XMK_ZHFZ t3 on t2.xmkid=t3.id 
		left join GCGL_ZHFZ t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ZHFZ where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
			) t5 where 1=1
			<if test="xmnf != null and  xmnf != ''">
					and t5.xmnf like '%'||trim(#{xmnf})||'%'
			</if>
	</select>
	<select id="getZhfznf" parameterType="gcglzhfz" resultType="hashmap">
		select t3.xmnf
		from PLAN_ZHFZ t1 left join SCK_ZHFZ  t2 on t1.SCKID=t2.SCKID left join XMK_ZHFZ t3 on t2.xmkid=t3.id 
		left join GCGL_ZHFZ t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ZHFZ where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			group by t3.xmnf
			order by t3.xmnf
	</select>
	<select id="getZhfzxzqh" parameterType="gcglzhfz" resultType="hashmap">
		select distinct(substr(t3.xzqhdm,0,4)) xzqhdm,substr(t3.xzqhmc,0,3) xzqhmc
		from PLAN_ZHFZ t1 left join SCK_ZHFZ  t2 on t1.SCKID=t2.SCKID left join XMK_ZHFZ t3 on t2.xmkid=t3.id 
		left join GCGL_ZHFZ t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ZHFZ where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
	</select>
	<select id="getzhfzlist2" parameterType="gcglzhfz" resultType="elist">
		select 
		t3.LXBM v_0,t3.LXMC v_1,t3.QDZH v_2,t3.ZDZH v_3,t3.LXJSDJ v_4,t3.GJXJND v_5,
		t1.PFZTZ v_6,t1.JHSYBZJE v_7,t1.JHSYDFZCJE v_8,
		(select BYWCGL from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_9,
		(select sum(BYWCGL) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_10,
		(select sum(BYWCGL) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_11,
		(select WC_BTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf})+(select WC_QTTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_12,
		(select WC_BTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_13,
		(select WC_QTTZ from GCGL_ZHFZ where  jhid=t1.sckid and sbyf=#{sbyf}) v_14,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_15,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_16,
		(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_17,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf})+(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_18,
		(select sum(WC_BTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_19,
		(select sum(WC_QTTZ) from GCGL_ZHFZ where  jhid=t1.sckid and sbyf &lt;= #{sbyf}) v_20,
		t2.jsnr v_21,t3.xmnf
		from PLAN_ZHFZ t1 left join SCK_ZHFZ  t2 on t1.SCKID=t2.SCKID left join XMK_ZHFZ t3 on t2.xmkid=t3.id 
		left join GCGL_ZHFZ t4 on t4.jhid=t1.SCKID
		where  
			t1.SCKID in (select jhid from GCGL_ZHFZ where sbyf=#{sbyf})
			<if test="sbyf != null and  sbyf != ''">
					and t4.sbyf like '%'||trim(#{sbyf})||'%'
			</if>
			<if test="gydw != null and  gydw != ''">
					and t3.gydwbm like '%'||trim(#{gydw})||'%'
			</if>
			<if test="xzqhdm != null and  xzqhdm != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhdm})||'%'
			</if>
			<if test="tiaojian != null and  tiaojian != ''">
					and t3.lxbm like trim(#{tiaojian})||'%'
			</if>
			<if test="lxmc != null and  lxmc != ''">
					and t3.lxmc like '%'||trim(#{lxmc})||'%'
			</if>
			<if test="xmnf != null and  xmnf != ''">
					and t3.xmnf like '%'||trim(#{xmnf})||'%'
			</if>
			<if test="xzqhmc != null and  xzqhmc != ''">
					and t3.xzqhdm like '%'||trim(#{xzqhmc})||'%'
			</if>
	</select>
	<!-- 灾毁重建 -->
	<select id="getShybb" parameterType="gcglsh" resultType="hashmap">
		select t1.lxmc v_0,t2.SFGYHBM v_1,t1.XZQHMC v_2,t1.lxbm v_3,t1.qdzh||'-'||t1.zdzh v_4,t1.qzlc v_5,
		t1.yhlc v_6,t2.SJKGSJ v_9,t1.YLMLX v_10,t2.SJLMLX v_11,t2.DC v_12,t3.BYWCDC v_13,
		(select sum(BYWCDC) from GCGL_SH where  jhid=t2.id and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_14,
		(select sum(BYWCDC) from GCGL_SH where  jhid=t2.id and sbyf &lt;= #{sbyf}) v_15,
		t2.JC v_17,t3.BYWCJC v_18,
		(select sum(BYWCJC) from GCGL_SH where  jhid=t2.id and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_19,
		(select sum(BYWCJC) from GCGL_SH where  jhid=t2.id and sbyf &lt;= #{sbyf}) v_20,
		t2.MC v_22,t3.BYWCMC v_23,
		(select sum(BYWCMC) from GCGL_SH where  jhid=t2.id and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_24,
		(select sum(BYWCMC) from GCGL_SH where  jhid=t2.id and sbyf &lt;= #{sbyf}) v_25,
		t2.pfztz v_27,t2.pfztz v_28,
		(select WC_BTZ from GCGL_SH where  jhid=t2.id and sbyf=#{sbyf}) v_29,
		(select sum(WC_BTZ) from GCGL_SH where  jhid=t2.id and sbyf &gt;= substr(#{sbyf},0,4)||'-1' and sbyf &lt;= #{sbyf}) v_30,
		(select sum(WC_BTZ) from GCGL_SH where  jhid=t2.id and sbyf &lt;= #{sbyf}) v_31,
		(case when t2.kgzt='0' then '未开工' when t2.kgzt='1' and t2.jgzt='0' then '在建' when t2.jgzt='1' then '完工' else '' end) v_33,
		t1.bz v_34,t2.SJWGSJ,t2.sbnf
		from PLAN_LX_SHUIH t1 left join PLAN_SHUIH t2 on t1.jhid=t2.id left join gcgl_sh t3 on t3.jhid=t2.id
		where t2.id in (select jhid from GCGL_SH where sbyf=#{sbyf})
		<if test="gydw != null and  gydw != ''">
				and t1.gydwdm like '%'||trim(#{gydw})||'%'
		</if>
		<if test="sbnf != null and  sbnf != ''">
				and t2.sbnf like '%'||trim(#{sbnf})||'%'
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				and t1.xzqhdm like '%'||trim(#{xzqhdm})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and t1.lxbm like trim(#{tiaojian})||'%'
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and t1.lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="sbyf != null and  sbyf != ''">
				and t3.sbyf like '%'||trim(#{sbyf})||'%'
		</if>
	</select>
	<!-- 危桥重做 -->
	<select id="getwqgzbblist1" parameterType="gcglwqgz" resultType="hashmap">
		select
			'总计' qlmc,' ' qldm,' ' qlzxzh,' ' lxbm,' ' lxmc,' ' jsdj,sum(qlqc) qlqc,sum(kjzc) kjzc,sum(dkzdkj) dkzdkj,sum(qlqk) qlqk,' ' sbjgxs,' ' dq,' ' zq,
			' ' xjgjnd,' ' sl,' ' wl,decode(sum(bnhj),null,' ',sum(bnhj)) bnhj,decode(sum(bnbtz),null,' ',sum(bnbtz)) bnbtz,decode(sum(bnstz),null,' ',sum(bnstz)) bnstz,
			decode(sum(byhj),null,'0',sum(byhj)) byhj,decode(sum(bybtz),null,'0',sum(bybtz)) bybtz,decode(sum(bystz),null,'0',sum(bystz)) bystz,decode(sum(yyhj),null,'0',sum(yyhj)) yyhj,decode(sum(yybtz),null,'0',sum(yybtz)) yybtz,decode(sum(yystz),null,'0',sum(yystz)) yystz,decode(sum(kghj),null,'0',sum(kghj)) kghj,decode(sum(kgbtz),null,'0',sum(kgbtz)) kgbtz,decode(sum(kgstz),null,'0',sum(kgstz)) kgstz,' ' yyjgqk,
			' ' yygjqk,' ' yycjqk,' ' zjgqk,' ' zgjqk,' ' zcjqk,' ' jsxz,' ' jhkgn,' ' jhwgn,' ' jsnr
		from
			(select
        xm.qlmc,xm.qlbh qldm,xm.qlzxzh,xm.lxbm,xm.lxmc,xm.jsdj,sc.scqlqc qlqc,xm.kjzc,xm.dkzdkj,sc.scqlqk qlqk,xm.sbjgxs,decode(xm.akjfl,'大桥','大桥',' ') dq,decode(xm.akjfl,'大桥',' ','中桥') zq,
        xm.xjgjnd,decode(xm.pddj,'四类','四类',' ') sl,decode(xm.pddj,'五类','五类',' ') wl,zj1.bnhj,zj1.bnbtz,zj1.bnstz,
        jz1.byhj,jz1.bybtz,jz1.bystz,jz2.yyhj,jz2.yybtz,jz2.yystz,jz3.kghj,jz3.kgbtz,jz3.kgstz,decode(substr(sc.jsxz,0,2),'加固',round(jz2.yyhj/zj1.bnhj,4)*100,0) yyjgqk,
        decode(substr(sc.jsxz,0,2),'改建',round(jz2.yyhj/zj1.bnhj,4)*100,0) yygjqk,decode(substr(sc.jsxz,-2),'重建',round(jz2.yyhj/zj1.bnhj,4)*100,0) yycjqk,decode(substr(sc.jsxz,0,2),'加固',round(jz3.kghj/p.pfztz,4)*100,0) zjgqk,
        decode(substr(sc.jsxz,0,2),'改建',round(jz3.kghj/p.pfztz,4)*100,0) zgjqk,decode(substr(sc.jsxz,-2),'重建',round(jz3.kghj/p.pfztz,4)*100,0) zcjqk,sc.jsxz,p.jhkgsj jhkgn,
        p.jhwgsj jhwgn,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,xm.qlmc||'('||xm.qlzxzh||')' xmmc
      from xmk_wqgz xm,sck_wqgz sc,plan_wqgz p,
      (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,pl.sbnf xdnf,zj.xmid from plan_zjxd zj left join plan_wqgz pl on zj.xmid=pl.id where 1=1 group by zj.xmid,pl.sbnf) zj1,
      (select jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_wqgz jz where jz.sbyf=#{sbyf}) jz1,
      (select sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from gcgl_wqgz jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
      (select sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_wqgz jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
      (select jhid,sbyf from gcgl_wqgz where sbyf=#{sbyf} group by jhid,sbyf) y
      where xm.id=sc.xmkid and sc.sckid=p.sckid(+) and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id ) 
		where 1=1 
		<if test="xmnf != null and  xmnf != ''">
				and xdnf in (${xmnf})
		</if>
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="qlmc != null and  qlmc != ''">
				and xmmc like '%'||trim(#{qlmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
	</select>
	<select id="getwqgzbblist2" parameterType="gcglwqgz" resultType="hashmap">
		select
			' ' qldm,decode(instr(max(xzqhmc), '市'),0,max(xzqhmc),substr(min(xzqhmc), 0, instr(max(xzqhmc), '市')))||'合计' qlmc,' ' qlzxzh,' ' lxbm,' ' lxmc,' ' jsdj,sum(qlqc) qlqc,sum(kjzc) kjzc,sum(dkzdkj) dkzdkj,sum(qlqk) qlqk,' ' sbjgxs,' ' dq,' ' zq,
			' ' xjgjnd,' ' sl,' ' wl,decode(sum(bnhj),null,' ',sum(bnhj)) bnhj,decode(sum(bnbtz),null,' ',sum(bnbtz)) bnbtz,decode(sum(bnstz),null,' ',sum(bnstz)) bnstz,
			decode(sum(byhj),null,'0',sum(byhj)) byhj,decode(sum(bybtz),null,'0',sum(bybtz)) bybtz,decode(sum(bystz),null,'0',sum(bystz)) bystz,decode(sum(yyhj),null,'0',sum(yyhj)) yyhj,decode(sum(yybtz),null,'0',sum(yybtz)) yybtz,decode(sum(yystz),null,'0',sum(yystz)) yystz,decode(sum(kghj),null,'0',sum(kghj)) kghj,decode(sum(kgbtz),null,'0',sum(kgbtz)) kgbtz,decode(sum(kgstz),null,'0',sum(kgstz)) kgstz,' ' yyjgqk,
			' ' yygjqk,' ' yycjqk,' ' zjgqk,' ' zgjqk,' ' zcjqk,' ' jsxz,' ' jhkgn,' ' jhwgn,' ' jsnr,substr(xzqhdm,0,4) xzqh
		from
			(select
        xm.qlmc,xm.qlbh qldm,xm.qlzxzh,xm.lxbm,xm.lxmc,xm.jsdj,sc.scqlqc qlqc,xm.kjzc,xm.dkzdkj,sc.scqlqk qlqk,xm.sbjgxs,decode(xm.akjfl,'大桥','大桥',' ') dq,decode(xm.akjfl,'大桥',' ','中桥') zq,
        xm.xjgjnd,decode(xm.pddj,'四类','四类',' ') sl,decode(xm.pddj,'五类','五类',' ') wl,zj1.bnhj,zj1.bnbtz,zj1.bnstz,
        jz1.byhj,jz1.bybtz,jz1.bystz,jz2.yyhj,jz2.yybtz,jz2.yystz,jz3.kghj,jz3.kgbtz,jz3.kgstz,decode(substr(sc.jsxz,0,2),'加固',round(jz2.yyhj/zj1.bnhj,4)*100,0) yyjgqk,
        decode(substr(sc.jsxz,0,2),'改建',round(jz2.yyhj/zj1.bnhj,4)*100,0) yygjqk,decode(substr(sc.jsxz,-2),'重建',round(jz2.yyhj/zj1.bnhj,4)*100,0) yycjqk,decode(substr(sc.jsxz,0,2),'加固',round(jz3.kghj/p.pfztz,4)*100,0) zjgqk,
        decode(substr(sc.jsxz,0,2),'改建',round(jz3.kghj/p.pfztz,4)*100,0) zgjqk,decode(substr(sc.jsxz,-2),'重建',round(jz3.kghj/p.pfztz,4)*100,0) zcjqk,sc.jsxz,p.jhkgsj jhkgn,
        p.jhwgsj jhwgn,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,xm.qlmc||'('||xm.qlzxzh||')' xmmc
      from xmk_wqgz xm,sck_wqgz sc,plan_wqgz p,
      (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,pl.sbnf xdnf,zj.xmid from plan_zjxd zj left join plan_wqgz pl on zj.xmid=pl.id where 1=1 group by zj.xmid,pl.sbnf) zj1,
      (select jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_wqgz jz where jz.sbyf=#{sbyf}) jz1,
      (select sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from gcgl_wqgz jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
      (select sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_wqgz jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
      (select jhid,sbyf from gcgl_wqgz where sbyf=#{sbyf} group by jhid,sbyf) y
      where xm.id=sc.xmkid and sc.sckid=p.sckid(+) and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id ) 
		where 1=1 
		<if test="xmnf != null and  xmnf != ''">
				and xdnf in (${xmnf})
		</if>
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="qlmc != null and  qlmc != ''">
				and xmmc like '%'||trim(#{qlmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		group by substr(xzqhdm,0,4) order by substr(xzqhdm,0,4)
	</select>
	<select id="getwqgzbblist3" parameterType="gcglwqgz" resultType="hashmap">
		select
			' ' qldm,xdnf||'年项目' qlmc,' ' qlzxzh,' ' lxbm,' ' lxmc,' ' jsdj,sum(qlqc) qlqc,sum(kjzc) kjzc,sum(dkzdkj) dkzdkj,sum(qlqk) qlqk,' ' sbjgxs,' ' dq,' ' zq,
			' ' xjgjnd,' ' sl,' ' wl,decode(sum(bnhj),null,' ',sum(bnhj)) bnhj,decode(sum(bnbtz),null,' ',sum(bnbtz)) bnbtz,decode(sum(bnstz),null,' ',sum(bnstz)) bnstz,
			decode(sum(byhj),null,'0',sum(byhj)) byhj,decode(sum(bybtz),null,'0',sum(bybtz)) bybtz,decode(sum(bystz),null,'0',sum(bystz)) bystz,decode(sum(yyhj),null,'0',sum(yyhj)) yyhj,decode(sum(yybtz),null,'0',sum(yybtz)) yybtz,decode(sum(yystz),null,'0',sum(yystz)) yystz,decode(sum(kghj),null,'0',sum(kghj)) kghj,decode(sum(kgbtz),null,'0',sum(kgbtz)) kgbtz,decode(sum(kgstz),null,'0',sum(kgstz)) kgstz,' ' yyjgqk,
			' ' yygjqk,' ' yycjqk,' ' zjgqk,' ' zgjqk,' ' zcjqk,' ' jsxz,' ' jhkgn,' ' jhwgn,' ' jsnr,xdnf,substr(xzqhdm,0,4) xzqh
		from
			(select
        xm.qlmc,xm.qlbh qldm,xm.qlzxzh,xm.lxbm,xm.lxmc,xm.jsdj,sc.scqlqc qlqc,xm.kjzc,xm.dkzdkj,sc.scqlqk qlqk,xm.sbjgxs,decode(xm.akjfl,'大桥','大桥',' ') dq,decode(xm.akjfl,'大桥',' ','中桥') zq,
        xm.xjgjnd,decode(xm.pddj,'四类','四类',' ') sl,decode(xm.pddj,'五类','五类',' ') wl,zj1.bnhj,zj1.bnbtz,zj1.bnstz,
        jz1.byhj,jz1.bybtz,jz1.bystz,jz2.yyhj,jz2.yybtz,jz2.yystz,jz3.kghj,jz3.kgbtz,jz3.kgstz,decode(substr(sc.jsxz,0,2),'加固',round(jz2.yyhj/zj1.bnhj,4)*100,0) yyjgqk,
        decode(substr(sc.jsxz,0,2),'改建',round(jz2.yyhj/zj1.bnhj,4)*100,0) yygjqk,decode(substr(sc.jsxz,-2),'重建',round(jz2.yyhj/zj1.bnhj,4)*100,0) yycjqk,decode(substr(sc.jsxz,0,2),'加固',round(jz3.kghj/p.pfztz,4)*100,0) zjgqk,
        decode(substr(sc.jsxz,0,2),'改建',round(jz3.kghj/p.pfztz,4)*100,0) zgjqk,decode(substr(sc.jsxz,-2),'重建',round(jz3.kghj/p.pfztz,4)*100,0) zcjqk,sc.jsxz,p.jhkgsj jhkgn,
        p.jhwgsj jhwgn,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,xm.qlmc||'('||xm.qlzxzh||')' xmmc
      from xmk_wqgz xm,sck_wqgz sc,plan_wqgz p,
      (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,pl.sbnf xdnf,zj.xmid from plan_zjxd zj left join plan_wqgz pl on zj.xmid=pl.id where 1=1 group by zj.xmid,pl.sbnf) zj1,
      (select jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_wqgz jz where jz.sbyf=#{sbyf}) jz1,
      (select sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from gcgl_wqgz jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
      (select sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_wqgz jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
      (select jhid,sbyf from gcgl_wqgz where sbyf=#{sbyf} group by jhid,sbyf) y
      where xm.id=sc.xmkid and sc.sckid=p.sckid(+) and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id  )
		where 1=1 
		<if test="xmnf != null and  xmnf != ''">
				and xdnf in (${xmnf})
		</if>
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="qlmc != null and  qlmc != ''">
				and xmmc like '%'||trim(#{qlmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		group by substr(xzqhdm,0,4),xdnf order by substr(xzqhdm,0,4),xdnf
	</select>
	<select id="getwqgzbblist4" parameterType="gcglwqgz" resultType="hashmap">
		select
			substr(xzqhdm,0,4) xzqh,t.*
		from
			(select
        decode(xm.qlmc,null,' ',xm.qlmc) qlmc,decode(xm.qlbh,null,' ',xm.qlbh) qldm,decode(xm.qlzxzh,null,' ',xm.qlzxzh) qlzxzh,decode(xm.lxbm,null,' ',xm.lxbm) lxbm,decode(xm.lxmc,null,' ',xm.lxmc) lxmc,decode(xm.jsdj,null,' ',xm.jsdj) jsdj,decode(sc.scqlqc,null,' ',sc.scqlqc) qlqc,decode(xm.kjzc,null,' ',xm.kjzc) kjzc,decode(xm.dkzdkj,null,' ',xm.dkzdkj) dkzdkj,decode(sc.scqlqk,null,' ',sc.scqlqk) qlqk,decode(xm.sbjgxs,null,' ',xm.sbjgxs) sbjgxs,decode(xm.akjfl,'大桥','大桥',' ') dq,decode(xm.akjfl,'大桥',' ','中桥') zq,
        decode(xm.xjgjnd,null,' ',xm.xjgjnd) xjgjnd,decode(xm.pddj,'四类','四类',' ') sl,decode(xm.pddj,'五类','五类',' ') wl,decode(zj1.bnhj,null,0,zj1.bnhj) bnhj,decode(zj1.bnbtz,null,0,zj1.bnbtz) bnbtz,decode(zj1.bnstz,null,0,zj1.bnstz) bnstz,
        decode(jz1.byhj,null,0,jz1.byhj) byhj,decode(jz1.bybtz,null,0,jz1.bybtz) bybtz,decode(jz1.bystz,null,0,jz1.bystz) bystz,decode(jz2.yyhj,null,0,jz2.yyhj) yyhj,decode(jz2.yybtz,null,0,jz2.yybtz) yybtz,decode(jz2.yystz,null,0,jz2.yystz) yystz,decode(jz3.kghj,null,0,jz3.kghj) kghj,decode(jz3.kgbtz,null,0,jz3.kgbtz) kgbtz,decode(jz3.kgstz,null,0,jz3.kgstz) kgstz,decode(decode(substr(sc.jsxz,0,2),'加固',round(jz2.yyhj/zj1.bnhj,4)*100,0),null,0,decode(substr(sc.jsxz,0,2),'加固',round(jz2.yyhj/zj1.bnhj,4)*100,0)) yyjgqk,
        decode(decode(substr(sc.jsxz,0,2),'改建',round(jz2.yyhj/zj1.bnhj,4)*100,0),null,0,decode(substr(sc.jsxz,0,2),'改建',round(jz2.yyhj/zj1.bnhj,4)*100,0)) yygjqk,decode(decode(substr(sc.jsxz,-2),'重建',round(jz2.yyhj/zj1.bnhj,4)*100,0),null,0,decode(substr(sc.jsxz,-2),'重建',round(jz2.yyhj/zj1.bnhj,4)*100,0)) yycjqk,decode(decode(substr(sc.jsxz,0,2),'加固',round(jz3.kghj/p.pfztz,4)*100,0),null,0,decode(substr(sc.jsxz,0,2),'加固',round(jz3.kghj/p.pfztz,4)*100,0)) zjgqk,
        decode(decode(substr(sc.jsxz,0,2),'改建',round(jz3.kghj/p.pfztz,4)*100,0),null,0,decode(substr(sc.jsxz,0,2),'改建',round(jz3.kghj/p.pfztz,4)*100,0)) zgjqk,decode(decode(substr(sc.jsxz,-2),'重建',round(jz3.kghj/p.pfztz,4)*100,0),null,0,decode(substr(sc.jsxz,-2),'重建',round(jz3.kghj/p.pfztz,4)*100,0)) zcjqk,sc.jsxz,decode(p.jhkgsj,null,' ',p.jhkgsj) jhkgn,
        decode(p.jhwgsj,null,' ',p.jhwgsj) jhwgn,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,xm.qlmc||'('||xm.qlzxzh||')' xmmc
      from xmk_wqgz xm,sck_wqgz sc,plan_wqgz p,
      (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,pl.sbnf xdnf,zj.xmid from plan_zjxd zj left join plan_wqgz pl on zj.xmid=pl.id where 1=1 group by zj.xmid,pl.sbnf) zj1,
      (select jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_wqgz jz where jz.sbyf=#{sbyf}) jz1,
      (select sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from gcgl_wqgz jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
      (select sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_wqgz jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
      (select jhid,sbyf from gcgl_wqgz where sbyf=#{sbyf} group by jhid,sbyf) y
      where xm.id=sc.xmkid and sc.sckid=p.sckid(+) and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id ) t
		where 1=1 
		<if test="xmnf != null and  xmnf != ''">
				and xdnf in (${xmnf})
		</if>
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="qlmc != null and  qlmc != ''">
				and xmmc like '%'||trim(#{qlmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		order by substr(xzqhdm,0,4),xdnf
	</select>
	<select id="getabgcbblist1" parameterType="gcglabgc" resultType="hashmap">
		select
			 ' ' lxmc,'总计' lxbm,' ' qdzh,' ' zdzh,' ' jsdj,
			' ' xjgjnd,decode(sum(bnhj),null,0,sum(bnhj)) bnhj,decode(sum(bnbtz),null,0,sum(bnbtz)) bnbtz,decode(sum(bnstz),null,0,sum(bnstz)) bnstz,
			' ' yhlx,' ' jsxz,decode(sum(jhc),null,0,sum(jhc)) jhc,decode(sum(jhgl),null,0,sum(jhgl)) jhgl,' ' jhkgn,' ' jhwgn,decode(sum(bywcc),null,0,sum(bywcc)) bywcc,decode(sum(bywcgl),null,0,sum(bywcgl)) bywcgl,
			decode(sum(yywcc),null,0,sum(yywcc)) yywcc,decode(sum(yywcgl),null,0,sum(yywcgl)) yywcgl,decode(sum(kgwcc),null,0,sum(kgwcc)) kgwcc,decode(sum(kgwcgl),null,0,sum(kgwcgl)) kgwcgl,
			decode(sum(byhj),null,0,sum(byhj)) byhj,decode(sum(bybtz),null,0,sum(bybtz)) bybtz,decode(sum(bystz),null,0,sum(bystz)) bystz,decode(sum(yyhj),null,0,sum(yyhj)) yyhj,decode(sum(yybtz),null,0,sum(yybtz)) yybtz,decode(sum(yystz),null,0,sum(yystz)) yystz, decode(sum(kghj),null,0,sum(kghj)) kghj,decode(sum(kgbtz),null,0,sum(kgbtz)) kgbtz,decode(sum(kgstz),null,0,sum(kgstz)) kgstz,' ' jsnr
		from(
        select
          xm.lxbm,xm.lxmc,xm.qdzh,xm.zdzh,xm.lxjsdj jsdj,xm.gjxjnd xjgjnd,zj1.bnhj,zj1.bnbtz,zj1.bnstz,xm.yhnr yhlx,sc.jsxz,p.jhwc_c jhc,sc.scyhlc jhgl,substr(p.jhkgsj,0,4) jhkgn,
          substr(p.jhwgsj,0,4) jhwgn,jz1.bywcc,jz1.bywcgl,jz2.yywcc,jz2.yywcgl,jz3.kgwcc,jz3.kgwcgl,
          jz1.byhj,jz1.bybtz,jz1.bystz,jz2.yyhj,jz2.yybtz,jz2.yystz,jz3.kghj,jz3.kgbtz,jz3.kgstz,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,
          xm.lxmc||'('||xm.qdzh||','||xm.zdzh||')' xmmc
        from xmk_abgc xm,sck_abgc sc,plan_abgc p,
        (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(pl.jhnf) xdnf,zj.xmid from plan_zjxd zj left join plan_abgc pl on zj.xmid=pl.id where 1=1 group by zj.xmid) zj1,
        (select jz.bywc_c bywcc,jz.bywc_gl bywcgl,jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_abgc jz where jz.sbyf=#{sbyf}) jz1,
        (select sum(jz.bywc_c) yywcc,sum(jz.bywc_gl) yywcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from gcgl_abgc jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
        (select sum(jz.bywc_c) kgwcc,sum(jz.bywc_gl) kgwcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_abgc jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
        (select jhid,sbyf from gcgl_abgc where sbyf=#{sbyf} group by jhid,sbyf) y
        where xm.id=sc.xmkid and sc.sckid(+)=p.sckid and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id 
      ) 
			where 1=1 
		<if test="xmnf != null and  xmnf != ''">
				and xdnf in (${xmnf})
		</if>
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
	</select>
	<select id="getabgcbblist2" parameterType="gcglabgc" resultType="hashmap">
		select
			 ' ' lxmc,decode(instr(max(xzqhmc), '市'),0,max(xzqhmc),substr(min(xzqhmc), 0, instr(max(xzqhmc), '市')))||'合计' lxbm,' ' qdzh,' ' zdzh,' ' jsdj,
			' ' xjgjnd,decode(sum(bnhj),null,0,sum(bnhj)) bnhj,decode(sum(bnbtz),null,0,sum(bnbtz)) bnbtz,decode(sum(bnstz),null,0,sum(bnstz)) bnstz,
			' ' yhlx,' ' jsxz,decode(sum(jhc),null,0,sum(jhc)) jhc,decode(sum(jhgl),null,0,sum(jhgl)) jhgl,' ' jhkgn,' ' jhwgn,decode(sum(bywcc),null,0,sum(bywcc)) bywcc,decode(sum(bywcgl),null,0,sum(bywcgl)) bywcgl,
			decode(sum(yywcc),null,0,sum(yywcc)) yywcc,decode(sum(yywcgl),null,0,sum(yywcgl)) yywcgl,decode(sum(kgwcc),null,0,sum(kgwcc)) kgwcc,decode(sum(kgwcgl),null,0,sum(kgwcgl)) kgwcgl,
			decode(sum(byhj),null,0,sum(byhj)) byhj,decode(sum(bybtz),null,0,sum(bybtz)) bybtz,decode(sum(bystz),null,0,sum(bystz)) bystz,decode(sum(yyhj),null,0,sum(yyhj)) yyhj,decode(sum(yybtz),null,0,sum(yybtz)) yybtz,decode(sum(yystz),null,0,sum(yystz)) yystz, decode(sum(kghj),null,0,sum(kghj)) kghj,decode(sum(kgbtz),null,0,sum(kgbtz)) kgbtz,decode(sum(kgstz),null,0,sum(kgstz)) kgstz,' ' jsnr,substr(xzqhdm,0,4) xzqh
		from(
        select
          xm.lxbm,xm.lxmc,xm.qdzh,xm.zdzh,xm.lxjsdj jsdj,xm.gjxjnd xjgjnd,zj1.bnhj,zj1.bnbtz,zj1.bnstz,xm.yhnr yhlx,sc.jsxz,p.jhwc_c jhc,sc.scyhlc jhgl,substr(p.jhkgsj,0,4) jhkgn,
          substr(p.jhwgsj,0,4) jhwgn,jz1.bywcc,jz1.bywcgl,jz2.yywcc,jz2.yywcgl,jz3.kgwcc,jz3.kgwcgl,
          jz1.byhj,jz1.bybtz,jz1.bystz,jz2.yyhj,jz2.yybtz,jz2.yystz,jz3.kghj,jz3.kgbtz,jz3.kgstz,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,
          xm.lxmc||'('||xm.qdzh||','||xm.zdzh||')' xmmc
        from xmk_abgc xm,sck_abgc sc,plan_abgc p,
        (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(pl.jhnf) xdnf,zj.xmid from plan_zjxd zj left join plan_abgc pl on zj.xmid=pl.id where 1=1 group by zj.xmid) zj1,
        (select jz.bywc_c bywcc,jz.bywc_gl bywcgl,jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_abgc jz where jz.sbyf=#{sbyf}) jz1,
        (select sum(jz.bywc_c) yywcc,sum(jz.bywc_gl) yywcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from gcgl_abgc jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
        (select sum(jz.bywc_c) kgwcc,sum(jz.bywc_gl) kgwcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_abgc jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
        (select jhid,sbyf from gcgl_abgc where sbyf=#{sbyf} group by jhid,sbyf) y
        where xm.id=sc.xmkid and sc.sckid(+)=p.sckid and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id 
      ) 
			where 1=1 
		<if test="xmnf != null and  xmnf != ''">
				and xdnf in (${xmnf})
		</if>
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		group by substr(xzqhdm,0,4) order by substr(xzqhdm,0,4)
	</select>
	<select id="getabgcbblist3" parameterType="gcglabgc" resultType="hashmap">
		select
			 ' ' lxmc,xdnf||'年项目' lxbm,' ' qdzh,' ' zdzh,' ' jsdj,
			' ' xjgjnd,decode(sum(bnhj),null,0,sum(bnhj)) bnhj,decode(sum(bnbtz),null,0,sum(bnbtz)) bnbtz,decode(sum(bnstz),null,0,sum(bnstz)) bnstz,
			' ' yhlx,' ' jsxz,decode(sum(jhc),null,0,sum(jhc)) jhc,decode(sum(jhgl),null,0,sum(jhgl)) jhgl,' ' jhkgn,' ' jhwgn,decode(sum(bywcc),null,0,sum(bywcc)) bywcc,decode(sum(bywcgl),null,0,sum(bywcgl)) bywcgl,
			decode(sum(yywcc),null,0,sum(yywcc)) yywcc,decode(sum(yywcgl),null,0,sum(yywcgl)) yywcgl,decode(sum(kgwcc),null,0,sum(kgwcc)) kgwcc,decode(sum(kgwcgl),null,0,sum(kgwcgl)) kgwcgl,
			decode(sum(byhj),null,0,sum(byhj)) byhj,decode(sum(bybtz),null,0,sum(bybtz)) bybtz,decode(sum(bystz),null,0,sum(bystz)) bystz,decode(sum(yyhj),null,0,sum(yyhj)) yyhj,decode(sum(yybtz),null,0,sum(yybtz)) yybtz,decode(sum(yystz),null,0,sum(yystz)) yystz, decode(sum(kghj),null,0,sum(kghj)) kghj,decode(sum(kgbtz),null,0,sum(kgbtz)) kgbtz,decode(sum(kgstz),null,0,sum(kgstz)) kgstz,' ' jsnr,substr(xzqhdm,0,4) xzqh,xdnf
		from(
        select
          xm.lxbm,xm.lxmc,xm.qdzh,xm.zdzh,xm.lxjsdj jsdj,xm.gjxjnd xjgjnd,zj1.bnhj,zj1.bnbtz,zj1.bnstz,xm.yhnr yhlx,sc.jsxz,p.jhwc_c jhc,sc.scyhlc jhgl,substr(p.jhkgsj,0,4) jhkgn,
          substr(p.jhwgsj,0,4) jhwgn,jz1.bywcc,jz1.bywcgl,jz2.yywcc,jz2.yywcgl,jz3.kgwcc,jz3.kgwcgl,
          jz1.byhj,jz1.bybtz,jz1.bystz,jz2.yyhj,jz2.yybtz,jz2.yystz,jz3.kghj,jz3.kgbtz,jz3.kgstz,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,
          xm.lxmc||'('||xm.qdzh||','||xm.zdzh||')' xmmc
        from xmk_abgc xm,sck_abgc sc,plan_abgc p,
        (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(pl.jhnf) xdnf,zj.xmid from plan_zjxd zj left join plan_abgc pl on zj.xmid=pl.id where 1=1 group by zj.xmid) zj1,
        (select jz.bywc_c bywcc,jz.bywc_gl bywcgl,jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_abgc jz where jz.sbyf=#{sbyf}) jz1,
        (select sum(jz.bywc_c) yywcc,sum(jz.bywc_gl) yywcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from gcgl_abgc jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
        (select sum(jz.bywc_c) kgwcc,sum(jz.bywc_gl) kgwcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_abgc jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
        (select jhid,sbyf from gcgl_abgc where sbyf=#{sbyf} group by jhid,sbyf) y
        where xm.id=sc.xmkid and sc.sckid(+)=p.sckid and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id 
      ) 
			where 1=1 
		<if test="xmnf != null and  xmnf != ''">
				and xdnf in (${xmnf})
		</if>
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		group by substr(xzqhdm,0,4),xdnf order by substr(xzqhdm,0,4),xdnf
	</select>
	<select id="getabgcbblist4" parameterType="gcglabgc" resultType="hashmap">
		select
			substr(xzqhdm,0,4) xzqh,tt.*
		from(
        select
          xm.lxbm,xm.lxmc,xm.qdzh,xm.zdzh,xm.lxjsdj jsdj,xm.gjxjnd xjgjnd,zj1.bnhj,zj1.bnbtz,zj1.bnstz,xm.yhnr yhlx,sc.jsxz,decode(p.jhwc_c,null,0,p.jhwc_c) jhc,sc.scyhlc jhgl,substr(p.jhkgsj,0,4) jhkgn,
          substr(p.jhwgsj,0,4) jhwgn,decode(jz1.bywcc,null,0,jz1.bywcc) bywcc,decode(jz1.bywcgl,null,0,jz1.bywcgl) bywcgl,decode(jz2.yywcc,null,0,jz2.yywcc) yywcc,decode(jz2.yywcgl,null,0,jz2.yywcgl) yywcgl,decode(jz3.kgwcc,null,0,jz3.kgwcc) kgwcc,decode(jz3.kgwcgl,null,0,jz3.kgwcgl) kgwcgl,
          decode(jz1.byhj,null,0,jz1.byhj) byhj,decode(jz1.bybtz,null,0,jz1.bybtz) bybtz,decode(jz1.bystz,null,0,jz1.bystz) bystz,decode(jz2.yyhj,null,0,jz2.yyhj) yyhj,decode(jz2.yybtz,null,0,jz2.yybtz) yybtz,decode(jz2.yystz,null,0,jz2.yystz) yystz,decode(jz3.kghj,null,0,jz3.kghj) kghj,decode(jz3.kgbtz,null,0,jz3.kgbtz) kgbtz,decode(jz3.kgstz,null,0,jz3.kgstz) kgstz,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,
          xm.lxmc||'('||xm.qdzh||','||xm.zdzh||')' xmmc
        from xmk_abgc xm,sck_abgc sc,plan_abgc p,
        (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(pl.jhnf) xdnf,zj.xmid from plan_zjxd zj left join plan_abgc pl on zj.xmid=pl.id where 1=1 group by zj.xmid) zj1,
        (select jz.bywc_c bywcc,jz.bywc_gl bywcgl,jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_abgc jz where jz.sbyf=#{sbyf}) jz1,
        (select sum(jz.bywc_c) yywcc,sum(jz.bywc_gl) yywcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from gcgl_abgc jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
        (select sum(jz.bywc_c) kgwcc,sum(jz.bywc_gl) kgwcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_abgc jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
        (select jhid,sbyf from gcgl_abgc where sbyf=#{sbyf} group by jhid,sbyf) y
        where xm.id=sc.xmkid and sc.sckid(+)=p.sckid and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id 
      ) 	tt
			where 1=1 
		<if test="xmnf != null and  xmnf != ''">
				and xdnf in (${xmnf})
		</if>
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		order by substr(xzqhdm,0,4),xdnf
	</select>
	<select id="getzhfzbblist1" parameterType="gcglzhfz" resultType="hashmap">
		select
			' ' lxmc,'总计' lxbm,' ' qdzh,' ' zdzh,' ' jsdj,
			' ' xjgjnd,sum(bnhj) bnhj,sum(bnbtz) bnbtz,sum(bnstz) bnstz,
			' ' yhlx,' ' jsxz,decode(sum(bywcgl),null,0,sum(bywcgl)) bywcgl,
			decode(sum(yywcgl),null,0,sum(yywcgl)) yywcgl,decode(sum(kgwcgl),null,0,sum(kgwcgl)) kgwcgl,
			sum(byhj) byhj,sum(bybtz) bybtz,sum(bystz) bystz,sum(yyhj) yyhj,sum(yybtz) yybtz,sum(yystz) yystz, sum(kghj) kghj,sum(kgbtz) kgbtz,sum(kgstz) kgstz,' ' jsnr
		from  (
		      select
		      xm.lxbm,xm.lxmc,xm.qdzh,xm.zdzh,xm.lxjsdj jsdj,xm.gjxjnd xjgjnd,nvl(zj1.bnhj,'0') bnhj,nvl(zj1.bnbtz,'0') bnbtz,nvl(zj1.bnstz,'0') bnstz,xm.yhnr yhlx,sc.jsxz,decode(jz1.bywcgl,null,0,jz1.bywcgl) bywcgl,decode(jz2.yywcgl,null,0,jz2.yywcgl) yywcgl,decode(jz3.kgwcgl,null,0,jz3.kgwcgl) kgwcgl,
		      nvl(jz1.byhj,'0') byhj,nvl(jz1.bybtz,'0') bybtz,nvl(jz1.bystz,'0') bystz,nvl(jz2.yyhj,'0') yyhj,nvl(jz2.yybtz,'0') yybtz,nvl(jz2.yystz,'0') yystz,nvl(jz3.kghj,'0') kghj,nvl(jz3.kgbtz,'0') kgbtz,nvl(jz3.kgstz,'0') kgstz,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,
		      xm.lxmc||'('||xm.qdzh||','||xm.zdzh||')' xmmc
		    from xmk_zhfz xm,sck_zhfz sc,plan_zhfz p,
		    (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(zj.xdnf) xdnf,zj.xmid from plan_zjxd zj left join plan_zhfz pl on zj.xmid=pl.id where 1=1 group by zj.xmid) zj1,
		    (select jz.bywcgl bywcgl,jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_zhfz jz where jz.sbyf=#{sbyf}) jz1,
		    (select sum(jz.bywcgl) yywcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from  gcgl_zhfz jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
		    (select sum(jz.bywcgl) kgwcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_zhfz jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
		    (select jhid,sbyf from gcgl_zhfz where sbyf=#{sbyf} group by jhid,sbyf) y
		    where xm.id=sc.xmkid and sc.sckid(+)=p.sckid and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id 
		    )
		where 1=1 
		<if test="xmnf != null and  xmnf != ''">
				and xdnf in (${xmnf})
		</if>
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
	</select>
	<select id="getzhfzbblist2" parameterType="gcglzhfz" resultType="hashmap">
		select
			' ' lxmc,decode(instr(max(xzqhmc), '市'),0,max(xzqhmc),substr(min(xzqhmc), 0, instr(max(xzqhmc), '市')))||'合计' lxbm,' ' qdzh,' ' zdzh,' ' jsdj,
			' ' xjgjnd,sum(bnhj) bnhj,sum(bnbtz) bnbtz,sum(bnstz) bnstz,
			' ' yhlx,' ' jsxz,decode(sum(bywcgl),null,0,sum(bywcgl)) bywcgl,
			decode(sum(yywcgl),null,0,sum(yywcgl)) yywcgl,decode(sum(kgwcgl),null,0,sum(kgwcgl)) kgwcgl,
			sum(byhj) byhj,sum(bybtz) bybtz,sum(bystz) bystz,sum(yyhj) yyhj,sum(yybtz) yybtz,sum(yystz) yystz, sum(kghj) kghj,sum(kgbtz) kgbtz,sum(kgstz) kgstz,' ' jsnr,substr(xzqhdm,0,4) xzqh
		from  (
		      select
		      xm.lxbm,xm.lxmc,xm.qdzh,xm.zdzh,xm.lxjsdj jsdj,xm.gjxjnd xjgjnd,nvl(zj1.bnhj,'0') bnhj,nvl(zj1.bnbtz,'0') bnbtz,nvl(zj1.bnstz,'0') bnstz,xm.yhnr yhlx,sc.jsxz,decode(jz1.bywcgl,null,0,jz1.bywcgl) bywcgl,decode(jz2.yywcgl,null,0,jz2.yywcgl) yywcgl,decode(jz3.kgwcgl,null,0,jz3.kgwcgl) kgwcgl,
		      nvl(jz1.byhj,'0') byhj,nvl(jz1.bybtz,'0') bybtz,nvl(jz1.bystz,'0') bystz,nvl(jz2.yyhj,'0') yyhj,nvl(jz2.yybtz,'0') yybtz,nvl(jz2.yystz,'0') yystz,nvl(jz3.kghj,'0') kghj,nvl(jz3.kgbtz,'0') kgbtz,nvl(jz3.kgstz,'0') kgstz,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,
		      xm.lxmc||'('||xm.qdzh||','||xm.zdzh||')' xmmc
		    from xmk_zhfz xm,sck_zhfz sc,plan_zhfz p,
		    (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(zj.xdnf) xdnf,zj.xmid from plan_zjxd zj left join plan_zhfz pl on zj.xmid=pl.id where 1=1 group by zj.xmid) zj1,
		    (select jz.bywcgl bywcgl,jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_zhfz jz where jz.sbyf=#{sbyf}) jz1,
		    (select sum(jz.bywcgl) yywcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from  gcgl_zhfz jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
		    (select sum(jz.bywcgl) kgwcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_zhfz jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
		    (select jhid,sbyf from gcgl_zhfz where sbyf=#{sbyf} group by jhid,sbyf) y
		    where xm.id=sc.xmkid and sc.sckid(+)=p.sckid and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id 
		    )
		where 1=1 
		<if test="xmnf != null and  xmnf != ''">
				and xdnf in (${xmnf})
		</if>
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		group by substr(xzqhdm,0,4) order by substr(xzqhdm,0,4)
	</select>
	<select id="getzhfzbblist3" parameterType="gcglzhfz" resultType="hashmap">
		select
			' ' lxmc,xdnf||'年项目' lxbm,' ' qdzh,' ' zdzh,' ' jsdj,
			' ' xjgjnd,sum(bnhj) bnhj,sum(bnbtz) bnbtz,sum(bnstz) bnstz,
			' ' yhlx,' ' jsxz,decode(sum(bywcgl),null,0,sum(bywcgl)) bywcgl,
			decode(sum(yywcgl),null,0,sum(yywcgl)) yywcgl,decode(sum(kgwcgl),null,0,sum(kgwcgl)) kgwcgl,
			sum(byhj) byhj,sum(bybtz) bybtz,sum(bystz) bystz,sum(yyhj) yyhj,sum(yybtz) yybtz,sum(yystz) yystz, sum(kghj) kghj,sum(kgbtz) kgbtz,sum(kgstz) kgstz,' ' jsnr,substr(xzqhdm,0,4) xzqh,xdnf
			from  (
		      select
		      xm.lxbm,xm.lxmc,xm.qdzh,xm.zdzh,xm.lxjsdj jsdj,xm.gjxjnd xjgjnd,nvl(zj1.bnhj,'0') bnhj,nvl(zj1.bnbtz,'0') bnbtz,nvl(zj1.bnstz,'0') bnstz,xm.yhnr yhlx,sc.jsxz,decode(jz1.bywcgl,null,0,jz1.bywcgl) bywcgl,decode(jz2.yywcgl,null,0,jz2.yywcgl) yywcgl,decode(jz3.kgwcgl,null,0,jz3.kgwcgl) kgwcgl,
		      nvl(jz1.byhj,'0') byhj,nvl(jz1.bybtz,'0') bybtz,nvl(jz1.bystz,'0') bystz,nvl(jz2.yyhj,'0') yyhj,nvl(jz2.yybtz,'0') yybtz,nvl(jz2.yystz,'0') yystz,nvl(jz3.kghj,'0') kghj,nvl(jz3.kgbtz,'0') kgbtz,nvl(jz3.kgstz,'0') kgstz,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,
		      xm.lxmc||'('||xm.qdzh||','||xm.zdzh||')' xmmc
		    from xmk_zhfz xm,sck_zhfz sc,plan_zhfz p,
		    (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(zj.xdnf) xdnf,zj.xmid from plan_zjxd zj left join plan_zhfz pl on zj.xmid=pl.id where 1=1 group by zj.xmid) zj1,
		    (select jz.bywcgl bywcgl,jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_zhfz jz where jz.sbyf=#{sbyf}) jz1,
		    (select sum(jz.bywcgl) yywcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from  gcgl_zhfz jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
		    (select sum(jz.bywcgl) kgwcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_zhfz jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
		    (select jhid,sbyf from gcgl_zhfz where sbyf=#{sbyf} group by jhid,sbyf) y
		    where xm.id=sc.xmkid and sc.sckid(+)=p.sckid and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id 
		    )
		where 1=1 
		<if test="xmnf != null and  xmnf != ''">
				and xdnf in (${xmnf})
		</if>
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		group by substr(xzqhdm,0,4),xdnf order by substr(xzqhdm,0,4),xdnf
	</select>
	<select id="getzhfzbblist4" parameterType="gcglzhfz" resultType="hashmap">
		select
			substr(xzqhdm,0,4) xzqh,tt.*
		from  (
		      select
		      xm.lxbm,xm.lxmc,xm.qdzh,xm.zdzh,xm.lxjsdj jsdj,xm.gjxjnd xjgjnd,nvl(zj1.bnhj,'0') bnhj,nvl(zj1.bnbtz,'0') bnbtz,nvl(zj1.bnstz,'0') bnstz,xm.yhnr yhlx,sc.jsxz,decode(jz1.bywcgl,null,0,jz1.bywcgl) bywcgl,decode(jz2.yywcgl,null,0,jz2.yywcgl) yywcgl,decode(jz3.kgwcgl,null,0,jz3.kgwcgl) kgwcgl,
		      nvl(jz1.byhj,'0') byhj,nvl(jz1.bybtz,'0') bybtz,nvl(jz1.bystz,'0') bystz,nvl(jz2.yyhj,'0') yyhj,nvl(jz2.yybtz,'0') yybtz,nvl(jz2.yystz,'0') yystz,nvl(jz3.kghj,'0') kghj,nvl(jz3.kgbtz,'0') kgbtz,nvl(jz3.kgstz,'0') kgstz,sc.jsnr,zj1.xdnf,zj1.xmid,xm.gydwbm gydw,xm.xzqhmc,xm.xzqhdm,
		      xm.lxmc||'('||xm.qdzh||','||xm.zdzh||')' xmmc
		    from xmk_zhfz xm,sck_zhfz sc,plan_zhfz p,
		    (select sum(zj.xdzj) bnhj,sum(zj.btzzj) bnbtz,sum(zj.stz) bnstz,avg(zj.xdnf) xdnf,zj.xmid from plan_zjxd zj left join plan_zhfz pl on zj.xmid=pl.id where 1=1 group by zj.xmid) zj1,
		    (select jz.bywcgl bywcgl,jz.wc_btz+jz.wc_stz+jz.wc_qttz byhj,jz.wc_btz bybtz,jz.wc_stz bystz,jz.jhid from gcgl_zhfz jz where jz.sbyf=#{sbyf}) jz1,
		    (select sum(jz.bywcgl) yywcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) yyhj,sum(jz.wc_btz) yybtz,sum(jz.wc_stz) yystz,jz.jhid from  gcgl_zhfz jz where to_date(jz.sbyf,'yyyy-mm')>=to_date(substr(#{sbyf},0,4)||'-1','yyyy-mm') and to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz2,
		    (select sum(jz.bywcgl) kgwcgl,sum(jz.wc_btz)+sum(jz.wc_stz)+sum(jz.wc_qttz) kghj,sum(jz.wc_btz) kgbtz,sum(jz.wc_stz) kgstz,jz.jhid from gcgl_zhfz jz where to_date(jz.sbyf,'yyyy-mm')&lt;=to_date(#{sbyf},'yyyy-mm') group by jz.jhid) jz3,
		    (select jhid,sbyf from gcgl_zhfz where sbyf=#{sbyf} group by jhid,sbyf) y
		    where xm.id=sc.xmkid and sc.sckid(+)=p.sckid and p.id=zj1.xmid(+) and p.id=jz1.jhid(+) and p.id=jz2.jhid(+) and p.id=jz3.jhid(+) and y.jhid(+)=p.id 
		    ) tt
		where 1=1 
		<if test="xmnf != null and  xmnf != ''">
				and xdnf in (${xmnf})
		</if>
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="lxmc != null and  lxmc != ''">
				and lxmc like '%'||trim(#{lxmc})||'%'
		</if>
		<if test="xmmc != null and  xmmc != ''">
				and xmmc like '%'||trim(#{xmmc})||'%'
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		order by substr(xzqhdm,0,4),xdnf
	</select>
	<!--  -->
	<select id="getGjxjmxbsj" parameterType="string" resultType="hashmap">
		${value}
	</select>
	
	<select id="getWqgzJsb" parameterType="gcglwqgz" resultType="hashmap">
		select * from
		(
			select nvl(substr(xm.xzqhmc,instr(xzqhmc, '市')+1,length(xm.xzqhmc)),' ') xian,(case when tsdq like '%罗霄山%' then '是' else '否' end) sflxs,
      (case when tsdq like '%原中央苏区%'and tsdq like '%国家贫困县%' then '是' else '否' end) sfpkx,(case when tsdq like '%原中央苏区%' then '是' else '否' end) sfyzy,
      xm.xzqhdm,xm.xzqhmc,xm.lxbm,xm.lxmc,sc.sck_qlzxzh qlzh,xm.qlbh qlbm,xm.qlmc,decode(pl.xdsj,null,' ',to_char(pl.xdsj,'yyyy-mm-dd')) xdsj,decode(pl.jhkgsj,null,' ',to_char(pl.jhkgsj,'yyyy-mm-dd')) jhkgsj, decode(pl.jhwgsj,null,' ',to_char(pl.jhwgsj,'yyyy-mm-dd')) jhwcsj,decode(pl.yjjgsj,null,' ',to_char(pl.yjjgsj,'yyyy-mm-dd')) yjjgsj,xm.qlqc,xm.kjzc qlqk,
      sc.jsxz,pl.pfwh,pl.pfztz ztz,pl.jhsybzje zytz,'0' stz,decode(pl.sjkgsj,null,' ',to_char(pl.sjkgsj,'yyyy-mm-dd')) sjkgsj,decode(pl.sjwgsj,null,' ',to_char(pl.sjwgsj,'yyyy-mm-dd')) sjwgsj,nvl(pl.jsdw,' ') jsdw,nvl(pl.sjdw,' ') sjdw,nvl(pl.sgdw,' ') sgdw,nvl(pl.jldw,' ') jldw,
      sc.scqlqc sjqlqc,sc.scqlqk sjqlqk,decode(to_char(pl.jhkgsj,'yyyy'),to_char(pl.jhwgsj,'yyyy'),'是','否') sfbnwc,(case when pl.kgzt='1' and pl.jgzt='0' then '1' else ' ' end) zjz,(case when pl.kgzt='1' and pl.jgzt='0' then sc.scqlqc else ' ' end) zjm,(case when pl.kgzt='0' and pl.jgzt='0' then '1' else ' ' end) wkgz,(case when pl.kgzt='0' and pl.jgzt='0' then sc.scqlqc else ' ' end) wkgm,
      nvl((gc.wcbtz+gc.wcqttz),0) wcztz,nvl(gc.wcbtz,0) wcbtz,nvl(gc.wcqttz,0) wcqttz,nvl(bf1.bnwctz,0) bnwctz,nvl(pl.wjgyy,' ') wjgyy,decode(jg.yssj,null,'否','是') sfjgys,decode(jg.sfcclq,null,' ',jg.sfcclq) sfcclq,
      nvl(zj.xdbtz,0) xdbtz,nvl(bf.dwbtz,0) dwbtz,decode(zj.xdbtz,null,' ',0,0||'%',round((bf.dwbtz/zj.xdbtz*100),0)||'%') bdwl,
      nvl(zj.xdstz,0) xdstz,nvl(bf.dwstz,0) dwstz,decode(zj.xdstz,null,' ',0,0||'%',round((bf.dwstz/zj.xdstz*100),0)||'%') sdwl,
      nvl(zj.xddfzj,0) xddfzj,nvl(gc.dwdfzj,0) dwdfzj,decode(zj.xddfzj,null,' ',0,0||'%',decode(gc.dwdfzj,null,0||'%',round((gc.dwdfzj/zj.xddfzj*100),0)||'%')) dfdwl,decode(jg.nsqsjjlzj,null,' ',jg.nsqsjjlzj) yjbz,decode(pl.bz,null,' ',pl.bz) bz,
      pl.sbnf,xm.gydwbm gydw
      from xmk_wqgz xm,sck_wqgz sc,plan_wqgz pl,(select jhid,sum(g.wc_btz) wcbtz,sum(g.wc_qttz) wcqttz,decode(sum(g.zjdw_qttz),null,0,sum(g.zjdw_qttz)) dwdfzj from gcgl_wqgz g where to_number(substr(g.sbyf,0,4))&lt;=to_number(#{sbyf}) group by jhid) gc,gcgl_jgys jg,
      (select z.xmid jhid,sum(z.btzzj) xdbtz,sum(z.stz) xdstz,sum(z.xdzj)-sum(z.stz)-sum(z.btzzj) xddfzj from plan_zjxd z where to_number(z.xdnf)&lt;=to_number(#{sbyf}) group by z.xmid) zj,
      (select b.jhid,decode(sum(b.cgsdwzj),null,0,sum(b.cgsdwzj)) dwbtz,decode(sum(b.stz),null,0,sum(b.stz)) dwstz from gcgl_cgs b where to_number(substr(b.tbyf,0,4))&lt;=to_number(#{sbyf}) group by b.jhid) bf,
      (select jhid,sum(g.wc_btz)+sum(g.wc_stz)+sum(g.wc_qttz) bnwctz from gcgl_wqgz g where substr(g.sbyf,0,4)&lt;=#{sbyf} group by g.jhid) bf1
      where xm.id=sc.xmkid and sc.sckid=pl.sckid and pl.id=gc.jhid and pl.id=jg.jhid(+) and pl.id=zj.jhid and pl.id=bf.jhid and pl.id=bf1.jhid
		)
		where 1=1
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		<if test="xmnf != null and  xmnf != ''">
				and sbnf in (${xmnf})
		</if>
		order by xzqhdm
	</select>
	<select id="getAbgcJsb" parameterType="gcglwqgz" resultType="hashmap">
	select * from
		(
		 select nvl(substr(xm.xzqhmc,instr(xzqhmc, '市')+1,length(xm.xzqhmc)),' ') xian,(case when tsdq like '%罗霄山脉连片特困地区%' then '是' else '否' end) sflxs,(case when tsdq like '%原中央苏区%'and tsdq like '%国家贫困县%' then '是' else '否' end) sfpkx,(case when tsdq like '%原中央苏区%' then '是' else '否' end) sfyzy,xm.xzqhdm,xm.xzqhmc,xm.lxbm,xm.lxmc,sc.scqdzh qdzh,sc.sczdzh zdzh,sc.scyhlc yhlc,sc.jsxz,
      decode(pl.xdsj,null,' ',to_char(pl.xdsj,'yyyy-mm-dd')) xdsj,decode(pl.jhkgsj,null,' ',to_char(pl.jhkgsj,'yyyy-mm-dd')) jhkgsj, decode(pl.jhwgsj,null,' ',to_char(pl.jhwgsj,'yyyy-mm-dd')) jhwcsj,decode(pl.yjwgsj,null,' ',to_char(pl.yjwgsj,'yyyy-mm-dd')) yjjgsj,
      pl.pfztz ztz,pl.jhsybbzje zytz,decode(pl.sjkgsj,null,' ',to_char(pl.sjkgsj,'yyyy-mm-dd')) sjkgsj,decode(pl.sjwgsj,null,' ',to_char(pl.sjwgsj,'yyyy-mm-dd')) sjwgsj,nvl(pl.jsdw,' ') jsdw,nvl(pl.sjdw,' ') sjdw,nvl(pl.sgdw,' ') sgdw,nvl(pl.jldw,' ') jldw,nvl(gc.wczlc,0) wczlc,nvl(gc1.wczlc,0) bnwclc,
      nvl((gc.wcbtz+gc.wcqttz),0) wcztz,nvl(gc.wcbtz,0) wcbtz,nvl(gc.wcqttz,0) wcqttz,nvl((gc1.wcbtz+gc1.wcqttz),0) bnwcztz,'0' xmyslc,
      nvl(zj.xdbtz,0) xdbtz,nvl(bf.dwbtz,0) dwbtz,decode(zj.xdbtz,null,' ',0,0||'%',round((bf.dwbtz/zj.xdbtz*100),0)||'%') bdwl,
      nvl(zj.xddfzj,0) xddfzj,nvl(gc.dwdfzj,0) dwdfzj,decode(zj.xddfzj,null,' ',0,0||'%',decode(gc.dwdfzj,null,0||'%',round((gc.dwdfzj/zj.xddfzj*100),0)||'%')) dfdwl,decode(pl.REMARKS,null,' ',pl.REMARKS) bz,pl.jhnf sbnf,xm.gydwbm gydw
      
      from xmk_abgc xm,sck_abgc sc,plan_abgc pl,
      (select jhid,nvl(sum(g.bywc_gl),0) wczlc,sum(g.wc_btz) wcbtz,sum(g.wc_qttz) wcqttz,decode(sum(g.zjdw_qttz),null,0,sum(g.zjdw_qttz)) dwdfzj from gcgl_abgc g where to_number(substr(g.sbyf,0,4))&lt;=to_number(#{sbyf}) group by jhid) gc,
      (select jhid,nvl(sum(g.bywc_gl),0) wczlc,sum(g.wc_btz) wcbtz,sum(g.wc_qttz) wcqttz,decode(sum(g.zjdw_qttz),null,0,sum(g.zjdw_qttz)) dwdfzj from gcgl_abgc g where to_number(substr(g.sbyf,0,4))&lt;=to_number(#{sbyf}) group by jhid) gc1,
      (select z.xmid jhid,sum(z.btzzj) xdbtz,sum(z.stz) xdstz,sum(z.xdzj)-sum(z.stz)-sum(z.btzzj) xddfzj from plan_zjxd z where to_number(z.xdnf)&lt;=to_number(#{sbyf}) group by z.xmid) zj,
      (select b.jhid,decode(sum(b.cgsdwzj),null,0,sum(b.cgsdwzj)) dwbtz,decode(sum(b.stz),null,0,sum(b.stz)) dwstz from gcgl_cgs b where to_number(substr(b.tbyf,0,4))&lt;=to_number(#{sbyf}) group by b.jhid) bf
      
      where xm.id=sc.xmkid and sc.sckid=pl.sckid and pl.id=gc.jhid and pl.id=gc1.jhid and pl.id=zj.jhid and pl.id=bf.jhid
		)
	where 1=1
	<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		<if test="xmnf != null and  xmnf != ''">
				and sbnf in (${xmnf})
		</if>
		order by xzqhdm
	</select>
	
	<select id="getWqgzJsb1" parameterType="gcglwqgz" resultType="elist">
		select * from
		(
			select nvl(substr(xm.xzqhmc,instr(xzqhmc, '市')+1,length(xm.xzqhmc)),' ') v_1,(case when tsdq like '%罗霄山脉连片特困地区%' then '是' else '否' end) v_2,
			(case when tsdq like '%原中央苏区%'and tsdq like '%国家贫困县%' then '是' else '否' end) v_3,(case when tsdq like '%原中央苏区%' then '是' else '否' end) v_4,
			xm.xzqhdm v_5,xm.xzqhmc v_6,xm.lxbm v_7,xm.lxmc v_8,sc.sck_qlzxzh v_9,xm.qlbh v_10,xm.qlmc v_11,decode(pl.xdsj,null,' ',to_char(pl.xdsj,'yyyy-mm-dd')) v_12,decode(pl.jhkgsj,null,' ',to_char(pl.jhkgsj,'yyyy-mm-dd')) v_13, decode(pl.jhwgsj,null,' ',to_char(pl.jhwgsj,'yyyy-mm-dd')) v_14,decode(pl.yjjgsj,null,' ',to_char(pl.yjjgsj,'yyyy-mm-dd')) v_15,xm.qlqc v_16,xm.kjzc v_17,
			sc.jsxz v_18,pl.pfwh v_19,pl.pfztz v_20,pl.jhsybzje v_21,'0' v_22,decode(pl.sjkgsj,null,' ',to_char(pl.sjkgsj,'yyyy-mm-dd')) v_23,decode(pl.sjwgsj,null,' ',to_char(pl.sjwgsj,'yyyy-mm-dd')) v_24,nvl(pl.jsdw,' ') v_25,nvl(pl.sjdw,' ') v_26,nvl(pl.sgdw,' ') v_27,nvl(pl.jldw,' ') v_28,
			sc.scqlqc v_29,sc.scqlqk v_30,decode(to_char(pl.jhkgsj,'yyyy'),to_char(pl.jhwgsj,'yyyy'),'是','否') v_31,(case when pl.kgzt='1' and pl.jgzt='0' then '1' else ' ' end) v_32,(case when pl.kgzt='1' and pl.jgzt='0' then sc.scqlqc else ' ' end) v_33,(case when pl.kgzt='0' and pl.jgzt='0' then '1' else ' ' end) v_34,(case when pl.kgzt='0' and pl.jgzt='0' then sc.scqlqc else ' ' end) v_35,
			nvl((gc.wcbtz+gc.wcqttz),0) v_36,nvl(gc.wcbtz,0) v_37,nvl(gc.wcqttz,0) v_38,nvl(bf1.bnwctz,0) v_39,nvl(pl.wjgyy,' ') v_40,decode(jg.yssj,null,'否','是') v_41,decode(jg.sfcclq,null,' ',jg.sfcclq) v_42,
			nvl(zj.xdbtz,0) v_43,nvl(bf.dwbtz,0) v_44,decode(zj.xdbtz,null,' ',0,0||'%',round((bf.dwbtz/zj.xdbtz*100),0)||'%') v_45,
			nvl(zj.xdstz,0) v_46,nvl(bf.dwstz,0) v_47,decode(zj.xdstz,null,' ',0,0||'%',round((bf.dwstz/zj.xdstz*100),0)||'%') v_48,
			nvl(zj.xddfzj,0) v_49,nvl(gc.dwdfzj,0) v_50,decode(zj.xddfzj,null,' ',0,0||'%',decode(gc.dwdfzj,null,0||'%',round((gc.dwdfzj/zj.xddfzj*100),0)||'%')) v_51,decode(jg.nsqsjjlzj,null,' ',jg.nsqsjjlzj) v_52,decode(pl.bz,null,' ',pl.bz) v_53,
			pl.sbnf,xm.gydwbm gydw,xm.xzqhdm,xm.lxbm
			from xmk_wqgz xm,sck_wqgz sc,plan_wqgz pl,(select jhid,sum(g.wc_btz) wcbtz,sum(g.wc_qttz) wcqttz,decode(sum(g.zjdw_qttz),null,0,sum(g.zjdw_qttz)) dwdfzj from gcgl_wqgz g where to_number(substr(g.sbyf,0,4))&lt;=to_number(#{sbyf}) group by jhid) gc,gcgl_jgys jg,
			(select z.xmid jhid,sum(z.btzzj) xdbtz,sum(z.stz) xdstz,sum(z.xdzj)-sum(z.stz)-sum(z.btzzj) xddfzj from plan_zjxd z where to_number(z.xdnf)&lt;=to_number(#{sbyf}) group by z.xmid) zj,
			(select b.jhid,decode(sum(b.cgsdwzj),null,0,sum(b.cgsdwzj)) dwbtz,decode(sum(b.stz),null,0,sum(b.stz)) dwstz from gcgl_cgs b where to_number(substr(b.tbyf,0,4))&lt;=to_number(#{sbyf}) group by b.jhid) bf,
			(select jhid,sum(g.wc_btz)+sum(g.wc_stz)+sum(g.wc_qttz) bnwctz from gcgl_wqgz g where substr(g.sbyf,0,4)&lt;=#{sbyf} group by g.jhid) bf1
			where xm.id=sc.xmkid and sc.sckid=pl.sckid and pl.id=gc.jhid and pl.id=jg.jhid(+) and pl.id=zj.jhid and pl.id=bf.jhid and pl.id=bf1.jhid
		)
		where 1=1
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		<if test="xmnf != null and  xmnf != ''">
				and sbnf in (${xmnf})
		</if>
		order by xzqhdm
	</select>
	
	<select id="getAbgcJsb1" parameterType="gcglwqgz" resultType="elist">
	select * from
		(
	  select nvl(substr(xm.xzqhmc,instr(xzqhmc, '市')+1,length(xm.xzqhmc)),' ') v_1,(case when tsdq like '%罗霄山脉连片特困地区%' then '是' else '否' end) v_2,(case when tsdq like '%原中央苏区%'and tsdq like '%国家贫困县%' then '是' else '否' end) v_3,(case when tsdq like '%原中央苏区%' then '是' else '否' end) v_4,xm.xzqhdm v_5,xm.xzqhmc v_6,xm.lxbm v_7,xm.lxmc v_8,sc.scqdzh v_9,sc.sczdzh v_10,sc.scyhlc v_11,sc.jsxz v_12,
      decode(pl.xdsj,null,' ',to_char(pl.xdsj,'yyyy-mm-dd')) v_13,decode(pl.jhkgsj,null,' ',to_char(pl.jhkgsj,'yyyy-mm-dd')) v_14, decode(pl.jhwgsj,null,' ',to_char(pl.jhwgsj,'yyyy-mm-dd')) v_15,decode(pl.yjwgsj,null,' ',to_char(pl.yjwgsj,'yyyy-mm-dd')) v_16,
      pl.pfztz v_17,pl.jhsybbzje v_18,decode(pl.sjkgsj,null,' ',to_char(pl.sjkgsj,'yyyy-mm-dd')) v_19,decode(pl.sjwgsj,null,' ',to_char(pl.sjwgsj,'yyyy-mm-dd')) v_20,nvl(pl.jsdw,' ') v_21,nvl(pl.sjdw,' ') v_22,nvl(pl.sgdw,' ') v_23,nvl(pl.jldw,' ') v_24,nvl(gc.wczlc,0) v_25,nvl(gc1.wczlc,0) v_26,
      nvl((gc.wcbtz+gc.wcqttz),0) v_27,nvl(gc.wcbtz,0) v_28,nvl(gc.wcqttz,0) v_29,nvl((gc1.wcbtz+gc1.wcqttz),0) v_30,'0' v_31,
      nvl(zj.xdbtz,0) v_32,nvl(bf.dwbtz,0) v_33,decode(zj.xdbtz,null,' ',0,0||'%',round((bf.dwbtz/zj.xdbtz*100),0)||'%') v_34,
      nvl(zj.xddfzj,0) v_35,nvl(gc.dwdfzj,0) v_36,decode(zj.xddfzj,null,' ',0,0||'%',decode(gc.dwdfzj,null,0||'%',round((gc.dwdfzj/zj.xddfzj*100),0)||'%')) v_37,decode(pl.REMARKS,null,' ',pl.REMARKS) v_38,pl.jhnf sbnf,xm.gydwbm gydw,xm.xzqhdm,xm.lxbm
      from xmk_abgc xm,sck_abgc sc,plan_abgc pl,
      (select jhid,nvl(sum(g.bywc_gl),0) wczlc,sum(g.wc_btz) wcbtz,sum(g.wc_qttz) wcqttz,decode(sum(g.zjdw_qttz),null,0,sum(g.zjdw_qttz)) dwdfzj from gcgl_abgc g where to_number(substr(g.sbyf,0,4))&lt;=to_number(#{sbyf}) group by jhid) gc,
      (select jhid,nvl(sum(g.bywc_gl),0) wczlc,sum(g.wc_btz) wcbtz,sum(g.wc_qttz) wcqttz,decode(sum(g.zjdw_qttz),null,0,sum(g.zjdw_qttz)) dwdfzj from gcgl_abgc g where to_number(substr(g.sbyf,0,4))&lt;=to_number(#{sbyf}) group by jhid) gc1,
      (select z.xmid jhid,sum(z.btzzj) xdbtz,sum(z.stz) xdstz,sum(z.xdzj)-sum(z.stz)-sum(z.btzzj) xddfzj from plan_zjxd z where to_number(z.xdnf)&lt;=to_number(#{sbyf}) group by z.xmid) zj,
      (select b.jhid,decode(sum(b.cgsdwzj),null,0,sum(b.cgsdwzj)) dwbtz,decode(sum(b.stz),null,0,sum(b.stz)) dwstz from gcgl_cgs b where to_number(substr(b.tbyf,0,4))&lt;=to_number(#{sbyf}) group by b.jhid) bf
      where xm.id=sc.xmkid and sc.sckid=pl.sckid and pl.id=gc.jhid and pl.id=gc1.jhid and pl.id=zj.jhid and pl.id=bf.jhid
		)
	where 1=1
	<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		<if test="xmnf != null and  xmnf != ''">
				and sbnf in (${xmnf})
		</if>
		order by xzqhdm
	</select>
	<!-- wqjh -->
	<select id="getWqgzjh1" parameterType="gcglwqgz" resultType="elist">
	select count(*) v_5,'全省合计' v_1,sum(v_6) v_6,sum(v_10) v_10,sum(v_11) v_11,sum(v_12) v_12,sum(v_19) v_19,sum(v_20) v_20 from 
	(
	select 
	  sc.scsqs v_1,sc.scxsq v_2,sc.scszxz v_3,xm.qlbh v_4,xm.qlmc v_5,pl.jhqlqc v_6,pl.jhqlqk v_7,sc.jsxz v_8,sc.jsnr v_9,pl.pfztz v_10,decode(pl.sfylrbwqk,'是',pl.jhsybzje,pl.shengbz) v_11,
	  decode(pl.sfylrbwqk,'是',to_char(to_number(pl.pfztz)-to_number(pl.jhsybzje)),to_char(to_number(pl.pfztz)-to_number(pl.shengbz))) v_12,substr(pl.sjkgsj,0,4) v_13,
	  substr(pl.sjwgsj,0,4) v_14,xm.lxbm v_15,xm.lxmc v_16,sc.sck_qlzxzh v_17,pl.pfwh v_18,nvl(wc.bnztz,0) v_19,nvl(wc.bnstz,0) v_20,pl.yjjgsj v_21,pl.bz v_22,substr(xm.xzqhdm,0,4)||'00' v_30,(select name from xtgl_xzqh where id=substr(xm.xzqhdm,0,4)||'00') v_31,
	  decode(pl.sjwgsj,null,' ',substr(pl.sjwgsj,0,4)) wgnf
	  from plan_wqgz pl,
	  sck_wqgz sc,
	  xmk_wqgz xm,
	  (select (sum(gc.wc_btz)+sum(gc.wc_stz)+sum(gc.wc_qttz)) bnztz,sum(gc.wc_stz) bnstz,gc.jhid from gcgl_wqgz gc where substr(gc.sbyf,0,4)=to_char(sysdate,'yyyy') group by gc.jhid) wc
	  where pl.sckid=sc.sckid and sc.xmkid=xm.id and pl.id=wc.jhid(+) and pl.spzt='1' and xm.gydwbm like '1%'
	<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		<if test="xmnf != null and  xmnf != ''">
				and sbnf in (${xmnf})
		</if>
		<if test="wgnf != null and  wgnf != ''">
				and substr(pl.sjwgsj,0,4)=#{wgnf}
		</if>
		<if test="sfylrbwqk != null and  sfylrbwqk != ''">
				and pl.sfylrbwqk = #{sfylrbwqk}
		</if>
	) t
	</select>
	<select id="getWqgzjh2" parameterType="gcglwqgz" resultType="elist">
	select count(*) v_5,v_30,max(v_31)||'小计' v_1,sum(v_6) v_6,sum(v_10) v_10,sum(v_11) v_1,sum(v_12) v_12,sum(v_19) v_19,sum(v_20) v_20 from 
		(
		select 
	  sc.scsqs v_1,sc.scxsq v_2,sc.scszxz v_3,xm.qlbh v_4,xm.qlmc v_5,pl.jhqlqc v_6,pl.jhqlqk v_7,sc.jsxz v_8,sc.jsnr v_9,pl.pfztz v_10,decode(pl.sfylrbwqk,'是',pl.jhsybzje,pl.shengbz) v_11,
	  decode(pl.sfylrbwqk,'是',to_char(to_number(pl.pfztz)-to_number(pl.jhsybzje)),to_char(to_number(pl.pfztz)-to_number(pl.shengbz))) v_12,substr(pl.sjkgsj,0,4) v_13,
	  substr(pl.sjwgsj,0,4) v_14,xm.lxbm v_15,xm.lxmc v_16,sc.sck_qlzxzh v_17,pl.pfwh v_18,nvl(wc.bnztz,0) v_19,nvl(wc.bnstz,0) v_20,pl.bz v_21,substr(xm.xzqhdm,0,4)||'00' v_30,(select name from xtgl_xzqh where id=substr(xm.xzqhdm,0,4)||'00') v_31,
	  decode(pl.sjwgsj,null,' ',substr(pl.sjwgsj,0,4)) wgnf
	  from plan_wqgz pl,
	  sck_wqgz sc,
	  xmk_wqgz xm,
	  (select (sum(gc.wc_btz)+sum(gc.wc_stz)+sum(gc.wc_qttz)) bnztz,sum(gc.wc_stz) bnstz,gc.jhid from gcgl_wqgz gc where substr(gc.sbyf,0,4)=to_char(sysdate,'yyyy') group by gc.jhid) wc
	  where pl.sckid=sc.sckid and sc.xmkid=xm.id and pl.id=wc.jhid(+) and pl.spzt='1' and xm.gydwbm like '1%'
	<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		<if test="xmnf != null and  xmnf != ''">
				and sbnf in (${xmnf})
		</if>
		<if test="wgnf != null and  wgnf != ''">
				and substr(pl.sjwgsj,0,4)=#{wgnf}
		</if>
		<if test="sfylrbwqk != null and  sfylrbwqk != ''">
				and pl.sfylrbwqk = #{sfylrbwqk}
		</if>
		) t
		group by t.v_30 order by v_30
	
	</select>
	<select id="getWqgzjh3" parameterType="gcglwqgz" resultType="elist">
	select 
	  sc.scsqs v_1,sc.scxsq v_2,sc.scszxz v_3,xm.qlbh v_4,xm.qlmc v_5,pl.jhqlqc v_6,pl.jhqlqk v_7,sc.jsxz v_8,sc.jsnr v_9,pl.pfztz v_10,decode(pl.sfylrbwqk,'是',pl.jhsybzje,pl.shengbz) v_11,
	  decode(pl.sfylrbwqk,'是',to_char(to_number(pl.pfztz)-to_number(pl.jhsybzje)),to_char(to_number(pl.pfztz)-to_number(pl.shengbz))) v_12,substr(pl.sjkgsj,0,4) v_13,
	  substr(pl.sjwgsj,0,4) v_14,xm.lxbm v_15,xm.lxmc v_16,sc.sck_qlzxzh v_17,pl.pfwh v_18,nvl(wc.bnztz,0) v_19,nvl(wc.bnstz,0) v_20,pl.yjjgsj v_21,pl.bz v_22,substr(xm.xzqhdm,0,4)||'00' v_30,(select name from xtgl_xzqh where id=substr(xm.xzqhdm,0,4)||'00') v_31,
	  decode(pl.sjwgsj,null,' ',substr(pl.sjwgsj,0,4)) wgnf
	  from plan_wqgz pl,
	  sck_wqgz sc,
	  xmk_wqgz xm,
	  (select (sum(gc.wc_btz)+sum(gc.wc_stz)+sum(gc.wc_qttz)) bnztz,sum(gc.wc_stz) bnstz,gc.jhid from gcgl_wqgz gc where substr(gc.sbyf,0,4)=to_char(sysdate,'yyyy') group by gc.jhid) wc
	  where pl.sckid=sc.sckid and sc.xmkid=xm.id and pl.id=wc.jhid(+) and pl.spzt='1' and xm.gydwbm like '1%'
	<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		<if test="xmnf != null and  xmnf != ''">
				and sbnf in (${xmnf})
		</if>
		<if test="wgnf != null and  wgnf != ''">
				and substr(pl.sjwgsj,0,4)=#{wgnf}
		</if>
		<if test="sfylrbwqk != null and  sfylrbwqk != ''">
				and pl.sfylrbwqk = #{sfylrbwqk}
		</if>
	order by v_30
	</select>
	<select id="getAbgcjh1" parameterType="gcglwqgz" resultType="elist">
		select 
		 '合计' v_0,count(*) v_4,sum(v_8) v_8,sum(v_11) v_11,sum(v_12) v_12,sum(v_13) v_13,sum(v_14) v_14,sum(v_15) v_15,sum(v_17) v_17,sum(v_18) v_18
		from (
		select 
	    xm.xzqhdm v_1,substr(xm.xzqhdm,0,4)||'00' v_20,(select name from xtgl_xzqh where id=substr(xm.xzqhdm,0,4)||'00') v_21,xm.gydw v_2,xm.lxbm v_3,xm.lxmc v_4,xm.qdzh v_5,xm.zdzh v_6,sc.jsxz v_7,
	    pl.jhyhlc v_8,substr(pl.sjkgsj,0,4) v_9,substr(pl.sjwgsj,0,4) v_10,pl.pfztz v_11,pl.jhsybbzje v_12,nvl(zj.ztz,0) v_13,nvl(zj.btz,0) v_14,nvl(zj.dftz,0) v_15,sc.jsnr v_16,nvl(wc.bnztz,0) v_17,nvl(wc.bnstz,0) v_18,pl.remarks v_19
	    from plan_abgc pl,
	    sck_abgc sc,
	    xmk_abgc xm,
	    (select t.xmid,t.xdzj ztz,t.btzzj btz,to_char(to_number(t.xdzj)-to_number(t.btzzj)) dftz from plan_zjxd t where t.xdnf='2016') zj,
	    (select (sum(gc.wc_btz)+sum(gc.wc_stz)+sum(gc.wc_qttz)) bnztz,sum(gc.wc_stz) bnstz,gc.jhid from gcgl_abgc gc where substr(gc.sbyf,0,4)=to_char(sysdate,'yyyy') group by gc.jhid) wc
	    where pl.sckid=sc.sckid and sc.xmkid=xm.id and pl.id=zj.xmid(+) and pl.id=wc.jhid(+) and pl.spzt='1' and xm.gydwbm like'1%'
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		<if test="xmnf != null and  xmnf != ''">
				and pl.jhnf =${xmnf}
		</if>
		<if test="wgnf != null and  wgnf != ''">
				and substr(pl.sjwgsj,0,4)=#{wgnf}
		</if>
		) tt
	</select>
	<select id="getAbgcjh2" parameterType="gcglwqgz" resultType="elist">
	select 
	 v_20,max(v_21) v_0,count(*) v_4,sum(v_8) v_8,sum(v_11) v_11,sum(v_12) v_12,sum(v_13) v_13,sum(v_14) v_14,sum(v_15) v_15,sum(v_17) v_17,sum(v_18) v_18
	from (
	select 
    xm.xzqhdm v_1,substr(xm.xzqhdm,0,4)||'00' v_20,(select name from xtgl_xzqh where id=substr(xm.xzqhdm,0,4)||'00') v_21,xm.gydw v_2,xm.lxbm v_3,xm.lxmc v_4,xm.qdzh v_5,xm.zdzh v_6,sc.jsxz v_7,
    pl.jhyhlc v_8,substr(pl.sjkgsj,0,4) v_9,substr(pl.sjwgsj,0,4) v_10,pl.pfztz v_11,pl.jhsybbzje v_12,nvl(zj.ztz,0) v_13,nvl(zj.btz,0) v_14,nvl(zj.dftz,0) v_15,sc.jsnr v_16,nvl(wc.bnztz,0) v_17,nvl(wc.bnstz,0) v_18,pl.remarks v_19
    from plan_abgc pl,
    sck_abgc sc,
    xmk_abgc xm,
    (select t.xmid,t.xdzj ztz,t.btzzj btz,to_char(to_number(t.xdzj)-to_number(t.btzzj)) dftz from plan_zjxd t where t.xdnf='2016') zj,
    (select (sum(gc.wc_btz)+sum(gc.wc_stz)+sum(gc.wc_qttz)) bnztz,sum(gc.wc_stz) bnstz,gc.jhid from gcgl_abgc gc where substr(gc.sbyf,0,4)=to_char(sysdate,'yyyy') group by gc.jhid) wc
    where pl.sckid=sc.sckid and sc.xmkid=xm.id and pl.id=zj.xmid(+) and pl.id=wc.jhid(+) and pl.spzt='1' and xm.gydwbm like'1%'
	<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		<if test="xmnf != null and  xmnf != ''">
				and pl.jhnf =${xmnf}
		</if>
		<if test="wgnf != null and  wgnf != ''">
				and substr(pl.sjwgsj,0,4)=#{wgnf}
		</if>
	) tt
	group by tt.v_20
	order by tt.v_20
	</select>
	<select id="getAbgcjh3" parameterType="gcglwqgz" resultType="elist">
		select 
	    xm.xzqhdm v_1,substr(xm.xzqhdm,0,4)||'00' v_20,(select name from xtgl_xzqh where id=substr(xm.xzqhdm,0,4)||'00') v_21,xm.gydw v_2,xm.lxbm v_3,xm.lxmc v_4,xm.qdzh v_5,xm.zdzh v_6,sc.jsxz v_7,
	    pl.jhyhlc v_8,substr(pl.sjkgsj,0,4) v_9,substr(pl.sjwgsj,0,4) v_10,pl.pfztz v_11,pl.jhsybbzje v_12,nvl(zj.ztz,0) v_13,nvl(zj.btz,0) v_14,nvl(zj.dftz,0) v_15,sc.jsnr v_16,nvl(wc.bnztz,0) v_17,nvl(wc.bnstz,0) v_18,pl.remarks v_19
	    from plan_abgc pl,
	    sck_abgc sc,
	    xmk_abgc xm,
	    (select t.xmid,t.xdzj ztz,t.btzzj btz,to_char(to_number(t.xdzj)-to_number(t.btzzj)) dftz from plan_zjxd t where t.xdnf='2016') zj,
	    (select (sum(gc.wc_btz)+sum(gc.wc_stz)+sum(gc.wc_qttz)) bnztz,sum(gc.wc_stz) bnstz,gc.jhid from gcgl_abgc gc where substr(gc.sbyf,0,4)=to_char(sysdate,'yyyy') group by gc.jhid) wc
	    where pl.sckid=sc.sckid and sc.xmkid=xm.id and pl.id=zj.xmid(+) and pl.id=wc.jhid(+) and pl.spzt='1' and xm.gydwbm like'1%'
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		<if test="xmnf != null and  xmnf != ''">
				and pl.jhnf =${xmnf}
		</if>
		<if test="wgnf != null and  wgnf != ''">
				and substr(pl.sjwgsj,0,4)=#{wgnf}
		</if>
		order by  v_20
	</select>
	
	
	<select id="getWqgzjy1" parameterType="gcglwqgz" resultType="elist">
	select count(*) v_6,'全省合计' v_1,sum(v_11) v_11,sum(v_12) v_12,sum(v_13) v_13,sum(v_23) v_23,sum(v_24) v_24,sum(v_25) v_25,sum(v_26) v_26 from 
	(
	select 
		sc.scsqs v_1,sc.scxsq v_2,xm.lxbm v_3,xm.lxmc v_4,xm.qlbh v_5,xm.qlmc v_6,sc.sck_qlzxzh v_7,sc.fapgdw v_8,pl.sjpfdw v_9,sc.pfwh v_10,pl1.ztz v_11,pl1.btz v_12,pl1.dftz v_13,
		pl.sfsqablbz v_14,pl.ablbzsqwh v_15,sc.jsxz v_16,sc.jsnr v_17,to_char(pl.jhkgsj, 'yyyy') v_18,to_char(pl.jhwgsj, 'yyyy') v_19,sc.scsqs v_20,sc.scxsq v_21,sc.scszxz v_22,
		to_number(pl1.ztz)*0.6 v_23,sc.zdezj v_24,pl1.btz v_25,sc.scqlqk v_26,sc.scqlqk v_27,sc.scbz v_28, substr(xm.xzqhdm, 0, 4) || '00' v_29,
		(select name from xtgl_xzqh where id = substr(xm.xzqhdm, 0, 4) || '00') v_30
		from plan_wqgz pl,sck_wqgz sc,xmk_wqgz xm,
		(select sckid,p.ztz ztz,p.nsqbbz btz,to_char(to_number(p.ztz)-to_number(p.nsqbbz)) dftz from sck_wqgz p) pl1
		where pl.sckid=sc.sckid and sc.xmkid=xm.id and pl.sckid=pl1.sckid
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		<if test="xmnf != null and  xmnf != ''">
				and sbnf =${xmnf}
		</if>
		<if test="sfylrbwqk != null and  sfylrbwqk != ''">
				and pl.sfylrbwqk = #{sfylrbwqk}
		</if>
	) t
	</select>
	<select id="getWqgzjy2" parameterType="gcglwqgz" resultType="elist">
	select count(*) v_5,v_29,max(v_30)||'小计' v_1,sum(v_11) v_11,sum(v_12) v_12,sum(v_13) v_13,sum(v_23) v_23,sum(v_24) v_24,sum(v_25) v_25,sum(v_26) v_26 from 
		(
		select 
		sc.scsqs v_1,sc.scxsq v_2,xm.lxbm v_3,xm.lxmc v_4,xm.qlbh v_5,xm.qlmc v_6,sc.sck_qlzxzh v_7,sc.fapgdw v_8,pl.sjpfdw v_9,sc.pfwh v_10,pl1.ztz v_11,pl1.btz v_12,pl1.dftz v_13,
		pl.sfsqablbz v_14,pl.ablbzsqwh v_15,sc.jsxz v_16,sc.jsnr v_17,to_char(pl.jhkgsj, 'yyyy') v_18,to_char(pl.jhwgsj, 'yyyy') v_19,sc.scsqs v_20,sc.scxsq v_21,sc.scszxz v_22,
		to_number(pl1.ztz)*0.6 v_23,sc.zdezj v_24,pl1.btz v_25,sc.scqlqk v_26,sc.scqlqk v_27,sc.scbz v_28, substr(xm.xzqhdm, 0, 4) || '00' v_29,
		(select name from xtgl_xzqh where id = substr(xm.xzqhdm, 0, 4) || '00') v_30
		from plan_wqgz pl,sck_wqgz sc,xmk_wqgz xm,
		(select sckid,p.ztz ztz,p.nsqbbz btz,to_char(to_number(p.ztz)-to_number(p.nsqbbz)) dftz from sck_wqgz p) pl1
		where pl.sckid=sc.sckid and sc.xmkid=xm.id and pl.sckid=pl1.sckid
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		<if test="xmnf != null and  xmnf != ''">
				and sbnf =${xmnf}
		</if>
		<if test="sfylrbwqk != null and  sfylrbwqk != ''">
				and pl.sfylrbwqk = #{sfylrbwqk}
		</if>
		) t
		group by t.v_29 order by v_29
	
	</select>
	<select id="getWqgzjy3" parameterType="gcglwqgz" resultType="elist">
		select 
		sc.scsqs v_1,sc.scxsq v_2,xm.lxbm v_3,xm.lxmc v_4,xm.qlbh v_5,xm.qlmc v_6,sc.sck_qlzxzh v_7,decode(sc.fapgdw,null,'',sc.fapgdw) v_8,pl.sjpfdw v_9,sc.pfwh v_10,pl1.ztz v_11,pl1.btz v_12,pl1.dftz v_13,
		pl.sfsqablbz v_14,pl.ablbzsqwh v_15,sc.jsxz v_16,sc.jsnr v_17,to_char(pl.jhkgsj, 'yyyy') v_18,to_char(pl.jhwgsj, 'yyyy') v_19,sc.scsqs v_20,sc.scxsq v_21,sc.scszxz v_22,
		to_number(pl1.ztz)*0.6 v_23,sc.zdezj v_24,pl1.btz v_25,sc.scqlqk v_26,sc.scqlqk v_27,sc.scbz v_28, substr(xm.xzqhdm, 0, 4) || '00' v_29,
		(select name from xtgl_xzqh where id = substr(xm.xzqhdm, 0, 4) || '00') v_30
		from plan_wqgz pl,sck_wqgz sc,xmk_wqgz xm,
		(select sckid,p.ztz ztz,p.nsqbbz btz,to_char(to_number(p.ztz)-to_number(p.nsqbbz)) dftz from sck_wqgz p) pl1
		where pl.sckid=sc.sckid and sc.xmkid=xm.id and pl.sckid=pl1.sckid
		<if test="gydw != null and  gydw != ''">
				${gydw}
		</if>
		<if test="xzqhdm != null and  xzqhdm != ''">
				${xzqhdm}
		</if>
		<if test="tiaojian != null and  tiaojian != ''">
				and lxbm like trim(#{tiaojian})||'%'
		</if>
		<if test="xmnf != null and  xmnf != ''">
				and sbnf =${xmnf}
		</if>
		<if test="sfylrbwqk != null and  sfylrbwqk != ''">
				and pl.sfylrbwqk = #{sfylrbwqk}
		</if>
		order by v_29
	</select>
	<select id="getGlgzxj" parameterType="gcglabgc" resultType="elist">
		select v_1,v_2,(select WMSYS.WM_CONCAT(distinct to_char(xzqh)) from lxsh_lx l where l.xmid=v_1 and l.jdbs='1' ) v_3,v_4,v_5,v_6,v_7,v_8,v_9,v_10,
		v_11,v_12,v_13,v_14,v_15,v_16,v_17,v_18,v_19,v_20,
		v_21,v_22,v_23,v_24,v_25,v_26,v_27,v_28,v_29,v_30,
		v_31,v_32,v_33,v_34,v_35,v_36,v_37,v_38,v_39,v_40,
		v_41,v_42,v_43,v_44,v_45,v_46,decode(v_36,'0','0',null,'0',round(v_46 / v_36 * 100, 0))  v_47,v_48,v_49,v_50,
		v_51,v_52,(case when to_number(v_54)&lt;0 then v_48 else v_53 end) v_53,(case when to_number(v_54)&lt;0 then 0 else v_54 end) v_54,v_55,v_56,v_57,v_58,nvl(v_60,0)+nvl(v_61,0)+nvl(v_62,0)+nvl(v_63,0)+nvl(v_64,0)+nvl(v_65,0)+nvl(v_66,0)+nvl(v_67,0)+nvl(v_68,0) v_59,v_60,
		v_61,v_62,v_63,v_64,v_65,v_66,v_67,v_68,v_69,v_70,
		v_71,v_72,v_73,v_74,(case when to_number(v_76)&lt;0 then v_70 else v_75 end) v_75,(case when to_number(v_76)&lt;0 then 0 else v_76 end) v_76,v_77,v_78,decode(v_14,'0','0',null,'0',round(v_70 / v_14 * 100, 0)) v_79,decode(v_19,'0','0',null,'0',round(v_60 / v_19 * 100, 0)) v_80,
		decode(v_18,'0','0',null,'0',round(v_69 / v_18 * 100, 0)) v_81,v_82,xzqhdm v_83,v_84 from GLGZXJMXB where 1=1
			    <if test="xmnf != null and  xmnf != ''">
		      and xmnf in (${xmnf})
		    </if>
		    <if test="gydw != null and  gydw != ''">
		        ${gydw}
		    </if>
		    <if test="xzqhdm != null and  xzqhdm != ''">
		        ${xzqhdm}
		    </if>
		    <if test="lxmc != null and  lxmc != ''">
		        and lxmc like '%'||trim(#{lxmc})||'%'
		    </if>
		    <if test="xmmc != null and  xmmc != ''">
		        and xmmc like '%'||trim(#{xmmc})||'%'
		    </if>
		    <if test="tiaojian != null and  tiaojian != ''">
		        ${tiaojian}
		    </if>
		    <if test="yjsdj != null and  tiaojian != ''">
		        ${yjsdj}
		    </if>
		     <if test="jsjsdj != null and  jsjsdj != ''">
		        ${jsjsdj}
		    </if>
		     <if test="gljslx != null and  gljslx != ''">
		        ${gljslx}
		    </if>
		     <if test="jhnd != null and  jhnd != ''">
		        ${jhnd}
		    </if>
		     <if test="jzzt != null and  jzzt != ''">
		        ${jzzt}
		    </if>
		     <if test="bnjhtz != null and  bnjhtz != ''">
		        ${bnjhtz}
		    </if>
		    <if test="bndsslc != null and  bndsslc != ''">
		        ${bndsslc}
		    </if> 
		    order by xzqhdm,decode(v_84,'新建',1,'改建',2,'路面改造',3,'灾毁重建',4)
	</select>
	<select id="getGlgzxj1" parameterType="gcglabgc" resultType="elist">
	select 
    '是' v_0,max(xzqhmc)||'合计' v_3,sum(v_14) v_14,sum(v_18) v_18,sum(v_19) v_19,sum(v_20) v_20,sum(v_21) v_21,sum(v_22) v_22,sum(v_23) v_23,sum(v_24) v_24,sum(v_25) v_25,
     sum(v_26) v_26,sum(v_27) v_27,sum(v_28) v_28,sum(v_29) v_29,sum(v_30) v_30,sum(v_31) v_31,sum(v_32) v_32,sum(v_33) v_33,
     sum(v_36) v_36,sum(v_37) v_37,sum(v_38) v_38,sum(v_39) v_39,sum(v_40) v_40,sum(v_41) v_41,sum(v_42) v_42,sum(v_43) v_43,sum(v_44) v_44,sum(v_45) v_45,sum(v_46) v_46,decode(sum(v_36),'0','0',null,'0',round(sum(v_46) / sum(v_36) * 100, 0)) v_47,sum(v_48) v_48,
     sum(v_49) v_49,sum(v_50) v_50,sum(v_51) v_51,sum(v_52) v_52,(case when to_number(sum(v_54))&lt;0 then sum(v_48) else sum(v_53) end) v_53,(case when to_number(sum(v_54))&lt;0 then 0 else sum(v_54) end) v_54,sum(v_55) v_55,sum(v_56) v_56,sum(v_57) v_57,sum(v_58) v_58,
     sum(nvl(v_60,0))+sum(nvl(v_61,0))+sum(nvl(v_62,0))+sum(nvl(v_63,0))+sum(nvl(v_64,0))+sum(nvl(v_65,0))+sum(nvl(v_66,0))+sum(nvl(v_67,0))+sum(nvl(v_68,0)) v_59,sum(v_60) v_60,sum(v_61) v_61,sum(v_62) v_62,sum(v_63) v_63,sum(v_64) v_64,sum(v_65) v_65,sum(v_66) v_66,sum(v_67) v_67,sum(v_68) v_68,
     sum(v_69) v_69,sum(v_70) v_70,sum(v_71) v_71,sum(v_72) v_72,sum(v_73) v_73,sum(v_74) v_74,(case when to_number(sum(v_76))&lt;0 then sum(v_70) else sum(v_75) end) v_75,(case when to_number(sum(v_76))&lt;0 then 0 else sum(v_76) end) v_76,sum(v_77) v_77,sum(v_78) v_78,decode(sum(v_14),'0','0',null,'0',round(sum(v_70) / sum(v_14) * 100, 0)) v_79,decode(sum(v_19),'0','0',null,'0',round(sum(v_60) / sum(v_19) * 100, 0)) v_80,
     decode(sum(v_18),'0','0',null,'0',round(sum(v_69) / sum(v_18) * 100, 0)) v_81,min(xzqhdm) v_83,min(v_84) v_84
     
 from (select * from GLGZXJMXB where 1=1
			    <if test="xmnf != null and  xmnf != ''">
		        and xmnf in (${xmnf})
		    </if>
		    <if test="gydw != null and  gydw != ''">
		        ${gydw}
		    </if>
		    <if test="xzqhdm != null and  xzqhdm != ''">
		        ${xzqhdm}
		    </if>
		    <if test="lxmc != null and  lxmc != ''">
		        and lxmc like '%'||trim(#{lxmc})||'%'
		    </if>
		    <if test="xmmc != null and  xmmc != ''">
		        and xmmc like '%'||trim(#{xmmc})||'%'
		    </if>
		    <if test="tiaojian != null and  tiaojian != ''">
		        ${tiaojian}
		    </if>
		    <if test="yjsdj != null and  tiaojian != ''">
		        ${yjsdj}
		    </if>
		     <if test="jsjsdj != null and  jsjsdj != ''">
		        ${jsjsdj}
		    </if>
		     <if test="gljslx != null and  gljslx != ''">
		        ${gljslx}
		    </if>
		     <if test="jhnd != null and  jhnd != ''">
		        ${jhnd}
		    </if>
		     <if test="jzzt != null and  jzzt != ''">
		        ${jzzt}
		    </if>
		   <if test="bnjhtz != null and  bnjhtz != ''">
		        ${bnjhtz}
		    </if>
		    <if test="bndsslc != null and  bndsslc != ''">
		        ${bndsslc}
		    </if>
		     ) tb group by xzqhdm order by v_83,decode(v_84,'新建',1,'改建',2,'路面改造',3,'灾毁重建',4)
	</select>
	<select id="getGlgzxj2" parameterType="gcglabgc" resultType="elist">
	select 
    '是' v_0,tb.v_84 v_3,sum(v_14) v_14,sum(v_18) v_18,sum(v_19) v_19,sum(v_20) v_20,sum(v_21) v_21,sum(v_22) v_22,sum(v_23) v_23,sum(v_24) v_24,sum(v_25) v_25,
     sum(v_26) v_26,sum(v_27) v_27,sum(v_28) v_28,sum(v_29) v_29,sum(v_30) v_30,sum(v_31) v_31,sum(v_32) v_32,sum(v_33) v_33,
     sum(v_36) v_36,sum(v_37) v_37,sum(v_38) v_38,sum(v_39) v_39,sum(v_40) v_40,sum(v_41) v_41,sum(v_42) v_42,sum(v_43) v_43,sum(v_44) v_44,sum(v_45) v_45,sum(v_46) v_46,decode(sum(v_36),'0','0',null,'0',round(sum(v_46) / sum(v_36) * 100, 0)) v_47,sum(v_48) v_48,
     sum(v_49) v_49,sum(v_50) v_50,sum(v_51) v_51,sum(v_52) v_52,(case when to_number(sum(v_54))&lt;0 then sum(v_48) else sum(v_53) end) v_53,(case when to_number(sum(v_54))&lt;0 then 0 else sum(v_54) end) v_54,sum(v_55) v_55,sum(v_56) v_56,sum(v_57) v_57,sum(v_58) v_58,
     sum(nvl(v_60,0))+sum(nvl(v_61,0))+sum(nvl(v_62,0))+sum(nvl(v_63,0))+sum(nvl(v_64,0))+sum(nvl(v_65,0))+sum(nvl(v_66,0))+sum(nvl(v_67,0))+sum(nvl(v_68,0)) v_59,sum(v_60) v_60,sum(v_61) v_61,sum(v_62) v_62,sum(v_63) v_63,sum(v_64) v_64,sum(v_65) v_65,sum(v_66) v_66,sum(v_67) v_67,sum(v_68) v_68,
     sum(v_69) v_69,sum(v_70) v_70,sum(v_71) v_71,sum(v_72) v_72,sum(v_73) v_73,sum(v_74) v_74,(case when to_number(sum(v_76))&lt;0 then sum(v_70) else sum(v_75) end) v_75,(case when to_number(sum(v_76))&lt;0 then 0 else sum(v_76) end) v_76,sum(v_77) v_77,sum(v_78) v_78,decode(sum(v_14),'0','0',null,'0',round(sum(v_70) / sum(v_14) * 100, 0)) v_79,decode(sum(v_19),'0','0',null,'0',round(sum(v_60) / sum(v_19) * 100, 0)) v_80,
     decode(sum(v_18),'0','0',null,'0',round(sum(v_69) / sum(v_18) * 100, 0)) v_81,min(xzqhdm) v_83, v_84
 from (select * from GLGZXJMXB where 1=1
			    <if test="xmnf != null and  xmnf != ''">
		       and xmnf in (${xmnf})
		    </if>
		    <if test="gydw != null and  gydw != ''">
		        ${gydw}
		    </if>
		    <if test="xzqhdm != null and  xzqhdm != ''">
		        ${xzqhdm}
		    </if>
		    <if test="lxmc != null and  lxmc != ''">
		        and lxmc like '%'||trim(#{lxmc})||'%'
		    </if>
		    <if test="xmmc != null and  xmmc != ''">
		        and xmmc like '%'||trim(#{xmmc})||'%'
		    </if>
		    <if test="tiaojian != null and  tiaojian != ''">
		        ${tiaojian}
		    </if>
		    <if test="yjsdj != null and  tiaojian != ''">
		        ${yjsdj}
		    </if>
		     <if test="jsjsdj != null and  jsjsdj != ''">
		        ${jsjsdj}
		    </if>
		     <if test="gljslx != null and  gljslx != ''">
		        ${gljslx}
		    </if>
		     <if test="jhnd != null and  jhnd != ''">
		        ${jhnd}
		    </if>
		     <if test="jzzt != null and  jzzt != ''">
		        ${jzzt}
		    </if>
		      <if test="bnjhtz != null and  bnjhtz != ''">
		        ${bnjhtz}
		    </if>
		    <if test="bndsslc != null and  bndsslc != ''">
		        ${bndsslc}
		    </if>
		    ) tb group by xzqhdm,v_84 order by v_83,decode(v_84,'新建',1,'改建',2,'路面改造',3,'灾毁重建',4)
	</select>
	
		<select id="getGlgzxj3" parameterType="gcglabgc" resultType="elist">
	select 
    '是' v_0,'合计' v_3,sum(v_14) v_14,sum(v_18) v_18,sum(v_19) v_19,sum(v_20) v_20,sum(v_21) v_21,sum(v_22) v_22,sum(v_23) v_23,sum(v_24) v_24,sum(v_25) v_25,
     sum(v_26) v_26,sum(v_27) v_27,sum(v_28) v_28,sum(v_29) v_29,sum(v_30) v_30,sum(v_31) v_31,sum(v_32) v_32,sum(v_33) v_33,
     sum(v_36) v_36,sum(v_37) v_37,sum(v_38) v_38,sum(v_39) v_39,sum(v_40) v_40,sum(v_41) v_41,sum(v_42) v_42,sum(v_43) v_43,sum(v_44) v_44,sum(v_45) v_45,sum(v_46) v_46,decode(sum(v_36),'0','0',null,'0',round(sum(v_46) / sum(v_36) * 100, 0)) v_47,sum(v_48) v_48,
     sum(v_49) v_49,sum(v_50) v_50,sum(v_51) v_51,sum(v_52) v_52,(case when to_number(sum(v_54))&lt;0 then sum(v_48) else sum(v_53) end) v_53,(case when to_number(sum(v_54))&lt;0 then 0 else sum(v_54) end) v_54,sum(v_55) v_55,sum(v_56) v_56,sum(v_57) v_57,sum(v_58) v_58,
     sum(nvl(v_60,0))+sum(nvl(v_61,0))+sum(nvl(v_62,0))+sum(nvl(v_63,0))+sum(nvl(v_64,0))+sum(nvl(v_65,0))+sum(nvl(v_66,0))+sum(nvl(v_67,0))+sum(nvl(v_68,0)) v_59,sum(v_60) v_60,sum(v_61) v_61,sum(v_62) v_62,sum(v_63) v_63,sum(v_64) v_64,sum(v_65) v_65,sum(v_66) v_66,sum(v_67) v_67,sum(v_68) v_68,
     sum(v_69) v_69,sum(v_70) v_70,sum(v_71) v_71,sum(v_72) v_72,sum(v_73) v_73,sum(v_74) v_74,(case when to_number(sum(v_76))&lt;0 then sum(v_70) else sum(v_75) end) v_75,(case when to_number(sum(v_76))&lt;0 then 0 else sum(v_76) end) v_76,sum(v_77) v_77,sum(v_78) v_78,decode(sum(v_14),'0','0',null,'0',round(sum(v_70) / sum(v_14) * 100, 0)) v_79,decode(sum(v_19),'0','0',null,'0',round(sum(v_60) / sum(v_19) * 100, 0)) v_80,
     decode(sum(v_18),'0','0',null,'0',round(sum(v_69) / sum(v_18) * 100, 0)) v_81
 from (select * from GLGZXJMXB where 1=1
			    <if test="xmnf != null and  xmnf != ''">
		       and xmnf in (${xmnf})
		    </if>
		    <if test="gydw != null and  gydw != ''">
		        ${gydw}
		    </if>
		    <if test="xzqhdm != null and  xzqhdm != ''">
		        ${xzqhdm}
		    </if>
		    <if test="lxmc != null and  lxmc != ''">
		        and lxmc like '%'||trim(#{lxmc})||'%'
		    </if>
		    <if test="xmmc != null and  xmmc != ''">
		        and xmmc like '%'||trim(#{xmmc})||'%'
		    </if>
		    <if test="tiaojian != null and  tiaojian != ''">
		        ${tiaojian}
		    </if>
		    <if test="yjsdj != null and  tiaojian != ''">
		        ${yjsdj}
		    </if>
		     <if test="jsjsdj != null and  jsjsdj != ''">
		        ${jsjsdj}
		    </if>
		     <if test="gljslx != null and  gljslx != ''">
		        ${gljslx}
		    </if>
		     <if test="jhnd != null and  jhnd != ''">
		        ${jhnd}
		    </if>
		     <if test="jzzt != null and  jzzt != ''">
		        ${jzzt}
		    </if>
		    <if test="bnjhtz != null and  bnjhtz != ''">
		        ${bnjhtz}
		    </if>
		    <if test="bndsslc != null and  bndsslc != ''">
		        ${bndsslc}
		    </if>
		    ) tb
	</select>
	<select id="getGlgzxj4" parameterType="gcglabgc" resultType="elist">
	select 
     '是' v_0,tb.v_84 v_3,sum(v_14) v_14,sum(v_18) v_18,sum(v_19) v_19,sum(v_20) v_20,sum(v_21) v_21,sum(v_22) v_22,sum(v_23) v_23,sum(v_24) v_24,sum(v_25) v_25,
     sum(v_26) v_26,sum(v_27) v_27,sum(v_28) v_28,sum(v_29) v_29,sum(v_30) v_30,sum(v_31) v_31,sum(v_32) v_32,sum(v_33) v_33,
     sum(v_36) v_36,sum(v_37) v_37,sum(v_38) v_38,sum(v_39) v_39,sum(v_40) v_40,sum(v_41) v_41,sum(v_42) v_42,sum(v_43) v_43,sum(v_44) v_44,sum(v_45) v_45,sum(v_46) v_46,decode(sum(v_36),'0','0',null,'0',round(sum(v_46) / sum(v_36) * 100, 0)) v_47,sum(v_48) v_48,
     sum(v_49) v_49,sum(v_50) v_50,sum(v_51) v_51,sum(v_52) v_52,(case when to_number(sum(v_54))&lt;0 then sum(v_48) else sum(v_53) end) v_53,(case when to_number(sum(v_54))&lt;0 then 0 else sum(v_54) end) v_54,sum(v_55) v_55,sum(v_56) v_56,sum(v_57) v_57,sum(v_58) v_58,
     sum(nvl(v_60,0))+sum(nvl(v_61,0))+sum(nvl(v_62,0))+sum(nvl(v_63,0))+sum(nvl(v_64,0))+sum(nvl(v_65,0))+sum(nvl(v_66,0))+sum(nvl(v_67,0))+sum(nvl(v_68,0)) v_59,sum(v_60) v_60,sum(v_61) v_61,sum(v_62) v_62,sum(v_63) v_63,sum(v_64) v_64,sum(v_65) v_65,sum(v_66) v_66,sum(v_67) v_67,sum(v_68) v_68,
     sum(v_69) v_69,sum(v_70) v_70,sum(v_71) v_71,sum(v_72) v_72,sum(v_73) v_73,sum(v_74) v_74,(case when to_number(sum(v_76))&lt;0 then sum(v_70) else sum(v_75) end) v_75,(case when to_number(sum(v_76))&lt;0 then 0 else sum(v_76) end) v_76,sum(v_77) v_77,sum(v_78) v_78,decode(sum(v_14),'0','0',null,'0',round(sum(v_70) / sum(v_14) * 100, 0)) v_79,decode(sum(v_19),'0','0',null,'0',round(sum(v_60) / sum(v_19) * 100, 0)) v_80,
     decode(sum(v_18),'0','0',null,'0',round(sum(v_69) / sum(v_18) * 100, 0)) v_81, v_84
 from (select * from GLGZXJMXB where 1=1
			    <if test="xmnf != null and  xmnf != ''">
		       and xmnf in (${xmnf})
		    </if>
		    <if test="gydw != null and  gydw != ''">
		        ${gydw}
		    </if>
		    <if test="xzqhdm != null and  xzqhdm != ''">
		        ${xzqhdm}
		    </if>
		    <if test="lxmc != null and  lxmc != ''">
		        and lxmc like '%'||trim(#{lxmc})||'%'
		    </if>
		    <if test="xmmc != null and  xmmc != ''">
		        and xmmc like '%'||trim(#{xmmc})||'%'
		    </if>
		    <if test="tiaojian != null and  tiaojian != ''">
		        ${tiaojian}
		    </if>
		    <if test="yjsdj != null and  tiaojian != ''">
		        ${yjsdj}
		    </if>
		     <if test="jsjsdj != null and  jsjsdj != ''">
		        ${jsjsdj}
		    </if>
		     <if test="gljslx != null and  gljslx != ''">
		        ${gljslx}
		    </if>
		     <if test="jhnd != null and  jhnd != ''">
		        ${jhnd}
		    </if>
		     <if test="jzzt != null and  jzzt != ''">
		        ${jzzt}
		    </if>
		     <if test="bnjhtz != null and  bnjhtz != ''">
		        ${bnjhtz}
		    </if>
		    <if test="bndsslc != null and  bndsslc != ''">
		        ${bndsslc}
		    </if>
		    ) tb group by v_84 order by decode(v_84,'新建',1,'改建',2,'路面改造',3,'灾毁重建',4)
	</select>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<select id="xmkaqsmfhbb1" parameterType="String" resultType="elist">
	select t.xuh v_0,t.province v_1,t.town v_2,t.county v_3,t.roadcode v_4,t.jsdj v_5,t.fangx v_6,t.roadstart v_7,t.roadend v_8,t.pcsj v_9,t.ldfl v_10,
	t.jtsgpcf v_11,t.jtsgfxdj v_12,t.gltjpcf v_13,t.glfxdj v_14,t.xbjyqx v_15,t.lxxp v_16,t.doup v_17,t.sjbl v_18,t.lcxy v_19,t.hjfz v_20,t.jckbgf v_21,
	t.jtl v_22,t.xchbc v_23,t.csxsss v_24,t.hul v_25,t.bzbx v_26,t.jshsxyd v_27,t.aqssqt v_28,t.tjgc v_29,t.hjzz v_30,t.bzbxcz v_31,t.jckcz v_32,
	t.jzhl v_33,t.jshsxydcz v_34,t.aqssqtcz v_35,t.tzgs v_36,t.jhnf v_37
	from XMK_AQSMFH t
	where 1=1 ${value}
	order by distcode,xuh
	</select>
	<select id="xmkaqsmfhbb2" parameterType="String" resultType="elist">
	select t.xuh v_0,t.province v_1,t.town v_2,t.county v_3,t.roadcode v_4,t.jsdj v_5,t.fangx v_6,t.roadstart v_7,t.roadend v_8,t.pcsj v_9,t.ldfl v_10,
	  t.sgpb v_11,t.dgjw v_12,t.lxjw v_13,t.lxxp v_14,t.doup v_15,t.sjbl v_16,t.lcxy v_17,t.hjfz v_18,t.jtlpbzb v_19,
	  t.xchbc v_20,t.csxsss v_21,t.hul v_22,t.bzbx v_23,t.jshsxyd v_24,t.aqssqt v_25,t.tjgc v_26,t.hjzz v_27,t.bzbxcz v_28,t.jckcz v_29,
	  t.jzhl v_30,t.jshsxydcz v_31,t.aqssqtcz v_32,t.tzgs v_33,t.jhnf v_34
  	from XMK_AQSMFH t
	where 1=1 ${value}
	order by distcode,xuh
	</select>
	<select id="sckaqsmfhbb" parameterType="String" resultType="elist">
	select ld.xuh v_0,ld.province v_1,ld.town v_2,ld.county v_3,ld.lxbm v_4,
      decode(ld.xuh,ld1.xuh,sc.yhlc,'') v_5,decode(ld.xuh,ld1.xuh,sc.xjgjnd,'') v_6,decode(ld.xuh,ld1.xuh,sc.fapgdw,'') v_7,
      decode(ld.xuh,ld1.xuh,sc.fascdw,'') v_8,decode(ld.xuh,ld1.xuh,sc.faspsj,'') v_9,decode(ld.xuh,ld1.xuh,sc.spwh,'') v_10,
      decode(ld.xuh,ld1.xuh,sc.jsxz,'') v_11,decode(ld.xuh,ld1.xuh,sc.cztzgs,'') v_12,decode(ld.xuh,ld1.xuh,sc.sfsqablbz,'') v_13,
      decode(ld.xuh,ld1.xuh,sc.ablbzsqwh,'') v_14,decode(ld.xuh,ld1.xuh,sc.bz,'') v_15
        from sck_aqsmfh_ld ld,xmk_aqsmfh xm,SCK_AQSMFH sc,(select min(xuh) xuh,xmbm from sck_aqsmfh_ld group by xmbm) ld1 
        where ld.xmkid=xm.id and ld.xmbm=sc.xmbm and ld.xmbm=ld1.xmbm(+)
       and sc.jhnf is not null
		${value}
		order by sc.xmbm,ld.xuh
	</select>
	
	<insert id="glgzxjmxb" parameterType="String">
			${value}
	</insert>
	<insert id="createybView" parameterType="String">
			${value}
	</insert>
	<select id="getGsgxsjgzjd" parameterType="String" resultType="elist">
		${value}
	</select>
	
	<select id="getHzgjxj" parameterType="gcglwqgz" resultType="elist">
		select * from(
		select 
		max(t1.xzqh) xzqh,36 xzqhdm,t1.xdnf v_1,t1.jhxdwh v_2,
                nvl(sum(t2.xmsl), 0) v_3,nvl(sum(t2.gsyi + t2.gser + t2.sser + t2.sssan + t2.qt), 0) v_4,
                nvl(sum(t2.gsyi), 0) v_5,nvl(sum(t2.gser), 0) v_6,nvl(sum(t2.sser), 0) v_7,nvl(sum(t2.sssan), 0) v_8,
                nvl(sum(t2.qt), 0) v_9,nvl(sum(t1.ztz), 0) v_10,nvl(sum(t1.btz), 0) v_11,
                nvl(sum(t1.stz), 0) v_12,nvl(sum(t1.gz), 0) v_13,nvl(sum(t1.sz), 0) v_14,nvl(sum(t1.stc), 0) v_15,
                nvl(sum(t1.qtzj), 0) v_16,nvl(sum(t3.xmsl), 0) v_17,nvl(sum(t3.bngsyi + t3.bngser + t3.bnsser + t3.bnsssan + t3.bnqt),0) v_18,
                nvl(sum(t3.bngsyi), 0) v_19,nvl(sum(t3.bngser), 0) v_20,nvl(sum(t3.bnsser), 0) v_21,nvl(sum(t3.bnsssan), 0) v_22,
                nvl(sum(t3.bnqt), 0) v_23,nvl(sum(t4.xmsl), 0) v_24,nvl(sum(t4.ljgsyi + t4.ljgser + t4.ljsser + t4.ljsssan + t4.ljqt),0) v_25,
                nvl(sum(t4.ljgsyi), 0) v_26,nvl(sum(t4.ljgser), 0) v_27,nvl(sum(t4.ljsser), 0) v_28,
                nvl(sum(t4.ljsssan), 0) v_29,nvl(sum(t4.ljqt), 0) v_30,nvl(sum(t3.bnwctz), 0) v_31,nvl(sum(t4.ljwctz), 0) v_32,'0' v_0
		from 
		(      select 
	      xdnf,jhxdwh,'总计' xzqh,sum(ztz) ztz,sum(btz) btz,sum(stz) stz,sum(gz) gz,sum(sz) sz,sum(stc) stc,sum(qtzj) qtzj
	      from 
	      (select 
		    xd.xdnf,xd.jhxdwh,'总计' xzqh,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl(sum(xd.gz),0) gz,nvl(sum(xd.sz),0) sz,(nvl(sum(xd.ztz),0)-nvl(sum(xd.btzzj),0)-nvl(sum(xd.stz),0)-nvl(sum(xd.gz),0)-nvl(sum(xd.sz),0)) stc ,0 qtzj
		    from 
		    plan_zjxd xd left join jhsh_sjgz t on xd.xmid=t.xmbm where length(xd.xmid)=14 and substr(xd.xmid,11,1)='1' group by xd.xdnf,xd.jhxdwh
		    union all
		    select 
		    xd.xdnf,xd.jhxdwh,'总计' xzqh,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl(sum(xd.gz),0) gz,nvl(sum(xd.sz),0) sz,(nvl(sum(xd.ztz),0)-nvl(sum(xd.btzzj),0)-nvl(sum(xd.stz),0)-nvl(sum(xd.gz),0)-nvl(sum(xd.sz),0)) stc ,0 qtzj
		    from 
		    plan_zjxd xd left join jhsh_xj t on xd.xmid=t.xmbm where length(xd.xmid)=14 and substr(xd.xmid,11,1)='3' group by xd.xdnf,xd.jhxdwh) tab
	      group by tab.xdnf,tab.jhxdwh) t1 
		left join
		(
		select jh.xdwh,substr(jh.xmbm,0,4) xmnf,'总计' xzqh,count(*) xmsl,
		decode(jh.gldj,'国道',sum(jhyilc)，0) gsyi,decode(jh.gldj,'国道',sum(jherlc)，0) gser,decode(jh.gldj,'省道',sum(jherlc)+sum(jhyilc)，0) sser,
		decode(jh.gldj,'省道',sum(jhsanlc)，0) sssan,decode(jh.gldj,'国道',sum(jhsanlc)+sum(jhqtlc),'省道',sum(jhqtlc),sum(jherlc)+sum(jhyilc)+sum(jhsanlc)+sum(jhqtlc)) qt 
		from jhsh_sjgz jh left join (select xmid xmbm,nvl(sum(lx.jhyilc),0) jhyilc,nvl(sum(lx.jherlc),0) jherlc,nvl(sum(lx.jhsanlc),0) jhsanlc,(nvl(sum(lx.jhsilc),0)+nvl(sum(lx.jhdwlc),0)+nvl(sum(lx.jhwllc),0)) jhqtlc from lxsh_lx lx where lx.jdbs='2' group by lx.xmid) lxb on jh.xmbm=lxb.xmbm 
		group by jh.xdwh,substr(jh.xmbm,0,4),jh.gldj
		union all
		select jh.xdwh,substr(jh.xmbm,0,4) xmnf,'总计' xzqh,count(*) xmsl,
		decode(jh.gldj,'国道',sum(jhyilc)，0) gsyi,decode(jh.gldj,'国道',sum(jherlc)，0) gser,decode(jh.gldj,'省道',sum(jherlc)+sum(jhyilc)，0) sser,
		decode(jh.gldj,'省道',sum(jhsanlc)，0) sssan,decode(jh.gldj,'国道',sum(jhsanlc)+sum(jhqtlc),'省道',sum(jhqtlc),sum(jherlc)+sum(jhyilc)+sum(jhsanlc)+sum(jhqtlc)) qt
		from jhsh_xj jh left join (select xmid xmbm,nvl(sum(lx.yilc),0) jhyilc,nvl(sum(lx.erlc),0) jherlc,nvl(sum(lx.sanlc),0) jhsanlc,(nvl(sum(lx.silc),0)+nvl(sum(lx.dwlc),0)+nvl(sum(lx.wllc),0)) jhqtlc from lxsh_lx lx where lx.jdbs='2' group by lx.xmid) lxb on jh.xmbm=lxb.xmbm 
		group by jh.xdwh,substr(jh.xmbm,0,4),jh.gldj
		 
		) t2
		on t1.xdnf= t2.xmnf and t1.jhxdwh=t2.xdwh and t1.xzqh=t2.xzqh
		left join
		(
		select j.xdwh,substr(j.xmbm,0,4) xmnf,'总计' xzqh,count(*) xmsl,
		decode(j.gldj,'国道',sum(yiji)，0) bngsyi,decode(j.gldj,'国道',sum(erji)，0) bngser,decode(j.gldj,'省道',sum(yiji)+sum(erji)，0) bnsser,
		decode(j.gldj,'省道',sum(sanji)，0) bnsssan,decode(j.gldj,'国道',sum(sanji)+sum(siji),'省道',sum(siji),sum(yiji)+sum(erji)+sum(sanji)+sum(siji)) bnqt,
		sum(bnwctz) bnwctz  
		from jhsh_sjgz j left join
		(select jhid,nvl(sum(g.yiji),0) yiji,nvl(sum(g.erji),0) erji,nvl(sum(g.sanji),0) sanji,nvl(sum(g.siji),0) siji,nvl(sum(g.bywctze),0) bnwctz from gcgl_gcgzsj g where
		to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
		and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
		  group by g.jhid) gc on j.xmbm=gc.jhid
		where j.sjwgsj is not null 
		and to_date(j.sjwgsj,'yyyy-MM-dd')&lt;=sysdate 
		and to_date(j.sjwgsj,'yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')  group by j.xdwh,substr(j.xmbm,0,4),j.gldj 
		union all
		select j.xdwh,substr(j.xmbm,0,4) xmnf,'总计' xzqh,count(*) xmsl,
		decode(j.gldj,'国道',sum(yiji)，0) bngsyi,decode(j.gldj,'国道',sum(erji)，0) bngser,decode(j.gldj,'省道',sum(yiji)+sum(erji)，0) bnsser,
		decode(j.gldj,'省道',sum(sanji)，0) bnsssan,decode(j.gldj,'国道',sum(sanji)+sum(siji),'省道',sum(siji),sum(yiji)+sum(erji)+sum(sanji)+sum(siji)) bnqt,
		sum(bnwctz) bnwctz  
		from jhsh_xj j left join
		(select jhid,nvl(sum(g.yiji),0) yiji,nvl(sum(g.erji),0) erji,nvl(sum(g.sanji),0) sanji,nvl(sum(g.siji),0) siji,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_xj g where
		to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
		and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
		  group by g.jhid) gc on j.xmbm=gc.jhid
		where j.sjwgsj is not null 
		and to_date(j.sjwgsj,'yyyy-MM-dd')&lt;=sysdate 
		and to_date(j.sjwgsj,'yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')  group by j.xdwh,substr(j.xmbm,0,4),j.gldj 
		
		) t3
		on t2.xmnf=t3.xmnf and t2.xdwh=t3.xdwh and t2.xzqh=t3.xzqh
		left join
		
		(
		select j.xdwh,substr(j.xmbm,0,4) xmnf,'总计' xzqh,count(*) xmsl,
		decode(j.gldj,'国道',sum(yiji)，0) ljgsyi,decode(j.gldj,'国道',sum(erji)，0) ljgser,decode(j.gldj,'省道',sum(yiji)+sum(erji)，0) ljsser,
		decode(j.gldj,'省道',sum(sanji)，0) ljsssan,decode(j.gldj,'国道',sum(sanji)+sum(siji),'省道',sum(siji),sum(yiji)+sum(erji)+sum(sanji)+sum(siji)) ljqt,
		sum(ljwctz) ljwctz  
		from jhsh_sjgz j left join
		(select jhid,nvl(sum(g.yiji),0) yiji,nvl(sum(g.erji),0) erji,nvl(sum(g.sanji),0) sanji,nvl(sum(g.siji),0) siji,nvl(sum(g.bywctze),0) ljwctz from gcgl_gcgzsj g where
		to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')
		  group by g.jhid) gc on j.xmbm=gc.jhid
		where j.sjwgsj is not null 
		and to_date(j.sjwgsj,'yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-28','yyyy-mm-dd')  group by j.xdwh,substr(j.xmbm,0,4),j.gldj 
		union all
		select j.xdwh,substr(j.xmbm,0,4) xmnf,'总计' xzqh,count(*) xmsl,
		decode(j.gldj,'国道',sum(yiji)，0) ljgsyi,decode(j.gldj,'国道',sum(erji)，0) ljgser,decode(j.gldj,'省道',sum(yiji)+sum(erji)，0) ljsser,
		decode(j.gldj,'省道',sum(sanji)，0) ljsssan,decode(j.gldj,'国道',sum(sanji)+sum(siji),'省道',sum(siji),sum(yiji)+sum(erji)+sum(sanji)+sum(siji)) ljqt,
		sum(ljwctz) ljwctz  
		from jhsh_xj j left join
		(select jhid,nvl(sum(g.yiji),0) yiji,nvl(sum(g.erji),0) erji,nvl(sum(g.sanji),0) sanji,nvl(sum(g.siji),0) siji,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) ljwctz from gcgl_xj g where
		to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')
		  group by g.jhid) gc on j.xmbm=gc.jhid
		where j.sjwgsj is not null 
		and to_date(j.sjwgsj,'yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-28','yyyy-mm-dd')  group by j.xdwh,substr(j.xmbm,0,4),j.gldj 
		
		
		) t4
		on t2.xmnf=t4.xmnf and t2.xdwh=t4.xdwh and t2.xzqh=t4.xzqh
		where t1.jhxdwh !=' '
		group by t1.xdnf,t1.jhxdwh
		
		union all
		
		select 
		max(t1.xzqh) xzqh,t1.xzqhdm,t1.xdnf v_1,t1.jhxdwh v_2,nvl(sum(t2.xmsl),0) v_3,nvl((sum(t2.gsyi)+sum(t2.gser)+sum(t2.sser)+sum(t2.sssan)+sum(t2.qt)),0) v_4,
	    nvl(sum(t2.gsyi),0) v_5,nvl(sum(t2.gser),0) v_6,nvl(sum(t2.sser),0) v_7,nvl(sum(t2.sssan),0) v_8,nvl(sum(t2.qt),0) v_9,sum(t1.ztz) v_10,
	    nvl(sum(t1.btz),0) v_11,nvl(sum(t1.stz),0) v_12,nvl(sum(t1.gz),0) v_13,nvl(sum(t1.sz),0) v_14,nvl(sum(t1.stc),0) v_15,sum(t1.qtzj) v_16,
	    nvl(sum(t3.xmsl),0) v_17,nvl((sum(t3.bngsyi)+sum(t3.bngser)+sum(t3.bnsser)+sum(t3.bnsssan)+sum(t3.bnqt)),0) v_18,
	    nvl(sum(t3.bngsyi),0) v_19,nvl(sum(t3.bngser),0) v_20,nvl(sum(t3.bnsser),0) v_21,nvl(sum(t3.bnsssan),0) v_22,nvl(sum(t3.bnqt),0) v_23,
	    nvl(sum(t4.xmsl),0) v_24,nvl((sum(t4.ljgsyi)+sum(t4.ljgser)+sum(t4.ljsser)+sum(t4.ljsssan)+sum(t4.ljqt)),0) v_25,
	    nvl(sum(t4.ljgsyi),0) v_26,nvl(sum(t4.ljgser),0) v_27,nvl(sum(t4.ljsser),0) v_28,nvl(sum(t4.ljsssan),0) v_29,nvl(sum(t4.ljqt),0) v_30,
	    nvl(sum(t3.bnwctz),0) v_31,nvl(sum(t4.ljwctz),0) v_32,
	    '0' v_0
		from 
		(select 
	    xd.xdnf,xd.jhxdwh,t.xzqh,(select id from xtgl_xzqh where name=t.xzqh) xzqhdm,
	    nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl(sum(xd.gz),0) gz,nvl(sum(xd.sz),0) sz,(nvl(sum(xd.ztz),0)-nvl(sum(xd.btzzj),0)-nvl(sum(xd.stz),0)-nvl(sum(xd.gz),0)-nvl(sum(xd.sz),0)) stc ,0 qtzj
	    from 
	    plan_zjxd xd left join jhsh_sjgz t on xd.xmid=t.xmbm where length(xd.xmid)=14 and substr(xd.xmid,11,1)='1' group by xd.xdnf,xd.jhxdwh,t.xzqh
	    union all
	    select 
	    xd.xdnf,xd.jhxdwh,t.xzqh,(select id from xtgl_xzqh where name=t.xzqh) xzqhdm,
	    nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl(sum(xd.gz),0) gz,nvl(sum(xd.sz),0) sz,(nvl(sum(xd.ztz),0)-nvl(sum(xd.btzzj),0)-nvl(sum(xd.stz),0)-nvl(sum(xd.gz),0)-nvl(sum(xd.sz),0)) stc ,0 qtzj
	    from 
	    plan_zjxd xd left join jhsh_xj t on xd.xmid=t.xmbm where length(xd.xmid)=14 and substr(xd.xmid,11,1)='3' group by xd.xdnf,xd.jhxdwh,t.xzqh) t1 
		left join
		(
		select jh.xdwh,substr(jh.xmbm,0,4) xmnf,jh.xzqh,count(*) xmsl,(select id from xtgl_xzqh where name=jh.xzqh) xzqhdm,
		decode(jh.gldj,'国道',sum(jhyilc)，0) gsyi,decode(jh.gldj,'国道',sum(jherlc)，0) gser,decode(jh.gldj,'省道',sum(jherlc)+sum(jhyilc)，0) sser,
		decode(jh.gldj,'省道',sum(jhsanlc)，0) sssan,decode(jh.gldj,'国道',sum(jhsanlc)+sum(jhqtlc),'省道',sum(jhqtlc),sum(jherlc)+sum(jhyilc)+sum(jhsanlc)+sum(jhqtlc)) qt
		from jhsh_sjgz jh left join (select xmid xmbm,nvl(sum(lx.jhyilc),0) jhyilc,nvl(sum(lx.jherlc),0) jherlc,nvl(sum(lx.jhsanlc),0) jhsanlc,(nvl(sum(lx.jhsilc),0)+nvl(sum(lx.jhdwlc),0)+nvl(sum(lx.jhwllc),0)) jhqtlc from lxsh_lx lx where lx.jdbs='2' group by lx.xmid) lxb on jh.xmbm=lxb.xmbm 
		group by jh.xdwh,substr(jh.xmbm,0,4),jh.xzqh,jh.gldj 
		union all
		select jh.xdwh,substr(jh.xmbm,0,4) xmnf,jh.xzqh,count(*) xmsl,(select id from xtgl_xzqh where name=jh.xzqh) xzqhdm,
		decode(jh.gldj,'国道',sum(jhyilc)，0) gsyi,decode(jh.gldj,'国道',sum(jherlc)，0) gser,decode(jh.gldj,'省道',sum(jherlc)+sum(jhyilc)，0) sser,
		decode(jh.gldj,'省道',sum(jhsanlc)，0) sssan,decode(jh.gldj,'国道',sum(jhsanlc)+sum(jhqtlc),'省道',sum(jhqtlc),sum(jherlc)+sum(jhyilc)+sum(jhsanlc)+sum(jhqtlc)) qt
		from jhsh_xj jh left join (select xmid xmbm,nvl(sum(lx.yilc),0) jhyilc,nvl(sum(lx.erlc),0) jherlc,nvl(sum(lx.sanlc),0) jhsanlc,(nvl(sum(lx.silc),0)+nvl(sum(lx.dwlc),0)+nvl(sum(lx.wllc),0)) jhqtlc from lxsh_lx lx where lx.jdbs='2' group by lx.xmid) lxb on jh.xmbm=lxb.xmbm 
		group by jh.xdwh,substr(jh.xmbm,0,4),jh.xzqh,jh.gldj 
		
		) t2
		on t1.xdnf= t2.xmnf and t1.jhxdwh=t2.xdwh and t1.xzqh=t2.xzqh
		left join
		(
		select j.xdwh,substr(j.xmbm,0,4) xmnf,j.xzqh,count(*) xmsl,(select id from xtgl_xzqh where name=j.xzqh) xzqhdm,
		decode(j.gldj,'国道',sum(yiji)，0) bngsyi,decode(j.gldj,'国道',sum(erji)，0) bngser,decode(j.gldj,'省道',sum(yiji)+sum(erji)，0) bnsser,
		decode(j.gldj,'省道',sum(sanji)，0) bnsssan,decode(j.gldj,'国道',sum(sanji)+sum(siji),'省道',sum(siji),sum(yiji)+sum(erji)+sum(sanji)+sum(siji)) bnqt,
		sum(bnwctz) bnwctz  
		from jhsh_sjgz j left join
		(select jhid,nvl(sum(g.yiji),0) yiji,nvl(sum(g.erji),0) erji,nvl(sum(g.sanji),0) sanji,nvl(sum(g.siji),0) siji,nvl(sum(g.bywctze),0) bnwctz from gcgl_gcgzsj g where
		to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
		and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
		  group by g.jhid) gc on j.xmbm=gc.jhid
		where j.sjwgsj is not null 
		and to_date(j.sjwgsj,'yyyy-MM-dd')&lt;=sysdate 
		and to_date(j.sjwgsj,'yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')  group by j.xdwh,substr(j.xmbm,0,4),j.xzqh,j.gldj 
		union all
		select j.xdwh,substr(j.xmbm,0,4) xmnf,j.xzqh,count(*) xmsl,(select id from xtgl_xzqh where name=j.xzqh) xzqhdm,
		decode(j.gldj,'国道',sum(yiji)，0) bngsyi,decode(j.gldj,'国道',sum(erji)，0) bngser,decode(j.gldj,'省道',sum(yiji)+sum(erji)，0) bnsser,
		decode(j.gldj,'省道',sum(sanji)，0) bnsssan,decode(j.gldj,'国道',sum(sanji)+sum(siji),'省道',sum(siji),sum(yiji)+sum(erji)+sum(sanji)+sum(siji)) bnqt,
		sum(bnwctz) bnwctz  
		from jhsh_xj j left join
		(select jhid,nvl(sum(g.yiji),0) yiji,nvl(sum(g.erji),0) erji,nvl(sum(g.sanji),0) sanji,nvl(sum(g.siji),0) siji,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_xj g where
		to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
		and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
		  group by g.jhid) gc on j.xmbm=gc.jhid
		where j.sjwgsj is not null 
		and to_date(j.sjwgsj,'yyyy-MM-dd')&lt;=sysdate 
		and to_date(j.sjwgsj,'yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')  group by j.xdwh,substr(j.xmbm,0,4),j.xzqh,j.gldj 
		
		) t3
		on t2.xmnf=t3.xmnf and t2.xdwh=t3.xdwh and t2.xzqh=t3.xzqh
		left join
		(
		select j.xdwh,substr(j.xmbm,0,4) xmnf,j.xzqh,count(*) xmsl,(select id from xtgl_xzqh where name=j.xzqh) xzqhdm,
		decode(j.gldj,'国道',sum(yiji)，0) ljgsyi,decode(j.gldj,'国道',sum(erji)，0) ljgser,decode(j.gldj,'省道',sum(yiji)+sum(erji)，0) ljsser,
		decode(j.gldj,'省道',sum(sanji)，0) ljsssan,decode(j.gldj,'国道',sum(sanji)+sum(siji),'省道',sum(siji),sum(yiji)+sum(erji)+sum(sanji)+sum(siji)) ljqt,
		sum(ljwctz) ljwctz  
		from jhsh_sjgz j left join
		(select jhid,nvl(sum(g.yiji),0) yiji,nvl(sum(g.erji),0) erji,nvl(sum(g.sanji),0) sanji,nvl(sum(g.siji),0) siji,nvl(sum(g.bywctze),0) ljwctz from gcgl_gcgzsj g where
		to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')
		  group by g.jhid) gc on j.xmbm=gc.jhid
		where j.sjwgsj is not null 
		and to_date(j.sjwgsj,'yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-28','yyyy-mm-dd')  group by j.xdwh,substr(j.xmbm,0,4),j.xzqh,j.gldj 
		union all
		select j.xdwh,substr(j.xmbm,0,4) xmnf,j.xzqh,count(*) xmsl,(select id from xtgl_xzqh where name=j.xzqh) xzqhdm,
		decode(j.gldj,'国道',sum(yiji)，0) ljgsyi,decode(j.gldj,'国道',sum(erji)，0) ljgser,decode(j.gldj,'省道',sum(yiji)+sum(erji)，0) ljsser,
		decode(j.gldj,'省道',sum(sanji)，0) ljsssan,decode(j.gldj,'国道',sum(sanji)+sum(siji),'省道',sum(siji),sum(yiji)+sum(erji)+sum(sanji)+sum(siji)) ljqt,
		sum(ljwctz) ljwctz  
		from jhsh_xj j left join
		(select jhid,nvl(sum(g.yiji),0) yiji,nvl(sum(g.erji),0) erji,nvl(sum(g.sanji),0) sanji,nvl(sum(g.siji),0) siji,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) ljwctz from gcgl_xj g where
		to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')
		  group by g.jhid) gc on j.xmbm=gc.jhid
		where j.sjwgsj is not null 
		and to_date(j.sjwgsj,'yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-28','yyyy-mm-dd')  group by j.xdwh,substr(j.xmbm,0,4),j.xzqh,j.gldj 
		) t4
		on t2.xmnf=t4.xmnf and t2.xdwh=t4.xdwh and t2.xzqh=t4.xzqh
		where t1.jhxdwh !=' '
		group by t1.xzqhdm,t1.xdnf,t1.jhxdwh
		order by xzqhdm,v_1

		)
		where v_1 in (${xmnf}) and xzqh is not null
	</select>
	
	<select id="getHzzh" parameterType="gcglwqgz" resultType="elist">
		select * from(
			select distinct 
			t1.xzqh,36 xzqhdm,t1.xdnf v_1,t1.jhxdwh v_2,nvl(t2.xmsl,0) v_3,nvl(t2.qt,0) v_4,nvl(t1.ztz,0) v_5,nvl(t1.btz,0) v_6,
			nvl((t1.ztz-t1.btz),0) v_7,'0' v_8,nvl(t3.xmsl,0) v_9,nvl(t3.bnqt,0) v_10,nvl(t4.xmsl,0) v_11,nvl(t4.ljqt,0) v_12,
			nvl(t3.bnwctz,0) v_13,nvl(t4.ljwctz,0) v_14,
			'0' v_0
			from 
			(select distinct 
			xd.xdnf,xd.jhxdwh,'总计' xzqh,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl(sum(xd.gz),0) gz,nvl(sum(xd.sz),0) sz,(nvl(sum(xd.ztz),0)-nvl(sum(xd.btzzj),0)-nvl(sum(xd.stz),0)-nvl(sum(xd.gz),0)-nvl(sum(xd.sz),0)) stc ,0 qtzj
			from 
			plan_zjxd xd left join jhsh_sh t on xd.xmid=t.xmbm where length(xd.xmid)=14 and substr(xd.xmid,11,1)='5' group by xd.xdnf,xd.jhxdwh) t1 
			left join
			(
			select distinct  jh.xdwh,substr(jh.xmbm,0,4) xmnf,'总计' xzqh,count(*) xmsl,sum(jherlc)+sum(jhyilc)+sum(jhsanlc)+sum(jhqtlc) qt
			from jhsh_sh jh left join (select xmid xmbm,nvl(sum(lx.yilc),0) jhyilc,nvl(sum(lx.erlc),0) jherlc,nvl(sum(lx.sanlc),0) jhsanlc,(nvl(sum(lx.silc),0)+nvl(sum(lx.dwlc),0)+nvl(sum(lx.wllc),0)) jhqtlc from lxsh_lx lx where lx.jdbs='2' group by lx.xmid) lxb on jh.xmbm=lxb.xmbm 
			group by jh.xdwh,substr(jh.xmbm,0,4)
			 
			) t2
			on t1.xdnf= t2.xmnf and t1.jhxdwh=t2.xdwh and t1.xzqh=t2.xzqh
			left join
			(
			select distinct  j.xdwh,substr(j.xmbm,0,4) xmnf,'总计' xzqh,count(*) xmsl,sum(yiji) bnqt,
			sum(bnwctz) bnwctz  
			from jhsh_sh j left join
			(select distinct  jhid,nvl(sum(g.bywcmc),0) yiji,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_sh g where
			to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
			and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
			  group by g.jhid) gc on j.xmbm=gc.jhid
			where j.sjwgsj is not null 
			and to_date(j.sjwgsj,'yyyy-MM-dd')&lt;=sysdate 
			and to_date(j.sjwgsj,'yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')  group by j.xdwh,substr(j.xmbm,0,4)
			
			) t3
			on t2.xmnf=t3.xmnf and t2.xdwh=t3.xdwh and t2.xzqh=t3.xzqh
			left join
			
			(
			select distinct  j.xdwh,substr(j.xmbm,0,4) xmnf,'总计' xzqh,count(*) xmsl,sum(yiji) ljqt,
			sum(ljwctz) ljwctz  
			from jhsh_sh j left join
			(select distinct  jhid,nvl(sum(g.bywcmc),0) yiji,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) ljwctz from gcgl_sh g  where
			to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')
			  group by g.jhid) gc on j.xmbm=gc.jhid
			where j.sjwgsj is not null 
			and to_date(j.sjwgsj,'yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-28','yyyy-mm-dd')  group by j.xdwh,substr(j.xmbm,0,4)
			
			
			) t4
			on t2.xmnf=t4.xmnf and t2.xdwh=t4.xdwh and t2.xzqh=t4.xzqh
			union all
			select distinct 
			t1.xzqh,t1.xzqhdm,t1.xdnf v_1,t1.jhxdwh v_2,nvl(t2.xmsl,0) v_3,nvl(t2.qt,0) v_4,nvl(t1.ztz,0) v_5,nvl(t1.btz,0) v_6,
			nvl((t1.ztz-t1.btz),0) v_7,'0' v_8,nvl(t3.xmsl,0) v_9,nvl(t3.bnqt,0) v_10,nvl(t4.xmsl,0) v_11,nvl(t4.ljqt,0) v_12,
			nvl(t3.bnwctz,0) v_13,nvl(t4.ljwctz,0) v_14,
			'0' v_0
			from 
			(select 
			xd.xdnf,xd.jhxdwh,t.xzqh,(select id from xtgl_xzqh where name=t.xzqh) xzqhdm,
			nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl(sum(xd.gz),0) gz,nvl(sum(xd.sz),0) sz,(nvl(sum(xd.ztz),0)-nvl(sum(xd.btzzj),0)-nvl(sum(xd.stz),0)-nvl(sum(xd.gz),0)-nvl(sum(xd.sz),0)) stc ,0 qtzj
			from 
			plan_zjxd xd left join jhsh_sh t on xd.xmid=t.xmbm where length(xd.xmid)=14 and substr(xd.xmid,11,1)='5' group by xd.xdnf,xd.jhxdwh,t.xzqh) t1 
			left join
			(
			
			select jh.xdwh,substr(jh.xmbm,0,4) xmnf,jh.xzqh,count(*) xmsl,(select id from xtgl_xzqh where name=jh.xzqh) xzqhdm,sum(jherlc)+sum(jhyilc)+sum(jhsanlc)+sum(jhqtlc) qt
			from jhsh_sh jh left join (select xmid xmbm,nvl(sum(lx.yilc),0) jhyilc,nvl(sum(lx.erlc),0) jherlc,nvl(sum(lx.sanlc),0) jhsanlc,(nvl(sum(lx.silc),0)+nvl(sum(lx.dwlc),0)+nvl(sum(lx.wllc),0)) jhqtlc from lxsh_lx lx where lx.jdbs='2' group by lx.xmid) lxb on jh.xmbm=lxb.xmbm 
			group by jh.xdwh,substr(jh.xmbm,0,4),jh.xzqh
			
			) t2
			on t1.xdnf= t2.xmnf and t1.jhxdwh=t2.xdwh and t1.xzqh=t2.xzqh
			left join
			(
			
			select j.xdwh,substr(j.xmbm,0,4) xmnf,j.xzqh,count(*) xmsl,(select id from xtgl_xzqh where name=j.xzqh) xzqhdm,sum(yiji) bnqt,
			sum(bnwctz) bnwctz  
			from jhsh_sh j left join
			(select distinct  jhid,nvl(sum(g.bywcmc),0) yiji,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_sh g where
			to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
			and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
			  group by g.jhid) gc on j.xmbm=gc.jhid
			where j.sjwgsj is not null 
			and to_date(j.sjwgsj,'yyyy-MM-dd')&lt;=sysdate 
			and to_date(j.sjwgsj,'yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')  group by j.xdwh,substr(j.xmbm,0,4),j.xzqh
			
			) t3
			on t2.xmnf=t3.xmnf and t2.xdwh=t3.xdwh and t2.xzqh=t3.xzqh
			left join
			(
			select j.xdwh,substr(j.xmbm,0,4) xmnf,j.xzqh,count(*) xmsl,(select id from xtgl_xzqh where name=j.xzqh) xzqhdm,sum(yiji) ljqt,
			sum(ljwctz) ljwctz  
			from jhsh_sh j left join
			(select distinct  jhid,nvl(sum(g.bywcmc),0) yiji,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) ljwctz from gcgl_sh g  where
			to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')
			  group by g.jhid) gc on j.xmbm=gc.jhid
			where j.sjwgsj is not null 
			and to_date(j.sjwgsj,'yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-28','yyyy-mm-dd')  group by j.xdwh,substr(j.xmbm,0,4),j.xzqh
			) t4
			on t2.xmnf=t4.xmnf and t2.xdwh=t4.xdwh and t2.xzqh=t4.xzqh
			order by xzqhdm,v_1
		)
		where v_1 in (${xmnf}) and xzqh is not null
	</select>
	
	<select id="getHzlm" parameterType="gcglwqgz" resultType="elist">
		select * from(
			select distinct 
			t1.xzqh,36 xzqhdm,t1.xdnf v_1,t1.jhxdwh v_2,nvl(t2.xmsl,0) v_3,nvl(t2.qt,0) v_4,nvl(t1.ztz,0) v_5,nvl(t1.btz,0) v_6,
			nvl((t1.ztz-t1.btz),0) v_7,'0' v_8,nvl(t3.xmsl,0) v_9,nvl(t3.bnqt,0) v_10,nvl(t4.xmsl,0) v_11,nvl(t4.ljqt,0) v_12,
			nvl(t3.bnwctz,0) v_13,nvl(t4.ljwctz,0) v_14,
			'0' v_0
			from 
			(select distinct 
			xd.xdnf,xd.jhxdwh,'总计' xzqh,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl(sum(xd.gz),0) gz,nvl(sum(xd.sz),0) sz,(nvl(sum(xd.ztz),0)-nvl(sum(xd.btzzj),0)-nvl(sum(xd.stz),0)-nvl(sum(xd.gz),0)-nvl(sum(xd.sz),0)) stc ,0 qtzj
			from 
			plan_zjxd xd left join jhsh_lmgz t on xd.xmid=t.xmbm where length(xd.xmid)=14 and substr(xd.xmid,11,1)='2' group by xd.xdnf,xd.jhxdwh) t1 
			left join
			(
			select distinct  jh.xdwh,substr(jh.xmbm,0,4) xmnf,'总计' xzqh,count(*) xmsl,sum(jherlc)+sum(jhyilc)+sum(jhsanlc)+sum(jhqtlc) qt
			from jhsh_lmgz jh left join (select xmid xmbm,nvl(sum(lx.yilc),0) jhyilc,nvl(sum(lx.erlc),0) jherlc,nvl(sum(lx.sanlc),0) jhsanlc,(nvl(sum(lx.silc),0)+nvl(sum(lx.dwlc),0)+nvl(sum(lx.wllc),0)) jhqtlc from lxsh_lx lx where lx.jdbs='2' group by lx.xmid) lxb on jh.xmbm=lxb.xmbm 
			group by jh.xdwh,substr(jh.xmbm,0,4)
			 
			) t2
			on t1.xdnf= t2.xmnf and t1.jhxdwh=t2.xdwh and t1.xzqh=t2.xzqh
			left join
			(
			select distinct  j.xdwh,substr(j.xmbm,0,4) xmnf,'总计' xzqh,count(*) xmsl,sum(yiji) bnqt,
			sum(bnwctz) bnwctz  
			from jhsh_lmgz j left join
			(select distinct  jhid,nvl(sum(g.bywcmc),0) yiji,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_gcgzgj g where
			to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
			and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
			  group by g.jhid) gc on j.xmbm=gc.jhid
			where j.sjwgsj is not null 
			and to_date(j.sjwgsj,'yyyy-MM-dd')&lt;=sysdate 
			and to_date(j.sjwgsj,'yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')  group by j.xdwh,substr(j.xmbm,0,4)
			
			) t3
			on t2.xmnf=t3.xmnf and t2.xdwh=t3.xdwh and t2.xzqh=t3.xzqh
			left join
			
			(
			select distinct  j.xdwh,substr(j.xmbm,0,4) xmnf,'总计' xzqh,count(*) xmsl,sum(yiji) ljqt,
			sum(ljwctz) ljwctz  
			from jhsh_lmgz j left join
			(select distinct  jhid,nvl(sum(g.bywcmc),0) yiji,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) ljwctz from gcgl_gcgzgj g  where
			to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')
			  group by g.jhid) gc on j.xmbm=gc.jhid
			where j.sjwgsj is not null 
			and to_date(j.sjwgsj,'yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-28','yyyy-mm-dd')  group by j.xdwh,substr(j.xmbm,0,4)
			
			
			) t4
			on t2.xmnf=t4.xmnf and t2.xdwh=t4.xdwh and t2.xzqh=t4.xzqh
			union all
			select distinct 
			t1.xzqh,t1.xzqhdm,t1.xdnf v_1,t1.jhxdwh v_2,nvl(t2.xmsl,0) v_3,nvl(t2.qt,0) v_4,nvl(t1.ztz,0) v_5,nvl(t1.btz,0) v_6,
			nvl((t1.ztz-t1.btz),0) v_7,'0' v_8,nvl(t3.xmsl,0) v_9,nvl(t3.bnqt,0) v_10,nvl(t4.xmsl,0) v_11,nvl(t4.ljqt,0) v_12,
			nvl(t3.bnwctz,0) v_13,nvl(t4.ljwctz,0) v_14,
			'0' v_0
			from 
			(select 
			xd.xdnf,xd.jhxdwh,t.xzqh,(select id from xtgl_xzqh where name=t.xzqh) xzqhdm,
			nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl(sum(xd.gz),0) gz,nvl(sum(xd.sz),0) sz,(nvl(sum(xd.ztz),0)-nvl(sum(xd.btzzj),0)-nvl(sum(xd.stz),0)-nvl(sum(xd.gz),0)-nvl(sum(xd.sz),0)) stc ,0 qtzj
			from 
			plan_zjxd xd left join jhsh_lmgz t on xd.xmid=t.xmbm where length(xd.xmid)=14 and substr(xd.xmid,11,1)='2' group by xd.xdnf,xd.jhxdwh,t.xzqh) t1 
			left join
			(
			
			select jh.xdwh,substr(jh.xmbm,0,4) xmnf,jh.xzqh,count(*) xmsl,(select id from xtgl_xzqh where name=jh.xzqh) xzqhdm,sum(jherlc)+sum(jhyilc)+sum(jhsanlc)+sum(jhqtlc) qt
			from jhsh_lmgz jh left join (select xmid xmbm,nvl(sum(lx.yilc),0) jhyilc,nvl(sum(lx.erlc),0) jherlc,nvl(sum(lx.sanlc),0) jhsanlc,(nvl(sum(lx.silc),0)+nvl(sum(lx.dwlc),0)+nvl(sum(lx.wllc),0)) jhqtlc from lxsh_lx lx where lx.jdbs='2' group by lx.xmid) lxb on jh.xmbm=lxb.xmbm 
			group by jh.xdwh,substr(jh.xmbm,0,4),jh.xzqh
			
			) t2
			on t1.xdnf= t2.xmnf and t1.jhxdwh=t2.xdwh and t1.xzqh=t2.xzqh
			left join
			(
			
			select j.xdwh,substr(j.xmbm,0,4) xmnf,j.xzqh,count(*) xmsl,(select id from xtgl_xzqh where name=j.xzqh) xzqhdm,sum(yiji) bnqt,
			sum(bnwctz) bnwctz  
			from jhsh_lmgz j left join
			(select distinct  jhid,nvl(sum(g.bywcmc),0) yiji,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_gcgzgj g where
			to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
			and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
			  group by g.jhid) gc on j.xmbm=gc.jhid
			where j.sjwgsj is not null 
			and to_date(j.sjwgsj,'yyyy-MM-dd')&lt;=sysdate 
			and to_date(j.sjwgsj,'yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')  group by j.xdwh,substr(j.xmbm,0,4),j.xzqh
			
			) t3
			on t2.xmnf=t3.xmnf and t2.xdwh=t3.xdwh and t2.xzqh=t3.xzqh
			left join
			(
			select j.xdwh,substr(j.xmbm,0,4) xmnf,j.xzqh,count(*) xmsl,(select id from xtgl_xzqh where name=j.xzqh) xzqhdm,sum(yiji) ljqt,
			sum(ljwctz) ljwctz  
			from jhsh_lmgz j left join
			(select distinct  jhid,nvl(sum(g.bywcmc),0) yiji,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) ljwctz from gcgl_gcgzgj g  where
			to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')
			  group by g.jhid) gc on j.xmbm=gc.jhid
			where j.sjwgsj is not null 
			and to_date(j.sjwgsj,'yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-28','yyyy-mm-dd')  group by j.xdwh,substr(j.xmbm,0,4),j.xzqh
			) t4
			on t2.xmnf=t4.xmnf and t2.xdwh=t4.xdwh and t2.xzqh=t4.xzqh
			order by xzqhdm,v_1
		)
		where v_1 in (${xmnf}) and xzqh is not null
	</select>
	<select id="getHzyh" parameterType="gcglwqgz" resultType="elist">
	select 
		'总计' xzqh,36 xzqhdm,'0' v_0,min(v_1) v_1,min(v_2) v_2,sum(v_3) v_3,sum(v_4) v_4,sum(v_5) v_5,sum(v_6) v_6,sum(v_7) v_7,sum(v_8) v_8,sum(v_9) v_9,sum(v_10) v_10,
		sum(v_11) v_11,sum(v_12) v_12,sum(v_13) v_13,sum(v_14) v_14,sum(v_15) v_15,sum(v_16) v_16,sum(v_17) v_17,sum(v_18) v_18,sum(v_19) v_19,sum(v_20) v_20,
		sum(v_21) v_21,sum(v_22) v_22,sum(v_23) v_23,sum(v_24) v_24,sum(v_25) v_25,sum(v_26) v_26,sum(v_27) v_27,sum(v_28) v_28,sum(v_29) v_29,sum(v_30) v_30,
		sum(v_31) v_31,sum(v_32) v_32,sum(v_33) v_33,sum(v_34) v_34,sum(v_35) v_35,sum(v_36) v_36,sum(v_37) v_37,sum(v_38) v_38,sum(v_39) v_39,sum(v_40) v_40,
		sum(v_41) v_41,sum(v_42) v_42,sum(v_43) v_43,sum(v_44) v_44,sum(v_45) v_45,sum(v_46) v_46,sum(v_47) v_47,sum(v_48) v_48,sum(v_49) v_49,sum(v_50) v_50,
		sum(v_51) v_51,sum(v_52) v_52,sum(v_53) v_53,sum(v_54) v_54,sum(v_55) v_55,sum(v_56) v_56,sum(v_57) v_57,sum(v_58) v_58,sum(v_59) v_59,sum(v_60) v_60,
		sum(v_61) v_61,sum(v_62) v_62,sum(v_63) v_63,sum(v_64) v_64,sum(v_65) v_65,sum(v_66) v_66,sum(v_67) v_67,sum(v_68) v_68,sum(v_69) v_69,sum(v_70) v_70,
		sum(v_71) v_71,sum(v_72) v_72,sum(v_73) v_73,sum(v_74) v_74,sum(v_75) v_75,sum(v_76) v_76
		from(
		select distinct
		t1.xzqh,t1.xzqhdm,t1.xdnf v_1,t1.jhxdwh v_2,
		nvl((t2.dglc+t2.dslc+t2.dxlc+t2.zglc+t2.zslc+t2.zxlc+t2.yglc+t2.yslc+t2.yxlc),0) v_3,
		nvl((t2.dglc+t2.zglc+t2.yglc),0) v_4,nvl((t2.dslc+t2.zslc+t2.yslc),0) v_5,nvl((t2.dxlc+t2.zxlc+t2.yxlc),0) v_6,
		nvl((t2.dglc+t2.dslc+t2.dxlc),0) v_7,nvl(t2.dglc,0) v_8,nvl(t2.dslc,0) v_9,nvl(t2.dxlc,0) v_10,
		nvl((t2.zglc+t2.zslc+t2.zxlc),0) v_11,nvl(t2.zglc,0) v_12,nvl(t2.zslc,0) v_13,nvl(t2.zxlc,0) v_14,
		nvl((t2.yglc+t2.yslc+t2.yxlc),0) v_15,nvl(t2.yglc,0) v_16,nvl(t2.yslc,0) v_17,nvl(t2.yxlc,0) v_18,
		nvl(t1.stcztz,0) v_19,nvl((dgstc+zgstc+ygstc),0) v_20,nvl((dsstc+zsstc+ysstc),0) v_21,nvl((dxstc+zxstc+yxstc),0) v_22,
		nvl((dgstc+dsstc+dxstc),0) v_23,nvl(t1.dgstc,0) v_24,nvl(t1.dsstc,0) v_25,nvl(t1.dxstc,0) v_26,
		nvl((zgstc+zsstc+zxstc),0) v_27,nvl(t1.zgstc,0) v_28,nvl(t1.zsstc,0) v_29,nvl(t1.zxstc,0) v_30,
		nvl((ygstc+ysstc+yxstc),0) v_31,nvl(t1.ygstc,0) v_32,nvl(t1.ysstc,0) v_33,nvl(t1.yxstc,0) v_34,
		nvl((stcztz-(dgstc+dsstc+dxstc+zgstc+zsstc+zxstc+ygstc+ysstc+yxstc)),0) v_35,nvl(t1.stcqt,0) v_36,
		nvl(t1.dkztz,0) v_37,nvl((dgdk+zgdk+ygdk),0) v_38,nvl((dsdk+zsdk+ysdk),0) v_39,nvl((dxdk+zxdk+yxdk),0) v_40,
		nvl((dgdk+dsdk+dxdk),0) v_41,nvl(t1.dgdk,0) v_42,nvl(t1.dsdk,0) v_43,nvl(t1.dxdk,0) v_44,
		nvl((zgdk+zsdk+zxdk),0) v_45,nvl(t1.zgdk,0) v_46,nvl(t1.zsdk,0) v_47,nvl(t1.zxdk,0) v_48,
		nvl((ygdk+ysdk+yxdk),0) v_49,nvl(t1.ygdk,0) v_50,nvl(t1.ysdk,0) v_51,nvl(t1.yxdk,0) v_52,
		nvl((dkztz-(dgdk+dsdk+dxdk+zgdk+zsdk+zxdk+ygdk+ysdk+yxdk)),0) v_53,nvl(t1.dkqt,0) v_54,
		nvl((t3.dglc+t3.dslc+t3.dxlc+t3.zglc+t3.zslc+t3.zxlc+t3.yglc+t3.yslc+t3.yxlc),0) v_55,
		nvl(t3.dglc,0) v_56,nvl(t3.dslc,0) v_57,nvl(t3.dxlc,0) v_58,
		nvl(t3.zglc,0) v_59,nvl(t3.zslc,0) v_60,nvl(t3.zxlc,0) v_61,
		nvl(t3.yglc,0) v_62,nvl(t3.yslc,0) v_63,nvl(t3.yxlc,0) v_64,
		nvl((t4.dglc+t4.dslc+t4.dxlc+t4.zglc+t4.zslc+t4.zxlc+t4.yglc+t4.yslc+t4.yxlc),0) v_65,
		nvl(t4.dglc,0) v_66,nvl(t4.dslc,0) v_67,nvl(t4.dxlc,0) v_68,
		nvl(t4.zglc,0) v_69,nvl(t4.zslc,0) v_70,nvl(t4.zxlc,0) v_71,
		nvl(t4.yglc,0) v_72,nvl(t4.yslc,0) v_73,nvl(t4.yxlc,0) v_74,
		nvl(t3.wctz,0) v_75,nvl(t4.wctz,0) v_76
		
		from
		
		(select 
		xd.xdnf,xd.jhxdwh,t.xzqh,(select id from xtgl_xzqh where name=t.xzqh) xzqhdm,
		  nvl(sum(xd.stcztz),0) stcztz,nvl(sum(xd.dkztz),0) dkztz,
		  decode(t.gcfl,'大修',nvl(decode(substr(t.ghlxbh,0,1),'G',nvl(sum(xd.stc),0)),0),0) dgstc,
		  decode(t.gcfl,'大修',nvl(decode(substr(t.ghlxbh,0,1),'S',nvl(sum(xd.stc),0)),0),0) dsstc,
		  decode(t.gcfl,'大修',nvl(decode(substr(t.ghlxbh,0,1),'X',nvl(sum(xd.stc),0)),0),0) dxstc,
		  decode(t.gcfl,'中修',nvl(decode(substr(t.ghlxbh,0,1),'G',nvl(sum(xd.stc),0)),0),0) zgstc,
		  decode(t.gcfl,'中修',nvl(decode(substr(t.ghlxbh,0,1),'S',nvl(sum(xd.stc),0)),0),0) zsstc,
		  decode(t.gcfl,'中修',nvl(decode(substr(t.ghlxbh,0,1),'X',nvl(sum(xd.stc),0)),0),0) zxstc,
		  decode(t.gcfl,'预防性',nvl(decode(substr(t.ghlxbh,0,1),'G',nvl(sum(xd.stc),0)),0),0) ygstc,
		  decode(t.gcfl,'预防性',nvl(decode(substr(t.ghlxbh,0,1),'S',nvl(sum(xd.stc),0)),0),0) ysstc,
		  decode(t.gcfl,'预防性',nvl(decode(substr(t.ghlxbh,0,1),'X',nvl(sum(xd.stc),0)),0),0) yxstc,
		  decode(t.gcfl,'大修',nvl(decode(substr(t.ghlxbh,0,1),'G',nvl(sum(xd.dk),0)),0),0) dgdk,
		  decode(t.gcfl,'大修',nvl(decode(substr(t.ghlxbh,0,1),'S',nvl(sum(xd.dk),0)),0),0) dsdk,
		  decode(t.gcfl,'大修',nvl(decode(substr(t.ghlxbh,0,1),'X',nvl(sum(xd.dk),0)),0),0) dxdk,
		  decode(t.gcfl,'中修',nvl(decode(substr(t.ghlxbh,0,1),'G',nvl(sum(xd.dk),0)),0),0) zgdk,
		  decode(t.gcfl,'中修',nvl(decode(substr(t.ghlxbh,0,1),'S',nvl(sum(xd.dk),0)),0),0) zsdk,
		  decode(t.gcfl,'中修',nvl(decode(substr(t.ghlxbh,0,1),'X',nvl(sum(xd.dk),0)),0),0) zxdk,
		  decode(t.gcfl,'预防性',nvl(decode(substr(t.ghlxbh,0,1),'G',nvl(sum(xd.dk),0)),0),0) ygdk,
		  decode(t.gcfl,'预防性',nvl(decode(substr(t.ghlxbh,0,1),'S',nvl(sum(xd.dk),0)),0),0) ysdk,
		  decode(t.gcfl,'预防性',nvl(decode(substr(t.ghlxbh,0,1),'X',nvl(sum(xd.dk),0)),0),0) yxdk,
		  0 stcqt,0 dkqt
		  from 
		(select id,xmid,xdnf,sfzj,tbdw,tbtime,btzzj,stz,jhxdwh,xmbm,yhdk,gz,sz,decode(stc,0,0,null,0,ztz) stcztz,decode(dk,0,0,null,0,ztz) dkztz,stc,dk from plan_zjxd
		)
		 xd left join jhsh_yhdzx t on xd.xmid=t.xmbm where length(xd.xmid)=14 and substr(xd.xmid,11,1)='4' group by xd.xdnf,xd.jhxdwh,t.xzqh,t.gcfl,substr(t.ghlxbh,0,1)
		) t1
		left join
		(
		select jh.xdwh,substr(jh.xmbm,0,4) xmnf,jh.xzqh,count(*) xmsl,(select id from xtgl_xzqh where name=jh.xzqh) xzqhdm,
		  decode(jh.gcfl,'大修',nvl(decode(substr(jh.ghlxbh,0,1),'G',nvl(sum(jh.lc),0)),0),0) dglc,
		  decode(jh.gcfl,'大修',nvl(decode(substr(jh.ghlxbh,0,1),'S',nvl(sum(jh.lc),0)),0),0) dslc,
		  decode(jh.gcfl,'大修',nvl(decode(substr(jh.ghlxbh,0,1),'X',nvl(sum(jh.lc),0)),0),0) dxlc,
		  decode(jh.gcfl,'中修',nvl(decode(substr(jh.ghlxbh,0,1),'G',nvl(sum(jh.lc),0)),0),0) zglc,
		  decode(jh.gcfl,'中修',nvl(decode(substr(jh.ghlxbh,0,1),'S',nvl(sum(jh.lc),0)),0),0) zslc,
		  decode(jh.gcfl,'中修',nvl(decode(substr(jh.ghlxbh,0,1),'X',nvl(sum(jh.lc),0)),0),0) zxlc,
		  decode(jh.gcfl,'预防性',nvl(decode(substr(jh.ghlxbh,0,1),'G',nvl(sum(jh.lc),0)),0),0) yglc,
		  decode(jh.gcfl,'预防性',nvl(decode(substr(jh.ghlxbh,0,1),'S',nvl(sum(jh.lc),0)),0),0) yslc,
		  decode(jh.gcfl,'预防性',nvl(decode(substr(jh.ghlxbh,0,1),'X',nvl(sum(jh.lc),0)),0),0) yxlc
		from jhsh_yhdzx jh
		group by jh.xdwh,substr(jh.xmbm,0,4),jh.xzqh,jh.gcfl,substr(jh.ghlxbh,0,1)
		) t2 on t1.jhxdwh=t2.xdwh and t1.xdnf=t2.xmnf and t1.xzqh=t2.xzqh
		left join 
		(
		select j.xdwh,substr(j.xmbm,0,4) xmnf,j.xzqh,count(*) xmsl,(select id from xtgl_xzqh where name=j.xzqh) xzqhdm,
		decode(j.gcfl,'大修',nvl(decode(substr(j.ghlxbh,0,1),'G',nvl(sum(yiji),0)),0),0) dglc,
		  decode(j.gcfl,'大修',nvl(decode(substr(j.ghlxbh,0,1),'S',nvl(sum(yiji),0)),0),0) dslc,
		  decode(j.gcfl,'大修',nvl(decode(substr(j.ghlxbh,0,1),'X',nvl(sum(yiji),0)),0),0) dxlc,
		  decode(j.gcfl,'中修',nvl(decode(substr(j.ghlxbh,0,1),'G',nvl(sum(yiji),0)),0),0) zglc,
		  decode(j.gcfl,'中修',nvl(decode(substr(j.ghlxbh,0,1),'S',nvl(sum(yiji),0)),0),0) zslc,
		  decode(j.gcfl,'中修',nvl(decode(substr(j.ghlxbh,0,1),'X',nvl(sum(yiji),0)),0),0) zxlc,
		  decode(j.gcfl,'预防性',nvl(decode(substr(j.ghlxbh,0,1),'G',nvl(sum(yiji),0)),0),0) yglc,
		  decode(j.gcfl,'预防性',nvl(decode(substr(j.ghlxbh,0,1),'S',nvl(sum(yiji),0)),0),0) yslc,
		  decode(j.gcfl,'预防性',nvl(decode(substr(j.ghlxbh,0,1),'X',nvl(sum(yiji),0)),0),0) yxlc,
		sum(bnwctz) wctz  
		from jhsh_yhdzx j left join
		(select distinct  jhid,nvl(sum(g.bywcmc),0) yiji,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_yhdzx g where
		to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
		and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
		  group by g.jhid) gc on j.xmbm=gc.jhid
		where j.sjwgsj is not null 
		and to_date(j.sjwgsj,'yyyy-MM-dd')&lt;=sysdate 
		and to_date(j.sjwgsj,'yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')  group by j.xdwh,substr(j.xmbm,0,4),j.xzqh,j.gcfl,substr(j.ghlxbh,0,1)
		) t3 on t2.xdwh=t3.xdwh and t2.xmnf=t3.xmnf and t2.xzqh=t3.xzqh
		left join
		(
		select j.xdwh,substr(j.xmbm,0,4) xmnf,j.xzqh,count(*) xmsl,(select id from xtgl_xzqh where name=j.xzqh) xzqhdm,
		decode(j.gcfl,'大修',nvl(decode(substr(j.ghlxbh,0,1),'G',nvl(sum(yiji),0)),0),0) dglc,
		  decode(j.gcfl,'大修',nvl(decode(substr(j.ghlxbh,0,1),'S',nvl(sum(yiji),0)),0),0) dslc,
		  decode(j.gcfl,'大修',nvl(decode(substr(j.ghlxbh,0,1),'X',nvl(sum(yiji),0)),0),0) dxlc,
		  decode(j.gcfl,'中修',nvl(decode(substr(j.ghlxbh,0,1),'G',nvl(sum(yiji),0)),0),0) zglc,
		  decode(j.gcfl,'中修',nvl(decode(substr(j.ghlxbh,0,1),'S',nvl(sum(yiji),0)),0),0) zslc,
		  decode(j.gcfl,'中修',nvl(decode(substr(j.ghlxbh,0,1),'X',nvl(sum(yiji),0)),0),0) zxlc,
		  decode(j.gcfl,'预防性',nvl(decode(substr(j.ghlxbh,0,1),'G',nvl(sum(yiji),0)),0),0) yglc,
		  decode(j.gcfl,'预防性',nvl(decode(substr(j.ghlxbh,0,1),'S',nvl(sum(yiji),0)),0),0) yslc,
		  decode(j.gcfl,'预防性',nvl(decode(substr(j.ghlxbh,0,1),'X',nvl(sum(yiji),0)),0),0) yxlc,
		nvl(sum(bnwctz),0) wctz  
		from jhsh_yhdzx j left join
		(select distinct  jhid,nvl(sum(g.bywcmc),0) yiji,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_yhdzx g where
		to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')
		  group by g.jhid) gc on j.xmbm=gc.jhid
		group by j.xdwh,substr(j.xmbm,0,4),j.xzqh,j.gcfl,substr(j.ghlxbh,0,1)
		) t4 on t2.xdwh=t4.xdwh and t2.xmnf=t4.xmnf and t2.xzqh=t4.xzqh
		) tb where tb.v_1 in (${xmnf}) and tb.xzqh is not null group by tb.v_1,tb.v_2
		union all
		select distinct
		t1.xzqh,t1.xzqhdm,'0' v_0,t1.xdnf v_1,t1.jhxdwh v_2,
		nvl((t2.dglc+t2.dslc+t2.dxlc+t2.zglc+t2.zslc+t2.zxlc+t2.yglc+t2.yslc+t2.yxlc),0) v_3,
		nvl((t2.dglc+t2.zglc+t2.yglc),0) v_4,nvl((t2.dslc+t2.zslc+t2.yslc),0) v_5,nvl((t2.dxlc+t2.zxlc+t2.yxlc),0) v_6,
		nvl((t2.dglc+t2.dslc+t2.dxlc),0) v_7,nvl(t2.dglc,0) v_8,nvl(t2.dslc,0) v_9,nvl(t2.dxlc,0) v_10,
		nvl((t2.zglc+t2.zslc+t2.zxlc),0) v_11,nvl(t2.zglc,0) v_12,nvl(t2.zslc,0) v_13,nvl(t2.zxlc,0) v_14,
		nvl((t2.yglc+t2.yslc+t2.yxlc),0) v_15,nvl(t2.yglc,0) v_16,nvl(t2.yslc,0) v_17,nvl(t2.yxlc,0) v_18,
		nvl(t1.stcztz,0) v_19,nvl((dgstc+zgstc+ygstc),0) v_20,nvl((dsstc+zsstc+ysstc),0) v_21,nvl((dxstc+zxstc+yxstc),0) v_22,
		nvl((dgstc+dsstc+dxstc),0) v_23,nvl(t1.dgstc,0) v_24,nvl(t1.dsstc,0) v_25,nvl(t1.dxstc,0) v_26,
		nvl((zgstc+zsstc+zxstc),0) v_27,nvl(t1.zgstc,0) v_28,nvl(t1.zsstc,0) v_29,nvl(t1.zxstc,0) v_30,
		nvl((ygstc+ysstc+yxstc),0) v_31,nvl(t1.ygstc,0) v_32,nvl(t1.ysstc,0) v_33,nvl(t1.yxstc,0) v_34,
		nvl((stcztz-(dgstc+dsstc+dxstc+zgstc+zsstc+zxstc+ygstc+ysstc+yxstc)),0) v_35,nvl(t1.stcqt,0) v_36,
		nvl(t1.dkztz,0) v_37,nvl((dgdk+zgdk+ygdk),0) v_38,nvl((dsdk+zsdk+ysdk),0) v_39,nvl((dxdk+zxdk+yxdk),0) v_40,
		nvl((dgdk+dsdk+dxdk),0) v_41,nvl(t1.dgdk,0) v_42,nvl(t1.dsdk,0) v_43,nvl(t1.dxdk,0) v_44,
		nvl((zgdk+zsdk+zxdk),0) v_45,nvl(t1.zgdk,0) v_46,nvl(t1.zsdk,0) v_47,nvl(t1.zxdk,0) v_48,
		nvl((ygdk+ysdk+yxdk),0) v_49,nvl(t1.ygdk,0) v_50,nvl(t1.ysdk,0) v_51,nvl(t1.yxdk,0) v_52,
		nvl((dkztz-(dgdk+dsdk+dxdk+zgdk+zsdk+zxdk+ygdk+ysdk+yxdk)),0) v_53,nvl(t1.dkqt,0) v_54,
		nvl((t3.dglc+t3.dslc+t3.dxlc+t3.zglc+t3.zslc+t3.zxlc+t3.yglc+t3.yslc+t3.yxlc),0) v_55,
		nvl(t3.dglc,0) v_56,nvl(t3.dslc,0) v_57,nvl(t3.dxlc,0) v_58,
		nvl(t3.zglc,0) v_59,nvl(t3.zslc,0) v_60,nvl(t3.zxlc,0) v_61,
		nvl(t3.yglc,0) v_62,nvl(t3.yslc,0) v_63,nvl(t3.yxlc,0) v_64,
		nvl((t4.dglc+t4.dslc+t4.dxlc+t4.zglc+t4.zslc+t4.zxlc+t4.yglc+t4.yslc+t4.yxlc),0) v_65,
		nvl(t4.dglc,0) v_66,nvl(t4.dslc,0) v_67,nvl(t4.dxlc,0) v_68,
		nvl(t4.zglc,0) v_69,nvl(t4.zslc,0) v_70,nvl(t4.zxlc,0) v_71,
		nvl(t4.yglc,0) v_72,nvl(t4.yslc,0) v_73,nvl(t4.yxlc,0) v_74,
		nvl(t3.wctz,0) v_75,nvl(t4.wctz,0) v_76
		
		from
		
		(select 
		xd.xdnf,xd.jhxdwh,t.xzqh,(select id from xtgl_xzqh where name=t.xzqh) xzqhdm,
		  nvl(sum(xd.stcztz),0) stcztz,nvl(sum(xd.dkztz),0) dkztz,
		  decode(t.gcfl,'大修',nvl(decode(substr(t.ghlxbh,0,1),'G',nvl(sum(xd.stc),0)),0),0) dgstc,
		  decode(t.gcfl,'大修',nvl(decode(substr(t.ghlxbh,0,1),'S',nvl(sum(xd.stc),0)),0),0) dsstc,
		  decode(t.gcfl,'大修',nvl(decode(substr(t.ghlxbh,0,1),'X',nvl(sum(xd.stc),0)),0),0) dxstc,
		  decode(t.gcfl,'中修',nvl(decode(substr(t.ghlxbh,0,1),'G',nvl(sum(xd.stc),0)),0),0) zgstc,
		  decode(t.gcfl,'中修',nvl(decode(substr(t.ghlxbh,0,1),'S',nvl(sum(xd.stc),0)),0),0) zsstc,
		  decode(t.gcfl,'中修',nvl(decode(substr(t.ghlxbh,0,1),'X',nvl(sum(xd.stc),0)),0),0) zxstc,
		  decode(t.gcfl,'预防性',nvl(decode(substr(t.ghlxbh,0,1),'G',nvl(sum(xd.stc),0)),0),0) ygstc,
		  decode(t.gcfl,'预防性',nvl(decode(substr(t.ghlxbh,0,1),'S',nvl(sum(xd.stc),0)),0),0) ysstc,
		  decode(t.gcfl,'预防性',nvl(decode(substr(t.ghlxbh,0,1),'X',nvl(sum(xd.stc),0)),0),0) yxstc,
		  decode(t.gcfl,'大修',nvl(decode(substr(t.ghlxbh,0,1),'G',nvl(sum(xd.dk),0)),0),0) dgdk,
		  decode(t.gcfl,'大修',nvl(decode(substr(t.ghlxbh,0,1),'S',nvl(sum(xd.dk),0)),0),0) dsdk,
		  decode(t.gcfl,'大修',nvl(decode(substr(t.ghlxbh,0,1),'X',nvl(sum(xd.dk),0)),0),0) dxdk,
		  decode(t.gcfl,'中修',nvl(decode(substr(t.ghlxbh,0,1),'G',nvl(sum(xd.dk),0)),0),0) zgdk,
		  decode(t.gcfl,'中修',nvl(decode(substr(t.ghlxbh,0,1),'S',nvl(sum(xd.dk),0)),0),0) zsdk,
		  decode(t.gcfl,'中修',nvl(decode(substr(t.ghlxbh,0,1),'X',nvl(sum(xd.dk),0)),0),0) zxdk,
		  decode(t.gcfl,'预防性',nvl(decode(substr(t.ghlxbh,0,1),'G',nvl(sum(xd.dk),0)),0),0) ygdk,
		  decode(t.gcfl,'预防性',nvl(decode(substr(t.ghlxbh,0,1),'S',nvl(sum(xd.dk),0)),0),0) ysdk,
		  decode(t.gcfl,'预防性',nvl(decode(substr(t.ghlxbh,0,1),'X',nvl(sum(xd.dk),0)),0),0) yxdk,
		  0 stcqt,0 dkqt
		  from 
		(select id,xmid,xdnf,sfzj,tbdw,tbtime,btzzj,stz,jhxdwh,xmbm,yhdk,gz,sz,decode(stc,0,0,null,0,ztz) stcztz,decode(dk,0,0,null,0,ztz) dkztz,stc,dk from plan_zjxd
		)
		 xd left join jhsh_yhdzx t on xd.xmid=t.xmbm where length(xd.xmid)=14 and substr(xd.xmid,11,1)='4' group by xd.xdnf,xd.jhxdwh,t.xzqh,t.gcfl,substr(t.ghlxbh,0,1)
		) t1
		left join
		(
		select jh.xdwh,substr(jh.xmbm,0,4) xmnf,jh.xzqh,count(*) xmsl,(select id from xtgl_xzqh where name=jh.xzqh) xzqhdm,
		  decode(jh.gcfl,'大修',nvl(decode(substr(jh.ghlxbh,0,1),'G',nvl(sum(jh.lc),0)),0),0) dglc,
		  decode(jh.gcfl,'大修',nvl(decode(substr(jh.ghlxbh,0,1),'S',nvl(sum(jh.lc),0)),0),0) dslc,
		  decode(jh.gcfl,'大修',nvl(decode(substr(jh.ghlxbh,0,1),'X',nvl(sum(jh.lc),0)),0),0) dxlc,
		  decode(jh.gcfl,'中修',nvl(decode(substr(jh.ghlxbh,0,1),'G',nvl(sum(jh.lc),0)),0),0) zglc,
		  decode(jh.gcfl,'中修',nvl(decode(substr(jh.ghlxbh,0,1),'S',nvl(sum(jh.lc),0)),0),0) zslc,
		  decode(jh.gcfl,'中修',nvl(decode(substr(jh.ghlxbh,0,1),'X',nvl(sum(jh.lc),0)),0),0) zxlc,
		  decode(jh.gcfl,'预防性',nvl(decode(substr(jh.ghlxbh,0,1),'G',nvl(sum(jh.lc),0)),0),0) yglc,
		  decode(jh.gcfl,'预防性',nvl(decode(substr(jh.ghlxbh,0,1),'S',nvl(sum(jh.lc),0)),0),0) yslc,
		  decode(jh.gcfl,'预防性',nvl(decode(substr(jh.ghlxbh,0,1),'X',nvl(sum(jh.lc),0)),0),0) yxlc
		from jhsh_yhdzx jh
		group by jh.xdwh,substr(jh.xmbm,0,4),jh.xzqh,jh.gcfl,substr(jh.ghlxbh,0,1)
		) t2 on t1.jhxdwh=t2.xdwh and t1.xdnf=t2.xmnf and t1.xzqh=t2.xzqh
		left join 
		(
		select j.xdwh,substr(j.xmbm,0,4) xmnf,j.xzqh,count(*) xmsl,(select id from xtgl_xzqh where name=j.xzqh) xzqhdm,
		decode(j.gcfl,'大修',nvl(decode(substr(j.ghlxbh,0,1),'G',nvl(sum(yiji),0)),0),0) dglc,
		  decode(j.gcfl,'大修',nvl(decode(substr(j.ghlxbh,0,1),'S',nvl(sum(yiji),0)),0),0) dslc,
		  decode(j.gcfl,'大修',nvl(decode(substr(j.ghlxbh,0,1),'X',nvl(sum(yiji),0)),0),0) dxlc,
		  decode(j.gcfl,'中修',nvl(decode(substr(j.ghlxbh,0,1),'G',nvl(sum(yiji),0)),0),0) zglc,
		  decode(j.gcfl,'中修',nvl(decode(substr(j.ghlxbh,0,1),'S',nvl(sum(yiji),0)),0),0) zslc,
		  decode(j.gcfl,'中修',nvl(decode(substr(j.ghlxbh,0,1),'X',nvl(sum(yiji),0)),0),0) zxlc,
		  decode(j.gcfl,'预防性',nvl(decode(substr(j.ghlxbh,0,1),'G',nvl(sum(yiji),0)),0),0) yglc,
		  decode(j.gcfl,'预防性',nvl(decode(substr(j.ghlxbh,0,1),'S',nvl(sum(yiji),0)),0),0) yslc,
		  decode(j.gcfl,'预防性',nvl(decode(substr(j.ghlxbh,0,1),'X',nvl(sum(yiji),0)),0),0) yxlc,
		sum(bnwctz) wctz  
		from jhsh_yhdzx j left join
		(select distinct  jhid,nvl(sum(g.bywcmc),0) yiji,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_yhdzx g where
		to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
		and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
		  group by g.jhid) gc on j.xmbm=gc.jhid
		where j.sjwgsj is not null 
		and to_date(j.sjwgsj,'yyyy-MM-dd')&lt;=sysdate 
		and to_date(j.sjwgsj,'yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')  group by j.xdwh,substr(j.xmbm,0,4),j.xzqh,j.gcfl,substr(j.ghlxbh,0,1)
		) t3 on t2.xdwh=t3.xdwh and t2.xmnf=t3.xmnf and t2.xzqh=t3.xzqh
		left join
		(
		select j.xdwh,substr(j.xmbm,0,4) xmnf,j.xzqh,count(*) xmsl,(select id from xtgl_xzqh where name=j.xzqh) xzqhdm,
		decode(j.gcfl,'大修',nvl(decode(substr(j.ghlxbh,0,1),'G',nvl(sum(yiji),0)),0),0) dglc,
		  decode(j.gcfl,'大修',nvl(decode(substr(j.ghlxbh,0,1),'S',nvl(sum(yiji),0)),0),0) dslc,
		  decode(j.gcfl,'大修',nvl(decode(substr(j.ghlxbh,0,1),'X',nvl(sum(yiji),0)),0),0) dxlc,
		  decode(j.gcfl,'中修',nvl(decode(substr(j.ghlxbh,0,1),'G',nvl(sum(yiji),0)),0),0) zglc,
		  decode(j.gcfl,'中修',nvl(decode(substr(j.ghlxbh,0,1),'S',nvl(sum(yiji),0)),0),0) zslc,
		  decode(j.gcfl,'中修',nvl(decode(substr(j.ghlxbh,0,1),'X',nvl(sum(yiji),0)),0),0) zxlc,
		  decode(j.gcfl,'预防性',nvl(decode(substr(j.ghlxbh,0,1),'G',nvl(sum(yiji),0)),0),0) yglc,
		  decode(j.gcfl,'预防性',nvl(decode(substr(j.ghlxbh,0,1),'S',nvl(sum(yiji),0)),0),0) yslc,
		  decode(j.gcfl,'预防性',nvl(decode(substr(j.ghlxbh,0,1),'X',nvl(sum(yiji),0)),0),0) yxlc,
		nvl(sum(bnwctz),0) wctz  
		from jhsh_yhdzx j left join
		(select distinct  jhid,nvl(sum(g.bywcmc),0) yiji,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_yhdzx g where
		to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')
		  group by g.jhid) gc on j.xmbm=gc.jhid
		group by j.xdwh,substr(j.xmbm,0,4),j.xzqh,j.gcfl,substr(j.ghlxbh,0,1)
		) t4 on t2.xdwh=t4.xdwh and t2.xmnf=t4.xmnf and t2.xzqh=t4.xzqh
		where t1.xdnf in (${xmnf}) and t1.xzqh is not null
		order by xzqhdm,v_1

	</select>
	
	<select id="getHzlw" parameterType="gcglwqgz" resultType="elist">
		select 
			'总计' xzqh,'36' xzqhdm,'0' v_0,min(v_1) v_1,min(v_2) v_2,sum(v_3) v_3,sum(v_4) v_4,sum(v_5) v_5,sum(v_6) v_6,sum(v_7) v_7,sum(v_8) v_8,sum(v_9) v_9,sum(v_10) v_10,
			sum(v_11) v_11,sum(v_12) v_12,sum(v_13) v_13,sum(v_14) v_14,sum(v_15) v_15,sum(v_16) v_16,sum(v_17) v_17,sum(v_18) v_18,sum(v_19) v_19,sum(v_20) v_20,
			sum(v_21) v_21,sum(v_22) v_22,sum(v_23) v_23,sum(v_24) v_24,sum(v_25) v_25,sum(v_26) v_26,sum(v_27) v_27,sum(v_28) v_28,sum(v_29) v_29,sum(v_30) v_30,
			sum(v_31) v_31,sum(v_32) v_32,sum(v_33) v_33,sum(v_34) v_34,sum(v_35) v_35,sum(v_36) v_36,sum(v_37) v_37,sum(v_38) v_38,sum(v_39) v_39,sum(v_40) v_40,
			sum(v_41) v_41,sum(v_42) v_42,sum(v_43) v_43,sum(v_44) v_44,sum(v_45) v_45,sum(v_46) v_46,sum(v_47) v_47,sum(v_48) v_48,sum(v_49) v_49,sum(v_50) v_50,
			sum(v_51) v_51,sum(v_52) v_52,sum(v_53) v_53,sum(v_54) v_54,sum(v_55) v_55,sum(v_56) v_56,sum(v_57) v_57,sum(v_58) v_58,sum(v_59) v_59,sum(v_60) v_60,
			sum(v_61) v_61
			from
			(
			select 
			max(tb0.xzqh) xzqh,tb0.xzqhdm,'0' v_0,tb0.xdnf v_1,tb0.jhxdwh v_2,nvl(sum(tb0.ztz),0) v_3,nvl(sum(tb0.btz),0) v_4,nvl(sum(tb0.stz),0) v_5,nvl(sum(tb0.dstc),0) v_6,nvl(sum(tb0.qtzj),0) v_7,
			nvl(sum(tb1.zuo),0) v_8,nvl(sum(tb1.ym),0) v_9,nvl(sum(tb1.ztz),0) v_10,nvl(sum(tb1.btz),0) v_11,nvl(sum(tb1.stz),0) v_12,nvl(sum(tb1.dstc),0) v_13,nvl(sum(tb1.qtzj),0) v_14,
			nvl(sum(tb2.zuo),0) v_15,nvl(sum(tb2.ym),0) v_16,nvl(sum(tb2.ztz),0) v_17,nvl(sum(tb2.btz),0) v_18,nvl(sum(tb2.stz),0) v_19,nvl(sum(tb2.dstc),0) v_20,nvl(sum(tb2.qtzj),0) v_21,
			nvl(sum(tb3.zuo),0) v_22,nvl(sum(tb3.ym),0) v_23,nvl(sum(tb3.ztz),0) v_24,nvl(sum(tb3.btz),0) v_25,nvl(sum(tb3.stz),0) v_26,nvl(sum(tb3.dstc),0) v_27,nvl(sum(tb3.qtzj),0) v_28,
			nvl(sum(tb4.zuo),0) v_29,nvl(sum(tb4.ym),0) v_30,nvl(sum(tb4.ztz),0) v_31,nvl(sum(tb4.btz),0) v_32,nvl(sum(tb4.stz),0) v_33,nvl(sum(tb4.dstc),0) v_34,nvl(sum(tb4.qtzj),0) v_35,
			nvl((nvl(sum(tb1.bnwctz),0)+nvl(sum(tb2.bnwctz),0)+nvl(sum(tb3.bnwctz),0)+nvl(sum(tb4.bnwctz),0)),0) v_36,nvl((nvl(sum(tb1.ljwctz),0)+nvl(sum(tb2.ljwctz),0)+nvl(sum(tb3.ljwctz),0)+nvl(sum(tb4.ljwctz),0)),0) v_37,
			nvl(sum(tb1.bnzuo),0) v_38,nvl(sum(tb1.bnym),0) v_39,nvl(sum(tb1.bnwctz),0) v_40,
			nvl(sum(tb2.bnzuo),0) v_41,nvl(sum(tb2.bnym),0) v_42,nvl(sum(tb2.bnwctz),0) v_43,
			nvl(sum(tb3.bnzuo),0) v_44,nvl(sum(tb3.bnym),0) v_45,nvl(sum(tb3.bnwctz),0) v_46,
			nvl(sum(tb4.bnzuo),0) v_47,nvl(sum(tb4.bnym),0) v_48,nvl(sum(tb4.bnwctz),0) v_49,
			nvl(sum(tb1.ljzuo),0) v_50,nvl(sum(tb1.ljym),0) v_51,nvl(sum(tb1.ljwctz),0) v_52,
			nvl(sum(tb2.ljzuo),0) v_53,nvl(sum(tb2.ljym),0) v_54,nvl(sum(tb2.ljwctz),0) v_55,
			nvl(sum(tb3.ljzuo),0) v_56,nvl(sum(tb3.ljym),0) v_57,nvl(sum(tb3.ljwctz),0) v_58,
			nvl(sum(tb4.ljzuo),0) v_59,nvl(sum(tb4.ljym),0) v_60,nvl(sum(tb4.ljwctz),0) v_61
			from 
			(
			select 
			xdnf,jhxdwh,min(xzqh) xzqh,xzqhdm,gydw,sum(ztz) ztz,sum(btz) btz,sum(stz) stz,sum(dstc) dstc,sum(qtzj) qtzj
			from(
			  select distinct 
			'危桥' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw
			from plan_wqgz pl left join sck_wqgz sc on pl.sckid=sc.sckid left join xmk_wqgz xm on sc.xmkid=xm.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			union all
			select distinct 
			'病害' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw
			from plan_bhsd pl left join sck_bhsd sc on pl.sckid=sc.sckid left join xmk_bhsd xm on sc.xmkid=xm.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			union all
			select distinct 
			'安保' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw
			from plan_abgc pl left join sck_abgc sc on pl.sckid=sc.sckid left join xmk_abgc xm on sc.xmkid=xm.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			union all
			select distinct 
			'安保' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(sc.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(sc.xzqhdm,0,4)||'00') xzqh,decode(substr(sc.gydwdm,0,1),'1','交通局','2','公路局') gydw
			from plan_af pl left join sck_aqsmfh sc on pl.sckid=sc.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			union all
			select distinct 
			'灾害' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw
			from plan_zhfz pl left join sck_zhfz sc on pl.sckid=sc.sckid left join xmk_zhfz xm on sc.xmkid=xm.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			) tt group by tt.xdnf,tt.jhxdwh,tt.xzqhdm,tt.gydw
			) tb0,
			(
			select 
			xmlx,t1.xdnf,t1.jhxdwh,t1.xzqh,t1.xzqhdm,t1.gydw,t1.ztz,t1.btz,t1.stz,t1.dstc,t1.qtzj,t2.zuo,t2.ym,t3.zuo bnzuo,t3.ym bnym,t3.wctz bnwctz,t4.zuo ljzuo,t4.ym ljym,t4.wctz ljwctz
			from
			(select distinct 
			'危桥' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw
			from plan_wqgz pl left join sck_wqgz sc on pl.sckid=sc.sckid left join xmk_wqgz xm on sc.xmkid=xm.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			) t1 left join
			(
			  select 
			     sbnf,jhxdwh,xzqhdm,gydw,count(*) zuo,sum(ym) ym 
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			     pl.jhqlqc ym,pl.jhxdwh,pl.sbnf
			    from plan_wqgz pl left join sck_wqgz sc on pl.sckid=sc.sckid left join xmk_wqgz xm on sc.xmkid=xm.id
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			) t2 on t1.xdnf=t2.sbnf and t1.jhxdwh=t2.jhxdwh and t1.xzqhdm=t2.xzqhdm and t1.gydw=t2.gydw
			left join
			(select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.sbnf,(select count(*) from plan_wqgz zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')&lt;=sysdate 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')) zuo
			    from plan_wqgz pl left join sck_wqgz sc on pl.sckid=sc.sckid left join xmk_wqgz xm on sc.xmkid=xm.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywcmc,-1),'米',substr(g.bywcmc,0,length(g.bywcmc)-1),g.bywcmc)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_wqgz g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
			    and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			    
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			) t3
			 on t1.xdnf=t3.sbnf and t1.jhxdwh=t3.jhxdwh and t1.xzqhdm=t3.xzqhdm and t1.gydw=t3.gydw
			left join 
			(
			select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.sbnf,(select count(*) from plan_wqgz zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')) zuo
			    from plan_wqgz pl left join sck_wqgz sc on pl.sckid=sc.sckid left join xmk_wqgz xm on sc.xmkid=xm.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywcmc,-1),'米',substr(g.bywcmc,0,length(g.bywcmc)-1),g.bywcmc)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_wqgz g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			    
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			) t4
			on t1.xdnf=t4.sbnf and t1.jhxdwh=t4.jhxdwh and t1.xzqhdm=t4.xzqhdm and t1.gydw=t4.gydw
			) tb1,
			(
			select 
			xmlx,t1.xdnf,t1.jhxdwh,t1.xzqh,t1.xzqhdm,t1.gydw,t1.ztz,t1.btz,t1.stz,t1.dstc,t1.qtzj,t2.zuo,t2.ym,t3.zuo bnzuo,t3.ym bnym,t3.wctz bnwctz,t4.zuo ljzuo,t4.ym ljym,t4.wctz ljwctz
			from
			(select distinct 
			'病害' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw
			from plan_bhsd pl left join sck_bhsd sc on pl.sckid=sc.sckid left join xmk_bhsd xm on sc.xmkid=xm.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			) t1 left join
			(
			  select 
			     sbnf,jhxdwh,xzqhdm,gydw,count(*) zuo,sum(ym) ym 
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			     pl.jhqlqc ym,pl.jhxdwh,pl.sbnf
			    from plan_bhsd pl left join sck_bhsd sc on pl.sckid=sc.sckid left join xmk_bhsd xm on sc.xmkid=xm.id
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			) t2 on t1.xdnf=t2.sbnf and t1.jhxdwh=t2.jhxdwh and t1.xzqhdm=t2.xzqhdm and t1.gydw=t2.gydw
			left join
			(select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.sbnf,(select count(*) from plan_bhsd zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')&lt;=sysdate 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')) zuo
			    from plan_bhsd pl left join sck_bhsd sc on pl.sckid=sc.sckid left join xmk_bhsd xm on sc.xmkid=xm.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywcmc,-1),'米',substr(g.bywcmc,0,length(g.bywcmc)-1),g.bywcmc)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_bhsd g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
			    and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			    
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			) t3
			 on t1.xdnf=t3.sbnf and t1.jhxdwh=t3.jhxdwh and t1.xzqhdm=t3.xzqhdm and t1.gydw=t3.gydw
			left join 
			(
			select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.sbnf,(select count(*) from plan_bhsd zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')) zuo
			    from plan_bhsd pl left join sck_bhsd sc on pl.sckid=sc.sckid left join xmk_bhsd xm on sc.xmkid=xm.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywcmc,-1),'米',substr(g.bywcmc,0,length(g.bywcmc)-1),g.bywcmc)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_bhsd g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			    
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			) t4
			on t1.xdnf=t4.sbnf and t1.jhxdwh=t4.jhxdwh and t1.xzqhdm=t4.xzqhdm and t1.gydw=t4.gydw
			) tb2,
			(
			select 
			xmlx,t1.xdnf,t1.jhxdwh,t1.xzqh,t1.xzqhdm,t1.gydw,t1.ztz,t1.btz,t1.stz,t1.dstc,t1.qtzj,t2.zuo,t2.ym,t3.zuo bnzuo,t3.ym bnym,t3.wctz bnwctz,t4.zuo ljzuo,t4.ym ljym,t4.wctz ljwctz
			from
			(select distinct 
			'安保' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw
			from plan_abgc pl left join sck_abgc sc on pl.sckid=sc.sckid left join xmk_abgc xm on sc.xmkid=xm.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			union all
			select distinct 
			'安保' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(sc.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(sc.xzqhdm,0,4)||'00') xzqh,decode(substr(sc.gydwdm,0,1),'1','交通局','2','公路局') gydw
			from plan_af pl left join sck_aqsmfh sc on pl.sckid=sc.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			) t1 left join
			(
			  select 
			     sbnf,jhxdwh,xzqhdm,gydw,count(*) zuo,sum(ym) ym 
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			     pl.jhyhlc ym,pl.jhxdwh,pl.jhnf sbnf
			    from plan_abgc pl left join sck_abgc sc on pl.sckid=sc.sckid left join xmk_abgc xm on sc.xmkid=xm.id
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			union all
			select 
			     sbnf,jhxdwh,xzqhdm,gydw,count(*) zuo,sum(ym) ym 
			  from(
			    select 
			 pl.id,substr(sc.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(sc.xzqhdm,0,4)||'00') xzqh,decode(substr(sc.gydwdm,0,1),'1','交通局','2','公路局') gydw,
			     pl.jhyhlc ym,pl.jhxdwh,pl.jhnf sbnf
			    from plan_af pl left join sck_aqsmfh sc on pl.sckid=sc.id
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			) t2 on t1.xdnf=t2.sbnf and t1.jhxdwh=t2.jhxdwh and t1.xzqhdm=t2.xzqhdm and t1.gydw=t2.gydw
			left join
			(select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.jhnf sbnf,(select count(*) from plan_abgc zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')&lt;=sysdate 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')) zuo
			    from plan_abgc pl left join sck_abgc sc on pl.sckid=sc.sckid left join xmk_abgc xm on sc.xmkid=xm.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywc_gl,-1),'米',substr(g.bywc_gl,0,length(g.bywc_gl)-1),g.bywc_gl)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_abgc g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
			    and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			  union all
			  select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(sc.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(sc.xzqhdm,0,4)||'00') xzqh,decode(substr(sc.gydwdm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.jhnf sbnf,(select count(*) from plan_af zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')&lt;=sysdate 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')) zuo
			    from plan_af pl left join sck_aqsmfh sc on pl.sckid=sc.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywc_gl,-1),'米',substr(g.bywc_gl,0,length(g.bywc_gl)-1),g.bywc_gl)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_abgc g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
			    and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			  
			) t3
			 on t1.xdnf=t3.sbnf and t1.jhxdwh=t3.jhxdwh and t1.xzqhdm=t3.xzqhdm and t1.gydw=t3.gydw
			left join 
			(
			select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.jhnf sbnf,(select count(*) from plan_abgc zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')&lt;=sysdate) zuo
			    from plan_abgc pl left join sck_abgc sc on pl.sckid=sc.sckid left join xmk_abgc xm on sc.xmkid=xm.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywc_gl,-1),'米',substr(g.bywc_gl,0,length(g.bywc_gl)-1),g.bywc_gl)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_abgc g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			  union all
			  select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(sc.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(sc.xzqhdm,0,4)||'00') xzqh,decode(substr(sc.gydwdm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.jhnf sbnf,(select count(*) from plan_af zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')) zuo
			    from plan_af pl left join sck_aqsmfh sc on pl.sckid=sc.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywc_gl,-1),'米',substr(g.bywc_gl,0,length(g.bywc_gl)-1),g.bywc_gl)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_abgc g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			  
			) t4
			on t1.xdnf=t4.sbnf and t1.jhxdwh=t4.jhxdwh and t1.xzqhdm=t4.xzqhdm and t1.gydw=t4.gydw
			) tb3,
			(
			select 
			xmlx,t1.xdnf,t1.jhxdwh,t1.xzqh,t1.xzqhdm,t1.gydw,t1.ztz,t1.btz,t1.stz,t1.dstc,t1.qtzj,t2.zuo,t2.ym,t3.zuo bnzuo,t3.ym bnym,t3.wctz bnwctz,t4.zuo ljzuo,t4.ym ljym,t4.wctz ljwctz
			from
			(select distinct 
			'灾害' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw
			from plan_zhfz pl left join sck_zhfz sc on pl.sckid=sc.sckid left join xmk_zhfz xm on sc.xmkid=xm.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			) t1 left join
			(
			  select 
			     sbnf,jhxdwh,xzqhdm,gydw,count(*) zuo,sum(ym) ym 
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			     pl.jhyhlc ym,pl.jhxdwh,pl.sbnf
			    from plan_zhfz pl left join sck_zhfz sc on pl.sckid=sc.sckid left join xmk_zhfz xm on sc.xmkid=xm.id
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			
			) t2 on t1.xdnf=t2.sbnf and t1.jhxdwh=t2.jhxdwh and t1.xzqhdm=t2.xzqhdm and t1.gydw=t2.gydw
			left join
			(select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.sbnf,(select count(*) from plan_zhfz zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and zcx.sjwgsj&lt;=sysdate 
			    and zcx.sjwgsj>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')) zuo
			    from plan_zhfz pl left join sck_zhfz sc on pl.sckid=sc.sckid left join xmk_zhfz xm on sc.xmkid=xm.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywcgl,-1),'米',substr(g.bywcgl,0,length(g.bywcgl)-1),g.bywcgl)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_zhfz g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
			    and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			  
			) t3
			 on t1.xdnf=t3.sbnf and t1.jhxdwh=t3.jhxdwh and t1.xzqhdm=t3.xzqhdm and t1.gydw=t3.gydw
			left join 
			(
			select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.sbnf,(select count(*) from plan_zhfz zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and zcx.sjwgsj&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')) zuo
			    from plan_zhfz pl left join sck_zhfz sc on pl.sckid=sc.sckid left join xmk_zhfz xm on sc.xmkid=xm.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywcgl,-1),'米',substr(g.bywcgl,0,length(g.bywcgl)-1),g.bywcgl)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_zhfz g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			 
			) t4
			on t1.xdnf=t4.sbnf and t1.jhxdwh=t4.jhxdwh and t1.xzqhdm=t4.xzqhdm and t1.gydw=t4.gydw
			) tb4
			where tb0.xdnf=tb1.xdnf(+) and tb0.jhxdwh=tb1.jhxdwh(+) 
			and tb0.xdnf=tb2.xdnf(+) and tb0.jhxdwh=tb2.jhxdwh(+)
			and tb0.xdnf=tb3.xdnf(+) and tb0.jhxdwh=tb3.jhxdwh(+)
			and tb0.xdnf=tb4.xdnf(+) and tb0.jhxdwh=tb4.jhxdwh(+)
			and tb0.xzqhdm=tb1.xzqhdm(+) and tb0.gydw=tb1.gydw(+)
			and tb0.xzqhdm=tb2.xzqhdm(+) and tb0.gydw=tb2.gydw(+)
			and tb0.xzqhdm=tb3.xzqhdm(+) and tb0.gydw=tb3.gydw(+)
			and tb0.xzqhdm=tb4.xzqhdm(+) and tb0.gydw=tb4.gydw(+)
			<if test="xmlx != null and  xmlx != ''">
					and tb0.gydw like '%'||trim(#{xmlx})||'%'
			</if>
			group by tb0.xzqhdm,tb0.xdnf,tb0.jhxdwh
			order by tb0.xzqhdm,tb0.xdnf
			) tbzj
			group by tbzj.v_1,tbzj.v_2
			
			
			
			union all
			
			
			
			select distinct
			to_char(max(tb0.xzqh)) xzqh,tb0.xzqhdm,'0' v_0,tb0.xdnf v_1,tb0.jhxdwh v_2,nvl(sum(tb0.ztz),0) v_3,nvl(sum(tb0.btz),0) v_4,nvl(sum(tb0.stz),0) v_5,nvl(sum(tb0.dstc),0) v_6,nvl(sum(tb0.qtzj),0) v_7,
			nvl(sum(tb1.zuo),0) v_8,nvl(sum(tb1.ym),0) v_9,nvl(sum(tb1.ztz),0) v_10,nvl(sum(tb1.btz),0) v_11,nvl(sum(tb1.stz),0) v_12,nvl(sum(tb1.dstc),0) v_13,nvl(sum(tb1.qtzj),0) v_14,
			nvl(sum(tb2.zuo),0) v_15,nvl(sum(tb2.ym),0) v_16,nvl(sum(tb2.ztz),0) v_17,nvl(sum(tb2.btz),0) v_18,nvl(sum(tb2.stz),0) v_19,nvl(sum(tb2.dstc),0) v_20,nvl(sum(tb2.qtzj),0) v_21,
			nvl(sum(tb3.zuo),0) v_22,nvl(sum(tb3.ym),0) v_23,nvl(sum(tb3.ztz),0) v_24,nvl(sum(tb3.btz),0) v_25,nvl(sum(tb3.stz),0) v_26,nvl(sum(tb3.dstc),0) v_27,nvl(sum(tb3.qtzj),0) v_28,
			nvl(sum(tb4.zuo),0) v_29,nvl(sum(tb4.ym),0) v_30,nvl(sum(tb4.ztz),0) v_31,nvl(sum(tb4.btz),0) v_32,nvl(sum(tb4.stz),0) v_33,nvl(sum(tb4.dstc),0) v_34,nvl(sum(tb4.qtzj),0) v_35,
			nvl((nvl(sum(tb1.bnwctz),0)+nvl(sum(tb2.bnwctz),0)+nvl(sum(tb3.bnwctz),0)+nvl(sum(tb4.bnwctz),0)),0) v_36,nvl((nvl(sum(tb1.ljwctz),0)+nvl(sum(tb2.ljwctz),0)+nvl(sum(tb3.ljwctz),0)+nvl(sum(tb4.ljwctz),0)),0) v_37,
			nvl(sum(tb1.bnzuo),0) v_38,nvl(sum(tb1.bnym),0) v_39,nvl(sum(tb1.bnwctz),0) v_40,
			nvl(sum(tb2.bnzuo),0) v_41,nvl(sum(tb2.bnym),0) v_42,nvl(sum(tb2.bnwctz),0) v_43,
			nvl(sum(tb3.bnzuo),0) v_44,nvl(sum(tb3.bnym),0) v_45,nvl(sum(tb3.bnwctz),0) v_46,
			nvl(sum(tb4.bnzuo),0) v_47,nvl(sum(tb4.bnym),0) v_48,nvl(sum(tb4.bnwctz),0) v_49,
			nvl(sum(tb1.ljzuo),0) v_50,nvl(sum(tb1.ljym),0) v_51,nvl(sum(tb1.ljwctz),0) v_52,
			nvl(sum(tb2.ljzuo),0) v_53,nvl(sum(tb2.ljym),0) v_54,nvl(sum(tb2.ljwctz),0) v_55,
			nvl(sum(tb3.ljzuo),0) v_56,nvl(sum(tb3.ljym),0) v_57,nvl(sum(tb3.ljwctz),0) v_58,
			nvl(sum(tb4.ljzuo),0) v_59,nvl(sum(tb4.ljym),0) v_60,nvl(sum(tb4.ljwctz),0) v_61
			from 
			(
			select 
			xdnf,jhxdwh,min(xzqh) xzqh,xzqhdm,gydw,sum(ztz) ztz,sum(btz) btz,sum(stz) stz,sum(dstc) dstc,sum(qtzj) qtzj
			from(
			  select distinct 
			'危桥' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw
			from plan_wqgz pl left join sck_wqgz sc on pl.sckid=sc.sckid left join xmk_wqgz xm on sc.xmkid=xm.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			union all
			select distinct 
			'病害' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw
			from plan_bhsd pl left join sck_bhsd sc on pl.sckid=sc.sckid left join xmk_bhsd xm on sc.xmkid=xm.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			union all
			select distinct 
			'安保' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw
			from plan_abgc pl left join sck_abgc sc on pl.sckid=sc.sckid left join xmk_abgc xm on sc.xmkid=xm.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			union all
			select distinct 
			'安保' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(sc.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(sc.xzqhdm,0,4)||'00') xzqh,decode(substr(sc.gydwdm,0,1),'1','交通局','2','公路局') gydw
			from plan_af pl left join sck_aqsmfh sc on pl.sckid=sc.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			union all
			select distinct 
			'灾害' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw
			from plan_zhfz pl left join sck_zhfz sc on pl.sckid=sc.sckid left join xmk_zhfz xm on sc.xmkid=xm.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			) tt group by tt.xdnf,tt.jhxdwh,tt.xzqhdm,tt.gydw
			) tb0,
			(
			select 
			xmlx,t1.xdnf,t1.jhxdwh,t1.xzqh,t1.xzqhdm,t1.gydw,t1.ztz,t1.btz,t1.stz,t1.dstc,t1.qtzj,t2.zuo,t2.ym,t3.zuo bnzuo,t3.ym bnym,t3.wctz bnwctz,t4.zuo ljzuo,t4.ym ljym,t4.wctz ljwctz
			from
			(select distinct 
			'危桥' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw
			from plan_wqgz pl left join sck_wqgz sc on pl.sckid=sc.sckid left join xmk_wqgz xm on sc.xmkid=xm.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			) t1 left join
			(
			  select 
			     sbnf,jhxdwh,xzqhdm,gydw,count(*) zuo,sum(ym) ym 
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			     pl.jhqlqc ym,pl.jhxdwh,pl.sbnf
			    from plan_wqgz pl left join sck_wqgz sc on pl.sckid=sc.sckid left join xmk_wqgz xm on sc.xmkid=xm.id
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			) t2 on t1.xdnf=t2.sbnf and t1.jhxdwh=t2.jhxdwh and t1.xzqhdm=t2.xzqhdm and t1.gydw=t2.gydw
			left join
			(select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.sbnf,(select count(*) from plan_wqgz zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')&lt;=sysdate 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')) zuo
			    from plan_wqgz pl left join sck_wqgz sc on pl.sckid=sc.sckid left join xmk_wqgz xm on sc.xmkid=xm.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywcmc,-1),'米',substr(g.bywcmc,0,length(g.bywcmc)-1),g.bywcmc)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_wqgz g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
			    and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			    
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			) t3
			 on t1.xdnf=t3.sbnf and t1.jhxdwh=t3.jhxdwh and t1.xzqhdm=t3.xzqhdm and t1.gydw=t3.gydw
			left join 
			(
			select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.sbnf,(select count(*) from plan_wqgz zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')) zuo
			    from plan_wqgz pl left join sck_wqgz sc on pl.sckid=sc.sckid left join xmk_wqgz xm on sc.xmkid=xm.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywcmc,-1),'米',substr(g.bywcmc,0,length(g.bywcmc)-1),g.bywcmc)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_wqgz g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			    
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			) t4
			on t1.xdnf=t4.sbnf and t1.jhxdwh=t4.jhxdwh and t1.xzqhdm=t4.xzqhdm and t1.gydw=t4.gydw
			) tb1,
			(
			select 
			xmlx,t1.xdnf,t1.jhxdwh,t1.xzqh,t1.xzqhdm,t1.gydw,t1.ztz,t1.btz,t1.stz,t1.dstc,t1.qtzj,t2.zuo,t2.ym,t3.zuo bnzuo,t3.ym bnym,t3.wctz bnwctz,t4.zuo ljzuo,t4.ym ljym,t4.wctz ljwctz
			from
			(select distinct 
			'病害' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw
			from plan_bhsd pl left join sck_bhsd sc on pl.sckid=sc.sckid left join xmk_bhsd xm on sc.xmkid=xm.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			) t1 left join
			(
			  select 
			     sbnf,jhxdwh,xzqhdm,gydw,count(*) zuo,sum(ym) ym 
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			     pl.jhqlqc ym,pl.jhxdwh,pl.sbnf
			    from plan_bhsd pl left join sck_bhsd sc on pl.sckid=sc.sckid left join xmk_bhsd xm on sc.xmkid=xm.id
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			) t2 on t1.xdnf=t2.sbnf and t1.jhxdwh=t2.jhxdwh and t1.xzqhdm=t2.xzqhdm and t1.gydw=t2.gydw
			left join
			(select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.sbnf,(select count(*) from plan_bhsd zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')&lt;=sysdate 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')) zuo
			    from plan_bhsd pl left join sck_bhsd sc on pl.sckid=sc.sckid left join xmk_bhsd xm on sc.xmkid=xm.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywcmc,-1),'米',substr(g.bywcmc,0,length(g.bywcmc)-1),g.bywcmc)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_bhsd g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
			    and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			    
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			) t3
			 on t1.xdnf=t3.sbnf and t1.jhxdwh=t3.jhxdwh and t1.xzqhdm=t3.xzqhdm and t1.gydw=t3.gydw
			left join 
			(
			select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.sbnf,(select count(*) from plan_bhsd zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')) zuo
			    from plan_bhsd pl left join sck_bhsd sc on pl.sckid=sc.sckid left join xmk_bhsd xm on sc.xmkid=xm.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywcmc,-1),'米',substr(g.bywcmc,0,length(g.bywcmc)-1),g.bywcmc)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_bhsd g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			    
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			) t4
			on t1.xdnf=t4.sbnf and t1.jhxdwh=t4.jhxdwh and t1.xzqhdm=t4.xzqhdm and t1.gydw=t4.gydw
			) tb2,
			(
			select 
			xmlx,t1.xdnf,t1.jhxdwh,t1.xzqh,t1.xzqhdm,t1.gydw,t1.ztz,t1.btz,t1.stz,t1.dstc,t1.qtzj,t2.zuo,t2.ym,t3.zuo bnzuo,t3.ym bnym,t3.wctz bnwctz,t4.zuo ljzuo,t4.ym ljym,t4.wctz ljwctz
			from
			(select distinct 
			'安保' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw
			from plan_abgc pl left join sck_abgc sc on pl.sckid=sc.sckid left join xmk_abgc xm on sc.xmkid=xm.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			union all
			select distinct 
			'安保' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(sc.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(sc.xzqhdm,0,4)||'00') xzqh,decode(substr(sc.gydwdm,0,1),'1','交通局','2','公路局') gydw
			from plan_af pl left join sck_aqsmfh sc on pl.sckid=sc.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			) t1 left join
			(
			  select 
			     sbnf,jhxdwh,xzqhdm,gydw,count(*) zuo,sum(ym) ym 
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			     pl.jhyhlc ym,pl.jhxdwh,pl.jhnf sbnf
			    from plan_abgc pl left join sck_abgc sc on pl.sckid=sc.sckid left join xmk_abgc xm on sc.xmkid=xm.id
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			union all
			select 
			     sbnf,jhxdwh,xzqhdm,gydw,count(*) zuo,sum(ym) ym 
			  from(
			    select 
			 pl.id,substr(sc.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(sc.xzqhdm,0,4)||'00') xzqh,decode(substr(sc.gydwdm,0,1),'1','交通局','2','公路局') gydw,
			     pl.jhyhlc ym,pl.jhxdwh,pl.jhnf sbnf
			    from plan_af pl left join sck_aqsmfh sc on pl.sckid=sc.id
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			) t2 on t1.xdnf=t2.sbnf and t1.jhxdwh=t2.jhxdwh and t1.xzqhdm=t2.xzqhdm and t1.gydw=t2.gydw
			left join
			(select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.jhnf sbnf,(select count(*) from plan_abgc zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')&lt;=sysdate 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')) zuo
			    from plan_abgc pl left join sck_abgc sc on pl.sckid=sc.sckid left join xmk_abgc xm on sc.xmkid=xm.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywc_gl,-1),'米',substr(g.bywc_gl,0,length(g.bywc_gl)-1),g.bywc_gl)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_abgc g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
			    and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			  union all
			  select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(sc.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(sc.xzqhdm,0,4)||'00') xzqh,decode(substr(sc.gydwdm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.jhnf sbnf,(select count(*) from plan_af zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')&lt;=sysdate 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')) zuo
			    from plan_af pl left join sck_aqsmfh sc on pl.sckid=sc.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywc_gl,-1),'米',substr(g.bywc_gl,0,length(g.bywc_gl)-1),g.bywc_gl)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_abgc g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
			    and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			  
			) t3
			 on t1.xdnf=t3.sbnf and t1.jhxdwh=t3.jhxdwh and t1.xzqhdm=t3.xzqhdm and t1.gydw=t3.gydw
			left join 
			(
			select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.jhnf sbnf,(select count(*) from plan_abgc zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')&lt;=sysdate) zuo
			    from plan_abgc pl left join sck_abgc sc on pl.sckid=sc.sckid left join xmk_abgc xm on sc.xmkid=xm.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywc_gl,-1),'米',substr(g.bywc_gl,0,length(g.bywc_gl)-1),g.bywc_gl)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_abgc g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			  union all
			  select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(sc.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(sc.xzqhdm,0,4)||'00') xzqh,decode(substr(sc.gydwdm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.jhnf sbnf,(select count(*) from plan_af zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and to_date(zcx.sjwgsj,'yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')) zuo
			    from plan_af pl left join sck_aqsmfh sc on pl.sckid=sc.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywc_gl,-1),'米',substr(g.bywc_gl,0,length(g.bywc_gl)-1),g.bywc_gl)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_abgc g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			  
			) t4
			on t1.xdnf=t4.sbnf and t1.jhxdwh=t4.jhxdwh and t1.xzqhdm=t4.xzqhdm and t1.gydw=t4.gydw
			) tb3,
			(
			select 
			xmlx,t1.xdnf,t1.jhxdwh,t1.xzqh,t1.xzqhdm,t1.gydw,t1.ztz,t1.btz,t1.stz,t1.dstc,t1.qtzj,t2.zuo,t2.ym,t3.zuo bnzuo,t3.ym bnym,t3.wctz bnwctz,t4.zuo ljzuo,t4.ym ljym,t4.wctz ljwctz
			from
			(select distinct 
			'灾害' xmlx,xd.xdnf,xd.jhxdwh,min(t.xzqh) xzqh,t.xzqhdm,t.gydw,nvl(sum(xd.ztz),0) ztz,nvl(sum(xd.btzzj),0) btz,nvl(sum(xd.stz),0) stz,nvl((sum(xd.ztz)-sum(xd.btzzj)-sum(xd.stz)),0) dstc,0 qtzj
			from 
			plan_zjxd xd left join 
			(select 
			 pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw
			from plan_zhfz pl left join sck_zhfz sc on pl.sckid=sc.sckid left join xmk_zhfz xm on sc.xmkid=xm.id) t on xd.xmid=t.id 
			where t.id is not null
			group by xd.xdnf,xd.jhxdwh,t.xzqhdm,t.gydw
			) t1 left join
			(
			  select 
			     sbnf,jhxdwh,xzqhdm,gydw,count(*) zuo,sum(ym) ym 
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			     pl.jhyhlc ym,pl.jhxdwh,pl.sbnf
			    from plan_zhfz pl left join sck_zhfz sc on pl.sckid=sc.sckid left join xmk_zhfz xm on sc.xmkid=xm.id
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			
			) t2 on t1.xdnf=t2.sbnf and t1.jhxdwh=t2.jhxdwh and t1.xzqhdm=t2.xzqhdm and t1.gydw=t2.gydw
			left join
			(select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.sbnf,(select count(*) from plan_zhfz zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and zcx.sjwgsj&lt;=sysdate 
			    and zcx.sjwgsj>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')) zuo
			    from plan_zhfz pl left join sck_zhfz sc on pl.sckid=sc.sckid left join xmk_zhfz xm on sc.xmkid=xm.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywcgl,-1),'米',substr(g.bywcgl,0,length(g.bywcgl)-1),g.bywcgl)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_zhfz g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(to_char(sysdate,'yyyy-MM')||'-01','yyyy-mm-dd')
			    and to_date(g.sbyf||'-01','yyyy-MM-dd')>=to_date(to_char(sysdate,'yyyy')||'-01-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			  
			) t3
			 on t1.xdnf=t3.sbnf and t1.jhxdwh=t3.jhxdwh and t1.xzqhdm=t3.xzqhdm and t1.gydw=t3.gydw
			left join 
			(
			select 
			     sbnf,jhxdwh,xzqhdm,gydw,sum(zuo) zuo,sum(ym) ym,sum(wctz) wctz
			  from(
			    select 
			     pl.id,substr(xm.xzqhdm,0,4)||'00' xzqhdm,(select name from xtgl_xzqh xz where xz.id=substr(xm.xzqhdm,0,4)||'00') xzqh,decode(substr(xm.gydwbm,0,1),'1','交通局','2','公路局') gydw,
			      nvl(gc.bnwctz,0) wctz,nvl(gc.ym,0) ym,pl.jhxdwh,pl.sbnf,(select count(*) from plan_zhfz zcx where zcx.id=pl.id and zcx.sjwgsj is not null 
			    and zcx.sjwgsj&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')) zuo
			    from plan_zhfz pl left join sck_zhfz sc on pl.sckid=sc.sckid left join xmk_zhfz xm on sc.xmkid=xm.id
			    left join
			    (select jhid,nvl(sum(decode(substr(g.bywcgl,-1),'米',substr(g.bywcgl,0,length(g.bywcgl)-1),g.bywcgl)),0) ym ,nvl(sum(g.wc_btz+g.wc_stz+g.wc_qttz),0) bnwctz from gcgl_zhfz g where
			    to_date(g.sbyf||'-01','yyyy-MM-dd')&lt;=to_date(#{ybnf}||'-'||#{ybyf}||'-01','yyyy-mm-dd')
			      group by g.jhid) gc on pl.id=gc.jhid
			  ) t group by t.sbnf,jhxdwh,xzqhdm,gydw
			 
			) t4
			on t1.xdnf=t4.sbnf and t1.jhxdwh=t4.jhxdwh and t1.xzqhdm=t4.xzqhdm and t1.gydw=t4.gydw
			) tb4
			where tb0.xdnf=tb1.xdnf(+) and tb0.jhxdwh=tb1.jhxdwh(+) 
			and tb0.xdnf=tb2.xdnf(+) and tb0.jhxdwh=tb2.jhxdwh(+)
			and tb0.xdnf=tb3.xdnf(+) and tb0.jhxdwh=tb3.jhxdwh(+)
			and tb0.xdnf=tb4.xdnf(+) and tb0.jhxdwh=tb4.jhxdwh(+)
			and tb0.xzqhdm=tb1.xzqhdm(+) and tb0.gydw=tb1.gydw(+)
			and tb0.xzqhdm=tb2.xzqhdm(+) and tb0.gydw=tb2.gydw(+)
			and tb0.xzqhdm=tb3.xzqhdm(+) and tb0.gydw=tb3.gydw(+)
			and tb0.xzqhdm=tb4.xzqhdm(+) and tb0.gydw=tb4.gydw(+)
			<if test="xmlx != null and  xmlx != ''">
					and tb0.gydw like '%'||trim(#{xmlx})||'%'
			</if>
			group by tb0.xzqhdm,tb0.xdnf,tb0.jhxdwh
			
			order by xzqhdm,v_1,v_2
	</select>
	
	<select id="getWqgzjsqk" parameterType="gcglwqgz" resultType="elist">
		select '1' v_0,'合计' v_1,sum(v_17) v_17,sum(v_18) v_18,sum(v_21) v_21,sum(v_22) v_22,sum(v_23) v_23,sum(v_30) v_30,sum(v_31) v_31,sum(v_33) v_33,sum(v_34) v_34,
		 sum(v_35) v_35,sum(v_36) v_36,sum(v_37) v_37,sum(v_38) v_38,sum(v_39) v_39,sum(v_40) v_40,sum(v_41) v_41,sum(v_42) v_42,sum(v_46) v_46,sum(v_47) v_47,decode(sum(v_46),0,0,round(((sum(v_47)/sum(v_46))*100),2)) v_48,
		 sum(v_49) v_49,sum(v_50) v_50,decode(sum(v_49),0,0,null,0,round(((nvl(sum(v_50),0)/sum(v_49))*100),2)) v_51,sum(v_21-v_22-v_23) v_52,sum(v_53) v_53,decode(sum(v_52),0,0,null,0,round(((nvl(sum(v_53),0)/sum(v_52))*100),2)) v_54 ,sum(trim(v_55)) v_55,count(*) v_12
		 from (
		select  
		 sc.scxsq v_1,(case when xm.tsdq like '%罗霄山脉连片特困地区%' then '是' else '否' end) v_2,(case when xm.tsdq like '%38个省领导定点联系县%' then '是' else '否' end) v_3,
		 (case when xm.tsdq like '%原中央苏区%' then '是' else '否' end) v_4,(case when xm.tsdq like '%国家贫困县%' then '是' else '否' end) v_5,xm.xzqhdm v_6,xm.xzqhmc v_7,
		 sc.sck_lxbm v_8,xm.lxmc v_9,sc.sck_qlzxzh v_10,sc.sck_qlbh v_11,xm.qlmc v_12,jh.xdsj v_13,jh.jhkgsj v_14,jh.jhwgsj v_15,jh.yjjgsj v_16,jh.jhqlqc v_17,jh.jhqlqk v_18,
		 sc.jsxz v_19,jh.pfwh v_20,round(nvl(jh.pfztz,0),2) v_21,decode(jh.sfylrbwqk,'是',round(nvl(jh.jhsybzje,0),2)，0) v_22,decode(jh.sfylrbwqk,'否',round(nvl(jh.shengbz,0),2)，0) v_23,jh.sjkgsj v_24,jh.sjwgsj v_25,jh.jsdw v_26,jh.sjdw v_27,jh.sgdw v_28,
		 jh.jldw v_29,jh.jhqlqc v_30,jh.jhqlqk v_31,(case when jh.sjwgsj like '%'||to_char(sysdate,'yyyy')||'%' then '是' else '否' end) v_32,
		(case when jh.jgzt='1' then '1' else '0' end) v_33,(case when jh.jgzt='1' then jh.jhqlqc else 0 end) v_34, (case when jh.kgzt='1' and jh.jgzt='0' then '1' else '0' end) v_35,(case when jh.kgzt='1' and jh.jgzt='0' then jh.jhqlqc else 0 end) v_36,
		 decode(jh.kgzt,'0',1,0) v_37,decode(jh.kgzt,'0',jh.jhqlqc,0) v_38,nvl((gc.zytz+gc.dfzc),0) v_39,nvl(gc.zytz,0) v_40,nvl(gc.dfzc,0) v_41,
		 nvl((gc1.zytz+gc1.dfzc),0) v_42,decode(jh.jgzt,'0',jh.wjgyy) v_43,decode(jg.yssj,null,'否','是') v_44,decode(jg.sfcclq,null,'',jg.sfcclq) v_45,
		 nvl(zj.btz,0) v_46,nvl(gc.btz,0) v_47,decode(zj.btz,0,0,null,0,round(((nvl(gc.btz,0)/zj.btz)*100),2)) v_48,
     	nvl(zj.stz,0) v_49,nvl(gc.stz,0) v_50,decode(zj.stz,0,0,null,0,round(((nvl(gc.stz,0)/zj.stz)*100),2)) v_51,
     	nvl(zj.qttz,0) v_52,nvl(gc.qttz,0) v_53,decode(zj.qttz,0,0,null,0,round(((nvl(gc.qttz,0)/zj.qttz)*100),2)) v_54,decode(jg.nsqsjjlzj,null,' ',jg.nsqsjjlzj) v_55,
		 jh.bz v_56,xm.gydwbm,xm.xzqhdm,jh.sbnf xmnf,substr(sc.sck_lxbm,0,1) xzdj 
		from plan_wqgz jh,sck_wqgz sc,xmk_wqgz xm,(select jhid,sum(g.zjdw_btz) btz,sum(g.zjdw_stz) stz,sum(g.zjdw_qttz) qttz,(sum(g.wc_btz)+sum(g.wc_stz)) zytz,sum(g.wc_qttz) dfzc,sum(decode(substr(g.bywcmc,-1),'米',substr(g.bywcmc,0,length(g.bywcmc)-1),g.bywcmc)) wc from gcgl_wqgz g group by jhid) gc,
		(select jhid,(sum(g.wc_btz)+sum(g.wc_stz)) zytz,sum(g.wc_qttz) dfzc,sum(decode(substr(g.bywcmc,-1),'米',substr(g.bywcmc,0,length(g.bywcmc)-1),g.bywcmc)) wc from gcgl_wqgz g where g.sbyf like '%'||to_char(sysdate,'yyyy')||'%'  group by jhid) gc1,
		gcgl_jgys jg,(select sum(t.btzzj) btz,sum(t.stz) stz,(sum(t.xdzj)-sum(t.btzzj)-sum(t.stz)) qttz,t.xmid from plan_zjxd t group by t.xmid) zj
		where jh.sckid=sc.sckid and sc.xmkid=xm.id and jh.id=gc.jhid(+) and jh.id=gc1.jhid(+) and jh.id=jg.jhid(+) and jh.id=zj.xmid(+)
		and xm.gydwbm like '1%' and jh.spzt='1'
			<if test="xmnf != null and xmnf !=''">
				and sbnf in (${xmnf})
			</if>
			<if test="gydw != null and gydw !=''">
				${gydw}
			</if>
			<if test="xzqhdm != null and xzqhdm !=''">
				${xzqhdm}
			</if>
			<if test="gldj != null and gldj !=''">
				${gldj}
			</if>
			<if test="sfylrbwqk != null and sfylrbwqk !=''">
				and jh.sfylrbwqk like '%'||#{sfylrbwqk}||'%'
			</if>
			<if test="tsdq != null and tsdq !=''">
				 ${tsdq}
			</if>
			<if test="akjfl != null and akjfl !=''">
				 ${akjfl}
			</if>
			<if test="jsxz != null and jsxz !=''">
				 ${jsxz}
			</if>
			<if test="jhpc != null and jhpc !=''">
				 ${jhpc}
			</if>
			order by xzqhdm
		) t1
		
	</select>
	<select id="getWqgzjsqk1" parameterType="gcglwqgz" resultType="elist">
		select rownum+1 v_0,t1.* from (
		select  
		 sc.scxsq v_1,(case when xm.tsdq like '%罗霄山脉连片特困地区%' then '是' else '否' end) v_2,(case when xm.tsdq like '%38个省领导定点联系县%' then '是' else '否' end) v_3,
		 (case when xm.tsdq like '%原中央苏区%' then '是' else '否' end) v_4,(case when xm.tsdq like '%国家贫困县%' then '是' else '否' end) v_5,xm.xzqhdm v_6,xm.xzqhmc v_7,
		 sc.sck_lxbm v_8,xm.lxmc v_9,sc.sck_qlzxzh v_10,sc.sck_qlbh v_11,xm.qlmc v_12,jh.xdsj v_13,jh.jhkgsj v_14,jh.jhwgsj v_15,jh.yjjgsj v_16,jh.jhqlqc v_17,jh.jhqlqk v_18,
		 sc.jsxz v_19,jh.pfwh v_20,round(nvl(jh.pfztz,0),2) v_21,decode(jh.sfylrbwqk,'是',round(nvl(jh.jhsybzje,0),2)，0) v_22,decode(jh.sfylrbwqk,'否',round(nvl(jh.shengbz,0),2)，0) v_23,jh.sjkgsj v_24,jh.sjwgsj v_25,jh.jsdw v_26,jh.sjdw v_27,jh.sgdw v_28,
		 jh.jldw v_29,jh.jhqlqc v_30,jh.jhqlqk v_31,(case when jh.sjwgsj like '%'||to_char(sysdate,'yyyy')||'%' then '是' else '否' end) v_32,
		(case when jh.jgzt='1' then '1' else '0' end) v_33,(case when jh.jgzt='1' then jh.jhqlqc else 0 end) v_34, (case when jh.kgzt='1' and jh.jgzt='0' then '1' else '0' end) v_35,(case when jh.kgzt='1' and jh.jgzt='0' then jh.jhqlqc else 0 end) v_36,
		 decode(jh.kgzt,'0',1,0) v_37,decode(jh.kgzt,'0',jh.jhqlqc,0) v_38,nvl((gc.zytz+gc.dfzc),0) v_39,nvl(gc.zytz,0) v_40,nvl(gc.dfzc,0) v_41,
		 nvl((gc1.zytz+gc1.dfzc),0) v_42,decode(jh.jgzt,'0',jh.wjgyy) v_43,decode(jg.yssj,null,'否','是') v_44,decode(jg.sfcclq,null,'',jg.sfcclq) v_45,
		 nvl(zj.btz,0) v_46,nvl(gc.btz,0) v_47,decode(zj.btz,0,0,null,0,round(((nvl(gc.btz,0)/zj.btz)*100),2)) v_48,
     	nvl(zj.stz,0) v_49,nvl(gc.stz,0) v_50,decode(zj.stz,0,0,null,0,round(((nvl(gc.stz,0)/zj.stz)*100),2)) v_51,
     	nvl(zj.qttz,0) v_52,nvl(gc.qttz,0) v_53,decode(zj.qttz,0,0,null,0,round(((nvl(gc.qttz,0)/zj.qttz)*100),2)) v_54,decode(jg.nsqsjjlzj,null,' ',jg.nsqsjjlzj) v_55,
		 jh.bz v_56,xm.gydwbm,xm.xzqhdm,jh.sbnf xmnf,substr(sc.sck_lxbm,0,1) xzdj 
		from plan_wqgz jh,sck_wqgz sc,xmk_wqgz xm,(select jhid,sum(g.zjdw_btz) btz,sum(g.zjdw_stz) stz,sum(g.zjdw_qttz) qttz,(sum(g.wc_btz)+sum(g.wc_stz)) zytz,sum(g.wc_qttz) dfzc,sum(decode(substr(g.bywcmc,-1),'米',substr(g.bywcmc,0,length(g.bywcmc)-1),g.bywcmc)) wc from gcgl_wqgz g group by jhid) gc,
		(select jhid,(sum(g.wc_btz)+sum(g.wc_stz)) zytz,sum(g.wc_qttz) dfzc,sum(decode(substr(g.bywcmc,-1),'米',substr(g.bywcmc,0,length(g.bywcmc)-1),g.bywcmc)) wc from gcgl_wqgz g where g.sbyf like '%'||to_char(sysdate,'yyyy')||'%'  group by jhid) gc1,
		gcgl_jgys jg,(select sum(t.btzzj) btz,sum(t.stz) stz,(sum(t.xdzj)-sum(t.btzzj)-sum(t.stz)) qttz,t.xmid from plan_zjxd t group by t.xmid) zj
		where jh.sckid=sc.sckid and sc.xmkid=xm.id and jh.id=gc.jhid(+) and jh.id=gc1.jhid(+) and jh.id=jg.jhid(+) and jh.id=zj.xmid(+)
		and xm.gydwbm like '1%' and jh.spzt='1'
			<if test="xmnf != null and xmnf !=''">
				and sbnf in (${xmnf})
			</if>
			<if test="gydw != null and gydw !=''">
				${gydw}
			</if>
			<if test="xzqhdm != null and xzqhdm !=''">
				${xzqhdm}
			</if>
			<if test="gldj != null and gldj !=''">
				${gldj}
			</if>
			<if test="sfylrbwqk != null and sfylrbwqk !=''">
				and jh.sfylrbwqk like '%'||#{sfylrbwqk}||'%'
			</if>
			<if test="tsdq != null and tsdq !=''">
				 ${tsdq}
			</if>
			<if test="akjfl != null and akjfl !=''">
				 ${akjfl}
			</if>
			<if test="jsxz != null and jsxz !=''">
				 ${jsxz}
			</if>
			<if test="jhpc != null and jhpc !=''">
				 ${jhpc}
			</if>
			order by xzqhdm
		) t1
		where 1=1
	</select>
	<select id="getAbjsqk" parameterType="gcglwqgz" resultType="elist">
		select '1' v_0, '合计' v_1,sum(v_12) v_12,sum(v_18) v_18,sum(v_19) v_19,sum(v_26) v_26,sum(v_27) v_27,sum(v_28) v_28,sum(v_29) v_29,sum(v_30) v_30,sum(v_31) v_31,sum(v_32) v_32,sum(v_33) v_33,
		sum(v_34) v_34,decode(sum(v_33),0,0,null,0,round(((nvl(sum(v_34),0)/sum(v_33))*100),2)) v_35,sum(v_36) v_36,sum(v_37) v_37,decode(sum(v_36),0,0,null,0,round(((nvl(sum(v_37),0)/sum(v_36))*100),2)) v_38
		 from(
		select 
		 (case when substr(xm.xzqhmc,instr(xm.xzqhmc,'市')+1,instr(xm.xzqhmc,'县')) is not null then substr(xm.xzqhmc,instr(xm.xzqhmc,'市')+1,instr(xm.xzqhmc,'县'))
		  when substr(xm.xzqhmc,instr(xm.xzqhmc,'市')+1,instr(xm.xzqhmc,'市')) is not null then substr(xm.xzqhmc,instr(xm.xzqhmc,'市')+1,instr(xm.xzqhmc,'市'))
		    when substr(xm.xzqhmc,instr(xm.xzqhmc,'市')+1,instr(xm.xzqhmc,'区')) is not null then substr(xm.xzqhmc,instr(xm.xzqhmc,'市')+1,instr(xm.xzqhmc,'区'))
		    else ' ' end) v_1,(case when xm.tsdq like '%罗霄山脉连片特困地区%' then '是' else '否' end) v_2,(case when xm.tsdq like '%38个省领导定点联系县%' then '是' else '否' end) v_3,
		 (case when xm.tsdq like '%原中央苏区%' then '是' else '否' end) v_4,(case when xm.tsdq like '%国家贫困县%' then '是' else '否' end) v_5,xm.xzqhdm v_6,xm.xzqhmc v_7,
		 sc.sck_lxbm v_8,sc.sck_lxmc v_9,sc.scqdzh v_10,sc.sczdzh v_11,p.jhyhlc v_12,sc.jsxz v_13,p.xdsj v_14,p.jhkgsj v_15,p.jhwgsj v_16,p.yjwgsj v_17,p.pfztz v_18,
		 p.jhsybbzje v_19,p.sjkgsj v_20,p.sjwgsj v_21,p.jsdw v_22,p.sjdw v_23,p.sgdw v_24,p.jldw v_25,decode(p.jgzt,'1',p.jhyhlc,nvl(gc.wcgl,0)) v_26,nvl(gc1.wcgl,0) v_27,
		 decode(p.jgzt,'1',zj.xdzj,nvl(gc.ztz,0)) v_28,decode(p.jgzt,'1',zj.btz,nvl(gc.btz,0)) v_29,decode(p.jgzt,'1',zj.dftz,nvl(gc.dftz,0)) v_30,nvl(gc1.ztz,0) v_31,
		 decode(jg.yssj,null,'0',p.jhyhlc) v_32,
		 nvl(zj.btz,0) v_33,nvl(gc.btz,0) v_34,decode(zj.btz,0,0,null,0,round(((nvl(gc.btz,0)/zj.btz)*100),2)) v_35,
		 nvl(zj.dftz,0) v_36,nvl(gc.dwdftz,0) v_37,decode(zj.dftz,0,0,null,0,round(((nvl(gc.dwdftz,0)/zj.dftz)*100),2)) v_38,
		 p.remarks v_39,xm.xzqhdm
		 
		from plan_abgc p,sck_abgc sc,xmk_abgc xm,
		(select g.jhid,sum(g.bywc_gl) wcgl,(sum(g.wc_btz)+sum(g.wc_stz)+sum(g.wc_qttz)) ztz,sum(g.wc_btz) btz,sum(g.wc_qttz) dftz,sum(g.zjdw_btz) dwbtz,sum(g.zjdw_qttz) dwdftz from gcgl_abgc g group by g.jhid) gc,
		(select g.jhid,sum(g.bywc_gl) wcgl,(sum(g.wc_btz)+sum(g.wc_stz)+sum(g.wc_qttz)) ztz,sum(g.wc_btz) btz,sum(g.wc_qttz) dftz,sum(g.zjdw_btz) dwbtz,sum(g.zjdw_qttz) dwdftz from gcgl_abgc g where g.sbyf like '%'||to_char(sysdate,'yyyy')||'%' group by g.jhid) gc1,
		(select sum(t.btzzj) btz,sum(t.stz) stz,(sum(t.xdzj)-sum(t.btzzj)-sum(t.stz)) dftz,sum(t.xdzj) xdzj,t.xmid from plan_zjxd t group by t.xmid) zj,gcgl_jgys jg
		where p.sckid=sc.sckid and sc.xmkid=xm.id and p.id=gc.jhid(+) and p.id=gc1.jhid(+) and p.id=zj.xmid(+) and p.id=jg.jhid(+)
		and p.spzt='1'
		and xm.gydwbm like '1%' 
		<if test="xmnf != null or xmnf !=''">
        	and p.jhnf in (${xmnf})
      	</if>
      	<if test="gydw != null or gydw !=''">
	        ${gydw}
	    </if>
	    <if test="xzqhdm != null or xzqhdm !=''">
	        ${xzqhdm}
	    </if>
	    <if test="gldj != null or gldj !=''">
        	${gldj}
        </if>
		union all
		select 
		 (case when substr(sc.xzqh,instr(sc.xzqh,'市')+1,instr(sc.xzqh,'县')) is not null then substr(sc.xzqh,instr(sc.xzqh,'市')+1,instr(sc.xzqh,'县'))
		  when substr(sc.xzqh,instr(sc.xzqh,'市')+1,instr(sc.xzqh,'市')) is not null then substr(sc.xzqh,instr(sc.xzqh,'市')+1,instr(sc.xzqh,'市'))
		    when substr(sc.xzqh,instr(sc.xzqh,'市')+1,instr(sc.xzqh,'区')) is not null then substr(sc.xzqh,instr(sc.xzqh,'市')+1,instr(sc.xzqh,'区'))
		    else ' ' end) v_1,(case when xm.tsdq like '%罗霄山脉连片特困地区%' then '是' else '否' end) v_2,(case when xm.tsdq like '%38个省领导定点联系县%' then '是' else '否' end) v_3,
		 (case when xm.tsdq like '%原中央苏区%' then '是' else '否' end) v_4,(case when xm.tsdq like '%国家贫困县%' then '是' else '否' end) v_5,sc.xzqhdm v_6,sc.xzqh v_7,
		 sc.lxbm v_8,sc.lxmc v_9,sc.qdzh v_10,sc.zdzh v_11,p.jhyhlc v_12,sc.jsxz v_13,p.xdsj v_14,p.jhkgsj v_15,p.jhwgsj v_16,p.yjwgsj v_17,p.pfztz v_18,
		 p.jhsybbzje v_19,p.sjkgsj v_20,p.sjwgsj v_21,p.jsdw v_22,p.sjdw v_23,p.sgdw v_24,p.jldw v_25,decode(p.jgzt,'1',p.jhyhlc,nvl(gc.wcgl,0)) v_26,nvl(gc1.wcgl,0) v_27,
		 decode(p.jgzt,'1',zj.xdzj,nvl(gc.ztz,0)) v_28,decode(p.jgzt,'1',zj.btz,nvl(gc.btz,0)) v_29,decode(p.jgzt,'1',zj.dftz,nvl(gc.dftz,0)) v_30,nvl(gc1.ztz,0) v_31,
		 decode(jg.yssj,null,'0',p.jhyhlc) v_32,
		 nvl(zj.btz,0) v_33,nvl(gc.btz,0) v_34,decode(zj.btz,0,0,null,0,round(((nvl(gc.btz,0)/zj.btz)*100),2)) v_35,
		 nvl(zj.dftz,0) v_36,nvl(gc.dwdftz,0) v_37,decode(zj.dftz,0,0,null,0,round(((nvl(gc.dwdftz,0)/zj.dftz)*100),2)) v_38,
		 p.remarks v_39,sc.xzqhdm
		 
		from plan_af p,sck_aqsmfh sc,(select replace(WMSYS.WM_CONCAT(xmk.tsdq),',',',') tsdq,xmbm,min(ld.gydwdm) gydwbm,min(ld.lxbm) sck_lxbm from sck_aqsmfh_ld ld left join xmk_aqsmfh xmk on ld.xmkid=xmk.id group by ld.xmbm) xm,
		(select g.jhid,sum(g.bywc_gl) wcgl,(sum(g.wc_btz)+sum(g.wc_stz)+sum(g.wc_qttz)) ztz,sum(g.wc_btz) btz,sum(g.wc_qttz) dftz,sum(g.zjdw_btz) dwbtz,sum(g.zjdw_qttz) dwdftz from gcgl_abgc g group by g.jhid) gc,
		(select g.jhid,sum(g.bywc_gl) wcgl,(sum(g.wc_btz)+sum(g.wc_stz)+sum(g.wc_qttz)) ztz,sum(g.wc_btz) btz,sum(g.wc_qttz) dftz,sum(g.zjdw_btz) dwbtz,sum(g.zjdw_qttz) dwdftz from gcgl_abgc g where g.sbyf like '%'||to_char(sysdate,'yyyy')||'%' group by g.jhid) gc1,
		(select sum(t.btzzj) btz,sum(t.stz) stz,(sum(t.xdzj)-sum(t.btzzj)-sum(t.stz)) dftz,sum(t.xdzj) xdzj,t.xmid from plan_zjxd t group by t.xmid) zj,gcgl_jgys jg
		where p.sckid=sc.id and sc.xmbm=xm.xmbm and p.id=gc.jhid(+) and p.id=gc1.jhid(+) and p.id=zj.xmid(+) and p.id=jg.jhid(+)
		and p.spzt='1'
		and sc.gydwdm like '1%'
		<if test="xmnf != null or xmnf !=''">
        and p.jhnf in (${xmnf})
      	</if>
      	<if test="gydw != null or gydw !=''">
	        ${gydw}
	    </if>
	    <if test="xzqhdm != null or xzqhdm !=''">
	        ${xzqhdm}
	    </if>
	    <if test="gldj != null or gldj !=''">
        	${gldj}
        </if>
		)
	</select>
	<select id="getAbjsqk1" parameterType="gcglwqgz" resultType="elist">
		select rownum+1 v_0,t1.* from(
		select 
		 (case when substr(xm.xzqhmc,instr(xm.xzqhmc,'市')+1,instr(xm.xzqhmc,'县')) is not null then substr(xm.xzqhmc,instr(xm.xzqhmc,'市')+1,instr(xm.xzqhmc,'县'))
		  when substr(xm.xzqhmc,instr(xm.xzqhmc,'市')+1,instr(xm.xzqhmc,'市')) is not null then substr(xm.xzqhmc,instr(xm.xzqhmc,'市')+1,instr(xm.xzqhmc,'市'))
		    when substr(xm.xzqhmc,instr(xm.xzqhmc,'市')+1,instr(xm.xzqhmc,'区')) is not null then substr(xm.xzqhmc,instr(xm.xzqhmc,'市')+1,instr(xm.xzqhmc,'区'))
		    else ' ' end) v_1,(case when xm.tsdq like '%罗霄山脉连片特困地区%' then '是' else '否' end) v_2,(case when xm.tsdq like '%38个省领导定点联系县%' then '是' else '否' end) v_3,
		 (case when xm.tsdq like '%原中央苏区%' then '是' else '否' end) v_4,(case when xm.tsdq like '%国家贫困县%' then '是' else '否' end) v_5,xm.xzqhdm v_6,xm.xzqhmc v_7,
		 sc.sck_lxbm v_8,sc.sck_lxmc v_9,sc.scqdzh v_10,sc.sczdzh v_11,p.jhyhlc v_12,sc.jsxz v_13,p.xdsj v_14,p.jhkgsj v_15,p.jhwgsj v_16,p.yjwgsj v_17,p.pfztz v_18,
		 p.jhsybbzje v_19,p.sjkgsj v_20,p.sjwgsj v_21,p.jsdw v_22,p.sjdw v_23,p.sgdw v_24,p.jldw v_25,decode(p.jgzt,'1',p.jhyhlc,nvl(gc.wcgl,0)) v_26,nvl(gc1.wcgl,0) v_27,
		 decode(p.jgzt,'1',zj.xdzj,nvl(gc.ztz,0)) v_28,decode(p.jgzt,'1',zj.btz,nvl(gc.btz,0)) v_29,decode(p.jgzt,'1',zj.dftz,nvl(gc.dftz,0)) v_30,nvl(gc1.ztz,0) v_31,
		 decode(jg.yssj,null,'0',p.jhyhlc) v_32,
		 nvl(zj.btz,0) v_33,nvl(gc.btz,0) v_34,decode(zj.btz,0,0,null,0,round(((nvl(gc.btz,0)/zj.btz)*100),2)) v_35,
		 nvl(zj.dftz,0) v_36,nvl(gc.dwdftz,0) v_37,decode(zj.dftz,0,0,null,0,round(((nvl(gc.dwdftz,0)/zj.dftz)*100),2)) v_38,
		 p.remarks v_39,xm.xzqhdm
		 
		from plan_abgc p,sck_abgc sc,xmk_abgc xm,
		(select g.jhid,sum(g.bywc_gl) wcgl,(sum(g.wc_btz)+sum(g.wc_stz)+sum(g.wc_qttz)) ztz,sum(g.wc_btz) btz,sum(g.wc_qttz) dftz,sum(g.zjdw_btz) dwbtz,sum(g.zjdw_qttz) dwdftz from gcgl_abgc g group by g.jhid) gc,
		(select g.jhid,sum(g.bywc_gl) wcgl,(sum(g.wc_btz)+sum(g.wc_stz)+sum(g.wc_qttz)) ztz,sum(g.wc_btz) btz,sum(g.wc_qttz) dftz,sum(g.zjdw_btz) dwbtz,sum(g.zjdw_qttz) dwdftz from gcgl_abgc g where g.sbyf like '%'||to_char(sysdate,'yyyy')||'%' group by g.jhid) gc1,
		(select sum(t.btzzj) btz,sum(t.stz) stz,(sum(t.xdzj)-sum(t.btzzj)-sum(t.stz)) dftz,sum(t.xdzj) xdzj,t.xmid from plan_zjxd t group by t.xmid) zj,gcgl_jgys jg
		where p.sckid=sc.sckid and sc.xmkid=xm.id and p.id=gc.jhid(+) and p.id=gc1.jhid(+) and p.id=zj.xmid(+) and p.id=jg.jhid(+)
		and p.spzt='1'
		and xm.gydwbm like '1%'
		<if test="xmnf != null or xmnf !=''">
        and p.jhnf in (${xmnf})
      	</if>
      	<if test="gydw != null or gydw !=''">
	        ${gydw}
	    </if>
	    <if test="xzqhdm != null or xzqhdm !=''">
	        ${xzqhdm}
	    </if>
	    <if test="gldj != null or gldj !=''">
        	${gldj}
        </if>
		union all
		select 
		 (case when substr(sc.xzqh,instr(sc.xzqh,'市')+1,instr(sc.xzqh,'县')) is not null then substr(sc.xzqh,instr(sc.xzqh,'市')+1,instr(sc.xzqh,'县'))
		  when substr(sc.xzqh,instr(sc.xzqh,'市')+1,instr(sc.xzqh,'市')) is not null then substr(sc.xzqh,instr(sc.xzqh,'市')+1,instr(sc.xzqh,'市'))
		    when substr(sc.xzqh,instr(sc.xzqh,'市')+1,instr(sc.xzqh,'区')) is not null then substr(sc.xzqh,instr(sc.xzqh,'市')+1,instr(sc.xzqh,'区'))
		    else ' ' end) v_1,(case when xm.tsdq like '%罗霄山脉连片特困地区%' then '是' else '否' end) v_2,(case when xm.tsdq like '%38个省领导定点联系县%' then '是' else '否' end) v_3,
		 (case when xm.tsdq like '%原中央苏区%' then '是' else '否' end) v_4,(case when xm.tsdq like '%国家贫困县%' then '是' else '否' end) v_5,sc.xzqhdm v_6,sc.xzqh v_7,
		 sc.lxbm v_8,sc.lxmc v_9,sc.qdzh v_10,sc.zdzh v_11,p.jhyhlc v_12,sc.jsxz v_13,p.xdsj v_14,p.jhkgsj v_15,p.jhwgsj v_16,p.yjwgsj v_17,p.pfztz v_18,
		 p.jhsybbzje v_19,p.sjkgsj v_20,p.sjwgsj v_21,p.jsdw v_22,p.sjdw v_23,p.sgdw v_24,p.jldw v_25,decode(p.jgzt,'1',p.jhyhlc,nvl(gc.wcgl,0)) v_26,nvl(gc1.wcgl,0) v_27,
		 decode(p.jgzt,'1',zj.xdzj,nvl(gc.ztz,0)) v_28,decode(p.jgzt,'1',zj.btz,nvl(gc.btz,0)) v_29,decode(p.jgzt,'1',zj.dftz,nvl(gc.dftz,0)) v_30,nvl(gc1.ztz,0) v_31,
		 decode(jg.yssj,null,'0',p.jhyhlc) v_32,
		 nvl(zj.btz,0) v_33,nvl(gc.btz,0) v_34,decode(zj.btz,0,0,null,0,round(((nvl(gc.btz,0)/zj.btz)*100),2)) v_35,
		 nvl(zj.dftz,0) v_36,nvl(gc.dwdftz,0) v_37,decode(zj.dftz,0,0,null,0,round(((nvl(gc.dwdftz,0)/zj.dftz)*100),2)) v_38,
		 p.remarks v_39,sc.xzqhdm
		 
		from plan_af p,sck_aqsmfh sc,(select replace(WMSYS.WM_CONCAT(xmk.tsdq),',',',') tsdq,xmbm,min(ld.gydwdm) gydwbm,min(ld.lxbm) sck_lxbm from sck_aqsmfh_ld ld left join xmk_aqsmfh xmk on ld.xmkid=xmk.id group by ld.xmbm) xm,
		(select g.jhid,sum(g.bywc_gl) wcgl,(sum(g.wc_btz)+sum(g.wc_stz)+sum(g.wc_qttz)) ztz,sum(g.wc_btz) btz,sum(g.wc_qttz) dftz,sum(g.zjdw_btz) dwbtz,sum(g.zjdw_qttz) dwdftz from gcgl_abgc g group by g.jhid) gc,
		(select g.jhid,sum(g.bywc_gl) wcgl,(sum(g.wc_btz)+sum(g.wc_stz)+sum(g.wc_qttz)) ztz,sum(g.wc_btz) btz,sum(g.wc_qttz) dftz,sum(g.zjdw_btz) dwbtz,sum(g.zjdw_qttz) dwdftz from gcgl_abgc g where g.sbyf like '%'||to_char(sysdate,'yyyy')||'%' group by g.jhid) gc1,
		(select sum(t.btzzj) btz,sum(t.stz) stz,(sum(t.xdzj)-sum(t.btzzj)-sum(t.stz)) dftz,sum(t.xdzj) xdzj,t.xmid from plan_zjxd t group by t.xmid) zj,gcgl_jgys jg
		where p.sckid=sc.id and sc.xmbm=xm.xmbm and p.id=gc.jhid(+) and p.id=gc1.jhid(+) and p.id=zj.xmid(+) and p.id=jg.jhid(+)
		and p.spzt='1'
		and sc.gydwdm like '1%'
		<if test="xmnf != null or xmnf !=''">
        and p.jhnf in (${xmnf})
      	</if>
      	<if test="gydw != null or gydw !=''">
	        ${gydw}
	    </if>
	    <if test="xzqhdm != null or xzqhdm !=''">
	        ${xzqhdm}
	    </if>
	    <if test="gldj != null or gldj !=''">
        	${gldj}
        </if>
		)t1
		
		order by v_6
	</select>
	
	<!-- 三件实事 -->
	<select id="getsjssjzhzb" parameterType="string" resultType="hashmap">
		select * from SJSSJZHZB t where xmnf = #{value}
	</select>
	<select id="getGlgzxjzd" parameterType="string" resultType="elist">
	select t2.value, t2.name, t1.co, t2.hight, t2.rowxh, t2.width
	  from (select substr1 value, count(*) co
	          from zdybbbt
	         where value in
	               (${value}) and ssbb='glgzxjmxb'
	         group by substr1
	        union all
	        select substr2 value, count(*) co
	          from zdybbbt
	         where value in
	               (${value}) and ssbb='glgzxjmxb'
	           and substr2 is not null
	         group by substr2
	        union all
	        select substr3 value, count(*) co
	          from zdybbbt
	         where value in
	               (${value}) and ssbb='glgzxjmxb'
	           and substr3 is not null
	         group by substr3
	        union all
	        select value, count(*) co
	          from zdybbbt
	         where value in
	               (${value}) and ssbb='glgzxjmxb'
	         group by value) t1,
	       zdybbbt t2
	 where t1.value = t2.value and ssbb='glgzxjmxb'
	 order by t2.xh
	</select>
	<select id="createBtTree" parameterType="elist" resultType="treenode">
	select 
	value id,text,state,(case when value not like '%v_%' then substr(id,0,length(id)-1)
	else id
	end) parent,id id1,xh
	from(
	select (case when value like '%v_%' then substr(value,0,instr(value,'v')-1) else value end) id,name text,'open' state,value,xh
	from ZDYBBBT where ssbb=#{ssbb} and value like #{treeno}||'%' 
	)
	order by (case when id like '%v_%' then id1||'v_' else id end), to_number(substr(id,instr(id, 'v') + 2)), xh
	</select>
	<select id="createWhTree" resultType="treenode">
		select distinct jhxdwh id,jhxdwh text,'close' state from plan_zjxd  where jhxdwh is not null and xmid in(select xmid from lxsh_lx where substr(xmid,11,1)=1 or substr(xmid,11,1)=3) order by jhxdwh
	</select>
	
	
	<select id="getZdyBbzd" parameterType="elist" resultType="elist">
		select t2.value, t2.name, t1.co, t2.hight, t2.rowxh, t2.width
	  from (select substr1 value, count(*) co
	          from zdybbbt
	         where value in
	               (${name}) and ssbb=#{ssbb}
	         group by substr1
	        union all
	        select substr2 value, count(*) co
	          from zdybbbt
	         where value in
	               (${name}) and ssbb=#{ssbb}
	           and substr2 is not null
	         group by substr2
	        union all
	        select substr3 value, count(*) co
	          from zdybbbt
	         where value in
	               (${name}) and ssbb=#{ssbb}
	           and substr3 is not null
	         group by substr3
	        union all
	        select value, count(*) co
	          from zdybbbt
	         where value in
	               (${name}) and ssbb=#{ssbb}
	         group by value) t1,
	       zdybbbt t2
	 where t1.value = t2.value and ssbb=#{ssbb}
	 order by t2.xh
	</select>
	<select id="getGljsjhhzb1" parameterType="string" resultType="elist">
		select '总计' v_0,'十三五计划累计' v_1,
		sum(gsyi)+sum(gser)+sum(ssyier)+sum(zdxm)+sum(zhxm)+sum(dxxm)+sum(zxxm)+sum(yfxxm) v_2,
		sum(gsyi)+sum(gser)+sum(ssyier) v_3,sum(gsyi) v_4,sum(gser) v_5,sum(ssyier) v_6,sum(zdxm) v_7,sum(zhxm) v_8,
		sum(dxxm)+sum(zxxm)+sum(yfxxm) v_9,sum(dxxm) v_10,sum(zxxm) v_11,sum(yfxxm) v_12,
		sum(zdxm)+sum(zhxm)+sum(dxxm) v_13,
		sum(bwq) v_14,sum(bab) v_15,sum(bzh) v_16,sum(swq) v_17,sum(sab) v_18,sum(szh) v_19,
		sum(zysj)+sum(dksj)+sum(zywq)+sum(zyab)+sum(zyzh)+sum(dkwq)+sum(dkab)+sum(dkzh)+sum(zylm)+sum(zysh)+sum(dxrys)+sum(zxrys)+sum(yfxrys)+sum(dxdk)+sum(zxdk)+sum(yfxdk) v_20,
		sum(zysj) v_21,sum(dksj) v_22,sum(zywq)+sum(zyab)+sum(zyzh) v_23,sum(zywq) v_24,sum(zyab) v_25,sum(zyzh) v_26,
		sum(dkwq)+sum(dkab)+sum(dkzh) v_27,sum(dkwq) v_28,sum(dkab) v_29,sum(dkzh) v_30,
		sum(zylm)+sum(zysh)+sum(dxrys)+sum(zxrys)+sum(yfxrys)+sum(dxdk)+sum(zxdk)+sum(yfxdk) v_31,
		sum(zylm) v_32,sum(zysh) v_33,sum(dxrys)+sum(zxrys)+sum(yfxrys) v_34,
		sum(dxrys) v_35,sum(zxrys) v_36,sum(yfxrys) v_37,sum(dxdk)+sum(zxdk)+sum(yfxdk) v_38,
		sum(dxdk) v_39,sum(zxdk) v_40,sum(yfxdk) v_41,sum(dfzc) v_42,'1' nf
		from gljsjhhzb 
		where xzqh != '00' and xzqh !='360000'
		union all
		select '总计' v_0,xdnf v_1,
		sum(gsyi)+sum(gser)+sum(ssyier)+sum(zdxm)+sum(zhxm)+sum(dxxm)+sum(zxxm)+sum(yfxxm) v_2,
		sum(gsyi)+sum(gser)+sum(ssyier) v_3,sum(gsyi) v_4,sum(gser) v_5,sum(ssyier) v_6,sum(zdxm) v_7,sum(zhxm) v_8,
		sum(dxxm)+sum(zxxm)+sum(yfxxm) v_9,sum(dxxm) v_10,sum(zxxm) v_11,sum(yfxxm) v_12,
		sum(zdxm)+sum(zhxm)+sum(dxxm) v_13,
		sum(bwq) v_14,sum(bab) v_15,sum(bzh) v_16,sum(swq) v_17,sum(sab) v_18,sum(szh) v_19,
		sum(zysj)+sum(dksj)+sum(zywq)+sum(zyab)+sum(zyzh)+sum(dkwq)+sum(dkab)+sum(dkzh)+sum(zylm)+sum(zysh)+sum(dxrys)+sum(zxrys)+sum(yfxrys)+sum(dxdk)+sum(zxdk)+sum(yfxdk) v_20,
		sum(zysj) v_21,sum(dksj) v_22,sum(zywq)+sum(zyab)+sum(zyzh) v_23,sum(zywq) v_24,sum(zyab) v_25,sum(zyzh) v_26,
		sum(dkwq)+sum(dkab)+sum(dkzh) v_27,sum(dkwq) v_28,sum(dkab) v_29,sum(dkzh) v_30,
		sum(zylm)+sum(zysh)+sum(dxrys)+sum(zxrys)+sum(yfxrys)+sum(dxdk)+sum(zxdk)+sum(yfxdk) v_31,
		sum(zylm) v_32,sum(zysh) v_33,sum(dxrys)+sum(zxrys)+sum(yfxrys) v_34,
		sum(dxrys) v_35,sum(zxrys) v_36,sum(yfxrys) v_37,sum(dxdk)+sum(zxdk)+sum(yfxdk) v_38,
		sum(dxdk) v_39,sum(zxdk) v_40,sum(yfxdk) v_41,sum(dfzc) v_42,xdnf nf
		from gljsjhhzb 
		where xzqh != '00' and xzqh !='360000'
		group by xdnf order by nf
	</select>
	<select id="getGljsjhhzb2" parameterType="string" resultType="elist">
	select xzqh,(select name from xtgl_xzqh where id=xzqh) v_0,'十三五计划累计' v_1,
	sum(gsyi)+sum(gser)+sum(ssyier)+sum(zdxm)+sum(zhxm)+sum(dxxm)+sum(zxxm)+sum(yfxxm) v_2,
	sum(gsyi)+sum(gser)+sum(ssyier) v_3,sum(gsyi) v_4,sum(gser) v_5,sum(ssyier) v_6,sum(zdxm) v_7,sum(zhxm) v_8,
	sum(dxxm)+sum(zxxm)+sum(yfxxm) v_9,sum(dxxm) v_10,sum(zxxm) v_11,sum(yfxxm) v_12,
	sum(zdxm)+sum(zhxm)+sum(dxxm) v_13,
	sum(bwq) v_14,sum(bab) v_15,sum(bzh) v_16,sum(swq) v_17,sum(sab) v_18,sum(szh) v_19,
	sum(zysj)+sum(dksj)+sum(zywq)+sum(zyab)+sum(zyzh)+sum(dkwq)+sum(dkab)+sum(dkzh)+sum(zylm)+sum(zysh)+sum(dxrys)+sum(zxrys)+sum(yfxrys)+sum(dxdk)+sum(zxdk)+sum(yfxdk) v_20,
	sum(zysj) v_21,sum(dksj) v_22,sum(zywq)+sum(zyab)+sum(zyzh) v_23,sum(zywq) v_24,sum(zyab) v_25,sum(zyzh) v_26,
	sum(dkwq)+sum(dkab)+sum(dkzh) v_27,sum(dkwq) v_28,sum(dkab) v_29,sum(dkzh) v_30,
	sum(zylm)+sum(zysh)+sum(dxrys)+sum(zxrys)+sum(yfxrys)+sum(dxdk)+sum(zxdk)+sum(yfxdk) v_31,
	sum(zylm) v_32,sum(zysh) v_33,sum(dxrys)+sum(zxrys)+sum(yfxrys) v_34,
	sum(dxrys) v_35,sum(zxrys) v_36,sum(yfxrys) v_37,sum(dxdk)+sum(zxdk)+sum(yfxdk) v_38,
	sum(dxdk) v_39,sum(zxdk) v_40,sum(yfxdk) v_41,sum(dfzc) v_42
	from gljsjhhzb 
	where xzqh != '00' and xzqh !='360000'
	group by xzqh order by xzqh
	</select>
	<select id="getGljsjhhzb3" parameterType="string" resultType="elist">
	select xzqh,(select name from xtgl_xzqh where id=xzqh) v_0,xdnf v_1,
	sum(gsyi)+sum(gser)+sum(ssyier)+sum(zdxm)+sum(zhxm)+sum(dxxm)+sum(zxxm)+sum(yfxxm) v_2,
	sum(gsyi)+sum(gser)+sum(ssyier) v_3,sum(gsyi) v_4,sum(gser) v_5,sum(ssyier) v_6,sum(zdxm) v_7,sum(zhxm) v_8,
	sum(dxxm)+sum(zxxm)+sum(yfxxm) v_9,sum(dxxm) v_10,sum(zxxm) v_11,sum(yfxxm) v_12,
	sum(zdxm)+sum(zhxm)+sum(dxxm) v_13,
	sum(bwq) v_14,sum(bab) v_15,sum(bzh) v_16,sum(swq) v_17,sum(sab) v_18,sum(szh) v_19,
	sum(zysj)+sum(dksj)+sum(zywq)+sum(zyab)+sum(zyzh)+sum(dkwq)+sum(dkab)+sum(dkzh)+sum(zylm)+sum(zysh)+sum(dxrys)+sum(zxrys)+sum(yfxrys)+sum(dxdk)+sum(zxdk)+sum(yfxdk) v_20,
	sum(zysj) v_21,sum(dksj) v_22,sum(zywq)+sum(zyab)+sum(zyzh) v_23,sum(zywq) v_24,sum(zyab) v_25,sum(zyzh) v_26,
	sum(dkwq)+sum(dkab)+sum(dkzh) v_27,sum(dkwq) v_28,sum(dkab) v_29,sum(dkzh) v_30,
	sum(zylm)+sum(zysh)+sum(dxrys)+sum(zxrys)+sum(yfxrys)+sum(dxdk)+sum(zxdk)+sum(yfxdk) v_31,
	sum(zylm) v_32,sum(zysh) v_33,sum(dxrys)+sum(zxrys)+sum(yfxrys) v_34,
	sum(dxrys) v_35,sum(zxrys) v_36,sum(yfxrys) v_37,sum(dxdk)+sum(zxdk)+sum(yfxdk) v_38,
	sum(dxdk) v_39,sum(zxdk) v_40,sum(yfxdk) v_41,sum(dfzc) v_42
	from gljsjhhzb 
	where xzqh != '00' and xzqh !='360000'
	group by xzqh,xdnf order by xzqh,v_1
	</select>
	
</mapper>