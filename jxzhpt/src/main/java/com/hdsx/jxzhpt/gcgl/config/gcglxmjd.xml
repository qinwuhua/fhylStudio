<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.gcglxmjd">
	<select id="selectYbByxmbm" parameterType="gcglxmjd" resultType="gcglxmjd">
	select * from (
		select m.*,rownum rn from (
			select * from gcgl_xmjd where 1=1
			<if test="xmbm != null and  xmbm != ''">
				and xmbm=#{xmbm}
			</if>
			<if test="sbzt != null and  sbzt != ''">
				and sbzt=#{sbzt}
			</if>
			<if test="shzt != null and  shzt != ''">
				and shzt=#{shzt}
			</if>
			order by to_number(substr(ybyf,0,4))desc,to_number(replace(ybyf,'-','')) desc
		)  m
			where <![CDATA[rownum<=(#{page} * #{rows})]]>
		) 
			where RN>((#{page} - 1) * #{rows})
	</select>
	<select id="selectYbByxmbmCount" parameterType="gcglxmjd" resultType="int">
		select count(*) from (
			select * from gcgl_xmjd where 1=1
			<if test="xmbm != null and  xmbm != ''">
				and xmbm=#{xmbm}
			</if>
			<if test="sbzt != null and  sbzt != ''">
				and sbzt=#{sbzt}
			</if>
			<if test="shzt != null and  shzt != ''">
				and shzt=#{shzt}
			</if>
		)  m
			
	</select>
	<select id="getbyzjdw" parameterType="gcglxmjd" resultType="gcglxmjd">
		select sum(nvl(t.cgsdwzj,0)) dwcgs,sum(nvl(gz,0)) dwgz,sum(nvl(sz,0)) dwsz,sum(nvl(zq,0)) dwzq,sum(nvl(dk,0)) dwdk,sum(nvl(jl,0)) dwjl,sum(nvl(qt,0)) dwqt,sum(nvl(dfzc,0)) dwdfzc,sum(nvl(yhdk,0)) dwyhdk,sum(nvl(rys,0)) dwrys from gcgl_cgs t
		where jhid=#{xmbm} and tbyf=#{ybyf}
	</select>
	<insert id="insertYb" parameterType="gcglxmjd">
		insert into GCGL_XMJD
		<trim prefix="(" suffix=")" suffixOverrides="," >
		id,
		<if test="xmbm != null" >XMBM,</if>
		<if test="zfcgs != null" >ZFCGS,</if>
		<if test="zfgz != null" >ZFGZ,</if>
		<if test="zfsz != null" >ZFSZ,</if>
		<if test="zfzq != null" >ZFZQ,</if>
		<if test="zfdk != null" >ZFDK,</if>
		<if test="zfjl != null" >ZFJL,</if>
		<if test="zfqt != null" >ZFQT,</if>
		<if test="zfdfzc != null" >ZFDFZC,</if>
		<if test="zfyhdk != null" >ZFYHDK,</if>
		<if test="zfrys != null" >ZFRYS,</if>
		<if test="wccgs != null" >WCCGS,</if>
		<if test="wcgz != null" >WCGZ,</if>
		<if test="wcsz != null" >WCSZ,</if>
		<if test="wczq != null" >WCZQ,</if>
		<if test="wcdk != null" >WCDK,</if>
		<if test="wcjl != null" >WCJL,</if>
		<if test="wcqt != null" >WCQT,</if>
		<if test="wcdfzc != null" >WCDFZC,</if>
		<if test="wcyhdk != null" >WCYHDK,</if>
		<if test="wcrys != null" >WCRYS,</if>
		<if test="yilc != null" >YILC,</if>
		<if test="erlc != null" >ERLC,</if>
		<if test="sanlc != null" >SANLC,</if>
		<if test="silc != null" >SILC,</if>
		<if test="lq != null" >LQ,</if>
		<if test="sn != null" >SN,</if>
		<if test="bndsslc != null" >BNDSSLC,</if>
		<if test="ssdctc != null" >SSDCTC,</if>
		<if test="wwcgcl != null" >WWCGCL,</if>
		<if test="qksm != null" >QKSM,</if>
		<if test="tbr != null" >TBR,</if>
		<if test="tbsj != null" >TBSJ,</if>
		<if test="ybyf != null" >YBYF,</if>
		<if test="sbzt != null" >SBZT,</if>
		<if test="shzt != null" >SHZT,</if>
		<if test="shyj != null" >SHYJ,</if>
		<if test="zgshzt != null" >ZGSHZT,</if>
		<if test="zgshyj != null" >ZGSHYJ,</if>
		<if test="thyy != null" >THYY,</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides="," >
		sys_guid(),
		<if test="xmbm != null" >#{xmbm},</if>
		<if test="zfcgs != null" >#{zfcgs},</if>
		<if test="zfgz != null" >#{zfgz},</if>
		<if test="zfsz != null" >#{zfsz},</if>
		<if test="zfzq != null" >#{zfzq},</if>
		<if test="zfdk != null" >#{zfdk},</if>
		<if test="zfjl != null" >#{zfjl},</if>
		<if test="zfqt != null" >#{zfqt},</if>
		<if test="zfdfzc != null" >#{zfdfzc},</if>
		<if test="zfyhdk != null" >#{zfyhdk},</if>
		<if test="zfrys != null" >#{zfrys},</if>
		<if test="wccgs != null" >#{wccgs},</if>
		<if test="wcgz != null" >#{wcgz},</if>
		<if test="wcsz != null" >#{wcsz},</if>
		<if test="wczq != null" >#{wczq},</if>
		<if test="wcdk != null" >#{wcdk},</if>
		<if test="wcjl != null" >#{wcjl},</if>
		<if test="wcqt != null" >#{wcqt},</if>
		<if test="wcdfzc != null" >#{wcdfzc},</if>
		<if test="wcyhdk != null" >#{wcyhdk},</if>
		<if test="wcrys != null" >#{wcrys},</if>
		<if test="yilc != null" >#{yilc},</if>
		<if test="erlc != null" >#{erlc},</if>
		<if test="sanlc != null" >#{sanlc},</if>
		<if test="silc != null" >#{silc},</if>
		<if test="lq != null" >#{lq},</if>
		<if test="sn != null" >#{sn},</if>
		<if test="bndsslc != null" >#{bndsslc},</if>
		<if test="ssdctc != null" >#{ssdctc},</if>
		<if test="wwcgcl != null" >#{wwcgcl},</if>
		<if test="qksm != null" >#{qksm},</if>
		<if test="tbr != null" >#{tbr},</if>
		<if test="tbsj != null" >#{tbsj},</if>
		<if test="ybyf != null" >#{ybyf},</if>
		<if test="sbzt != null" >#{sbzt},</if>
		<if test="shzt != null" >#{shzt},</if>
		<if test="shyj != null" >#{shyj},</if>
		<if test="zgshzt != null" >#{zgshzt},</if>
		<if test="zgshyj != null" >#{zgshyj},</if>
		<if test="thyy != null" >#{thyy},</if>
		</trim>
	</insert>
	<update id="updateYb" parameterType="gcglxmjd">
		update GCGL_XMJD
    <set >
      <if test="zfcgs != null" >
        ZFCGS = #{zfcgs},
      </if>
      <if test="zfgz != null" >
        ZFGZ = #{zfgz},
      </if>
      <if test="zfsz != null" >
        ZFSZ = #{zfsz},
      </if>
      <if test="zfzq != null" >
        ZFZQ = #{zfzq},
      </if>
      <if test="zfdk != null" >
        ZFDK = #{zfdk},
      </if>
      <if test="zfjl != null" >
        ZFJL = #{zfjl},
      </if>
      <if test="zfqt != null" >
        ZFQT = #{zfqt},
      </if>
      <if test="zfdfzc != null" >
        ZFDFZC = #{zfdfzc},
      </if>
      <if test="zfyhdk != null" >
        ZFYHDK = #{zfyhdk},
      </if>
      <if test="zfrys != null" >
        ZFRYS = #{zfrys},
      </if>
      <if test="wccgs != null" >
        WCCGS = #{wccgs},
      </if>
      <if test="wcgz != null" >
        WCGZ = #{wcgz},
      </if>
      <if test="wcsz != null" >
        WCSZ = #{wcsz},
      </if>
      <if test="wczq != null" >
        WCZQ = #{wczq},
      </if>
      <if test="wcdk != null" >
        WCDK = #{wcdk},
      </if>
      <if test="wcjl != null" >
        WCJL = #{wcjl},
      </if>
      <if test="wcqt != null" >
        WCQT = #{wcqt},
      </if>
      <if test="wcdfzc != null" >
        WCDFZC = #{wcdfzc},
      </if>
      <if test="wcyhdk != null" >
        WCYHDK = #{wcyhdk},
      </if>
      <if test="wcrys != null" >
        WCRYS = #{wcrys},
      </if>
      <if test="yilc != null" >
        YILC = #{yilc},
      </if>
      <if test="erlc != null" >
        ERLC = #{erlc},
      </if>
      <if test="sanlc != null" >
        SANLC = #{sanlc},
      </if>
      <if test="silc != null" >
        SILC = #{silc},
      </if>
      <if test="lq != null" >
        LQ = #{lq},
      </if>
      <if test="sn != null" >
        SN = #{sn},
      </if>
      <if test="bndsslc != null" >
        BNDSSLC = #{bndsslc},
      </if>
      <if test="ssdctc != null" >
        SSDCTC = #{ssdctc},
      </if>
      <if test="wwcgcl != null" >
        WWCGCL = #{wwcgcl},
      </if>
      <if test="qksm != null" >
        QKSM = #{qksm},
      </if>
      <if test="tbr != null" >
        TBR = #{tbr},
      </if>
      <if test="tbsj != null" >
        TBSJ = #{tbsj},
      </if>
      <if test="ybyf != null" >
        YBYF = #{ybyf},
      </if>
      <if test="sbzt != null" >
        SBZT = #{sbzt},
      </if>
      <if test="shzt != null" >
        SHZT = #{shzt},
      </if>
      <if test="shyj != null" >
        SHYJ = #{shyj},
      </if>
      <if test="zgshzt != null" >
        ZGSHZT = #{zgshzt},
      </if>
      <if test="zgshyj != null" >
        ZGSHYJ = #{zgshyj},
      </if>
      <if test="thyy != null" >
        THYY = #{thyy},
      </if>
    </set>
    where id=#{id} and xmbm=#{xmbm}
	</update>
	<delete id="deleteYb" parameterType="gcglxmjd">
		delete from gcgl_xmjd where id=#{id}
	</delete>
	<update id="updateYbzt" parameterType="gcglxmjd">
		update GCGL_XMJD
    <set >
      <if test="sbzt != null" >
        SBZT = #{sbzt},
      </if>
      <if test="shzt != null" >
        SHZT = #{shzt},
      </if>
      <if test="shyj != null" >
        SHYJ = #{shyj},
      </if>
      <if test="zgshzt != null" >
        ZGSHZT = #{zgshzt},
      </if>
      <if test="zgshyj != null" >
        ZGSHYJ = #{zgshyj},
      </if>
      <if test="thyy != null" >
        THYY = #{thyy},
      </if>
    </set>
    where 1=1 ${id} and xmbm=#{xmbm}
	</update>
</mapper>