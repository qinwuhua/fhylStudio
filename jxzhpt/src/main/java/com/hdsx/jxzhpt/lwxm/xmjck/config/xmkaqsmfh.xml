<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.xmkaqsmfh">
	<select id="selectXmkaqsmfhXMK" parameterType="xmkaqsmfh" resultType="xmkaqsmfh">
		select * from (
	 		select rownum num ,t.*,decode(sbthcd,'7','已上报',#{sbthcd},'未上报',sbzt) sbzt2 from XMK_AQSMFH t 
	 		left join (select count(*) jhsl,a4.id  from plan_af a1 left join sck_aqsmfh a2 on a1.sckid=a2.id left join sck_aqsmfh_ld a3 on a2.xmbm=a3.xmbm left join xmk_aqsmfh a4 on a3.xmkid=a4.id group by a4.id) t1
	 		on t.id=t1.id 
	 		where 1=1 
	 			and  to_number(sbthcd) &lt;=to_number(#{sbthcd}) 
	 		<if test="unitcode!='' and unitcode!= null ">
				${unitcode}
			</if>
			<if test="distcode!='' and distcode!= null ">
				${distcode}
			</if>
	 		<if test="roadname!='' and roadname!= null ">
	 			and roadname like '%'||(#{roadname})||'%'
	 		</if>
	 		<if test="jhnf!='' and jhnf!= null ">
	 			and jhnf like '%'||(#{jhnf})||'%'
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			and decode(sbthcd,'7','已上报',#{sbthcd},'未上报',sbzt) like '%'||(#{sbzt})||'%'
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 				${jsdj}
 			</if> 
 			<if test="gldj!='' and gldj!= null ">
 				${gldj}
 			</if> 
	 		<if test="roadcode!='' and roadcode!= null ">
	 			and roadcode like '%'||(#{roadcode})||'%'
	 		</if>
	 		<if test="throadcode!='' and throadcode!= null ">
	 			and throadcode like '%'||(#{throadcode})||'%'
	 		</if>
	 		<if test="throadname!='' and throadname!= null ">
	 			and roadname like '%'||(#{throadname})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			${tsdq}
	 		</if>
	 		<if test="xmklx !='' and xmklx != null ">
 			and xmklx like '%'||(#{xmklx})||'%'
 		</if>
	 		<if test="bzls!='' and bzls!= null ">
 			and decode(t1.jhsl,null,'无','有') like #{bzls}||'%'
 		</if>
	 			) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows} 
	 			order by decode(sbthcd,#{sbthcd},'未上报',sbzt) desc 
	</select>
	<select id="selectXmkaqsmfhXMKCount" parameterType="xmkaqsmfh" resultType="int">
	 		select count(*) from XMK_AQSMFH t 
	 		left join (select count(*) jhsl,a4.id  from plan_af a1 left join sck_aqsmfh a2 on a1.sckid=a2.id left join sck_aqsmfh_ld a3 on a2.xmbm=a3.xmbm left join xmk_aqsmfh a4 on a3.xmkid=a4.id group by a4.id) t1
	 		on t.id=t1.id
	 		where 1=1 
	 			and  to_number(sbthcd) &lt;=to_number(#{sbthcd}) 
	 		<if test="unitcode!='' and unitcode!= null ">
				${unitcode}
			</if>
			<if test="distcode!='' and distcode!= null ">
				${distcode}
			</if>
	 		<if test="roadname!='' and roadname!= null ">
	 			and roadname like '%'||(#{roadname})||'%'
	 		</if>
	 		<if test="jhnf!='' and jhnf!= null ">
	 			and jhnf like '%'||(#{jhnf})||'%'
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			and decode(sbthcd,'7','已上报',#{sbthcd},'未上报',sbzt) like '%'||(#{sbzt})||'%'
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 				${jsdj}
 			</if> 
 			<if test="gldj!='' and gldj!= null ">
 				${gldj}
 			</if> 
	 		<if test="roadcode!='' and roadcode!= null ">
	 			and roadcode like '%'||(#{roadcode})||'%'
	 		</if>
	 		<if test="throadcode!='' and throadcode!= null ">
	 			and throadcode like '%'||(#{throadcode})||'%'
	 		</if>
	 		<if test="throadname!='' and throadname!= null ">
	 			and roadname like '%'||(#{throadname})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			${tsdq}
	 		</if>
 			<if test="bzls!='' and bzls!= null ">
	 			and decode(t1.jhsl,null,'无','有') like #{bzls}||'%'
	 		</if>
	 		<if test="xmklx !='' and xmklx != null ">
 			and xmklx like '%'||(#{xmklx})||'%'
 		</if>
	</select>
	<select id="loadXmkaqsmfhXMKCount" parameterType="xmkaqsmfh" resultType="xmkaqsmfh">
	 		select count(*) sbthcd,decode(sum(zlc),null,0,sum(zlc)) zlc from XMK_AQSMFH t 
	 		left join (select count(*) jhsl,a4.id  from plan_af a1 left join sck_aqsmfh a2 on a1.sckid=a2.id left join sck_aqsmfh_ld a3 on a2.xmbm=a3.xmbm left join xmk_aqsmfh a4 on a3.xmkid=a4.id group by a4.id) t1
	 		on t.id=t1.id
	 		where 1=1 
	 			and  to_number(sbthcd) &lt;=to_number(#{sbthcd}) 
	 		<if test="unitcode!='' and unitcode!= null ">
				${unitcode}
			</if>
			<if test="distcode!='' and distcode!= null ">
				${distcode}
			</if>
	 		<if test="roadname!='' and roadname!= null ">
	 			and roadname like '%'||(#{roadname})||'%'
	 		</if>
	 		<if test="jhnf!='' and jhnf!= null ">
	 			and jhnf like '%'||(#{jhnf})||'%'
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			and decode(sbthcd,'7','已上报',#{sbthcd},'未上报',sbzt) like '%'||(#{sbzt})||'%'
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 				${jsdj}
 			</if> 
 			<if test="gldj!='' and gldj!= null ">
 				${gldj}
 			</if> 
	 		<if test="roadcode!='' and roadcode!= null ">
	 			and roadcode like '%'||(#{roadcode})||'%'
	 		</if>
	 		<if test="throadcode!='' and throadcode!= null ">
	 			and throadcode like '%'||(#{throadcode})||'%'
	 		</if>
	 		<if test="throadname!='' and throadname!= null ">
	 			and roadname like '%'||(#{throadname})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			${tsdq}
	 		</if>
	 		<if test="bzls!='' and bzls!= null ">
 			and decode(t1.jhsl,null,'无','有') like #{bzls}||'%'
 		</if>
 		<if test="xmklx !='' and xmklx != null ">
 			and xmklx like '%'||(#{xmklx})||'%'
 		</if>
	</select>
	
	<select id="selectXmkaqsmfhsh" parameterType="xmkaqsmfh" resultType="xmkaqsmfh">
		select * from (
	 		select rownum num ,t.*,decode(sbthcd,'7','已上报',#{sbthcd},'未上报',sbzt) sbzt2 from XMK_AQSMFH t 
	 		left join (select count(*) jhsl,a4.id  from plan_af a1 left join sck_aqsmfh a2 on a1.sckid=a2.id left join sck_aqsmfh_ld a3 on a2.xmbm=a3.xmbm left join xmk_aqsmfh a4 on a3.xmkid=a4.id group by a4.id) t1
	 		on t.id=t1.id
	 		where 1=1 
	 			and  (sbthcd &lt;=7 or zsyj is not null)
	 		<if test="unitcode!='' and unitcode!= null ">
				${unitcode}
			</if>
			<if test="distcode!='' and distcode!= null ">
				${distcode}
			</if>
	 		<if test="lxmc!='' and lxmc!= null ">
	 			and roadname like '%'||(#{lxmc})||'%'
	 		</if>
	 		<if test="jhnf!='' and jhnf!= null ">
	 			and jhnf like '%'||(#{jhnf})||'%'
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			
				<if test="sbzt == '未审核'">
 					and (zszt like '%'||(#{sbzt})||'%' or zszt is null) and sbthcd=7
				</if>
				<if test="sbzt == '已审核'">
	 					and (decode(zszt,null,'未审核',zszt) like '%'||(#{sbzt})||'%' or  (zsyj is not null and sbthcd != 7))
				</if>
				<if test="sbzt == '审核不同意'">
	 					and zsyj is not null and sbthcd != 7
				</if>
				<if test="sbzt == '审核同意'">
	 					and zsyj = '同意' and sbthcd = 7 and (decode(zszt,null,'未审核',zszt) like '已审核')
				</if>
				
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 				${jsdj}
 			</if> 
 			<if test="gldj!='' and gldj!= null ">
 				${gldj}
 			</if> 
	 		<if test="lxbm!='' and lxbm!= null ">
	 			and roadcode like '%'||(#{lxbm})||'%'
	 		</if>
	 		<if test="ylxbm!='' and ylxbm!= null ">
	 			and ylxbm like '%'||(#{ylxbm})||'%'
	 		</if>
	 		<if test="throadcode!='' and throadcode!= null ">
	 			and throadcode like '%'||(#{throadcode})||'%'
	 		</if>
	 		<if test="throadname!='' and throadname!= null ">
	 			and roadname like '%'||(#{throadname})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			${tsdq}
	 		</if>
	 		<if test="bzls!='' and bzls!= null ">
 			and decode(t1.jhsl,null,'无','有') like #{bzls}||'%'
 		</if>
 		<if test="xmklx !='' and xmklx != null ">
 			and xmklx like '%'||(#{xmklx})||'%'
 		</if>
	 			) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows} 
	 			order by decode(sbthcd,#{sbthcd},'未上报',sbzt) desc 
	</select>
	<select id="selectXmkaqsmfhshCount" parameterType="xmkaqsmfh" resultType="int">
	 		select count(*) from XMK_AQSMFH t 
	 		left join (select count(*) jhsl,a4.id  from plan_af a1 left join sck_aqsmfh a2 on a1.sckid=a2.id left join sck_aqsmfh_ld a3 on a2.xmbm=a3.xmbm left join xmk_aqsmfh a4 on a3.xmkid=a4.id group by a4.id) t1
	 		on t.id=t1.id
	 		where 1=1 
	 			and  (sbthcd &lt;=7 or zsyj is not null)
	 		<if test="unitcode!='' and unitcode!= null ">
				${unitcode}
			</if>
			<if test="distcode!='' and distcode!= null ">
				${distcode}
			</if>
	 		<if test="roadname!='' and roadname!= null ">
	 			and roadname like '%'||(#{roadname})||'%'
	 		</if>
	 		<if test="jhnf!='' and jhnf!= null ">
	 			and jhnf like '%'||(#{jhnf})||'%'
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			<!-- <if test="sbzt == '未审核'">
 					and (zszt like '%'||(#{sbzt})||'%' or zszt is null) and sbthcd=7
				</if>
				<if test="sbzt == '已审核'">
 					and decode(zszt,null,'未审核',zszt) like '%'||(#{zszt})||'%' or (zsyj is not null and sbthcd != 7)
				</if> -->
				<if test="sbzt == '未审核'">
 					and (zszt like '%'||(#{sbzt})||'%' or zszt is null) and sbthcd=7
				</if>
				<if test="sbzt == '已审核'">
	 					and (decode(zszt,null,'未审核',zszt) like '%'||(#{sbzt})||'%' or  (zsyj is not null and sbthcd != 7))
				</if>
				<if test="sbzt == '审核不同意'">
	 					and zsyj is not null and sbthcd != 7
				</if>
				<if test="sbzt == '审核同意'">
	 					and zsyj = '同意' and sbthcd = 7 and (decode(zszt,null,'未审核',zszt) like '已审核')
				</if>
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 				${jsdj}
 			</if> 
 			<if test="gldj!='' and gldj!= null ">
 				${gldj}
 			</if> 
	 		<if test="roadcode!='' and roadcode!= null ">
	 			and roadcode like '%'||(#{roadcode})||'%'
	 		</if>
	 		<if test="throadcode!='' and throadcode!= null ">
	 			and throadcode like '%'||(#{throadcode})||'%'
	 		</if>
	 		<if test="throadname!='' and throadname!= null ">
	 			and roadname like '%'||(#{throadname})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			${tsdq}
	 		</if>
	 		<if test="xmklx !='' and xmklx != null ">
 			and xmklx like '%'||(#{xmklx})||'%'
 		</if>
 		    <if test="ylxbm!='' and ylxbm!= null ">
	 			and ylxbm like '%'||(#{ylxbm})||'%'
	 		</if>
	 			<if test="bzls!='' and bzls!= null ">
 			and decode(t1.jhsl,null,'无','有') like #{bzls}||'%'
 		</if>
	</select>
	<select id="loadXmkaqsmfhshCount" parameterType="xmkaqsmfh" resultType="xmkaqsmfh">
	 		select count(*) sbthcd,decode(sum(zlc),null,0,sum(zlc)) zlc from XMK_AQSMFH t 
	 		left join (select count(*) jhsl,a4.id  from plan_af a1 left join sck_aqsmfh a2 on a1.sckid=a2.id left join sck_aqsmfh_ld a3 on a2.xmbm=a3.xmbm left join xmk_aqsmfh a4 on a3.xmkid=a4.id group by a4.id) t1
	 		on t.id=t1.id
	 		where 1=1 
	 			and  (sbthcd &lt;=7 or zsyj is not null)
	 		<if test="unitcode!='' and unitcode!= null ">
				${unitcode}
			</if>
			<if test="distcode!='' and distcode!= null ">
				${distcode}
			</if>
	 		<if test="lxmc!='' and lxmc!= null ">
	 			and roadname like '%'||(#{lxmc})||'%'
	 		</if>
	 		<if test="jhnf!='' and jhnf!= null ">
	 			and jhnf like '%'||(#{jhnf})||'%'
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			<!-- <if test="sbzt == '未审核'">
 					and (zszt like '%'||(#{sbzt})||'%' or zszt is null) and sbthcd=7
				</if>
				<if test="sbzt == '已审核'">
 					and decode(zszt,null,'未审核',zszt) like '%'||(#{sbzt})||'%' or (zsyj is not null and sbthcd != 7)
				</if> -->
				<if test="sbzt == '未审核'">
 					and (zszt like '%'||(#{sbzt})||'%' or zszt is null) and sbthcd=7
				</if>
				<if test="sbzt == '已审核'">
	 					and (decode(zszt,null,'未审核',zszt) like '%'||(#{sbzt})||'%' or  (zsyj is not null and sbthcd != 7))
				</if>
				<if test="sbzt == '审核不同意'">
	 					and zsyj is not null and sbthcd != 7
				</if>
				<if test="sbzt == '审核同意'">
	 					and zsyj = '同意' and sbthcd = 7 and (decode(zszt,null,'未审核',zszt) like '已审核')
				</if>
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 				${jsdj}
 			</if> 
 			<if test="gldj!='' and gldj!= null ">
 				${gldj}
 			</if> 
	 		<if test="lxbm!='' and lxbm!= null ">
	 			and roadcode like '%'||(#{lxbm})||'%'
	 		</if>
	 		<if test="ylxbm!='' and ylxbm!= null ">
	 			and ylxbm like '%'||(#{ylxbm})||'%'
	 		</if>
	 		<if test="throadcode!='' and throadcode!= null ">
	 			and throadcode like '%'||(#{throadcode})||'%'
	 		</if>
	 		<if test="throadname!='' and throadname!= null ">
	 			and roadname like '%'||(#{throadname})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			${tsdq}
	 		</if>
	 		<if test="bzls!='' and bzls!= null ">
 			and decode(t1.jhsl,null,'无','有') like #{bzls}||'%'
 		</if>
 		<if test="xmklx !='' and xmklx != null ">
 			and xmklx like '%'||(#{xmklx})||'%'
 		</if>
	</select>
	<update id="afXmkCs" parameterType="xmkaqsmfh">
 			update XMK_AQSMFH set sbzt=#{sbzt},sbthcd=#{sbthcd},cszt=#{cszt},csyj=#{csyj} where id =#{id} 
	</update>
	<update id="afXmkZs" parameterType="xmkaqsmfh" >
			update XMK_AQSMFH set zszt=#{zszt},sbthcd=#{sbthcd},cszt=#{cszt},zsyj=#{zsyj} where id =#{id} 
	</update>
 	<update id="afXmkZsbeatch" parameterType="hashmap" >
			update XMK_AQSMFH set zszt=#{zszt},sbthcd=#{sbthcd},cszt=#{cszt},zsyj=#{zsyj} where id =#{id} 
	</update>
 		
	
	<select id="smfhGpsroad" parameterType="hashmap" resultType="xmkaqsmfh">
	
		select roadcode,roadname,min(roadstart) roadstart,max(roadends)
		roadend,substr(roadcode,length(roadcode)-5,6) distcode, 
		(select name from xtgl_xzqh where id=substr(roadcode,length(roadcode)-5,6))
		dist,F044 unitcode,F045 unit,
		decode(max(substr(F026, 0, 4)), null, max(substr(F025,0,4)), max(substr(F026, 0, 4)))
		xjgjnd,F114 jsdj,decode(substr(roadcode,1,1),'G','国道','S','省道','X','县道','Y','乡道') gldj from GPSROAD
		where substr(roadcode,1,1) in('G','S','X','Y') and F048='1' and roadcode like #{roadcode} ||'%' 
		<if test="unitcode!='' and unitcode!= null ">
			and F044 in(select id from xtgl_department where id like '%'||substr(#{unitcode},0,4)||'_'||substr(#{unitcode},6)||'%' or parent like '%'||substr(#{unitcode},0,4)||'_'||substr(#{unitcode},6)||'%') 
		</if>
<!-- 		<if test="xzqhdm!='' and xzqhdm!= null ">
			and substr(roadcode,length(roadcode)-5,6) in(select id from xtgl_xzqh where id=#{xzqhdm} or parent=#{xzqhdm}) 
		</if> -->
 		and<![CDATA[ROWNUM <=50]]>
		group by roadname,roadcode,F114,F044,F045
		order by roadcode,roadstart
		</select>
		
		<insert id="insertAqsmfhxmk" parameterType="xmkaqsmfh" >
	    insert into XMK_AQSMFH
	    <trim prefix="(" suffix=")" suffixOverrides="," >	      
	        ID,
	      <if test="province != null" > PROVINCE,</if>
	      <if test="town != null" >TOWN,</if>
	      <if test="county != null" > COUNTY,</if>
	      <if test="unit != null" >UNIT,</if>
	      <if test="unitcode != null" >
	        UNITCODE,
	      </if>
	      <if test="roadcode != null" >
	        ROADCODE,
	      </if>
	      <if test="jsdj != null" >
	        JSDJ,
	      </if>
	      <if test="fangx != null" >
	        FANGX,
	      </if>
	      <if test="roadstart != null" >
	        ROADSTART,
	      </if>
	      <if test="roadend != null" >
	        ROADEND,
	      </if>
	      <if test="pcsj != null" >
	        PCSJ,
	      </if>
	      <if test="ldfl != null" >
	        LDFL,
	      </if>
	      <if test="jtsgpcf != null" >
	        JTSGPCF,
	      </if>
	      <if test="jtsgfxdj != null" >
	        JTSGFXDJ,
	      </if>
	      <if test="gltjpcf != null" >
	        GLTJPCF,
	      </if>
	      <if test="glfxdj != null" >
	        GLFXDJ,
	      </if>
	      <if test="xbjyqx != null" >
	        XBJYQX,
	      </if>
	      <if test="lxxp != null" >
	        LXXP,
	      </if>
	      <if test="doup != null" >
	        DOUP,
	      </if>
	      <if test="sjbl != null" >
	        SJBL,
	      </if>
	      <if test="lcxy != null" >
	        LCXY,
	      </if>
	      <if test="hjfz != null" >
	        HJFZ,
	      </if>
	      <if test="jckbgf != null" >
	        JCKBGF,
	      </if>
	      <if test="jtl != null" >
	        JTL,
	      </if>
	      <if test="xchbc != null" >
	        XCHBC,
	      </if>
	      <if test="csxsss != null" >
	        CSXSSS,
	      </if>
	      <if test="hul != null" >
	        HUL,
	      </if>
	      <if test="bzbx != null" >
	        BZBX,
	      </if>
	      <if test="jshsxyd != null" >
	        JSHSXYD,
	      </if>
	      <if test="aqssqt != null" >
	        AQSSQT,
	      </if>
	      <if test="tjgc != null" >
	        TJGC,
	      </if>
	      <if test="hjzz != null" >
	        HJZZ,
	      </if>
	      <if test="bzbxcz != null" >
	        BZBXCZ,
	      </if>
	      <if test="jckcz != null" >
	        JCKCZ,
	      </if>
	      <if test="jzhl != null" >
	        JZHL,
	      </if>
	      <if test="jshsxydcz != null" >
	        JSHSXYDCZ,
	      </if>
	      <if test="aqssqtcz != null" >
	        AQSSQTCZ,
	      </if>
	      <if test="tzgs != null" >
	        TZGS,
	      </if>
	      <if test="jhnf != null" >
	        JHNF,
	      </if>
	      <if test="throadcode != null" >
	        THROADCODE,
	      </if>
	      <if test="throadstart != null" >
	        THROADSTART,
	      </if>
	      <if test="throadend != null" >
	        THROADEND,
	      </if>
	      <if test="sgpb != null" >
	        SGPB,
	      </if>
	      <if test="dgjw != null" >
	        DGJW,
	      </if>
	      <if test="lxjw != null" >
	        LXJW,
	      </if>
	      <if test="jtlpbzb != null" >
	        JTLPBZB,
	      </if>
	      <if test="dist != null" >
	        DIST,
	      </if>
	      <if test="distcode != null" >
	        DISTCODE,
	      </if>
	      <if test="sbzt != null" >
	        SBZT,
	      </if>
	      <if test="cszt != null" >
	        CSZT,
	      </if>
	      <if test="zszt != null" >
	        ZSZT,
	      </if>
	      <if test="csyj != null" >
	        CSYJ,
	      </if>
	      <if test="zsyj != null" >
	        ZSYJ,
	      </if>
	      <if test="roadname != null" >
	        ROADNAME,
	      </if>
	      <if test="gldj != null" >
	        GLDJ,
	      </if>
	      <if test="tsdq != null" >
	        TSDQ,
	      </if>
	      <if test="xjgjnd != null" >
	        XJGJND,
	      </if>
	      <if test="zlc != null" >
	        ZLC,
	      </if>
	      <if test="sbthcd != null" >
	        SBTHCD,
	      </if>
	      <if test="yhlc != null" >
	        yhlc,
	      </if>
	      <if test="gpsqd != null" >
	        gpsqd,
	      </if>
	      <if test="gpszd != null" >
	        gpszd,
	      </if>
	      <if test="tbbmbm != null" >
	        tbbmbm,
	      </if>
	      <if test="xuh != null" >
	        xuh,
	      </if>
	      <if test="xmklx != null">xmklx,</if>
	      <if test="lsjl != null">lsjl,</if>
	      <if test="lsxmxx != null">lsxmxx,</if>
	    </trim>
	    <trim prefix="values (" suffix=")" suffixOverrides="," >
			sys_guid(),
			<if test="province != null">
				#{province},
			</if>
			<if test="town != null">
				#{town},
			</if>
			<if test="county != null">
				#{county},
			</if>
			<if test="unit != null">
				#{unit},
			</if>
			<if test="unitcode != null">
				#{unitcode},
			</if>
			<if test="roadcode != null">
				#{roadcode},
			</if>
			<if test="jsdj != null">
				#{jsdj},
			</if>
			<if test="fangx != null">
				#{fangx},
			</if>
			<if test="roadstart != null">
				#{roadstart},
			</if>
			<if test="roadend != null">
				#{roadend},
			</if>
			<if test="pcsj != null">
				#{pcsj},
			</if>
			<if test="ldfl != null">
				#{ldfl},
			</if>
			<if test="jtsgpcf != null">
				#{jtsgpcf},
			</if>
			<if test="jtsgfxdj != null">
				#{jtsgfxdj},
			</if>
			<if test="gltjpcf != null">
				#{gltjpcf},
			</if>
			<if test="glfxdj != null">
				#{glfxdj},
			</if>
			<if test="xbjyqx != null">
				#{xbjyqx},
			</if>
			<if test="lxxp != null">
				#{lxxp},
			</if>
			<if test="doup != null">
				#{doup},
			</if>
			<if test="sjbl != null">
				#{sjbl},
			</if>
			<if test="lcxy != null">
				#{lcxy},
			</if>
			<if test="hjfz != null">
				#{hjfz},
			</if>
			<if test="jckbgf != null">
				#{jckbgf},
			</if>
			<if test="jtl != null">
				#{jtl},
			</if>
			<if test="xchbc != null">
				#{xchbc},
			</if>
			<if test="csxsss != null">
				#{csxsss},
			</if>
			<if test="hul != null">
				#{hul},
			</if>
			<if test="bzbx != null">
				#{bzbx},
			</if>
			<if test="jshsxyd != null">
				#{jshsxyd},
			</if>
			<if test="aqssqt != null">
				#{aqssqt},
			</if>
			<if test="tjgc != null">
				#{tjgc},
			</if>
			<if test="hjzz != null">
				#{hjzz},
			</if>
			<if test="bzbxcz != null">
				#{bzbxcz},
			</if>
			<if test="jckcz != null">
				#{jckcz},
			</if>
			<if test="jzhl != null">
				#{jzhl},
			</if>
			<if test="jshsxydcz != null">
				#{jshsxydcz},
			</if>
			<if test="aqssqtcz != null">
				#{aqssqtcz},
			</if>
			<if test="tzgs != null">
				#{tzgs},
			</if>
			<if test="jhnf != null">
				#{jhnf},
			</if>
			<if test="throadcode != null">
				#{throadcode},
			</if>
			<if test="throadstart != null">
				#{throadstart},
			</if>
			<if test="throadend != null">
				#{throadend},
			</if>
			<if test="sgpb != null">
				#{sgpb},
			</if>
			<if test="dgjw != null">
				#{dgjw},
			</if>
			<if test="lxjw != null">
				#{lxjw},
			</if>
			<if test="jtlpbzb != null">
				#{jtlpbzb},
			</if>
			<if test="dist != null">
				#{dist},
			</if>
			<if test="distcode != null">
				#{distcode},
			</if>
			<if test="sbzt != null">
				#{sbzt},
			</if>
			<if test="cszt != null">
				#{cszt},
			</if>
			<if test="zszt != null">
				#{zszt},
			</if>
			<if test="csyj != null">
				#{csyj},
			</if>
			<if test="zsyj != null">
				#{zsyj},
			</if>
			<if test="roadname != null">
				#{roadname},
			</if>
			<if test="gldj != null">
				#{gldj},
			</if>
			<if test="tsdq != null">
				#{tsdq},
			</if>
			<if test="xjgjnd != null">
				#{xjgjnd},
			</if>
			<if test="zlc != null">
				#{zlc},
			</if>
			<if test="sbthcd != null">
				#{sbthcd},
			</if>
			<if test="yhlc != null">
				#{yhlc},
			</if>
			<if test="gpsqd != null">
				#{gpsqd},
			</if>
			<if test="gpszd != null">
				#{gpszd},
			</if>
			<if test="tbbmbm != null">
				#{tbbmbm},
			</if>
			<if test="xuh != null">
				#{xuh},
			</if>
			<if test="xmklx != null">#{xmklx},</if>
			<if test="lsjl != null">#{lsjl},</if>
	      	<if test="lsxmxx != null">#{lsxmxx},</if>
	    </trim>
	  </insert>
	  <update id="updateAqsmfhxmk" parameterType="xmkaqsmfh">
	  	update XMK_AQSMFH
		    <set >
		      <if test="province != null" >
		        PROVINCE = #{province},
		      </if>
		      <if test="town != null" >
		        TOWN = #{town},
		      </if>
		      <if test="county != null" >
		        COUNTY = #{county},
		      </if>
		      <if test="unit != null" >
		        UNIT = #{unit},
		      </if>
		      <if test="unitcode != null" >
		        UNITCODE = #{unitcode},
		      </if>
		      <if test="roadcode != null" >
		        ROADCODE = #{roadcode},
		      </if>
		      <if test="jsdj != null" >
		        JSDJ = #{jsdj},
		      </if>
		      <if test="fangx != null" >
		        FANGX = #{fangx},
		      </if>
		      <if test="roadstart != null" >
		        ROADSTART = #{roadstart},
		      </if>
		      <if test="roadend != null" >
		        ROADEND = #{roadend},
		      </if>
		      <if test="pcsj != null" >
		        PCSJ = #{pcsj},
		      </if>
		      <if test="ldfl != null" >
		        LDFL = #{ldfl},
		      </if>
		      <if test="jtsgpcf != null" >
		        JTSGPCF = #{jtsgpcf},
		      </if>
		      <if test="jtsgfxdj != null" >
		        JTSGFXDJ = #{jtsgfxdj},
		      </if>
		      <if test="gltjpcf != null" >
		        GLTJPCF = #{gltjpcf},
		      </if>
		      <if test="glfxdj != null" >
		        GLFXDJ = #{glfxdj},
		      </if>
		      <if test="xbjyqx != null" >
		        XBJYQX = #{xbjyqx},
		      </if>
		      <if test="lxxp != null" >
		        LXXP = #{lxxp},
		      </if>
		      <if test="doup != null" >
		        DOUP = #{doup},
		      </if>
		      <if test="sjbl != null" >
		        SJBL = #{sjbl},
		      </if>
		      <if test="lcxy != null" >
		        LCXY = #{lcxy},
		      </if>
		      <if test="hjfz != null" >
		        HJFZ = #{hjfz},
		      </if>
		      <if test="jckbgf != null" >
		        JCKBGF = #{jckbgf},
		      </if>
		      <if test="jtl != null" >
		        JTL = #{jtl},
		      </if>
		      <if test="xchbc != null" >
		        XCHBC = #{xchbc},
		      </if>
		      <if test="csxsss != null" >
		        CSXSSS = #{csxsss},
		      </if>
		      <if test="hul != null" >
		        HUL = #{hul},
		      </if>
		      <if test="bzbx != null" >
		        BZBX = #{bzbx},
		      </if>
		      <if test="jshsxyd != null" >
		        JSHSXYD = #{jshsxyd},
		      </if>
		      <if test="aqssqt != null" >
		        AQSSQT = #{aqssqt},
		      </if>
		      <if test="tjgc != null" >
		        TJGC = #{tjgc},
		      </if>
		      <if test="hjzz != null" >
		        HJZZ = #{hjzz},
		      </if>
		      <if test="bzbxcz != null" >
		        BZBXCZ = #{bzbxcz},
		      </if>
		      <if test="jckcz != null" >
		        JCKCZ = #{jckcz},
		      </if>
		      <if test="jzhl != null" >
		        JZHL = #{jzhl},
		      </if>
		      <if test="jshsxydcz != null" >
		        JSHSXYDCZ = #{jshsxydcz},
		      </if>
		      <if test="aqssqtcz != null" >
		        AQSSQTCZ = #{aqssqtcz},
		      </if>
		      <if test="tzgs != null" >
		        TZGS = #{tzgs},
		      </if>
		      <if test="jhnf != null" >
		        JHNF = #{jhnf},
		      </if>
		      <if test="throadcode != null" >
		        THROADCODE = #{throadcode},
		      </if>
		      <if test="throadstart != null" >
		        THROADSTART = #{throadstart},
		      </if>
		      <if test="throadend != null" >
		        THROADEND = #{throadend},
		      </if>
		      <if test="sgpb != null" >
		        SGPB = #{sgpb},
		      </if>
		      <if test="dgjw != null" >
		        DGJW = #{dgjw},
		      </if>
		      <if test="lxjw != null" >
		        LXJW = #{lxjw},
		      </if>
		      <if test="jtlpbzb != null" >
		        JTLPBZB = #{jtlpbzb},
		      </if>
		      <if test="dist != null" >
		        DIST = #{dist},
		      </if>
		      <if test="distcode != null" >
		        DISTCODE = #{distcode},
		      </if>
		      <if test="sbzt != null" >
		        SBZT = #{sbzt},
		      </if>
		      <if test="cszt != null" >
		        CSZT = #{cszt},
		      </if>
		      <if test="zszt != null" >
		        ZSZT = #{zszt},
		      </if>
		      <if test="csyj != null" >
		        CSYJ = #{csyj},
		      </if>
		      <if test="zsyj != null" >
		        ZSYJ = #{zsyj},
		      </if>
		      <if test="roadname != null" >
		        ROADNAME = #{roadname},
		      </if>
		      <if test="gldj != null" >
		        GLDJ = #{gldj},
		      </if>
		      <if test="tsdq != null" >
		        TSDQ = #{tsdq},
		      </if>
		      <if test="xjgjnd != null" >
		        XJGJND = #{xjgjnd},
		      </if>
		      <if test="zlc != null" >
		        ZLC = #{zlc},
		      </if>
		      <if test="sbthcd != null" >
		        SBTHCD = #{sbthcd},
		      </if>
		      <if test="yhlc != null" >
		        YHLC = #{yhlc},
		      </if>
		      <if test="gpsqd != null" >
		        gpsqd = #{gpsqd},
		      </if>
		      <if test="gpszd != null" >
		        gpszd = #{gpszd},
		      </if>
		      <if test="xuh != null" >
		        xuh = #{xuh},
		      </if>
		      <if test="xmklx != null">
					xmklx=#{xmklx},
				</if>
			<if test="lsjl != null">lsjl=#{lsjl},</if>
	      	<if test="lsxmxx != null">lsxmxx=#{lsxmxx},</if>
		    </set>
		    where id=#{id}
	  </update>
	   	<update id="xgXmkAFSbzt" parameterType="hashmap" >
 			update XMK_AQSMFH set sbzt='已上报',sbthcd=#{sbthcd} where id =#{id}
 		</update>
 		<delete id="deleteAfxmkById" parameterType="java.util.List">
 			delete from XMK_AQSMFH where id=#{id}
 		</delete>
 		
 		
 		
 		
 		
 		
 		<!-- 审查库 -->
 		<select id="selectSckaqsmfh" parameterType="xmkaqsmfh" resultType="xmkaqsmfh">
		select * from (
	 		select rownum num ,t.*,decode(sbthbmcd,'7','已上报',#{sbthbmcd},'未上报',sbzt) sbzt2 
	 		from (select sc.*,xmld.tsdq,xmld.xmklx,xmld.throadname,xmld.throadcode from SCK_AQSMFH sc left join (select ld.xmbm,WMSYS.WM_CONCAT( distinct xm.xmklx) xmklx,WMSYS.WM_CONCAT( distinct xm.tsdq) tsdq,WMSYS.WM_CONCAT(xm.throadcode) throadcode,WMSYS.WM_CONCAT(xm.roadname) throadname from sck_aqsmfh_ld ld left join xmk_aqsmfh xm on ld.xmkid=xm.id group by ld.xmbm) xmld on sc.xmbm=xmld.xmbm) t where 1=1 
	 			and  to_number(sbthbmcd) &lt;=to_number(#{sbthbmcd}) 
	 		<if test="gydw!='' and gydw!= null ">
				${gydw}
			</if>
			<if test="xzqh!='' and xzqh!= null ">
				${xzqh}
			</if>
	 		<if test="lxmc!='' and lxmc!= null ">
	 			and lxmc like '%'||(#{lxmc})||'%'
	 		</if>
	 		<if test="jhnf!='' and jhnf!= null ">
	 			and jhnf in (${jhnf})
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			and decode(sbthbmcd,'7','已上报',#{sbthbmcd},'未上报',sbzt) like '%'||(#{sbzt})||'%'
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 				${jsdj}
 			</if> 
 			<if test="gldj!='' and gldj!= null ">
 				${gldj}
 			</if> 
	 		<if test="lxbm!='' and lxbm!= null ">
	 			and lxbm like '%'||(#{lxbm})||'%'
	 		</if>
	 		<if test="throadcode!='' and throadcode!= null ">
	 			and throadcode like '%'||(#{throadcode})||'%'
	 		</if>
	 		<if test="throadname!='' and throadname!= null ">
	 			and throadname like '%'||(#{throadname})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			${tsdq}
	 		</if>
	 		<if test="bzls!='' and bzls!= null ">
	 			and bzls like '%'||(#{bzls})||'%'
	 		</if>
	 		<if test="xmklx !='' and xmklx != null ">
	 			and xmklx like '%'||(#{xmklx})||'%'
	 		</if>
	 			) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows} 
	 			order by decode(sbthbmcd,#{sbthbmcd},'未上报',sbzt) desc 
	</select>
	<select id="selectSckaqsmfhsh" parameterType="xmkaqsmfh" resultType="xmkaqsmfh">
		select * from (
	 		select rownum num ,t.* from (select sc.*,xmld.tsdq,xmld.xmklx,xmld.throadname,xmld.throadcode from SCK_AQSMFH sc left join (select ld.xmbm,WMSYS.WM_CONCAT(xm.tsdq) tsdq, WMSYS.WM_CONCAT( distinct xm.xmklx) xmklx,WMSYS.WM_CONCAT(xm.throadcode) throadcode, WMSYS.WM_CONCAT(xm.roadname) throadname from sck_aqsmfh_ld ld left join xmk_aqsmfh xm on ld.xmkid=xm.id group by ld.xmbm) xmld on sc.xmbm=xmld.xmbm) t where 1=1 
	 			and  (to_number(sbthbmcd) &lt;=7 or shyj is not null)
	 		<if test="gydw!='' and gydw!= null ">
				${gydw}
			</if>
			<if test="xzqh!='' and xzqh!= null ">
				${xzqh}
			</if>
	 		<if test="lxmc!='' and lxmc!= null ">
	 			and lxmc like '%'||(#{lxmc})||'%'
	 		</if>
	 		<if test="jhnf!='' and jhnf!= null ">
	 			and jhnf in (${jhnf})
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			<if test="sbzt == '未审核'">
 					and (shzt like '%'||(#{sbzt})||'%' or shzt is null) and sbthbmcd=7
				</if>
				<if test="sbzt == '已审核'">
	 					and (decode(shzt,null,'未审核',shzt) like '%'||(#{sbzt})||'%'  or (shyj is not null and sbthbmcd != 7))
				</if>
				<if test="sbzt == '审核不同意'">
	 					and shyj is not null and sbthbmcd != 7
				</if>
				<if test="sbzt == '审核同意'">
	 					and shyj = '同意' and sbthbmcd = 7
				</if>
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 				${jsdj}
 			</if> 
 			<if test="gldj!='' and gldj!= null ">
 				${gldj}
 			</if> 
	 		<if test="lxbm!='' and lxbm!= null ">
	 			and lxbm like '%'||(#{lxbm})||'%'
	 		</if>
	 		<if test="throadcode!='' and throadcode!= null ">
	 			and throadcode like '%'||(#{throadcode})||'%'
	 		</if>
	 		<if test="throadname!='' and throadname!= null ">
	 			and throadname like '%'||(#{throadname})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			${tsdq}
	 		</if>
	 		<if test="bzls!='' and bzls!= null ">
	 			and bzls like '%'||(#{bzls})||'%'
	 		</if>
	 		<if test="xmklx !='' and xmklx != null ">
	 			and xmklx like '%'||(#{xmklx})||'%'
	 		</if>
	 			) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows} 
	 			order by decode(shyj,null,1,'同意',3,'',1,2) 
	</select>
	
		<select id="selectSckaqsmfhCount" parameterType="xmkaqsmfh" resultType="int">
	 		select count(*) from 
				(select sc.*,xmld.tsdq,xmld.xmklx,xmld.throadname,xmld.throadcode from SCK_AQSMFH sc left join (select ld.xmbm,WMSYS.WM_CONCAT( distinct xm.xmklx) xmklx,WMSYS.WM_CONCAT(xm.tsdq) tsdq,WMSYS.WM_CONCAT(xm.throadcode) throadcode,WMSYS.WM_CONCAT(xm.roadname) throadname from sck_aqsmfh_ld ld left join xmk_aqsmfh xm on ld.xmkid=xm.id group by ld.xmbm) xmld on sc.xmbm=xmld.xmbm) t where 1=1
	 			and  to_number(sbthbmcd) &lt;=to_number(#{sbthbmcd}) 
	 		<if test="gydw!='' and gydw!= null ">
				${gydw}
			</if>
			<if test="xzqh!='' and xzqh!= null ">
				${xzqh}
			</if>
	 		<if test="lxmc!='' and lxmc!= null ">
	 			and lxmc like '%'||(#{lxmc})||'%'
	 		</if>
	 		<if test="jhnf!='' and jhnf!= null ">
	 			and jhnf in (${jhnf})
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			and decode(sbthbmcd,'7','已上报',#{sbthbmcd},'未上报',sbzt) like '%'||(#{sbzt})||'%'
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 				${jsdj}
 			</if> 
 			<if test="gldj!='' and gldj!= null ">
 				${gldj}
 			</if> 
	 		<if test="lxbm!='' and lxbm!= null ">
	 			and lxbm like '%'||(#{lxbm})||'%'
	 		</if>
	 		<if test="throadcode!='' and throadcode!= null ">
	 			and throadcode like '%'||(#{throadcode})||'%'
	 		</if>
	 		<if test="throadname!='' and throadname!= null ">
	 			and throadname like '%'||(#{throadname})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			${tsdq}
	 		</if>
	 		<if test="bzls!='' and bzls!= null ">
	 			and bzls like '%'||(#{bzls})||'%'
	 		</if>
	 			
	</select>
	<select id="selectSckaqsmfhshCount" parameterType="xmkaqsmfh" resultType="int">
	 		select count(*) from 
				(select sc.*,xmld.tsdq,xmld.xmklx,xmld.throadname,xmld.throadcode from SCK_AQSMFH sc left join (select ld.xmbm,WMSYS.WM_CONCAT( distinct xm.xmklx) xmklx,WMSYS.WM_CONCAT(xm.tsdq) tsdq, WMSYS.WM_CONCAT(xm.throadcode) throadcode, WMSYS.WM_CONCAT(xm.roadname) throadname from sck_aqsmfh_ld ld left join xmk_aqsmfh xm on ld.xmkid=xm.id group by ld.xmbm) xmld on sc.xmbm=xmld.xmbm) t where 1=1 
	 			and  (to_number(sbthbmcd) &lt;=7 or shyj is not null)
	 		<if test="gydw!='' and gydw!= null ">
				${gydw}
			</if>
			<if test="xzqh!='' and xzqh!= null ">
				${xzqh}
			</if>
	 		<if test="lxmc!='' and lxmc!= null ">
	 			and lxmc like '%'||(#{lxmc})||'%'
	 		</if>
	 		<if test="jhnf!='' and jhnf!= null ">
	 			and jhnf in (${jhnf})
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			<if test="sbzt == '未审核'">
 					and (shzt like '%'||(#{sbzt})||'%' or shzt is null) and sbthbmcd=7
				</if>
				<if test="sbzt == '已审核'">
	 					and (decode(shzt,null,'未审核',shzt) like '%'||(#{sbzt})||'%'  or (shyj is not null and sbthbmcd != 7))
				</if>
				<if test="sbzt == '审核不同意'">
	 					and shyj is not null and sbthbmcd != 7
				</if>
				<if test="sbzt == '审核同意'">
	 					and shyj = '同意' and sbthbmcd = 7
				</if>
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 				${jsdj}
 			</if> 
 			<if test="gldj!='' and gldj!= null ">
 				${gldj}
 			</if> 
	 		<if test="lxbm!='' and lxbm!= null ">
	 			and lxbm like '%'||(#{lxbm})||'%'
	 		</if>
	 		<if test="throadcode!='' and throadcode!= null ">
	 			and throadcode like '%'||(#{throadcode})||'%'
	 		</if>
	 		<if test="throadname!='' and throadname!= null ">
	 			and throadname like '%'||(#{throadname})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			${tsdq}
	 		</if>
	 		<if test="bzls!='' and bzls!= null ">
	 			and bzls like '%'||(#{bzls})||'%'
	 		</if>
	 		<if test="xmklx !='' and xmklx != null ">
	 			and xmklx like '%'||(#{xmklx})||'%'
	 		</if>
	</select>
	
		<select id="loadSckaqsmfhCount" parameterType="xmkaqsmfh" resultType="xmkaqsmfh">
	 		select count(*) sbthbmcd,decode(sum(yhlc),null,0,sum(yhlc)) yhlc,decode(sum(czzlc),null,0,sum(czzlc)) czzlc,sum(cztzgs) cztzgs,sum(nsqbbz) nsqbbz from 
				(select sc.*,xmld.tsdq,xmld.throadname,xmld.xmklx,xmld.throadcode from SCK_AQSMFH sc left join (select ld.xmbm,WMSYS.WM_CONCAT(xm.tsdq) tsdq,WMSYS.WM_CONCAT( distinct xm.xmklx) xmklx, WMSYS.WM_CONCAT(xm.throadcode) throadcode, WMSYS.WM_CONCAT(xm.roadname) throadname from sck_aqsmfh_ld ld left join xmk_aqsmfh xm on ld.xmkid=xm.id group by ld.xmbm) xmld on sc.xmbm=xmld.xmbm) t where 1=1 
	 			and  to_number(sbthbmcd) &lt;=to_number(#{sbthbmcd}) 
	 		<if test="gydw!='' and gydw!= null ">
				${gydw}
			</if>
			<if test="xzqh!='' and xzqh!= null ">
				${xzqh}
			</if>
	 		<if test="lxmc!='' and lxmc!= null ">
	 			and lxmc like '%'||(#{lxmc})||'%'
	 		</if>
	 		<if test="jhnf!='' and jhnf!= null ">
	 			and jhnf in (${jhnf})
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			and decode(sbthbmcd,'7','已上报',#{sbthbmcd},'未上报',sbzt) like '%'||(#{sbzt})||'%'
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 				${jsdj}
 			</if> 
 			<if test="gldj!='' and gldj!= null ">
 				${gldj}
 			</if> 
	 		<if test="lxbm!='' and lxbm!= null ">
	 			and lxbm like '%'||(#{lxbm})||'%'
	 		</if>
	 		<if test="throadcode!='' and throadcode!= null ">
	 			and throadcode like '%'||(#{throadcode})||'%'
	 		</if>
	 		<if test="throadname!='' and throadname!= null ">
	 			and throadname like '%'||(#{throadname})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			${tsdq}
	 		</if>
	 		<if test="bzls!='' and bzls!= null ">
	 			and bzls like '%'||(#{bzls})||'%'
	 		</if>
	 		<if test="xmklx !='' and xmklx != null ">
	 			and xmklx like '%'||(#{xmklx})||'%'
	 		</if>
	</select>
	<select id="loadSckaqsmfhshCount" parameterType="xmkaqsmfh" resultType="xmkaqsmfh">
	 		select count(*) sbthbmcd,decode(sum(yhlc),null,0,sum(yhlc)) yhlc,decode(sum(czzlc),null,0,sum(czzlc)) czzlc,sum(cztzgs) cztzgs,sum(nsqbbz) nsqbbz from 
				(select sc.*,xmld.tsdq,xmld.throadname,xmld.xmklx, xmld.throadcode from SCK_AQSMFH sc left join (select ld.xmbm,WMSYS.WM_CONCAT( distinct xm.xmklx) xmklx,WMSYS.WM_CONCAT(xm.tsdq) tsdq, WMSYS.WM_CONCAT(xm.throadcode) throadcode, WMSYS.WM_CONCAT(xm.roadname) throadname from sck_aqsmfh_ld ld left join xmk_aqsmfh xm on ld.xmkid=xm.id group by ld.xmbm) xmld on sc.xmbm=xmld.xmbm) t where 1=1 
	 			and  (to_number(sbthbmcd) &lt;=7 or shyj is not null)
	 		<if test="gydw!='' and gydw!= null ">
				${gydw}
			</if>
			<if test="xzqh!='' and xzqh!= null ">
				${xzqh}
			</if>
	 		<if test="lxmc!='' and lxmc!= null ">
	 			and lxmc like '%'||(#{lxmc})||'%'
	 		</if>
	 		<if test="jhnf!='' and jhnf!= null ">
	 			and jhnf in (${jhnf})
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			<if test="sbzt == '未审核'">
 					and (shzt like '%'||(#{sbzt})||'%' or shzt is null) and sbthbmcd=7
				</if>
				<if test="sbzt == '已审核'">
	 					and (decode(shzt,null,'未审核',shzt) like '%'||(#{sbzt})||'%'  or (shyj is not null and sbthbmcd != 7))
				</if>
				<if test="sbzt == '审核不同意'">
	 					and shyj is not null and sbthbmcd != 7
				</if>
				<if test="sbzt == '审核同意'">
	 					and shyj = '同意' and sbthbmcd = 7
				</if>
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 				${jsdj}
 			</if> 
 			<if test="gldj!='' and gldj!= null ">
 				${gldj}
 			</if> 
	 		<if test="lxbm!='' and lxbm!= null ">
	 			and lxbm like '%'||(#{lxbm})||'%'
	 		</if>
	 		<if test="throadcode!='' and throadcode!= null ">
	 			and throadcode like '%'||(#{throadcode})||'%'
	 		</if>
	 		<if test="throadname!='' and throadname!= null ">
	 			and throadname like '%'||(#{throadname})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			${tsdq}
	 		</if>
	 		<if test="bzls!='' and bzls!= null ">
	 			and bzls like '%'||(#{bzls})||'%'
	 		</if>
	 		<if test="xmklx !='' and xmklx != null ">
	 			and xmklx like '%'||(#{xmklx})||'%'
	 		</if>
	</select>
	
 		<select id="aqsmfhJckGpsRoad" parameterType="hashmap" resultType="xmkaqsmfh">
 			select * from xmk_aqsmfh  where 1=1
 			<if test="unitcode!='' and unitcode!= null ">
				and unitcode like '%' || substr(#{unitcode}, 0, 4) || '_' || substr(#{unitcode}, 6) || '%'
			</if>
 			<if test="distcode!='' and distcode!= null ">
				and distcode like '%'||#{distcode}||'%'
			</if>
			<if test="roadcode!='' and roadcode!= null ">
				and roadcode like '%'||#{roadcode}||'%'
			</if>
 		</select>
 		<insert id="insertAqsmfhsck" parameterType="xmkaqsmfh">
 		insert into SCK_AQSMFH
		    <trim prefix="(" suffix=")" suffixOverrides="," >    
		        ID,
		      <if test="province != null" >
		        PROVINCE,
		      </if>
		      <if test="town != null" >
		        TOWN,
		      </if>
		      <if test="county != null" >
		        COUNTY,
		      </if>
		      <if test="gydw != null" >
		        GYDW,
		      </if>
		      <if test="gydwdm != null" >
		        GYDWDM,
		      </if>
		      <if test="lxbm != null" >
		        LXBM,
		      </if>
		      <if test="jsdj != null" >
		        JSDJ,
		      </if>
		      <if test="qdzh != null" >
		        QDZH,
		      </if>
		      <if test="zdzh != null" >
		        ZDZH,
		      </if>
		      <if test="sbzt != null" >
		        SBZT,
		      </if>
		      <if test="lxmc != null" >
		        LXMC,
		      </if>
		      <if test="xjgjnd != null" >
		        XJGJND,
		      </if>
		      <if test="sbthbmcd != null" >
		        SBTHBMCD,
		      </if>
		      <if test="yhlc != null" >
		        YHLC,
		      </if>
		      <if test="fapgdw != null" >
		        FAPGDW,
		      </if>
		      <if test="fascdw != null" >
		        FASCDW,
		      </if>
		      <if test="faspsj != null" >
		        FASPSJ,
		      </if>
		      <if test="spwh != null" >
		        SPWH,
		      </if>
		      <if test="czzlc != null" >
		        CZZLC,
		      </if>
		      <if test="cztzgs != null" >
		        CZTZGS,
		      </if>
		      <if test="jsxz != null" >
		        JSXZ,
		      </if>
		      <if test="jsnr != null" >
		        JSNR,
		      </if>
		      <if test="bz != null" >
		        BZ,
		      </if>
		      <if test="shzt != null" >
		        SHZT,
		      </if>
		      <if test="tbdwdm != null" >
		        TBDWDM,
		      </if>
		      <if test="sfsqablbz != null" >
		        SFSQABLBZ,
		      </if>
		      <if test="ablbzsqwh != null" >
		        ABLBZSQWH,
		      </if>
		      <if test="xzqhdm != null" >
		        XZQHDM,
		      </if>
		      <if test="xzqh != null" >
		        XZQH,
		      </if>
		      <if test="cszt != null" >
		        CSZT,
		      </if>
		      <if test="csyj != null" >
		        CSYJ,
		      </if>
		      <if test="shyj != null" >
		        SHYJ,
		      </if>
		      <if test="xmbm != null" >
		        XMBM,
		      </if>
		      <if test="bzls != null" >
		        BZLS,
		      </if>
		      <if test="jhnf != null" >
		        JHNF,
		      </if>
		       <if test="str1 != null" >
		        STR1,
		      </if>
		      <if test="str2 != null" >
		        STR2,
		      </if>
		      <if test="str3 != null" >
		        STR3,
		      </if>
		      <if test="str4 != null" >
		        STR4,
		      </if>
		      <if test="str5 != null" >
		        STR5,
		      </if>
		      <if test="str6 != null" >
		        STR6,
		      </if>
		      <if test="str7 != null" >
		        STR7,
		      </if>
		      <if test="str8 != null" >
		        STR8,
		      </if>
		      <if test="nsqbbz != null" >
		        nsqbbz,
		      </if>
		    </trim>
		    <trim prefix="values (" suffix=")" suffixOverrides="," >
		        sys_guid(),
		      <if test="province != null" >
		        #{province},
		      </if>
		      <if test="town != null" >
		        #{town},
		      </if>
		      <if test="county != null" >
		        #{county},
		      </if>
		      <if test="gydw != null" >
		        #{gydw},
		      </if>
		      <if test="gydwdm != null" >
		        #{gydwdm},
		      </if>
		      <if test="lxbm != null" >
		        #{lxbm},
		      </if>
		      <if test="jsdj != null" >
		        #{jsdj},
		      </if>
		      <if test="qdzh != null" >
		        #{qdzh},
		      </if>
		      <if test="zdzh != null" >
		        #{zdzh},
		      </if>
		      <if test="sbzt != null" >
		        #{sbzt},
		      </if>
		      <if test="lxmc != null" >
		        #{lxmc},
		      </if>
		      <if test="xjgjnd != null" >
		        #{xjgjnd},
		      </if>
		      <if test="sbthbmcd != null" >
		        #{sbthbmcd},
		      </if>
		      <if test="yhlc != null" >
		        #{yhlc},
		      </if>
		      <if test="fapgdw != null" >
		        #{fapgdw},
		      </if>
		      <if test="fascdw != null" >
		        #{fascdw},
		      </if>
		      <if test="faspsj != null" >
		        #{faspsj},
		      </if>
		      <if test="spwh != null" >
		        #{spwh},
		      </if>
		      <if test="czzlc != null" >
		        #{czzlc},
		      </if>
		      <if test="cztzgs != null" >
		        #{cztzgs},
		      </if>
		      <if test="jsxz != null" >
		        #{jsxz},
		      </if>
		      <if test="jsnr != null" >
		        #{jsnr},
		      </if>
		      <if test="bz != null" >
		        #{bz},
		      </if>
		      <if test="shzt != null" >
		        #{shzt},
		      </if>
		      <if test="tbdwdm != null" >
		        #{tbdwdm},
		      </if>
		      <if test="sfsqablbz != null" >
		        #{sfsqablbz},
		      </if>
		      <if test="ablbzsqwh != null" >
		        #{ablbzsqwh},
		      </if>
		      <if test="xzqhdm != null" >
		        #{xzqhdm},
		      </if>
		      <if test="xzqh != null" >
		        #{xzqh},
		      </if>
		      <if test="cszt != null" >
		        #{cszt},
		      </if>
		      <if test="csyj != null" >
		        #{csyj},
		      </if>
		      <if test="shyj != null" >
		        #{shyj},
		      </if>
		      <if test="xmbm != null" >
		        #{xmbm},
		      </if>
		      <if test="bzls != null" >
		        #{bzls},
		      </if>
		      <if test="jhnf != null" >
		        #{jhnf},
		      </if>
		      <if test="str1 != null" >
		        #{str1},
		      </if>
		      <if test="str2 != null" >
		        #{str2},
		      </if>
		      <if test="str3 != null" >
		        #{str3},
		      </if>
		      <if test="str4 != null" >
		        #{str4},
		      </if>
		      <if test="str5 != null" >
		        #{str5},
		      </if>
		      <if test="str6 != null" >
		        #{str6},
		      </if>
		      <if test="str7 != null" >
		        #{str7},
		      </if>
		       <if test="str8 != null" >
		        #{str8},
		      </if>
		       <if test="nsqbbz != null" >
		        #{nsqbbz},
		      </if>
		    </trim>
 		</insert>
 		<select id="selectafldList" parameterType="xmkaqsmfh" resultType="xmkaqsmfh">
 			select * from SCK_AQSMFH where 1=1 and zszt='已审核'
 			<if test="xmbm!='' and xmbm!=null "> and xmbm=#{xmbm}</if>
 			order by xuh
 		</select>
 		<select id="selectAqsmfhsckbyid" parameterType="xmkaqsmfh" resultType="xmkaqsmfh">
 			select * from SCK_AQSMFH sa
            left join xmk_aqsmfh xa on xa.id = sa.id where 1=1 
 			<if test="id!='' and id!=null "> and sa.id=#{id}</if>
 		</select>
 		<select id="selectAqsmfhsckbyid1" parameterType="xmkaqsmfh" resultType="xmkaqsmfh">
 			select * from SCK_AQSMFH where 1=1 
 			<if test="id!='' and id!=null "> and id=#{id}</if>
 		</select>
 		<select id="selectAqsmfhxmkbyid" parameterType="xmkaqsmfh" resultType="xmkaqsmfh">
 			select * from XMK_AQSMFH where 1=1 
 			<if test="id!='' and id!=null "> and id=#{id}</if>
 		</select>
 		<update id="updateAqsmfhsck" parameterType="xmkaqsmfh">
 			 update SCK_AQSMFH
			    <set >
			      <if test="province != null" >
			        PROVINCE = #{province},
			      </if>
			      <if test="town != null" >
			        TOWN = #{town},
			      </if>
			      <if test="county != null" >
			        COUNTY = #{county},
			      </if>
			      <if test="gydw != null" >
			        GYDW = #{gydw},
			      </if>
			      <if test="gydwdm != null" >
			        GYDWDM = #{gydwdm},
			      </if>
			      <if test="lxbm != null" >
			        LXBM = #{lxbm},
			      </if>
			      <if test="jsdj != null" >
			        JSDJ = #{jsdj},
			      </if>
			      <if test="qdzh != null" >
			        QDZH = #{qdzh},
			      </if>
			      <if test="zdzh != null" >
			        ZDZH = #{zdzh},
			      </if>
			      <if test="sbzt != null" >
			        SBZT = #{sbzt},
			      </if>
			      <if test="lxmc != null" >
			        LXMC = #{lxmc},
			      </if>
			      <if test="xjgjnd != null" >
			        XJGJND = #{xjgjnd},
			      </if>
			      <if test="sbthbmcd != null" >
			        SBTHBMCD = #{sbthbmcd},
			      </if>
			      <if test="yhlc != null" >
			        YHLC = #{yhlc},
			      </if>
			      <if test="fapgdw != null" >
			        FAPGDW = #{fapgdw},
			      </if>
			      <if test="fascdw != null" >
			        FASCDW = #{fascdw},
			      </if>
			      <if test="faspsj != null" >
			        FASPSJ = #{faspsj},
			      </if>
			      <if test="spwh != null" >
			        SPWH = #{spwh},
			      </if>
			      <if test="czzlc != null" >
			        CZZLC = #{czzlc},
			      </if>
			      <if test="cztzgs != null" >
			        CZTZGS = #{cztzgs},
			      </if>
			      <if test="jsxz != null" >
			        JSXZ = #{jsxz},
			      </if>
			      <if test="jsnr != null" >
			        JSNR = #{jsnr},
			      </if>
			      <if test="bz != null" >
			        BZ = #{bz},
			      </if>
			      <if test="shzt != null" >
			        SHZT = #{shzt},
			      </if>
			      <if test="tbdwdm != null" >
			        TBDWDM = #{tbdwdm},
			      </if>
			      <if test="sfsqablbz != null" >
			        SFSQABLBZ = #{sfsqablbz},
			      </if>
			      <if test="ablbzsqwh != null" >
			        ABLBZSQWH = #{ablbzsqwh},
			      </if>
			      <if test="xzqhdm != null" >
			        XZQHDM = #{xzqhdm},
			      </if>
			      <if test="xzqh != null" >
			        XZQH = #{xzqh},
			      </if>
			      <if test="cszt != null" >
			        CSZT = #{cszt},
			      </if>
			      <if test="csyj != null" >
			        CSYJ = #{csyj},
			      </if>
			      <if test="shyj != null" >
			        SHYJ = #{shyj},
			      </if>
			      <if test="xmbm != null" >
			        XMBM = #{xmbm},
			      </if>
			      <if test="bzls != null" >
			        BZLS = #{bzls},
			      </if>
			      <if test="jhnf != null" >
			        JHNF = #{jhnf},
			      </if>
			      <if test="str1 != null" >
			        STR1 = #{str1},
			      </if>
			      <if test="str2 != null" >
			        STR2 = #{str2},
			      </if>
			      <if test="str3 != null" >
			        STR3 = #{str3},
			      </if>
			      <if test="str4 != null" >
			        STR4 = #{str4},
			      </if>
			      <if test="str5 != null" >
			        STR5 = #{str5},
			      </if>
			      <if test="str6 != null" >
			        STR6 = #{str6},
			      </if>
			      <if test="str7 != null" >
			        STR7 = #{str7},
			      </if>
			      <if test="str8 != null" >
			        STR8 = #{str8},
			      </if>
			      <if test="nsqbbz != null" >
			        nsqbbz = #{nsqbbz},
			      </if>
			    </set>
			    where 1=1 and id=#{id}
 		</update>
 		<select id="selectSckaqsmfhld" parameterType="xmkaqsmfh" resultType="xmkaqsmfh">
 			select T.* from XMK_AQSMFH T where 1=1 ${xmkid} order by xuh
 		</select>
 		<select id="selectSckaqsmfhld1" parameterType="xmkaqsmfh" resultType="xmkaqsmfh">
 			select s.*, x.THROADCODE, x.THROADSTART, x.THROADEND from SCK_AQSMFH_LD s left join xmk_aqsmfh x on s.xmkid=x.id where 1=1 and s.xmbm=#{xmbm} order by s.xuh
 		</select>
 		<insert id="insertAqsmfhsckld" parameterType="hashmap">
 			 insert into SCK_AQSMFH_LD select sys_guid(),xm.province,xm.town,xm.county,xm.unit,xm.unitcode,xm.roadcode,xm.jsdj,xm.gpsqd,xm.gpszd,xm.roadname,xm.xjgjnd,xm.yhlc,xm.tzgs,xm.id,xm.distcode,xm.dist,xm.xuh,#{xmbm} xmbm,decode(xm.bzbxcz,'1','1','0'),decode(xm.jckcz,'1','1','0'),decode(xm.jzhl,'1','1','0'),decode(xm.tjgc,'1','1','0'),decode(xm.tjgc,'1','1','0'),decode(xm.hjzz,'1','1','0'),decode(xm.hjzz,'1','1','0'),'0' from xmk_aqsmfh xm where xm.id=#{xmkid}
 		</insert>
 		<select id="loadscktjld" parameterType="xmkaqsmfh" resultType="xmkaqsmfh">
 			select max(t.province) province,max(t.town) town,max(t.county) county,max(t.unit) gydw,max(t.unitcode) gydwdm,max(t.dist) xzqh,max(t.jsdj) jsdj,max(t.xjgjnd) xjgjnd,
			max(t.distcode) xzqhdm,max(t.roadcode) lxbm,max(t.roadname) lxmc,to_char(round(min(to_number(t.gpsqd)),3)) qdzh,to_char(round(max(to_number(t.gpszd)),3)) zdzh,
			 to_char(round(max(to_number(t.gpsqd)),3)) qdzh1,to_char(round(min(to_number(t.gpszd)),3)) zdzh1,
			sum(yhlc) yhlc,sum(t.tzgs) cztzgs
			from XMK_AQSMFH t 
			where 1=1 ${xmkid} 
 		</select>
 		<select id="loadscktjld1" parameterType="xmkaqsmfh" resultType="xmkaqsmfh">
 			select max(t.province) province,max(t.town) town,max(t.county) county,max(t.gydw) gydw,max(t.gydwdm) gydwdm,max(t.xzqh) xzqh,max(t.jsdj) jsdj,max(t.xjgjnd) xjgjnd,
			max(t.xzqhdm) xzqhdm,max(t.lxbm) lxbm,max(t.lxmc) lxmc,to_char(round(min(to_number(t.qdzh)),3)) qdzh,to_char(round(max(to_number(t.zdzh)),3)) zdzh,
			sum(yhlc) yhlc,sum(t.cztzgs) cztzgs
			from SCK_AQSMFH_LD t 
			where 1=1 and xmbm=#{xmbm}
 		</select>
 		<delete id="delafldsck" parameterType="xmkaqsmfh" >
 			delete from SCK_AQSMFH_LD where id=#{id}
 		</delete>
	    <delete id="deleteSckAf" parameterType="java.util.List" >
	 	  delete from SCK_AQSMFH where xmbm =#{String}
	   </delete>
	   <delete id="deleteSckAfld" parameterType="java.util.List" >
	 	 delete from SCK_AQSMFH_LD where xmbm =#{String}
	   </delete>
	    <update id="sckAfSb" parameterType="hashmap" >
 			update SCK_AQSMFH set sbzt='已上报',sbthbmcd=#{sbthbmcd} where id =#{id}
 		</update>
	   <update id="afSckCs" parameterType="xmkaqsmfh" >
 			update SCK_AQSMFH set sbzt=#{sbzt},sbthbmcd=#{sbthbmcd},cszt=#{cszt},csyj=#{csyj} where id =#{id} 
 		</update>
	   <update id="afSckZs" parameterType="xmkaqsmfh" >
 			update SCK_AQSMFH set shzt=#{shzt},sbthbmcd=#{sbthbmcd},cszt=#{cszt},shyj=#{shyj} where id =#{id} 
 		</update>
 		<insert id="insertPlanaf" parameterType="xmkaqsmfh">
 			insert into plan_af(sckid,jhnf,jh_sbthcd,pfztz,jhsybbzje,jhsydfzczj,sfsqablbz,ablbzsqwh,pfwh,pfsj,jhzlc,jhyhlc,sjpfdw) select id,jhnf,decode(substr(t.gydwdm,0,1),'2','2',decode(substr(t.gydwdm,-1),'0','2','0')),
			t.cztzgs,t.nsqbbz,(t.cztzgs-t.nsqbbz),decode(t.sfsqablbz,1,'是','否'),t.ablbzsqwh,t.spwh,REPLACE( t.faspsj, '/', '-'),t.czzlc,t.yhlc,t.fascdw
			 from SCK_AQSMFH t where id=#{id}
 		</insert>
 		<select id="dcaqsmfhsckExcel" parameterType="xmkaqsmfh" resultType="elist">
 			<!-- select ld.xuh v_0,ld.province v_1,ld.town v_2,ld.county v_3,ld.lxbm v_4,
		      decode(ld.xuh,ld1.xuh,ld.gydw,'') v_5,decode(ld.xuh,ld1.xuh,ld.xzqhdm,'') v_6,decode(ld.xuh,ld1.xuh,sc.lxmc,'') v_7,
		      decode(ld.xuh,ld1.xuh,sc.jsdj,'') v_8,decode(ld.xuh,ld1.xuh,sc.qdzh,'') v_9,decode(ld.xuh,ld1.xuh,sc.zdzh,'') v_10,
		      decode(ld.xuh,ld1.xuh,sc.yhlc,'') v_11,decode(ld.xuh,ld1.xuh,sc.czzlc,'') v_12,decode(ld.xuh,ld1.xuh,sc.xjgjnd,'') v_13,
		      decode(ld.xuh,ld1.xuh,sc.fapgdw,'') v_14,decode(ld.xuh,ld1.xuh,sc.fascdw,'') v_15,decode(ld.xuh,ld1.xuh,sc.faspsj,'') v_16,
		      decode(ld.xuh,ld1.xuh,sc.spwh,'') v_17,decode(ld.xuh,ld1.xuh,sc.nsqbbz,'') v_19,decode(ld.xuh,ld1.xuh,sc.cztzgs,'') v_18,decode(ld.xuh,ld1.xuh,sc.sfsqablbz,'') v_20,
		      decode(ld.xuh,ld1.xuh,sc.ablbzsqwh,'') v_21,decode(ld.xuh,ld1.xuh,sc.jsxz,'') v_22,decode(ld.xuh,ld1.xuh,sc.jsnr,'') v_23,
		      decode(ld.xuh,ld1.xuh,sc.bz,'') v_24
	        from sck_aqsmfh_ld ld,xmk_aqsmfh xm,SCK_AQSMFH sc,(select min(xuh) xuh,xmbm from sck_aqsmfh_ld group by xmbm) ld1 
	        where ld.xmkid=xm.id and ld.xmbm=sc.xmbm and ld.xmbm=ld1.xmbm(+)and sc.jhnf is not null -->
  select * from(   
	  select '' v_0,decode(ld.id,ld1.mid,1,0) v_50 ,ld.xzqhdm v_1,ld.xzqh v_2,ld.lxbm v_3,sc.lxmc v_4,ld.qdzh v_5,ld.zdzh v_6,
          to_char(ld.zlc,'fm9999999990.000') v_7,to_char(ld.yhlc,'fm9999999990.000') v_8,sc.xjgjnd v_9,sc.fapgdw v_10,sc.fascdw v_11,sc.faspsj v_12,sc.spwh v_13,sc.cztzgs v_14,
          sc.jsxz v_15,sc.jsnr v_16,sc.jhnf v_17,sc.bz v_18,sc.xmbm v_30
          from sck_aqsmfh sc 
           left join 
           (select ld.id,ld.gydwdm, ld.xmbm, ld.xzqhdm,ld.xzqh,ld.lxbm,ld.qdzh,ld.zdzh,ld.yhlc,ld.yhlc zlc           
           from sck_aqsmfh_ld ld ) ld 
           on ld.xmbm=sc.xmbm
           left join 
           (select ld.xmbm,WMSYS.WM_CONCAT( distinct xm.xmklx) xmklx,
       WMSYS.WM_CONCAT( distinct xm.tsdq) tsdq,WMSYS.WM_CONCAT(xm.throadcode) throadcode,
       WMSYS.WM_CONCAT(xm.roadname) throadname from sck_aqsmfh_ld ld 
       left join xmk_aqsmfh xm on ld.xmkid=xm.id group by ld.xmbm) xmld 
       on sc.xmbm=xmld.xmbm
       left join 
       (select min(id) mid,xmbm from sck_aqsmfh_ld group by xmbm) ld1 on ld1.xmbm=sc.xmbm
       where 1=1 and sc.jhnf is not null
			<if test="gydw!='' and gydw!= null ">
				${gydw}
			</if>
			<if test="xzqhdm!='' and xzqhdm!= null ">
				${xzqhdm}
			</if>
	 		<if test="lxmc!='' and lxmc!= null ">
	 			and lxmc like '%'||(#{lxmc})||'%'
	 		</if>
	 		<if test="jhnf!='' and jhnf!= null ">
	 			and sc.jhnf like '%'||(#{jhnf})||'%'
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			and decode(sbthbmcd,'7','已上报',#{sbthbmcd},'未上报',sbzt) like '%'||(#{sbzt})||'%'
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 				and jsdj like '%'||(#{jsdj})||'%'
 			</if> 
 			<if test="gldj!='' and gldj!= null ">
 				and lxbm like '%'||(#{gldj})||'%'
 			</if> 
	 		<if test="lxbm!='' and lxbm!= null ">
	 			and lxbm like '%'||(#{lxbm})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			and tsdq like '%'||(#{tsdq})||'%'
	 		</if>
	 		<if test="bzls!='' and bzls!= null ">
	 			and bzls like '%'||(#{bzls})||'%'
	 		</if>
	 		) order by v_30,v_50 desc
 		</select>
 		
 		<select id="dcaqsmfhsckshExcel" parameterType="xmkaqsmfh" resultType="elist">
 			<!-- select ld.xuh v_0,ld.province v_1,ld.town v_2,ld.county v_3,ld.lxbm v_4,
		      decode(ld.xuh,ld1.xuh,ld.gydw,'') v_5,decode(ld.xuh,ld1.xuh,ld.xzqhdm,'') v_6,decode(ld.xuh,ld1.xuh,sc.lxmc,'') v_7,
		      decode(ld.xuh,ld1.xuh,sc.jsdj,'') v_8,decode(ld.xuh,ld1.xuh,sc.qdzh,'') v_9,decode(ld.xuh,ld1.xuh,sc.zdzh,'') v_10,
		      decode(ld.xuh,ld1.xuh,sc.yhlc,'') v_11,decode(ld.xuh,ld1.xuh,sc.czzlc,'') v_12,decode(ld.xuh,ld1.xuh,sc.xjgjnd,'') v_13,
		      decode(ld.xuh,ld1.xuh,sc.fapgdw,'') v_14,decode(ld.xuh,ld1.xuh,sc.fascdw,'') v_15,decode(ld.xuh,ld1.xuh,sc.faspsj,'') v_16,
		      decode(ld.xuh,ld1.xuh,sc.spwh,'') v_17,decode(ld.xuh,ld1.xuh,sc.nsqbbz,'') v_19,decode(ld.xuh,ld1.xuh,sc.cztzgs,'') v_18,decode(ld.xuh,ld1.xuh,sc.sfsqablbz,'') v_20,
		      decode(ld.xuh,ld1.xuh,sc.ablbzsqwh,'') v_21,decode(ld.xuh,ld1.xuh,sc.jsxz,'') v_22,decode(ld.xuh,ld1.xuh,sc.jsnr,'') v_23,
		      decode(ld.xuh,ld1.xuh,sc.bz,'') v_24
	        from sck_aqsmfh_ld ld,xmk_aqsmfh xm,SCK_AQSMFH sc,(select min(xuh) xuh,xmbm from sck_aqsmfh_ld group by xmbm) ld1 
	        where ld.xmkid=xm.id and ld.xmbm=sc.xmbm and ld.xmbm=ld1.xmbm(+)and sc.jhnf is not null -->
	        
	        select * from (  
          select '' v_0,decode(ld.id,ld1.mid,1,0) v_50 ,ld.xzqhdm v_1,ld.xzqh v_2,ld.lxbm v_3,sc.lxmc v_4,ld.qdzh v_5,ld.zdzh v_6,
          to_char(ld.zlc,'fm9999999990.000') v_7,to_char(ld.yhlc,'fm9999999990.000') v_8,sc.xjgjnd v_9,sc.fapgdw v_10,sc.fascdw v_11,sc.faspsj v_12,sc.spwh v_13,sc.cztzgs v_14,
          sc.jsxz v_15,sc.jsnr v_16,sc.jhnf v_17,sc.bz v_18,sc.xmbm v_30
          from sck_aqsmfh sc 
           left join 
           (select ld.id, ld.gydwdm,ld.xmbm, ld.xzqhdm,ld.xzqh,ld.lxbm,ld.qdzh,ld.zdzh,ld.yhlc,ld.yhlc zlc           
           from sck_aqsmfh_ld ld ) ld 
           on ld.xmbm=sc.xmbm
           left join 
           (select ld.xmbm,WMSYS.WM_CONCAT( distinct xm.xmklx) xmklx,
       WMSYS.WM_CONCAT( distinct xm.tsdq) tsdq,WMSYS.WM_CONCAT(xm.throadcode) throadcode,
       WMSYS.WM_CONCAT(xm.roadname) throadname from sck_aqsmfh_ld ld 
       left join xmk_aqsmfh xm on ld.xmkid=xm.id group by ld.xmbm) xmld 
       on sc.xmbm=xmld.xmbm
       left join 
       (select min(id) mid,xmbm from sck_aqsmfh_ld group by xmbm) ld1 on ld1.xmbm=sc.xmbm
       where  1=1 and sc.jhnf is not null
			  and  (to_number(sbthbmcd) &lt;=7)
	 		<if test="gydw!='' and gydw!= null ">
				${gydw}
			</if>
			<if test="xzqh!='' and xzqh!= null ">
				${xzqh}
			</if>
	 		<if test="lxmc!='' and lxmc!= null ">
	 			and lxmc like '%'||(#{lxmc})||'%'
	 		</if>
	 		<if test="jhnf!='' and jhnf!= null ">
	 			and sc.jhnf in (${jhnf})
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			<if test="sbzt == '未审核'">
 					and (shzt like '%'||(#{sbzt})||'%' or shzt is null) and sbthbmcd=7
				</if>
				<if test="sbzt == '已审核'">
 					and (decode(shzt,null,'未审核',shzt) like '%'||(#{sbzt})||'%'  or (shyj is not null and sbthbmcd != 7))
				</if>
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 				${jsdj}
 			</if> 
 			<if test="gldj!='' and gldj!= null ">
 				${gldj}
 			</if> 
	 		<if test="lxbm!='' and lxbm!= null ">
	 			and lxbm like '%'||(#{lxbm})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			${tsdq}
	 		</if>
	 		<if test="bzls!='' and bzls!= null ">
	 			and bzls like '%'||(#{bzls})||'%'
	 		</if>
	 		 ) order by v_30,v_50 desc  
 		</select>
 		
 		<select id="sfcfbntj" parameterType="xmkaqsmfh" resultType="xmkaqsmfh">
 			select sc.lxbm||'('||sc.lxmc||' '||sc.qdzh||','||sc.zdzh||')' lxbm from sck_aqsmfh_ld ld,sck_aqsmfh sc where ld.xmbm=sc.xmbm and sc.jhnf=#{jhnf} ${xmkid} and sc.xmbm not like #{xmbm}
 		</select>
 		<delete id="deletesckldbyxmbm" parameterType="xmkaqsmfh" >
 			delete from sck_aqsmfh_ld where xmbm=#{xmbm}
 		</delete>
 		
 		<!-- shm路网项目     基础库管理   安全生命防护   导出excel -->
 		<select id="xmkaqsmfhDoExcel" parameterType="xmkaqsmfh" resultType="elist">
		<!-- select rownum v_0,t.ZSZT v_1,t.roadcode v_2,t.ROADNAME v_3,t.THROADSTART v_4,
               t.THROADEND v_5,t.JSDJ v_6,t.GLDJ v_7,t.FANGX v_8,t.PCSJ v_9,t.LDFL v_10,
               t.UNIT v_11,t.DIST v_12,t.TZGS v_13,t.JHNF v_14,
               decode(sbthcd, '7', '已上报', 7, '未上报', sbzt) v_15
          from XMK_AQSMFH t
          left join (select count(*) jhsl, a4.id
                      from plan_af a1
                      left join sck_aqsmfh a2 on a1.sckid = a2.id
                      left join sck_aqsmfh_ld a3 on a2.xmbm = a3.xmbm
                      left join xmk_aqsmfh a4 on a3.xmkid = a4.id
                     group by a4.id) t1 on t.id = t1.id
         where 1 = 1 -->
         select rownum v_0,t.province v_1,t.town v_2,t.county v_3,t.roadcode v_4,t.roadname v_5,t.roadstart v_6,t.roadend v_7,
			t.jsdj v_8,t.fangx v_9,to_char(t.yhlc,'fm9999999990.000') v_10,t.pcsj v_11,t.ldfl v_12,t.jtsgpcf v_13,t.jtsgfxdj v_14,t.gltjpcf v_15,t.glfxdj v_16,
			t.sgpb v_17,t.dgjw v_18,t.lxjw v_19,t.lxxp v_20,t.doup v_21,t.sjbl v_22, t.lcxy v_23,t.hjfz v_24,t.jtlpbzb v_25,t.xchbc v_26,t.csxsss v_27,
			t.hul v_28,t.bzbx v_29,t.jshsxyd v_30,t.aqssqt v_31,t.tjgc v_32,t.hjzz v_33,t.bzbxcz v_34,t.jckcz v_35,t.jzhl v_36,t.jshsxydcz v_37,
			t.aqssqtcz v_38,t.tzgs v_39,t.jhnf v_40
			   from XMK_AQSMFH t
          left join (select count(*) jhsl, a4.id
                      from plan_af a1
                      left join sck_aqsmfh a2 on a1.sckid = a2.id
                      left join sck_aqsmfh_ld a3 on a2.xmbm = a3.xmbm
                      left join xmk_aqsmfh a4 on a3.xmkid = a4.id
                     group by a4.id) t1 on t.id = t1.id
         where 1 = 1
	 			and  to_number(sbthcd) &lt;=to_number(#{sbthcd}) 
	 		<if test="unitcode!='' and unitcode!= null ">
				${unitcode}
			</if>
			<if test="distcode!='' and distcode!= null ">
				${distcode}
			</if>
	 		<if test="roadname!='' and roadname!= null ">
	 			and roadname like '%'||(#{roadname})||'%'
	 		</if>
	 		<if test="jhnf!='' and jhnf!= null ">
	 			and jhnf like '%'||(#{jhnf})||'%'
	 		</if>
	 		<if test="sbzt!='' and sbzt!= null ">
	 			and decode(sbthcd,'7','已上报',#{sbthcd},'未上报',sbzt) like '%'||(#{sbzt})||'%'
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 				${jsdj}
 			</if> 
 			<if test="gldj!='' and gldj!= null ">
 				${gldj}
 			</if> 
	 		<if test="roadcode!='' and roadcode!= null ">
	 			and roadcode like '%'||(#{roadcode})||'%'
	 		</if>
 			<if test="tsdq!='' and tsdq!= null ">
	 			${tsdq}
	 		</if>
	 		<if test="bzls!='' and bzls!= null ">
 			   and decode(t1.jhsl,null,'无','有') like #{bzls}||'%'
 			</if>
 			<if test="xmklx !='' and xmklx != null ">
 			   and xmklx like '%'||(#{xmklx})||'%'
 		    </if>
	 			<!-- order by decode(sbthcd,#{sbthcd},'未上报',sbzt) desc  -->
	 			order by v_0 asc
	</select>
	<!-- wdd路网项目     基础库审核   安全生命防护   导出excel start-->
 	<select id="shaqsmfhDoExcel" parameterType="xmkaqsmfh" resultType="elist">
		<!-- select rownum v_0,t.ZSZT v_1,t.roadcode v_2,t.ROADNAME v_3,t.THROADSTART v_4,
               t.THROADEND v_5,t.JSDJ v_6,t.GLDJ v_7,t.FANGX v_8,t.PCSJ v_9,t.LDFL v_10,
               t.UNIT v_11,t.DIST v_12,t.TZGS v_13,t.JHNF v_14,
               decode(sbthcd, '7', '已上报', 7, '未上报', sbzt) v_15
          from XMK_AQSMFH t
          left join (select count(*) jhsl, a4.id
                      from plan_af a1
                      left join sck_aqsmfh a2 on a1.sckid = a2.id
                      left join sck_aqsmfh_ld a3 on a2.xmbm = a3.xmbm
                      left join xmk_aqsmfh a4 on a3.xmkid = a4.id
                     group by a4.id) t1 on t.id = t1.id
         where 1 = 1 -->
      select rownum v_0,t.province v_1,t.town v_2,t.county v_3,    
      t.roadcode v_4,t.roadname v_5,t.roadstart v_6,t.roadend v_7, 
      t.ylxbm v_8, t.ylxmc v_9, t.yqdzh v_10, t.yzdzh v_11,
      t.jsdj v_12,t.fangx v_13,to_char(t.yhlc,'fm9999999990.000') v_14,t.pcsj v_15,t.ldfl v_16,t.jtsgpcf v_17,t.jtsgfxdj v_18,t.gltjpcf v_19,t.glfxdj v_20,
      t.sgpb v_21,t.dgjw v_22,t.lxjw v_23,t.lxxp v_24,t.doup v_25,t.sjbl v_26, t.lcxy v_27,t.hjfz v_28,t.jtlpbzb v_29,t.xchbc v_30,t.csxsss v_31,
      t.hul v_32,t.bzbx v_33,t.jshsxyd v_34,t.aqssqt v_35,t.tjgc v_36,t.hjzz v_37,t.bzbxcz v_38,t.jckcz v_39,t.jzhl v_40,t.jshsxydcz v_41,
      t.aqssqtcz v_42,t.tzgs v_43,t.jhnf v_44
         from XMK_AQSMFH t
          left join (select count(*) jhsl, a4.id
                      from plan_af a1
                      left join sck_aqsmfh a2 on a1.sckid = a2.id
                      left join sck_aqsmfh_ld a3 on a2.xmbm = a3.xmbm
                      left join xmk_aqsmfh a4 on a3.xmkid = a4.id
                     group by a4.id) t1 on t.id = t1.id
         where 1 = 1
	 			and  to_number(sbthcd) &lt;=to_number(#{sbthcd}) 
	 		<if test="unitcode!='' and unitcode!= null ">
				${unitcode}
			</if>
			<if test="distcode!='' and distcode!= null ">
				${distcode}
			</if>
	 		<if test="roadname!='' and roadname!= null ">
	 			and roadname like '%'||(#{roadname})||'%'
	 		</if>
	 		<if test="jhnf!='' and jhnf!= null ">
	 			and jhnf like '%'||(#{jhnf})||'%'
	 		</if>
<!-- 	 		<if test="sbzt!='' and sbzt!= null "> -->
<!-- 	 			and decode(sbthcd,'7','已上报',#{sbthcd},'未上报',sbzt) like '%'||(#{sbzt})||'%' -->
<!-- 	 		</if> -->
	 		<if test="sbzt!='' and sbzt!= null ">
	 			
				<if test="sbzt == '未审核'">
 					and (zszt like '%'||(#{sbzt})||'%' or zszt is null) and sbthcd=7
				</if>
				<if test="sbzt == '已审核'">
	 					and (decode(zszt,null,'未审核',zszt) like '%'||(#{sbzt})||'%' or  (zsyj is not null and sbthcd != 7))
				</if>
				<if test="sbzt == '审核不同意'">
	 					and zsyj is not null and sbthcd != 7
				</if>
				<if test="sbzt == '审核同意'">
	 					and zsyj = '同意' and sbthcd = 7 and (decode(zszt,null,'未审核',zszt) like '已审核')
				</if>
				
	 		</if>
	 		<if test="jsdj!='' and jsdj!= null ">
 				${jsdj}
 			</if> 
 			<if test="gldj!='' and gldj!= null ">
 				${gldj}
 			</if> 
	 		<if test="roadcode!='' and roadcode!= null ">
	 			and roadcode like '%'||(#{roadcode})||'%'
	 		</if>
	 		<if test="tsdq!='' and tsdq!= null ">
	 			${tsdq}
	 		</if>
	 		<if test="bzls!='' and bzls!= null ">
 			   and decode(t1.jhsl,null,'无','有') like #{bzls}||'%'
 			</if>
 			<if test="xmklx !='' and xmklx != null ">
 			   and xmklx like '%'||(#{xmklx})||'%'
 		    </if>
	 			<!-- order by decode(sbthcd,#{sbthcd},'未上报',sbzt) desc  -->
	 			order by v_0 asc
	</select>	
 	<!-- wdd路网项目     基础库审核   安全生命防护   导出excel end-->	
</mapper>