<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "/xsd/mybatis-3-mapper.dtd">
<mapper namespace="com.hdsx.jxzhpt.jckwqgz">
<insert id="insertJckwqgz"  parameterType="jckwqgz">
	insert into xmk_wqgz(id,qlmc,qlbh,xzqhmc,xzqhdm,lxmc,lxbm,gydw,gydwbm,xjgjnd,jsdj,pddj,qlzxzh,qlkd,qlqc,
		kjzc,dkzdkj,akjfl,sbjgxs,bhnr,bz,tbbmbm,xmnf,xmtype,tbsj,sbzt,shzt,sbthcd,tsdq) 
		values(sys_guid(),#{qlmc},#{qlbh},#{xzqhmc},#{xzqhdm},#{lxmc},#{lxbm},#{gydw},
		(select id from xtgl_department where name=#{gydw}),#{xjgjnd},#{jsdj},
		#{pddj},#{qlzxzh},#{qlkd},#{qlqc},#{kjzc},#{dkzdkj},#{akjfl},#{sbjgxs},#{bhnr},#{bz},#{tbbmbm},#{xmnf},#{xmtype},
		sysdate,'未上报','未审核',#{sbthcd},#{tsdq})
</insert>

 <select id="selectJckwqgz" parameterType="jckwqgz" resultType="jckwqgz">
 	select * from (
 		select rownum num ,t.*,decode(sbthcd,#{sbthcd},'未上报',sbzt) sbzt2 from xmk_wqgz t where 1=1 and SFYLRBWQK='是'
 			and  sbthcd &lt;=#{sbthcd} and (sfwg!='是' or sfwg is null)
 		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
 		<if test="lxmc!='' and lxmc!= null ">
 			and lxmc like '%'||(#{lxmc})||'%'
 		</if>
 		<if test="xlxmc!='' and xlxmc!= null ">
 			and xlxmc like '%'||(#{xlxmc})||'%'
 		</if>
 		<if test="qlmc!='' and qlmc!= null ">
 			and qlmc like '%'||(#{qlmc})||'%'
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf in (${xmnf})
 		</if>
 		<if test="gldj!='' and gldj!= null">
 			${gldj}
 		</if>
 		<if test="jsdj!='' and jsdj!= null">
 			${jsdj}
 		</if>
 		<if test="xmtype!='' and xmtype!= null ">
 			and xmtype like '%'||(#{xmtype})||'%'
 		</if>
 		<if test="sbzt!='' and sbzt!= null ">
 			and decode(sbthcd,#{sbthcd},'未上报',sbzt) like '%'||(#{sbzt})||'%'
 		</if>
<!--  		<if test="jsdj!='' and jsdj!= null ">
 			and jsdj like '%'||(#{jsdj})||'%'
 		</if> -->
 		<if test="akjfl!='' and akjfl!= null">
 			${akjfl}
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
 			and lxbm like '%'||(#{lxbm})||'%'
 		</if>
 		 <if test="xlxbm!='' and xlxbm!= null ">
 			and xlxbm like '%'||(#{xlxbm})||'%'
 		</if>
 		<if test="qlbh!='' and qlbh!= null ">
 			and qlbh like '%'||(#{qlbh})||'%'
 		</if>
 		<if test="tsdq!='' and tsdq!= null and tsdq !='全部'">
 			${tsdq}
 		</if>
 		<if test="xmklx !='' and xmklx != null ">
 			and xmklx like '%'||(#{xmklx})||'%'
 		</if>
 		
		) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows} 
		order by decode(sbthcd,#{sbthcd},'未上报',sbzt),shzt desc 
 </select>
  <select id="selectWqgzCount" parameterType="jckwqgz" resultType="int">
 		select count(*) from xmk_wqgz t where 1=1 and SFYLRBWQK='是'
 			and  sbthcd &lt;=#{sbthcd}  and (sfwg!='是' or sfwg is null)
 		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
 		<if test="lxmc!='' and lxmc!= null ">
 			and lxmc like '%'||(#{lxmc})||'%'
 		</if>
 		<if test="xlxmc!='' and xlxmc!= null ">
 			and xlxmc like '%'||(#{xlxmc})||'%'
 		</if>
 		<if test="qlmc!='' and qlmc!= null ">
 			and qlmc like '%'||(#{qlmc})||'%'
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf in (${xmnf})
 		</if>
 		<if test="gldj!='' and gldj!= null">
 			${gldj}
 		</if>
 		<if test="jsdj!='' and jsdj!= null">
 			${jsdj}
 		</if>
 		<if test="xmtype!='' and xmtype!= null ">
 			and xmtype like '%'||(#{xmtype})||'%'
 		</if>
 		<if test="sbzt!='' and sbzt!= null ">
 			and decode(sbthcd,#{sbthcd},'未上报',sbzt) like '%'||(#{sbzt})||'%'
 		</if>
<!--  		<if test="jsdj!='' and jsdj!= null ">
 			and jsdj like '%'||(#{jsdj})||'%'
 		</if> -->
 		<if test="akjfl!='' and akjfl!= null">
 			${akjfl}
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
 			and lxbm like '%'||(#{lxbm})||'%'
 		</if>
 		<if test="xlxbm!='' and xlxbm!= null ">
 			and lxbm like '%'||(#{lxbm})||'%'
 		</if>
 		<if test="qlbh!='' and qlbh!= null ">
 			and qlbh like '%'||(#{qlbh})||'%'
 		</if>
 		<if test="tsdq!='' and tsdq!= null and tsdq !='全部'">
 			${tsdq}
 		</if>
 		<if test="xmklx !='' and xmklx != null ">
 			and xmklx like '%'||(#{xmklx})||'%'
 		</if>
 </select>
 <select id="selectWqgzCount1" parameterType="jckwqgz" resultType="int">
 		select count(*) from xmk_wqgz t 
 		left join (select count(*) jhsl,a3.id from plan_wqgz a1 left join sck_wqgz a2 on a1.sckid=a2.sckid left join xmk_wqgz a3 on a2.xmkid=a3.id group by a3.id) t1
	 			on t.id=t1.id 
 		where 1=1 
 			and  sbthcd &lt;=#{sbthcd} and gydwbm like '1%'  and xxcsj='是' and sfsc is null
 		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
 		<if test="lxmc!='' and lxmc!= null ">
 			and lxmc like '%'||(#{lxmc})||'%'
 		</if>
 		<if test="qlmc!='' and qlmc!= null ">
 			and qlmc like '%'||(#{qlmc})||'%'
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf in (${xmnf})
 		</if>
 		<if test="xmtype!='' and xmtype!= null ">
 			and xmtype like '%'||(#{xmtype})||'%'
 		</if>
 		<if test="sbzt!='' and sbzt!= null ">
 			and decode(sbthcd,#{sbthcd},'未上报',sbzt) like '%'||(#{sbzt})||'%'
 		</if>
		<if test="jsdj!='' and jsdj!= null ">
 			and pddj like '%'||(#{jsdj})||'%'
 		</if> 
 		<if test="akjfl!='' and akjfl!= null ">
 			${akjfl}
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
 			and lxbm like '%'||(#{lxbm})||'%'
 		</if>
 		<if test="qlbh!='' and qlbh!= null ">
 			and qlbh like '%'||(#{qlbh})||'%'
 		</if>
 		<if test="tsdq!='' and tsdq!= null ">
 			${tsdq}
 		</if>
 		<if test="sfylrbwqk!='' and sfylrbwqk!= null ">
 			and sfylrbwqk like '%'||(#{sfylrbwqk})||'%'
 		</if>
 		<if test="bzls!='' and bzls!= null ">
			and decode(t1.jhsl,null,'无','有') like #{bzls}||'%'
 		</if>
 		<if test="gldj != '' and gldj != null ">
 			${gldj}
 		</if>
 </select>
 
 <select id="selectJckwqgzById" parameterType="jckwqgz" resultType="jckwqgz">
 	select * from xmk_wqgz where id=#{id}
 </select>
 <update id="updateJckwqgz" parameterType="jckwqgz">
 	update xmk_wqgz set qlmc=#{qlmc} ,qlbh=#{qlbh},xzqhmc=#{xzqhmc},xzqhdm=#{xzqhdm},lxmc=#{lxmc},lxbm=#{lxbm},
 		gydw=#{gydw} ,xjgjnd=#{xjgjnd},jsdj=#{jsdj},pddj=#{pddj},qlzxzh=#{qlzxzh},qlkd=#{qlkd},qlqc=#{qlqc},kjzc=#{kjzc},
 		dkzdkj=#{dkzdkj},akjfl=#{akjfl},sbjgxs=#{sbjgxs},bhnr=#{bhnr},bz=#{bz},xmnf=#{xmnf},xmtype=#{xmtype}
 		where id=#{id}
 </update>
  <delete id="deleteJckWqgz" parameterType="java.util.List" >
 	delete from xmk_wqgz where id =#{String}
 </delete>
 
 <update id="xgJckwqgzSbzt" parameterType="hashmap" >
 	update xmk_wqgz set sbzt='已上报',sbsj=sysdate,sbbm=#{sbbm},sbthcd=#{sbthcd} where id =#{id}
 </update>
 
 <update id="xgJckwqgzShzt" parameterType="hashmap" >
 	update xmk_wqgz set shzt='已审核',shsj=sysdate,shbm=#{shbm} where id=#{id}
 </update>

  <update id="xgJckWqgzTH" parameterType="java.util.List" >
 	update xmk_wqgz set sbthcd=(sbthcd+2) where id =#{String}
 </update>
 
  <select id="selectGpsroad"  parameterType="hashmap" resultType="jckwqgz">
 	select roadbm qlbh,F002 qlmc,roadpos qlzxzh,gydw,<!-- DISTNAME xzqhmc -->
 	(select name from jxzhpt.xtgl_xzqh where id =substr(roadcode,length(roadcode)-5,6)) xzqhmc,
 		substr(roadcode,length(roadcode)-5,6) xzqhdm,
 		roadname lxmc,roadcode lxbm,F011 kjzc,F012 qlqc,F014 qlkd,F016 dkzdkj,<!-- ,F045 pddj -->
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '技术状况评定%' and F002=F044) pddj,decode(substr(F052, 0, 4), null,
 		substr(F051,0,4),substr(F052, 0, 4)) xjgjnd<!-- ,F010 akjfl -->,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '桥梁跨径分类%' and F002=F009) akjfl,
 		<!-- ,F022 sbjgxs -->
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '上部结构形式%' and F002=F113) sbjgxs,F112 bhnr,F074 bz,ptx,pty,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '跨越地物类型%' and F002=f006) kydwlx,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '通航等级%' and F002=F037) thdj,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '桥墩类型%' and F002=F023) qdlx,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '桥台类型%' and F002=F025) qtlx,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '桥面铺装类型%' and F002=F027) pzlx,
 		F013 qmjk,F020 qxjk,F015 zqks
		from DATA50  where substr(roadcode,1,1) in('G','S','X','Y','C','Z') and sfxzdm='1' <!-- and F045 in('四类','五类')  -->
		and F044 in(SELECT F002 FROM ROADTARGETVALUES WHERE F001 LIKE '技术状况评定%' and F003 in('四类','五类'))
		<!-- and F010 in('中桥','大桥','特大桥')  -->
		and F009 in(SELECT F002 FROM ROADTARGETVALUES WHERE F001 LIKE '桥梁跨径分类%' and F003 in('中桥','大桥','特大桥'))
		and roadbm like #{qlbh} ||'%' 
		<if test="gydwbm!='' and gydwbm!= null ">
			and gydw in(select name from xtgl_department where id like '%'||substr(#{gydwbm},0,4)||'_'||substr(#{gydwbm},6)||'%' or parent like '%'||substr(#{gydwbm},0,4)||'_'||substr(#{gydwbm},6)||'%') 
		</if>
<!--  		<if test="xzqhdm!='' and xzqhdm!= null ">
			and substr(roadcode,length(roadcode)-5,6) in(select id from xtgl_xzqh where id=#{xzqhdm} or parent=#{xzqhdm}) 
		</if>  -->
		order by roadbm,F002
 </select>
   <select id="selectGpsroad1"  parameterType="hashmap" resultType="jckwqgz">
 	select roadbm qlbh,F002 qlmc,roadpos qlzxzh,gydw,<!-- DISTNAME xzqhmc -->
 	(select name from jxzhpt.xtgl_xzqh where id =substr(roadcode,length(roadcode)-5,6)) xzqhmc,
 		substr(roadcode,length(roadcode)-5,6) xzqhdm,
 		(select substr(name,0,instr(name, '市')) from jxzhpt.xtgl_xzqh where id =substr(roadcode,length(roadcode)-5,6)) sqs,
 		(select decode(substr(name,instr(name, '市')+1,instr(name, '县')),null,substr(name,instr(name, '市')+1,instr(name, '区')),substr(name,instr(name, '市')+1,instr(name, '县'))) from jxzhpt.xtgl_xzqh where id =substr(roadcode,length(roadcode)-5,6)) xsq,
 		(select substr(name,decode(instr(name, '县'),null,decode(instr(name, '区'),null,length(name),instr(name, '区')+1),instr(name, '县')+1),length(name)) from jxzhpt.xtgl_xzqh where id =substr(roadcode,length(roadcode)-5,6)) szxz,
 		roadname lxmc,roadcode lxbm,F011 kjzc,F012 qlqc,F014 qlkd,F016 dkzdkj,<!-- ,F045 pddj -->
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '技术状况评定%' and F002=F044) pddj,decode(substr(F052, 0, 4), null,
 		substr(F051,0,4),substr(F052, 0, 4)) xjgjnd<!-- ,F010 akjfl -->,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '桥梁跨径分类%' and F002=F009) akjfl,
 		<!-- ,F022 sbjgxs -->
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '上部结构形式%' and F002=F113) sbjgxs,F112 bhnr,F074 bz,trunc(ptx,6) ptx,trunc(pty,6) pty,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '跨越地物类型%' and F002=f006) kydwlx,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '通航等级%' and F002=F037) thdj,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '桥墩类型%' and F002=F023) qdlx,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '桥台类型%' and F002=F025) qtlx,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '桥面铺装类型%' and F002=F027) pzlx,
 		F013 qmjk,F020 qxjk,F015 zqks,decode(d.yqlbm, null,  q.yqlbh, d.yqlbm) xqlbm,decode(d.yqlmc, null, q.yqlmc, d.yqlmc) xqlmc,decode(d.yqlzz, null, q.yzxzh, d.yqlzz) xzxzh
		from DATA50 d left join qlxlgl q on d.roadbm=q.xqlbh where substr(roadcode,1,1) in('G','S','X','Y','C','Z') and sfxzdm='1' <!-- and F045 in('四类','五类')  -->
<!-- 		and F044 in(SELECT F002 FROM ROADTARGETVALUES WHERE F001 LIKE '技术状况评定%' and F003 in('四类','五类')) -->
		<!-- and F010 in('中桥','大桥','特大桥')  -->
		and F009 in(SELECT F002 FROM ROADTARGETVALUES WHERE F001 LIKE '桥梁跨径分类%' and F003 in('中桥','大桥','特大桥','小桥'))
		and roadbm like #{qlbh} ||'%' 
		<if test="gydwbm!='' and gydwbm!= null ">
			and gydw in(select name from xtgl_department where id like '%'||substr(#{gydwbm},0,4)||'_'||substr(#{gydwbm},6)||'%' or parent like '%'||substr(#{gydwbm},0,4)||'_'||substr(#{gydwbm},6)||'%') 
		</if>
<!--  		<if test="xzqhdm!='' and xzqhdm!= null ">
			and substr(roadcode,length(roadcode)-5,6) in(select id from xtgl_xzqh where id=#{xzqhdm} or parent=#{xzqhdm}) 
		</if>  -->
		order by roadbm,F002
 </select>
 
 
 <select id="selectGpsroad11"  parameterType="hashmap" resultType="jckwqgz">
 	select roadbm qlbh,F002 qlmc,roadpos qlzxzh,gydw,<!-- DISTNAME xzqhmc -->
 	(select name from jxzhpt.xtgl_xzqh where id =substr(roadcode,length(roadcode)-5,6)) xzqhmc,
 		substr(roadcode,length(roadcode)-5,6) xzqhdm,
 		(select substr(name,0,instr(name, '市')) from jxzhpt.xtgl_xzqh where id =substr(roadcode,length(roadcode)-5,6)) sqs,
 		(select decode(substr(name,instr(name, '市')+1,instr(name, '县')),null,substr(name,instr(name, '市')+1,instr(name, '区')),substr(name,instr(name, '市')+1,instr(name, '县'))) from jxzhpt.xtgl_xzqh where id =substr(roadcode,length(roadcode)-5,6)) xsq,
 		(select substr(name,decode(instr(name, '县'),null,decode(instr(name, '区'),null,length(name),instr(name, '区')+1),instr(name, '县')+1),length(name)) from jxzhpt.xtgl_xzqh where id =substr(roadcode,length(roadcode)-5,6)) szxz,
 		roadname lxmc,roadcode lxbm,F011 kjzc,F012 qlqc,F014 qlkd,F016 dkzdkj,<!-- ,F045 pddj -->
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '技术状况评定%' and F002=F044) pddj,decode(substr(F052, 0, 4), null,
 		substr(F051,0,4),substr(F052, 0, 4)) xjgjnd<!-- ,F010 akjfl -->,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '桥梁跨径分类%' and F002=F009) akjfl,
 		<!-- ,F022 sbjgxs -->
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '上部结构形式%' and F002=F113) sbjgxs,F112 bhnr,F074 bz,trunc(ptx,6) ptx,trunc(pty,6) pty,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '跨越地物类型%' and F002=f006) kydwlx,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '通航等级%' and F002=F037) thdj,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '桥墩类型%' and F002=F023) qdlx,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '桥台类型%' and F002=F025) qtlx,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '桥面铺装类型%' and F002=F027) pzlx,
 		F013 qmjk,F020 qxjk,F015 zqks,q.xqlbh,q.xqlmc,q.xzxzh
		from DATA50 d left join qlxlgl q on d.roadbm=q.yqlbh where substr(roadcode,1,1) in('G','S','X','Y','C','Z') and sfxzdm='1' <!-- and F045 in('四类','五类')  -->
<!-- 		and F044 in(SELECT F002 FROM ROADTARGETVALUES WHERE F001 LIKE '技术状况评定%' and F003 in('四类','五类')) -->
		<!-- and F010 in('中桥','大桥','特大桥')  -->
		and F009 in(SELECT F002 FROM ROADTARGETVALUES WHERE F001 LIKE '桥梁跨径分类%' and F003 in('中桥','大桥','特大桥','小桥'))
		and xqlbh like #{qlbh} ||'%' 
		<if test="gydwbm!='' and gydwbm!= null ">
			and gydw in(select name from xtgl_department where id like '%'||substr(#{gydwbm},0,4)||'_'||substr(#{gydwbm},6)||'%' or parent like '%'||substr(#{gydwbm},0,4)||'_'||substr(#{gydwbm},6)||'%') 
		</if>
<!--  		<if test="xzqhdm!='' and xzqhdm!= null ">
			and substr(roadcode,length(roadcode)-5,6) in(select id from xtgl_xzqh where id=#{xzqhdm} or parent=#{xzqhdm}) 
		</if>  -->
		order by roadbm,F002
 </select>
 
  <select id="JckWqgzRoad" parameterType="hashmap" resultType="jckwqgz">
 	select * from xmk_wqgz where shzt='已审核' and qlbh like #{qlbh}||'%' and SFYLRBWQK='是' and sfwg != '是'
 	<if test="gydwbm!='' and gydwbm!= null ">
		and tbbmbm in(select id from xtgl_department where id like '%'||substr(#{gydwbm},0,4)||'_'||substr(#{gydwbm},6)||'%' or parent like '%'||substr(#{gydwbm},0,4)||'_'||substr(#{gydwbm},6)||'%') 
	</if>
 	order by qlbh
 </select>
 
 <select id="JckWqgzRoad1" parameterType="hashmap" resultType="jckwqgz">
 	select * from xmk_wqgz where shzt='已审核' and qlbh like #{qlbh}||'%' and xxcsj='是' 
 	<if test="gydwbm!='' and gydwbm!= null ">
		and tbbmbm in(select id from xtgl_department where id like '%'||substr(#{gydwbm},0,4)||'_'||substr(#{gydwbm},6)||'%' or parent like '%'||substr(#{gydwbm},0,4)||'_'||substr(#{gydwbm},6)||'%') 
	</if>
 	order by qlbh
 </select>
 
 
  <select id="selectJckShwqgz" parameterType="jckwqgz" resultType="jckwqgz">
 	select * from (
 		select rownum num ,t.* from xmk_wqgz t where sbthcd=7 and SFYLRBWQK='是'
		and sbthcd>=#{sbthcd} and (sfwg!='是' or sfwg is null)
 		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
 		<if test="lxmc!='' and lxmc!= null ">
 			and lxmc like '%'||(#{lxmc})||'%'
 		</if>
 		<if test="xlxmc!='' and xlxmc!= null">
 		 	and xlxmc like '%'||(#{xlxmc})||'%'
 		</if>
 		<if test="qlmc!='' and qlmc!= null ">
 			and qlmc like '%'||(#{qlmc})||'%'
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf in (${xmnf})
 		</if>
 		<if test="xmtype!='' and xmtype!= null ">
 			and xmtype like '%'||(#{xmtype})||'%'
 		</if>
 		<if test="shzt!='' and shzt!= null ">
 			and shzt like '%'||(#{shzt})||'%'
 		</if>
 		<if test="jsdj!='' and jsdj!= null ">
 			${jsdj}
 		</if> 
 		<if test="gldj!='' and gldj!= null ">
 			${gldj}
 		</if> 
 		<if test="akjfl!='' and akjfl!= null ">
 			${akjfl}
 		</if>
 		<if test="lxbm!='' and lxbm!= null">
 			and lxbm like '%'||(#{lxbm})||'%'
 		</if>
 		<if test="xlxbm!='' and xlxbm!= null">
 		 	and xlxbm like '%'||(#{xlxbm})||'%'
 		</if>
 		<if test="qlbh!='' and qlbh!= null ">
 			and qlbh like '%'||(#{qlbh})||'%'
 		</if>
 		<if test="tsdq!='' and tsdq!= null ">
 			${tsdq}
 		</if>
 		<if test="xmklx !='' and xmklx != null ">
 			and xmklx like '%'||(#{xmklx})||'%'
 		</if>
 			) t1 where t1.num &lt;=(#{page} * #{rows}) and t1.num>(#{page}-1)*#{rows} 
 			order by shzt desc
 </select>
  <select id="selectWqgzShCount" parameterType="jckwqgz" resultType="int">
 		select count(*) from xmk_wqgz t where sbthcd=7 and SFYLRBWQK='是' and sbthcd>=#{sbthcd}  and (sfwg!='是' or sfwg is null)
 		<if test="gydw!='' and gydw!= null ">
			${gydw}
		</if>
		<if test="xzqhdm!='' and xzqhdm!= null ">
			${xzqhdm}
		</if>
 		<if test="lxmc!='' and lxmc!= null ">
 			and lxmc like '%'||(#{lxmc})||'%'
 		</if>
 		<if test="xlxmc!='' and xlxmc!= null ">
 			and xlxmc like '%'||(#{xlxmc})||'%'
 		</if>
 		<if test="qlmc!='' and qlmc!= null ">
 			and qlmc like '%'||(#{qlmc})||'%'
 		</if>
 		<if test="xmnf!='' and xmnf!= null ">
 			and xmnf in (${xmnf})
 		</if>
 		<if test="xmtype!='' and xmtype!= null ">
 			and xmtype like '%'||(#{xmtype})||'%'
 		</if>
 		<if test="shzt!='' and shzt!= null ">
 			and shzt like '%'||(#{shzt})||'%'
 		</if>
 		<if test="jsdj!='' and jsdj!= null ">
 			${jsdj}
 		</if> 
 		<if test="gldj!='' and gldj!= null ">
 			${gldj}
 		</if> 
 		<if test="akjfl!='' and akjfl!= null ">
 			${akjfl}
 		</if>
 		<if test="lxbm!='' and lxbm!= null ">
 			and lxbm like '%'||(#{lxbm})||'%'
 		</if>
 		<if test="xlxbm!='' and xlxbm!= null ">
 			and xlxbm like '%'||(#{xlxbm})||'%'
 		</if>
 		<if test="qlbh!='' and qlbh!= null ">
 			and qlbh like '%'||(#{qlbh})||'%'
 		</if>
 		<if test="tsdq!='' and tsdq!= null ">
 			${tsdq}
 		</if>
 		<if test="xmklx !='' and xmklx != null ">
 			and xmklx like '%'||(#{xmklx})||'%'
 		</if>
 </select>

 <select id="onceWqgz" parameterType="jckwqgz" resultType="int">
 		select count(*) from xmk_wqgz where 1=1
 		<if test="qlbh!='' and qlbh!= null "  >
 			and (qlbh=#{qlbh} or qlbh=substr(#{qlbh},1,4)||substr(#{qlbh},-5)||substr(#{qlbh},5,6))
 		</if>
 		<if test="lxbm!='' and lxbm!= null "  >
 			or (lxbm=#{lxbm} and to_number(qlzxzh)=to_number(#{qlzxzh}))
 		</if>
 		<if test="gydw!='' and gydw!= null "  >
 			and gydwbm like #{gydw}||'%'
 		</if>
 </select>
 
 <sql id="wqgz_commonsql">
 	and  sbthcd &lt;=#{sbthcd} and sfylrbwqk='是' and (sfwg!='是' or sfwg is null)
 	<if test="gydw!='' and gydw!= null ">
		${gydw}
	</if>
	<if test="xzqhdm!='' and xzqhdm!= null ">
		${xzqhdm}
	</if>
	<if test="lxmc!='' and lxmc!= null ">
		and lxmc like '%'||(#{lxmc})||'%'
	</if>
	<if test="qlmc!='' and qlmc!= null ">
		and qlmc like '%'||(#{qlmc})||'%'
	</if>
	<if test="xmnf!='' and xmnf!= null ">
		and xmnf in (${xmnf})
	</if>
	<if test="xmtype!='' and xmtype!= null ">
		and xmtype like '%'||(#{xmtype})||'%'
	</if>
	<if test="sbzt!='' and sbzt!= null ">
		and decode(sbthcd,#{sbthcd},'未上报',sbzt) like '%'||(#{sbzt})||'%'
	</if>
	<if test="shzt!='' and shzt!= null ">
 		and shzt like '%'||(#{shzt})||'%'
   </if>
	<if test="gldj!='' and gldj!= null">
		${gldj}
	</if>
	<if test="jsdj!='' and jsdj!= null">
		${jsdj}
	</if>
	<if test="akjfl!='' and akjfl!= null">
		${akjfl}
	</if>
	<if test="tsdq!='' and tsdq!= null and tsdq !='全部'">
		${tsdq}
	</if>
	<if test="lxbm!='' and lxbm!= null ">
 		and lxbm like '%'||(#{lxbm})||'%'
 	</if>
 	<if test="qlbh!='' and qlbh!= null ">
 		and qlbh like '%'||(#{qlbh})||'%'
 	</if>

 	<if test="xlxbm !='' and xlxbm != null">
	    and xlxbm like '%'||(#{xlxbm})||'%'
	</if>
	<if test="xqlbm !='' and xqlbm != null">
	    and xlxbm like '%'||(#{xqlbm})||'%'
	</if>
	<if test="xzxzh !='' and xzxzh != null">
	    and xlxbm like '%'||(#{xlxbm})||'%'
	</if>
	<if test="xlxmc !='' and xlxmc != null">
	    and xlxbm like '%'||(#{xlxbm})||'%'
	</if>
	<if test="xqlmc !='' and xqlmc != null">
	    and xlxbm like '%'||(#{xlxbm})||'%'
	</if>

 	<if test="xmklx !='' and xmklx != null ">
 		and xmklx like '%'||(#{xmklx})||'%'
 	</if>
 </sql>

 <select id="exportExcel_wqgz" parameterType="jckwqgz" resultType="elist">
 	  select 
  rownum v_0,gydw v_1,xzqhdm v_2,xzqhmc v_3,ptx v_4,pty v_5,  
  lxbm v_6, lxmc v_7, qlbh v_8, qlmc v_9, qlzxzh v_10,
  xlxbm v_11, xlxmc v_12, xqlbm v_13, xqlmc v_14, xzxzh v_15,
  xjgjnd v_16, qlqc v_17, qlkd v_18, kjzc v_19, dkzdkj v_20, akjfl v_21, sbjgxs v_22, pddj v_23, bhnr v_24, xmnf v_25,
  xmklx v_26, tsdq v_27, bz v_28
   from xmk_wqgz  where 1=1
 	<include refid="wqgz_commonsql"/>
 	<!-- 
 	and sbthcd &lt;=#{sbthcd}
 	<if test="gydw!='' and gydw!= null ">
		${gydw}
	</if>
	<if test="xzqhdm!='' and xzqhdm!= null ">
		${xzqhdm}
	</if>
	<if test="lxmc!='' and lxmc!= null ">
		and lxmc like '%'||(#{lxmc})||'%'
	</if>
	<if test="qlmc!='' and qlmc!= null ">
		and qlmc like '%'||(#{qlmc})||'%'
	</if>
	<if test="xmnf!='' and xmnf!= null ">
		and xmnf like '%'||(#{xmnf})||'%'
	</if>
	<if test="xmtype!='' and xmtype!= null ">
		and xmtype like '%'||(#{xmtype})||'%'
	</if>
	<if test="shzt!='' and shzt!= null ">
		and shzt  like '%'||(#{sbzt})||'%'
	</if>
	<if test="jsdj!='' and jsdj!= null ">
		and jsdj like '%'||(#{jsdj})||'%'
	</if>
	<if test="akjfl!='' and akjfl!= null ">
		and akjfl like '%'||(#{akjfl})||'%'
	</if>
	<if test="lxbm!='' and lxbm!= null ">
		and lxbm like '%'||(#{lxbm})||'%'
	</if>
	<if test="qlbh!='' and qlbh!= null ">
		and qlbh like '%'||(#{qlbh})||'%'
	</if>
	<if test="tsdq!='' and tsdq!= null ">
		and tsdq like '%'||(#{tsdq})||'%'
	</if>
	<if test="xlxbm !='' and xlxbm != null">
	    and xlxbm like '%'||(#{xlxbm})||'%'
	</if>
	<if test="xqlbm !='' and xqlbm != null">
	    and xlxbm like '%'||(#{xqlbm})||'%'
	</if>
	<if test="xzxzh !='' and xzxzh != null">
	    and xlxbm like '%'||(#{xlxbm})||'%'
	</if>
	<if test="xlxmc !='' and xlxmc != null">
	    and xlxbm like '%'||(#{xlxbm})||'%'
	</if>
	<if test="xqlmc !='' and xqlmc != null">
	    and xlxbm like '%'||(#{xlxbm})||'%'
	</if>
	<if test="xmklx !='' and xmklx != null ">
 			and xmklx like '%'||(#{xmklx})||'%'
 	</if> -->
 </select>
 <insert id="importWqgz"  parameterType="hashMap">
	insert into xmk_wqgz(id,gydwbm,gydw,xzqhdm,xzqhmc,lxbm,lxmc,qlbh,qlmc,qlzxzh,
	<!-- ,xjgjnd,qlqc,qlkd,kjzc,dkzdkj,akjfl,sbjgxs,pddj, -->
		xmnf,<!-- xmtype, -->bhnr,bz,tbsj,tbbmbm,sbthcd,sbzt,shzt) 
		values(sys_guid(),(select id from xtgl_department where name=#{0}),#{0},#{1},#{2},#{3},#{4},#{5},#{6},#{7},#{8},
		<!-- #{9},#{10},#{11},#{12},#{13},#{14},#{15},#{16},#{17}, -->
		#{9},#{10},sysdate,#{tbbmbm},#{sbthcd},'未上报','未审核')
 </insert>

  <select id="exportExcel_wqgz_sh" parameterType="jckwqgz" resultType="elist">
 	  select 
	  rownum v_0, gydw v_1, xzqhdm v_2, xzqhmc v_3, ptx v_4, pty v_5,
	  lxbm v_6, lxmc v_7, qlbh v_8, qlmc v_9, qlzxzh v_10,
	  xlxbm v_11, xlxmc v_12, xqlbm v_13, xqlmc v_14, xzxzh v_15,	  
	  xjgjnd v_16, qlqc v_17, qlkd v_18, kjzc v_19, dkzdkj v_20, akjfl v_21, sbjgxs v_22, pddj v_23, bhnr v_24, xmnf v_25,
	  xmklx v_26, tsdq v_27, bz v_28
	   from xmk_wqgz  where sbthcd=7
 	<include refid="wqgz_commonsql"/>
 </select>
 
   <select id="daoRuwqgz"  parameterType="jckwqgz" resultType="jckwqgz">
 	<!-- select roadbm qlbh,F002 qlmc,roadpos qlzxzh,gydw,
 	(select name from jxzhpt.xtgl_xzqh where id =substr(roadcode,length(roadcode)-5,6)) xzqhmc,
 		substr(roadcode,length(roadcode)-5,6) xzqhdm,
 		roadname lxmc,roadcode lxbm,F011 kjzc,F012 qlqc,F014 qlkd,F016 dkzdkj,F045 pddj,decode(substr(F052, 0, 4), null,
 		substr(F051,0,4),substr(F052, 0, 4)) xjgjnd,F010 akjfl,F022 sbjgxs,F112 bhnr,F074 bz 
		from DATA50 where substr(roadcode,1,1) in('G','S','X','Y') and sfxzdm='1' and F045 in('四类','五类') 
		and F010 in('中桥','大桥','特大桥')  -->
		select roadbm qlbh,F002 qlmc,roadpos qlzxzh,gydw,<!-- DISTNAME xzqhmc -->
 		(select name from jxzhpt.xtgl_xzqh where id =substr(roadcode,length(roadcode)-5,6)) xzqhmc,
 		substr(roadcode,length(roadcode)-5,6) xzqhdm,
 		roadname lxmc,roadcode lxbm,F011 kjzc,F012 qlqc,F014 qlkd,F016 dkzdkj,<!-- ,F045 pddj -->
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '技术状况评定%' and F002=F044) pddj,decode(substr(F052, 0, 4), null,
 		substr(F051,0,4),substr(F052, 0, 4)) xjgjnd<!-- ,F010 akjfl -->,
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '桥梁跨径分类%' and F002=F009) akjfl,
 		<!-- ,F022 sbjgxs -->
 		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '上部结构形式%' and F002=F113) sbjgxs,F112 bhnr,F074 bz 
		from DATA50 where substr(roadcode,1,1) in('G','S','X','Y','C','Z') and sfxzdm='1' <!-- and F045 in('四类','五类')  -->
		and F044 in(SELECT F002 FROM ROADTARGETVALUES WHERE F001 LIKE '技术状况评定%' and F003 in('四类','五类'))
		<!-- and F010 in('中桥','大桥','特大桥')  -->
		and F009 in(SELECT F002 FROM ROADTARGETVALUES WHERE F001 LIKE '桥梁跨径分类%' and F003 in('中桥','大桥','特大桥'))
		<if test="gydwbm!='' and gydwbm!= null ">
			and gydw in(select name from xtgl_department where id like #{gydwbm}||'%' or parent like #{gydwbm}||'%') 
		</if>
 			and (roadbm=#{qlbh} or (roadcode=#{lxbm} and roadpos=to_number(#{qlzxzh})))
		order by roadbm,F002
 	</select>
   <select id="selJsdj"  parameterType="jckwqgz" resultType="jckwqgz">
	   	select F114 jsdj from GPSROAD where 
	   		roadcode=#{lxbm}
			and roadstart  &lt;=#{qlzxzh}
	     	and roadends >#{qlzxzh}
   </select>
 
  <insert id="importWqgz2"  parameterType="hashMap">
	
	insert into xmk_wqgz(gydwbm ,gydw,xzqhdm,xzqhmc,lxbm,lxmc,qlbh,qlmc,qlzxzh,xjgjnd,qlqc,
		qlkd,kjzc,dkzdkj,akjfl,sbjgxs,pddj,xmnf,xmtype,bhnr,bz,tbsj,tbbmbm,sbthcd,sbzt,shzt,jsdj) 
		select (select id from xtgl_department where name=#{0}) gydwbm ,#{0} gydw,#{1} xzqhdm,#{2} xzqhmc,#{3} lxbm,
		#{4} lxmc,#{5} qlbh,#{6} qlmc,#{7} qlzxzh,decode(substr(F052, 0, 4), null,substr(F051,0,4),substr(F052, 0, 4)) xjgjnd,
		to_char(F012) qlqc,to_char(F014) qlkd,to_char(F011) kjzc,to_char(F016) dkzdkj,<!-- F010 akjfl,F022 sbjgxs,F045 pddj, -->
		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '桥梁跨径分类%' and F002=F009) akjfl,
		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '上部结构形式%' and F002=F113) sbjgxs,
		(SELECT F003 FROM ROADTARGETVALUES WHERE F001 LIKE '技术状况评定%' and F002=F044) pddj,
		#{8} xmnf,'待上报' xmtype,#{9} bhnr,#{10} bz,sysdate tbsj,#{tbbmbm} tbbmbm,
		#{sbthcd} sbthcd,'未上报' sbzt,'未审核' shzt ,
		(select F114 jsdj from GPSROAD where roadcode=#{3} and roadstart  &lt;=#{7} and roadends >#{7})
		from DATA50 where roadbm =#{5}
		
 </insert>
 
 <!-- qwh查询行政区划 -->
 <select id="selectTSDQ" parameterType="jckwqgz" resultType="String">
 	select distinct x.name from xtgl_xzqhtsdq t,xtgl_tsdq x where t.xzqhdm in(
	select distinct substr(roadcode,-6) from gpsroad where substr(roadcode,1,length(roadcode)-6) =#{lxbm}
	and to_number(roadstart)&lt;=to_number(#{zdzh}) and to_number(roadends)>=to_number(#{qdzh})) and x.id=t.parent 
</select>
  <select id="selectTSDQ1" parameterType="String" resultType="String">
 	select distinct x.name from xtgl_xzqhtsdq t left join xtgl_tsdq x on t.parent=x.id where t.xzqhdm = ${value}
</select>
</mapper>

